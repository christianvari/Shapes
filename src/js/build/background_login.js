(function(){'use strict';function M(){}function S(Fu,Hu){this.x=Fu||0,this.y=Hu||0}function E(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')}function L(Fu,Hu,Vu,ku){this._x=Fu||0,this._y=Hu||0,this._z=Vu||0,this._w=ku===void 0?1:ku}function A(Fu,Hu,Vu){this.x=Fu||0,this.y=Hu||0,this.z=Vu||0}function C(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')}function R(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu){Object.defineProperty(this,'id',{value:yp++}),this.uuid=fp.generateUUID(),this.name='',this.image=Fu===void 0?R.DEFAULT_IMAGE:Fu,this.mipmaps=[],this.mapping=Hu===void 0?R.DEFAULT_MAPPING:Hu,this.wrapS=Vu===void 0?Ns:Vu,this.wrapT=ku===void 0?Ns:ku,this.magFilter=Wu===void 0?Fs:Wu,this.minFilter=ju===void 0?Vs:ju,this.anisotropy=Yu===void 0?1:Yu,this.format=qu===void 0?nl:qu,this.type=Xu===void 0?ks:Xu,this.offset=new S(0,0),this.repeat=new S(1,1),this.center=new S(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new C,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Zu===void 0?rp:Zu,this.version=0,this.onUpdate=null}function I(Fu,Hu,Vu,ku){this.x=Fu||0,this.y=Hu||0,this.z=Vu||0,this.w=ku===void 0?1:ku}function D(Fu,Hu,Vu){this.width=Fu,this.height=Hu,this.scissor=new I(0,0,Fu,Hu),this.scissorTest=!1,this.viewport=new I(0,0,Fu,Hu),Vu=Vu||{},Vu.minFilter===void 0&&(Vu.minFilter=Fs),this.texture=new R(void 0,void 0,Vu.wrapS,Vu.wrapT,Vu.magFilter,Vu.minFilter,Vu.format,Vu.type,Vu.anisotropy,Vu.encoding),this.texture.generateMipmaps=!(Vu.generateMipmaps!==void 0)||Vu.generateMipmaps,this.depthBuffer=!(Vu.depthBuffer!==void 0)||Vu.depthBuffer,this.stencilBuffer=!(Vu.stencilBuffer!==void 0)||Vu.stencilBuffer,this.depthTexture=Vu.depthTexture===void 0?null:Vu.depthTexture}function U(Fu,Hu,Vu){D.call(this,Fu,Hu,Vu),this.activeCubeFace=0,this.activeMipMapLevel=0}function G(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu){R.call(this,null,ju,qu,Xu,Yu,Zu,ku,Wu,Ju,Qu),this.image={data:Fu,width:Hu,height:Vu},this.magFilter=Yu===void 0?Us:Yu,this.minFilter=Zu===void 0?Us:Zu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function O(Fu,Hu){this.min=Fu===void 0?new A(+Infinity,+Infinity,+Infinity):Fu,this.max=Hu===void 0?new A(-Infinity,-Infinity,-Infinity):Hu}function F(Fu,Hu){this.center=Fu===void 0?new A:Fu,this.radius=Hu===void 0?0:Hu}function H(Fu,Hu){this.normal=Fu===void 0?new A(1,0,0):Fu,this.constant=Hu===void 0?0:Hu}function V(Fu,Hu,Vu,ku,Wu,ju){this.planes=[Fu===void 0?new H:Fu,Hu===void 0?new H:Hu,Vu===void 0?new H:Vu,ku===void 0?new H:ku,Wu===void 0?new H:Wu,ju===void 0?new H:ju]}function W(Fu,Hu,Vu){return void 0===Hu&&void 0===Vu?this.set(Fu):this.setRGB(Fu,Hu,Vu)}function X(){function Fu(Wu,ju){!1===Vu||(ku(Wu,ju),Hu.requestAnimationFrame(Fu))}var Hu=null,Vu=!1,ku=null;return{start:function(){!0==Vu||null==ku||(Hu.requestAnimationFrame(Fu),Vu=!0)},stop:function(){Vu=!1},setAnimationLoop:function(Wu){ku=Wu},setContext:function(Wu){Hu=Wu}}}function Y(Fu){function Hu(Xu,Yu){var Zu=Xu.array,Ju=Xu.dynamic?35048:35044,Qu=Fu.createBuffer();Fu.bindBuffer(Yu,Qu),Fu.bufferData(Yu,Zu,Ju),Xu.onUploadCallback();var Ku=5126;return Zu instanceof Float32Array?Ku=5126:Zu instanceof Float64Array?console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.'):Zu instanceof Uint16Array?Ku=5123:Zu instanceof Int16Array?Ku=5122:Zu instanceof Uint32Array?Ku=5125:Zu instanceof Int32Array?Ku=5124:Zu instanceof Int8Array?Ku=5120:Zu instanceof Uint8Array&&(Ku=5121),{buffer:Qu,type:Ku,bytesPerElement:Zu.BYTES_PER_ELEMENT,version:Xu.version}}function Vu(Xu,Yu,Zu){var Ju=Yu.array,Qu=Yu.updateRange;Fu.bindBuffer(Zu,Xu),!1===Yu.dynamic?Fu.bufferData(Zu,Ju,35044):-1===Qu.count?Fu.bufferSubData(Zu,0,Ju):0===Qu.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):(Fu.bufferSubData(Zu,Qu.offset*Ju.BYTES_PER_ELEMENT,Ju.subarray(Qu.offset,Qu.offset+Qu.count)),Qu.count=-1)}var qu=new WeakMap;return{get:function(Xu){return Xu.isInterleavedBufferAttribute&&(Xu=Xu.data),qu.get(Xu)},remove:function(Xu){Xu.isInterleavedBufferAttribute&&(Xu=Xu.data);var Yu=qu.get(Xu);Yu&&(Fu.deleteBuffer(Yu.buffer),qu.delete(Xu))},update:function(Xu,Yu){Xu.isInterleavedBufferAttribute&&(Xu=Xu.data);var Zu=qu.get(Xu);Zu===void 0?qu.set(Xu,Hu(Xu,Yu)):Zu.version<Xu.version&&(Vu(Zu.buffer,Xu,Yu),Zu.version=Xu.version)}}}function Z(Fu,Hu,Vu,ku,Wu,ju){this.a=Fu,this.b=Hu,this.c=Vu,this.normal=ku&&ku.isVector3?ku:new A,this.vertexNormals=Array.isArray(ku)?ku:[],this.color=Wu&&Wu.isColor?Wu:new W,this.vertexColors=Array.isArray(Wu)?Wu:[],this.materialIndex=ju===void 0?0:ju}function J(Fu,Hu,Vu,ku){this._x=Fu||0,this._y=Hu||0,this._z=Vu||0,this._order=ku||J.DefaultOrder}function Q(){this.mask=1}function K(){Object.defineProperty(this,'id',{value:Hc++}),this.uuid=fp.generateUUID(),this.name='',this.type='Object3D',this.parent=null,this.children=[],this.up=K.DefaultUp.clone();var Vu=new A,ku=new J,Wu=new L,ju=new A(1,1,1);ku.onChange(function(){Wu.setFromEuler(ku,!1)}),Wu.onChange(function(){ku.setFromQuaternion(Wu,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:Vu},rotation:{configurable:!0,enumerable:!0,value:ku},quaternion:{configurable:!0,enumerable:!0,value:Wu},scale:{configurable:!0,enumerable:!0,value:ju},modelViewMatrix:{value:new E},normalMatrix:{value:new C}}),this.matrix=new E,this.matrixWorld=new E,this.matrixAutoUpdate=K.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Q,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ee(){Object.defineProperty(this,'id',{value:Vc+=2}),this.uuid=fp.generateUUID(),this.name='',this.type='Geometry',this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function re(Fu,Hu,Vu){if(Array.isArray(Fu))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.name='',this.array=Fu,this.itemSize=Hu,this.count=Fu===void 0?0:Fu.length/Hu,this.normalized=!0===Vu,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function oe(Fu,Hu,Vu){re.call(this,new Int8Array(Fu),Hu,Vu)}function ie(Fu,Hu,Vu){re.call(this,new Uint8Array(Fu),Hu,Vu)}function ne(Fu,Hu,Vu){re.call(this,new Uint8ClampedArray(Fu),Hu,Vu)}function se(Fu,Hu,Vu){re.call(this,new Int16Array(Fu),Hu,Vu)}function le(Fu,Hu,Vu){re.call(this,new Uint16Array(Fu),Hu,Vu)}function pe(Fu,Hu,Vu){re.call(this,new Int32Array(Fu),Hu,Vu)}function ue(Fu,Hu,Vu){re.call(this,new Uint32Array(Fu),Hu,Vu)}function ge(Fu,Hu,Vu){re.call(this,new Float32Array(Fu),Hu,Vu)}function fe(Fu,Hu,Vu){re.call(this,new Float64Array(Fu),Hu,Vu)}function he(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function ye(Fu){if(0===Fu.length)return-Infinity;for(var Hu=Fu[0],Vu=1,ku=Fu.length;Vu<ku;++Vu)Fu[Vu]>Hu&&(Hu=Fu[Vu]);return Hu}function xe(){Object.defineProperty(this,'id',{value:kc+=2}),this.uuid=fp.generateUUID(),this.name='',this.type='BufferGeometry',this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:Infinity},this.userData={}}function ve(Fu,Hu,Vu,ku,Wu,ju){ee.call(this),this.type='BoxGeometry',this.parameters={width:Fu,height:Hu,depth:Vu,widthSegments:ku,heightSegments:Wu,depthSegments:ju},this.fromBufferGeometry(new _e(Fu,Hu,Vu,ku,Wu,ju)),this.mergeVertices()}function _e(Fu,Hu,Vu,ku,Wu,ju){function qu(em,tm,rm,am,om,im,nm,sm,lm,pm,dm){var hm=lm+1,xm=0,vm=0,_m,bm,Mm=new A;for(bm=0;bm<pm+1;bm++){var Sm=bm*(nm/pm)-nm/2;for(_m=0;_m<hm;_m++){var Tm=_m*(im/lm)-im/2;Mm[em]=Tm*am,Mm[tm]=Sm*om,Mm[rm]=sm/2,Zu.push(Mm.x,Mm.y,Mm.z),Mm[em]=0,Mm[tm]=0,Mm[rm]=0<sm?1:-1,Ju.push(Mm.x,Mm.y,Mm.z),Qu.push(_m/lm),Qu.push(1-bm/pm),xm+=1}}for(bm=0;bm<pm;bm++)for(_m=0;_m<lm;_m++){var Em=Ku+_m+hm*bm,wm=Ku+_m+hm*(bm+1),Lm=Ku+(_m+1)+hm*(bm+1),Am=Ku+(_m+1)+hm*bm;Yu.push(Em,wm,Am),Yu.push(wm,Lm,Am),vm+=6}Xu.addGroup($u,vm,dm),$u+=vm,Ku+=xm}xe.call(this),this.type='BoxBufferGeometry',this.parameters={width:Fu,height:Hu,depth:Vu,widthSegments:ku,heightSegments:Wu,depthSegments:ju};var Xu=this;Fu=Fu||1,Hu=Hu||1,Vu=Vu||1,ku=Math.floor(ku)||1,Wu=Math.floor(Wu)||1,ju=Math.floor(ju)||1;var Yu=[],Zu=[],Ju=[],Qu=[],Ku=0,$u=0;qu('z','y','x',-1,-1,Vu,Hu,Fu,ju,Wu,0),qu('z','y','x',1,-1,Vu,Hu,-Fu,ju,Wu,1),qu('x','z','y',1,1,Fu,Vu,Hu,ku,ju,2),qu('x','z','y',1,-1,Fu,Vu,-Hu,ku,ju,3),qu('x','y','z',1,-1,Fu,Hu,Vu,ku,Wu,4),qu('x','y','z',-1,-1,Fu,Hu,-Vu,ku,Wu,5),this.setIndex(Yu),this.addAttribute('position',new ge(Zu,3)),this.addAttribute('normal',new ge(Ju,3)),this.addAttribute('uv',new ge(Qu,2))}function Me(Fu,Hu,Vu,ku){ee.call(this),this.type='PlaneGeometry',this.parameters={width:Fu,height:Hu,widthSegments:Vu,heightSegments:ku},this.fromBufferGeometry(new Se(Fu,Hu,Vu,ku)),this.mergeVertices()}function Se(Fu,Hu,Vu,ku){xe.call(this),this.type='PlaneBufferGeometry',this.parameters={width:Fu,height:Hu,widthSegments:Vu,heightSegments:ku},Fu=Fu||1,Hu=Hu||1;var Wu=Fu/2,ju=Hu/2,qu=Math.floor(Vu)||1,Xu=Math.floor(ku)||1,Yu=qu+1,Ju=Fu/qu,Qu=Hu/Xu,Ku,$u,em=[],tm=[],rm=[],am=[];for($u=0;$u<Xu+1;$u++){var om=$u*Qu-ju;for(Ku=0;Ku<Yu;Ku++){var im=Ku*Ju-Wu;tm.push(im,-om,0),rm.push(0,0,1),am.push(Ku/qu),am.push(1-$u/Xu)}}for($u=0;$u<Xu;$u++)for(Ku=0;Ku<qu;Ku++){var nm=Ku+Yu*$u,sm=Ku+Yu*($u+1),lm=Ku+1+Yu*($u+1),pm=Ku+1+Yu*$u;em.push(nm,sm,pm),em.push(sm,lm,pm)}this.setIndex(em),this.addAttribute('position',new ge(tm,3)),this.addAttribute('normal',new ge(rm,3)),this.addAttribute('uv',new ge(am,2))}function Te(){Object.defineProperty(this,'id',{value:Wc++}),this.uuid=fp.generateUUID(),this.name='',this.type='Material',this.fog=!0,this.lights=!0,this.blending=Hn,this.side=Dn,this.flatShading=!1,this.vertexColors=Un,this.opacity=1,this.transparent=!1,this.blendSrc=ts,this.blendDst=rs,this.blendEquation=qn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=us,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function Ee(Fu){Te.call(this),this.type='ShaderMaterial',this.defines={},this.uniforms={},this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}',this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}',this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,Fu!==void 0&&(Fu.attributes!==void 0&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(Fu))}function we(Fu,Hu){this.origin=Fu===void 0?new A:Fu,this.direction=Hu===void 0?new A:Hu}function Le(Fu,Hu,Vu){this.a=Fu===void 0?new A:Fu,this.b=Hu===void 0?new A:Hu,this.c=Vu===void 0?new A:Vu}function Ae(Fu){Te.call(this),this.type='MeshBasicMaterial',this.color=new W(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ys,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(Fu)}function Pe(Fu,Hu){K.call(this),this.type='Mesh',this.geometry=Fu===void 0?new xe:Fu,this.material=Hu===void 0?new Ae({color:16777215*Math.random()}):Hu,this.drawMode=$l,this.updateMorphTargets()}function Ce(Fu,Hu,Vu,ku){function ju(Ju,Qu){Hu.buffers.color.setClear(Ju.r,Ju.g,Ju.b,Qu,ku)}var qu=new W(0),Xu=0,Yu,Zu;return{getClearColor:function(){return qu},setClearColor:function(Ju,Qu){qu.set(Ju),Xu=Qu===void 0?1:Qu,ju(qu,Xu)},getClearAlpha:function(){return Xu},setClearAlpha:function(Ju){Xu=Ju,ju(qu,Xu)},render:function(Ju,Qu,Ku,$u){var em=Qu.background;null===em?ju(qu,Xu):em&&em.isColor&&(ju(em,1),$u=!0),(Fu.autoClear||$u)&&Fu.clear(Fu.autoClearColor,Fu.autoClearDepth,Fu.autoClearStencil),em&&(em.isCubeTexture||em.isWebGLRenderTargetCube)?(Zu===void 0&&(Zu=new Pe(new _e(1,1,1),new Ee({type:'BackgroundCubeMaterial',uniforms:Uc.clone(Fc.cube.uniforms),vertexShader:Fc.cube.vertexShader,fragmentShader:Fc.cube.fragmentShader,side:zn,depthTest:!0,depthWrite:!1,fog:!1})),Zu.geometry.removeAttribute('normal'),Zu.geometry.removeAttribute('uv'),Zu.onBeforeRender=function(tm,rm,am){this.matrixWorld.copyPosition(am.matrixWorld)},Object.defineProperty(Zu.material,'envMap',{get:function(){return this.uniforms.tCube.value}}),Vu.update(Zu)),Zu.material.uniforms.tCube.value=em.isWebGLRenderTargetCube?em.texture:em,Zu.material.uniforms.tFlip.value=em.isWebGLRenderTargetCube?1:-1,Ju.push(Zu,Zu.geometry,Zu.material,0,null)):em&&em.isTexture&&(Yu===void 0&&(Yu=new Pe(new Se(2,2),new Ee({type:'BackgroundMaterial',uniforms:Uc.clone(Fc.background.uniforms),vertexShader:Fc.background.vertexShader,fragmentShader:Fc.background.fragmentShader,side:Dn,depthTest:!0,depthWrite:!1,fog:!1})),Yu.geometry.removeAttribute('normal'),Object.defineProperty(Yu.material,'map',{get:function(){return this.uniforms.t2D.value}}),Vu.update(Yu)),Yu.material.uniforms.t2D.value=em,!0===em.matrixAutoUpdate&&em.updateMatrix(),Yu.material.uniforms.uvTransform.value.copy(em.matrix),Ju.push(Yu,Yu.geometry,Yu.material,0,null))}}}function Re(Fu,Hu,Vu,ku){var Xu;this.setMode=function(Yu){Xu=Yu},this.render=function(Yu,Zu){Fu.drawArrays(Xu,Yu,Zu),Vu.update(Zu,Xu)},this.renderInstances=function(Yu,Zu,Ju){var Qu;if(ku.isWebGL2)Qu=Fu;else if(Qu=Hu.get('ANGLE_instanced_arrays'),null===Qu)return void console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');Qu[ku.isWebGL2?'drawArraysInstanced':'drawArraysInstancedANGLE'](Xu,Zu,Ju,Yu.maxInstancedCount),Vu.update(Ju,Xu,Yu.maxInstancedCount)}}function Ie(Fu,Hu,Vu){function Wu(sm){if('highp'===sm){if(0<Fu.getShaderPrecisionFormat(35633,36338).precision&&0<Fu.getShaderPrecisionFormat(35632,36338).precision)return'highp';sm='mediump'}return'mediump'===sm&&0<Fu.getShaderPrecisionFormat(35633,36337).precision&&0<Fu.getShaderPrecisionFormat(35632,36337).precision?'mediump':'lowp'}var ju,qu='undefined'!=typeof WebGL2RenderingContext&&Fu instanceof WebGL2RenderingContext,Xu=Vu.precision===void 0?'highp':Vu.precision,Yu=Wu(Xu);Yu!==Xu&&(console.warn('THREE.WebGLRenderer:',Xu,'not supported, using',Yu,'instead.'),Xu=Yu);var Zu=!0===Vu.logarithmicDepthBuffer,Ju=Fu.getParameter(34930),Qu=Fu.getParameter(35660),Ku=Fu.getParameter(3379),$u=Fu.getParameter(34076),em=Fu.getParameter(34921),tm=Fu.getParameter(36347),rm=Fu.getParameter(36348),am=Fu.getParameter(36349),om=0<Qu,im=qu||!!Hu.get('OES_texture_float');return{isWebGL2:qu,getMaxAnisotropy:function(){if(void 0!==ju)return ju;var sm=Hu.get('EXT_texture_filter_anisotropic');return ju=null===sm?0:Fu.getParameter(sm.MAX_TEXTURE_MAX_ANISOTROPY_EXT),ju},getMaxPrecision:Wu,precision:Xu,logarithmicDepthBuffer:Zu,maxTextures:Ju,maxVertexTextures:Qu,maxTextureSize:Ku,maxCubemapSize:$u,maxAttributes:em,maxVertexUniforms:tm,maxVaryings:rm,maxFragmentUniforms:am,vertexTextures:om,floatFragmentTextures:im,floatVertexTextures:om&&im}}function De(){function Fu(){Zu.value!==ku&&(Zu.value=ku,Zu.needsUpdate=0<Wu),Vu.numPlanes=Wu,Vu.numIntersection=0}function Hu(Ju,Qu,Ku,$u){var em=null===Ju?0:Ju.length,tm=null;if(0!==em){if(tm=Zu.value,!0!==$u||null==tm){var rm=Ku+4*em,am=Qu.matrixWorldInverse;Yu.getNormalMatrix(am),(null==tm||tm.length<rm)&&(tm=new Float32Array(rm));for(var om=0,im=Ku;om!==em;++om,im+=4)Xu.copy(Ju[om]).applyMatrix4(am,Yu),Xu.normal.toArray(tm,im),tm[im+3]=Xu.constant}Zu.value=tm,Zu.needsUpdate=!0}return Vu.numPlanes=em,tm}var Vu=this,ku=null,Wu=0,ju=!1,qu=!1,Xu=new H,Yu=new C,Zu={value:null,needsUpdate:!1};this.uniform=Zu,this.numPlanes=0,this.numIntersection=0,this.init=function(Ju,Qu,Ku){var $u=0!==Ju.length||Qu||0!=Wu||ju;return ju=Qu,ku=Hu(Ju,Ku,0),Wu=Ju.length,$u},this.beginShadows=function(){qu=!0,Hu(null)},this.endShadows=function(){qu=!1,Fu()},this.setState=function(Ju,Qu,Ku,$u,em,tm){if(!ju||null===Ju||0===Ju.length||qu&&!Ku)qu?Hu(null):Fu();else{var rm=qu?0:Wu,am=4*rm,om=em.clippingState||null;Zu.value=om,om=Hu(Ju,$u,am,tm);for(var im=0;im!==am;++im)om[im]=ku[im];em.clippingState=om,this.numIntersection=Qu?this.numPlanes:0,this.numPlanes+=rm}}}function ze(Fu){var Hu={};return{get:function(Vu){if(void 0!==Hu[Vu])return Hu[Vu];var ku;return ku='WEBGL_depth_texture'===Vu?Fu.getExtension('WEBGL_depth_texture')||Fu.getExtension('MOZ_WEBGL_depth_texture')||Fu.getExtension('WEBKIT_WEBGL_depth_texture'):'EXT_texture_filter_anisotropic'===Vu?Fu.getExtension('EXT_texture_filter_anisotropic')||Fu.getExtension('MOZ_EXT_texture_filter_anisotropic')||Fu.getExtension('WEBKIT_EXT_texture_filter_anisotropic'):'WEBGL_compressed_texture_s3tc'===Vu?Fu.getExtension('WEBGL_compressed_texture_s3tc')||Fu.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||Fu.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc'):'WEBGL_compressed_texture_pvrtc'===Vu?Fu.getExtension('WEBGL_compressed_texture_pvrtc')||Fu.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'):Fu.getExtension(Vu),null===ku&&console.warn('THREE.WebGLRenderer: '+Vu+' extension not supported.'),Hu[Vu]=ku,ku}}}function Ne(Fu,Hu,Vu){function ku(Zu){var Ju=Zu.target,Qu=Xu[Ju.id];for(var Ku in null!==Qu.index&&Hu.remove(Qu.index),Qu.attributes)Hu.remove(Qu.attributes[Ku]);Ju.removeEventListener('dispose',ku),delete Xu[Ju.id];var $u=Yu[Qu.id];$u&&(Hu.remove($u),delete Yu[Qu.id]),Vu.memory.geometries--}var Xu={},Yu={};return{get:function(Zu,Ju){var Qu=Xu[Ju.id];return Qu?Qu:(Ju.addEventListener('dispose',ku),Ju.isBufferGeometry?Qu=Ju:Ju.isGeometry&&(void 0===Ju._bufferGeometry&&(Ju._bufferGeometry=new xe().setFromObject(Zu)),Qu=Ju._bufferGeometry),Xu[Ju.id]=Qu,Vu.memory.geometries++,Qu)},update:function(Zu){var Ju=Zu.index,Qu=Zu.attributes;for(var Ku in null!==Ju&&Hu.update(Ju,34963),Qu)Hu.update(Qu[Ku],34962);var $u=Zu.morphAttributes;for(var Ku in $u)for(var em=$u[Ku],tm=0,rm=em.length;tm<rm;tm++)Hu.update(em[tm],34962)},getWireframeAttribute:function(Zu){var Ju=Yu[Zu.id];if(Ju)return Ju;var Qu=[],Ku=Zu.index,$u=Zu.attributes;if(null!==Ku)for(var em=Ku.array,tm=0,rm=em.length;tm<rm;tm+=3){var am=em[tm+0],om=em[tm+1],im=em[tm+2];Qu.push(am,om,om,im,im,am)}else for(var em=$u.position.array,tm=0,rm=em.length/3-1;tm<rm;tm+=3){var am=tm+0,om=tm+1,im=tm+2;Qu.push(am,om,om,im,im,am)}return Ju=new(65535<ye(Qu)?ue:le)(Qu,1),Hu.update(Ju,34963),Yu[Zu.id]=Ju,Ju}}}function Be(Fu,Hu,Vu,ku){var Yu,Zu,Ju;this.setMode=function(Qu){Yu=Qu},this.setIndex=function(Qu){Zu=Qu.type,Ju=Qu.bytesPerElement},this.render=function(Qu,Ku){Fu.drawElements(Yu,Ku,Zu,Qu*Ju),Vu.update(Ku,Yu)},this.renderInstances=function(Qu,Ku,$u){var em;if(ku.isWebGL2)em=Fu;else{var em=Hu.get('ANGLE_instanced_arrays');if(null===em)return void console.error('THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.')}em[ku.isWebGL2?'drawElementsInstanced':'drawElementsInstancedANGLE'](Yu,$u,Zu,Ku*Ju,Qu.maxInstancedCount),Vu.update($u,Yu,Qu.maxInstancedCount)}}function Ue(){var Wu={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:Wu,programs:null,autoReset:!0,reset:function(){Wu.frame++,Wu.calls=0,Wu.triangles=0,Wu.points=0,Wu.lines=0},update:function(ju,qu,Xu){switch(Xu=Xu||1,Wu.calls++,qu){case 4:Wu.triangles+=Xu*(ju/3);break;case 5:case 6:Wu.triangles+=Xu*(ju-2);break;case 1:Wu.lines+=Xu*(ju/2);break;case 3:Wu.lines+=Xu*(ju-1);break;case 2:Wu.lines+=Xu*ju;break;case 0:Wu.points+=Xu*ju;break;default:console.error('THREE.WebGLInfo: Unknown draw mode:',qu);}}}}function Ge(Fu,Hu){return Math.abs(Hu[1])-Math.abs(Fu[1])}function Oe(Fu){var Vu={},ku=new Float32Array(8);return{update:function(Wu,ju,qu,Xu){var Yu=Wu.morphTargetInfluences,Zu=Yu.length,Ju=Vu[ju.id];if(Ju===void 0){Ju=[];for(var Qu=0;Qu<Zu;Qu++)Ju[Qu]=[Qu,0];Vu[ju.id]=Ju}for(var Ku=qu.morphTargets&&ju.morphAttributes.position,$u=qu.morphNormals&&ju.morphAttributes.normal,Qu=0,em;Qu<Zu;Qu++)em=Ju[Qu],0!==em[1]&&(Ku&&ju.removeAttribute('morphTarget'+Qu),$u&&ju.removeAttribute('morphNormal'+Qu));for(var Qu=0,em;Qu<Zu;Qu++)em=Ju[Qu],em[0]=Qu,em[1]=Yu[Qu];Ju.sort(Ge);for(var Qu=0,em;8>Qu;Qu++){if(em=Ju[Qu],em){var tm=em[0],rm=em[1];if(rm){Ku&&ju.addAttribute('morphTarget'+Qu,Ku[tm]),$u&&ju.addAttribute('morphNormal'+Qu,$u[tm]),ku[Qu]=rm;continue}}ku[Qu]=0}Xu.getUniforms().setValue(Fu,'morphTargetInfluences',ku)}}}function Fe(Fu,Hu){var Wu={};return{update:function(ju){var qu=Hu.render.frame,Xu=ju.geometry,Yu=Fu.get(ju,Xu);return Wu[Yu.id]!==qu&&(Xu.isGeometry&&Yu.updateFromObject(ju),Fu.update(Yu),Wu[Yu.id]=qu),Yu},dispose:function(){Wu={}}}}function He(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu){Fu=Fu===void 0?[]:Fu,Hu=Hu===void 0?Ls:Hu,R.call(this,Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu),this.flipY=!1}function Ve(Fu,Hu,Vu,ku){R.call(this,null),this.image={data:Fu,width:Hu,height:Vu,depth:ku},this.magFilter=Us,this.minFilter=Us,this.generateMipmaps=!1,this.flipY=!1}function ke(){this.seq=[],this.map={}}function We(Fu,Hu,Vu){var ku=Fu[0];if(0>=ku||0<ku)return Fu;var Wu=Hu*Vu,ju=Yc[Wu];if(void 0===ju&&(ju=new Float32Array(Wu),Yc[Wu]=ju),0!==Hu){ku.toArray(ju,0);for(var qu=1,Xu=0;qu!==Hu;++qu)Xu+=Vu,Fu[qu].toArray(ju,Xu)}return ju}function je(Fu,Hu){if(Fu.length!==Hu.length)return!1;for(var Vu=0,ku=Fu.length;Vu<ku;Vu++)if(Fu[Vu]!==Hu[Vu])return!1;return!0}function qe(Fu,Hu){for(var Vu=0,ku=Hu.length;Vu<ku;Vu++)Fu[Vu]=Hu[Vu]}function Xe(Fu,Hu){var Vu=Zc[Hu];Vu===void 0&&(Vu=new Int32Array(Hu),Zc[Hu]=Vu);for(var ku=0;ku!==Hu;++ku)Vu[ku]=Fu.allocTextureUnit();return Vu}function Ye(Fu,Hu){var Vu=this.cache;Vu[0]===Hu||(Fu.uniform1f(this.addr,Hu),Vu[0]=Hu)}function Ze(Fu,Hu){var Vu=this.cache;Vu[0]===Hu||(Fu.uniform1i(this.addr,Hu),Vu[0]=Hu)}function Je(Fu,Hu){var Vu=this.cache;if(Hu.x!==void 0)(Vu[0]!==Hu.x||Vu[1]!==Hu.y)&&(Fu.uniform2f(this.addr,Hu.x,Hu.y),Vu[0]=Hu.x,Vu[1]=Hu.y);else{if(je(Vu,Hu))return;Fu.uniform2fv(this.addr,Hu),qe(Vu,Hu)}}function Qe(Fu,Hu){var Vu=this.cache;if(Hu.x!==void 0)(Vu[0]!==Hu.x||Vu[1]!==Hu.y||Vu[2]!==Hu.z)&&(Fu.uniform3f(this.addr,Hu.x,Hu.y,Hu.z),Vu[0]=Hu.x,Vu[1]=Hu.y,Vu[2]=Hu.z);else if(Hu.r!==void 0)(Vu[0]!==Hu.r||Vu[1]!==Hu.g||Vu[2]!==Hu.b)&&(Fu.uniform3f(this.addr,Hu.r,Hu.g,Hu.b),Vu[0]=Hu.r,Vu[1]=Hu.g,Vu[2]=Hu.b);else{if(je(Vu,Hu))return;Fu.uniform3fv(this.addr,Hu),qe(Vu,Hu)}}function Ke(Fu,Hu){var Vu=this.cache;if(Hu.x!==void 0)(Vu[0]!==Hu.x||Vu[1]!==Hu.y||Vu[2]!==Hu.z||Vu[3]!==Hu.w)&&(Fu.uniform4f(this.addr,Hu.x,Hu.y,Hu.z,Hu.w),Vu[0]=Hu.x,Vu[1]=Hu.y,Vu[2]=Hu.z,Vu[3]=Hu.w);else{if(je(Vu,Hu))return;Fu.uniform4fv(this.addr,Hu),qe(Vu,Hu)}}function $e(Fu,Hu){var Vu=this.cache,ku=Hu.elements;if(ku===void 0){if(je(Vu,Hu))return;Fu.uniformMatrix2fv(this.addr,!1,Hu),qe(Vu,Hu)}else{if(je(Vu,ku))return;Kc.set(ku),Fu.uniformMatrix2fv(this.addr,!1,Kc),qe(Vu,ku)}}function et(Fu,Hu){var Vu=this.cache,ku=Hu.elements;if(ku===void 0){if(je(Vu,Hu))return;Fu.uniformMatrix3fv(this.addr,!1,Hu),qe(Vu,Hu)}else{if(je(Vu,ku))return;Qc.set(ku),Fu.uniformMatrix3fv(this.addr,!1,Qc),qe(Vu,ku)}}function tt(Fu,Hu){var Vu=this.cache,ku=Hu.elements;if(ku===void 0){if(je(Vu,Hu))return;Fu.uniformMatrix4fv(this.addr,!1,Hu),qe(Vu,Hu)}else{if(je(Vu,ku))return;Jc.set(ku),Fu.uniformMatrix4fv(this.addr,!1,Jc),qe(Vu,ku)}}function rt(Fu,Hu,Vu){var ku=this.cache,Wu=Vu.allocTextureUnit();ku[0]!==Wu&&(Fu.uniform1i(this.addr,Wu),ku[0]=Wu),Vu.setTexture2D(Hu||jc,Wu)}function at(Fu,Hu,Vu){var ku=this.cache,Wu=Vu.allocTextureUnit();ku[0]!==Wu&&(Fu.uniform1i(this.addr,Wu),ku[0]=Wu),Vu.setTexture3D(Hu||qc,Wu)}function ot(Fu,Hu,Vu){var ku=this.cache,Wu=Vu.allocTextureUnit();ku[0]!==Wu&&(Fu.uniform1i(this.addr,Wu),ku[0]=Wu),Vu.setTextureCube(Hu||Xc,Wu)}function it(Fu,Hu){var Vu=this.cache;je(Vu,Hu)||(Fu.uniform2iv(this.addr,Hu),qe(Vu,Hu))}function nt(Fu,Hu){var Vu=this.cache;je(Vu,Hu)||(Fu.uniform3iv(this.addr,Hu),qe(Vu,Hu))}function st(Fu,Hu){var Vu=this.cache;je(Vu,Hu)||(Fu.uniform4iv(this.addr,Hu),qe(Vu,Hu))}function lt(Fu){return 5126===Fu?Ye:35664===Fu?Je:35665===Fu?Qe:35666===Fu?Ke:35674===Fu?$e:35675===Fu?et:35676===Fu?tt:35678===Fu||36198===Fu?rt:35679===Fu?at:35680===Fu?ot:5124===Fu||35670===Fu?Ze:35667===Fu||35671===Fu?it:35668===Fu||35672===Fu?nt:35669===Fu||35673===Fu?st:void 0}function dt(Fu,Hu){var Vu=this.cache;je(Vu,Hu)||(Fu.uniform1fv(this.addr,Hu),qe(Vu,Hu))}function ct(Fu,Hu){var Vu=this.cache;je(Vu,Hu)||(Fu.uniform1iv(this.addr,Hu),qe(Vu,Hu))}function ut(Fu,Hu){var Vu=this.cache,ku=We(Hu,this.size,2);je(Vu,ku)||(Fu.uniform2fv(this.addr,ku),this.updateCache(ku))}function mt(Fu,Hu){var Vu=this.cache,ku=We(Hu,this.size,3);je(Vu,ku)||(Fu.uniform3fv(this.addr,ku),this.updateCache(ku))}function gt(Fu,Hu){var Vu=this.cache,ku=We(Hu,this.size,4);je(Vu,ku)||(Fu.uniform4fv(this.addr,ku),this.updateCache(ku))}function ft(Fu,Hu){var Vu=this.cache,ku=We(Hu,this.size,4);je(Vu,ku)||(Fu.uniformMatrix2fv(this.addr,!1,ku),this.updateCache(ku))}function ht(Fu,Hu){var Vu=this.cache,ku=We(Hu,this.size,9);je(Vu,ku)||(Fu.uniformMatrix3fv(this.addr,!1,ku),this.updateCache(ku))}function yt(Fu,Hu){var Vu=this.cache,ku=We(Hu,this.size,16);je(Vu,ku)||(Fu.uniformMatrix4fv(this.addr,!1,ku),this.updateCache(ku))}function xt(Fu,Hu,Vu){var ku=this.cache,Wu=Hu.length,ju=Xe(Vu,Wu);!1===je(ku,ju)&&(Fu.uniform1iv(this.addr,ju),qe(ku,ju));for(var qu=0;qu!==Wu;++qu)Vu.setTexture2D(Hu[qu]||jc,ju[qu])}function vt(Fu,Hu,Vu){var ku=this.cache,Wu=Hu.length,ju=Xe(Vu,Wu);!1===je(ku,ju)&&(Fu.uniform1iv(this.addr,ju),qe(ku,ju));for(var qu=0;qu!==Wu;++qu)Vu.setTextureCube(Hu[qu]||Xc,ju[qu])}function _t(Fu){return 5126===Fu?dt:35664===Fu?ut:35665===Fu?mt:35666===Fu?gt:35674===Fu?ft:35675===Fu?ht:35676===Fu?yt:35678===Fu?xt:35680===Fu?vt:5124===Fu||35670===Fu?ct:35667===Fu||35671===Fu?it:35668===Fu||35672===Fu?nt:35669===Fu||35673===Fu?st:void 0}function bt(Fu,Hu,Vu){this.id=Fu,this.addr=Vu,this.cache=[],this.setValue=lt(Hu.type)}function Mt(Fu,Hu,Vu){this.id=Fu,this.addr=Vu,this.cache=[],this.size=Hu.size,this.setValue=_t(Hu.type)}function St(Fu){this.id=Fu,ke.call(this)}function Tt(Fu,Hu){Fu.seq.push(Hu),Fu.map[Hu.id]=Hu}function Et(Fu,Hu,Vu){var ku=Fu.name,Wu=ku.length;for($c.lastIndex=0;;){var ju=$c.exec(ku),qu=$c.lastIndex,Xu=ju[1],Yu=']'===ju[2],Zu=ju[3];if(Yu&&(Xu|=0),void 0===Zu||'['===Zu&&qu+2===Wu){Tt(Vu,void 0===Zu?new bt(Xu,Fu,Hu):new Mt(Xu,Fu,Hu));break}else{var Ju=Vu.map,Qu=Ju[Xu];void 0===Qu&&(Qu=new St(Xu),Tt(Vu,Qu)),Vu=Qu}}}function wt(Fu,Hu,Vu){ke.call(this),this.renderer=Vu;for(var ku=Fu.getProgramParameter(Hu,35718),Wu=0;Wu<ku;++Wu){var ju=Fu.getActiveUniform(Hu,Wu),qu=Fu.getUniformLocation(Hu,ju.name);Et(ju,qu,this)}}function Lt(Fu){for(var Hu=Fu.split('\n'),Vu=0;Vu<Hu.length;Vu++)Hu[Vu]=Vu+1+': '+Hu[Vu];return Hu.join('\n')}function At(Fu,Hu,Vu){var ku=Fu.createShader(Hu);return Fu.shaderSource(ku,Vu),Fu.compileShader(ku),!1===Fu.getShaderParameter(ku,35713)&&console.error('THREE.WebGLShader: Shader couldn\'t compile.'),''!==Fu.getShaderInfoLog(ku)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',35633===Hu?'vertex':'fragment',Fu.getShaderInfoLog(ku),Lt(Vu)),ku}function Pt(Fu){switch(Fu){case rp:return['Linear','( value )'];case 3001:return['sRGB','( value )'];case 3002:return['RGBE','( value )'];case 3004:return['RGBM','( value, 7.0 )'];case 3005:return['RGBM','( value, 16.0 )'];case 3006:return['RGBD','( value, 256.0 )'];case op:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw new Error('unsupported encoding: '+Fu);}}function Ct(Fu,Hu){var Vu=Pt(Hu);return'vec4 '+Fu+'( vec4 value ) { return '+Vu[0]+'ToLinear'+Vu[1]+'; }'}function Rt(Fu,Hu){var Vu=Pt(Hu);return'vec4 '+Fu+'( vec4 value ) { return LinearTo'+Vu[0]+Vu[1]+'; }'}function It(Fu,Hu){var Vu;switch(Hu){case Ms:Vu='Linear';break;case 2:Vu='Reinhard';break;case 3:Vu='Uncharted2';break;case 4:Vu='OptimizedCineon';break;default:throw new Error('unsupported toneMapping: '+Hu);}return'vec3 '+Fu+'( vec3 color ) { return '+Vu+'ToneMapping( color ); }'}function Dt(Fu,Hu,Vu){Fu=Fu||{};var ku=[Fu.derivatives||Hu.envMapCubeUV||Hu.bumpMap||Hu.normalMap&&!Hu.objectSpaceNormalMap||Hu.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(Fu.fragDepth||Hu.logarithmicDepthBuffer)&&Vu.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',Fu.drawBuffers&&Vu.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(Fu.shaderTextureLOD||Hu.envMap)&&Vu.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''];return ku.filter(Bt).join('\n')}function zt(Fu){var Hu=[];for(var Vu in Fu){var ku=Fu[Vu];!1===ku||Hu.push('#define '+Vu+' '+ku)}return Hu.join('\n')}function Nt(Fu,Hu){for(var Vu={},ku=Fu.getProgramParameter(Hu,35721),Wu=0;Wu<ku;Wu++){var ju=Fu.getActiveAttrib(Hu,Wu),qu=ju.name;Vu[qu]=Fu.getAttribLocation(Hu,qu)}return Vu}function Bt(Fu){return''!==Fu}function Ut(Fu,Hu){return Fu.replace(/NUM_DIR_LIGHTS/g,Hu.numDirLights).replace(/NUM_SPOT_LIGHTS/g,Hu.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,Hu.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,Hu.numPointLights).replace(/NUM_HEMI_LIGHTS/g,Hu.numHemiLights)}function Gt(Fu,Hu){return Fu.replace(/NUM_CLIPPING_PLANES/g,Hu.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,Hu.numClippingPlanes-Hu.numClipIntersection)}function Ot(Fu){var Vu=/^[ \t]*#include +<([\w\d./]+)>/gm;return Fu.replace(Vu,function(ku,Wu){var ju=Bc[Wu];if(ju===void 0)throw new Error('Can not resolve #include <'+Wu+'>');return Ot(ju)})}function Ft(Fu){var Vu=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return Fu.replace(Vu,function(ku,Wu,ju,qu){for(var Xu='',Yu=parseInt(Wu);Yu<parseInt(ju);Yu++)Xu+=qu.replace(/\[ i \]/g,'[ '+Yu+' ]');return Xu})}function Ht(Fu,Hu,Vu,ku,Wu,ju,qu){var Xu=Fu.context,Yu=ku.defines,Zu=Wu.vertexShader,Ju=Wu.fragmentShader,Qu='SHADOWMAP_TYPE_BASIC';ju.shadowMapType===Rn?Qu='SHADOWMAP_TYPE_PCF':ju.shadowMapType===2&&(Qu='SHADOWMAP_TYPE_PCF_SOFT');var Ku='ENVMAP_TYPE_CUBE',$u='ENVMAP_MODE_REFLECTION',em='ENVMAP_BLENDING_MULTIPLY';if(ju.envMap){switch(ku.envMap.mapping){case Ls:case As:Ku='ENVMAP_TYPE_CUBE';break;case Is:case Ds:Ku='ENVMAP_TYPE_CUBE_UV';break;case Ps:case Cs:Ku='ENVMAP_TYPE_EQUIREC';break;case Rs:Ku='ENVMAP_TYPE_SPHERE';}switch(ku.envMap.mapping){case As:case Cs:$u='ENVMAP_MODE_REFRACTION';}switch(ku.combine){case ys:em='ENVMAP_BLENDING_MULTIPLY';break;case 1:em='ENVMAP_BLENDING_MIX';break;case 2:em='ENVMAP_BLENDING_ADD';}}var tm=0<Fu.gammaFactor?Fu.gammaFactor:1,rm=qu.isWebGL2?'':Dt(ku.extensions,ju,Hu),am=zt(Yu),om=Xu.createProgram(),im,nm;if(ku.isRawShaderMaterial?(im=[am].filter(Bt).join('\n'),0<im.length&&(im+='\n'),nm=[rm,am].filter(Bt).join('\n'),0<nm.length&&(nm+='\n')):(im=['precision '+ju.precision+' float;','precision '+ju.precision+' int;','#define SHADER_NAME '+Wu.name,am,ju.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+tm,'#define MAX_BONES '+ju.maxBones,ju.useFog&&ju.fog?'#define USE_FOG':'',ju.useFog&&ju.fogExp?'#define FOG_EXP2':'',ju.map?'#define USE_MAP':'',ju.envMap?'#define USE_ENVMAP':'',ju.envMap?'#define '+$u:'',ju.lightMap?'#define USE_LIGHTMAP':'',ju.aoMap?'#define USE_AOMAP':'',ju.emissiveMap?'#define USE_EMISSIVEMAP':'',ju.bumpMap?'#define USE_BUMPMAP':'',ju.normalMap?'#define USE_NORMALMAP':'',ju.normalMap&&ju.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',ju.displacementMap&&ju.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',ju.specularMap?'#define USE_SPECULARMAP':'',ju.roughnessMap?'#define USE_ROUGHNESSMAP':'',ju.metalnessMap?'#define USE_METALNESSMAP':'',ju.alphaMap?'#define USE_ALPHAMAP':'',ju.vertexColors?'#define USE_COLOR':'',ju.flatShading?'#define FLAT_SHADED':'',ju.skinning?'#define USE_SKINNING':'',ju.useVertexTexture?'#define BONE_TEXTURE':'',ju.morphTargets?'#define USE_MORPHTARGETS':'',ju.morphNormals&&!1===ju.flatShading?'#define USE_MORPHNORMALS':'',ju.doubleSided?'#define DOUBLE_SIDED':'',ju.flipSided?'#define FLIP_SIDED':'',ju.shadowMapEnabled?'#define USE_SHADOWMAP':'',ju.shadowMapEnabled?'#define '+Qu:'',ju.sizeAttenuation?'#define USE_SIZEATTENUATION':'',ju.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',ju.logarithmicDepthBuffer&&(qu.isWebGL2||Hu.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(Bt).join('\n'),nm=[rm,'precision '+ju.precision+' float;','precision '+ju.precision+' int;','#define SHADER_NAME '+Wu.name,am,ju.alphaTest?'#define ALPHATEST '+ju.alphaTest+(ju.alphaTest%1?'':'.0'):'','#define GAMMA_FACTOR '+tm,ju.useFog&&ju.fog?'#define USE_FOG':'',ju.useFog&&ju.fogExp?'#define FOG_EXP2':'',ju.map?'#define USE_MAP':'',ju.envMap?'#define USE_ENVMAP':'',ju.envMap?'#define '+Ku:'',ju.envMap?'#define '+$u:'',ju.envMap?'#define '+em:'',ju.lightMap?'#define USE_LIGHTMAP':'',ju.aoMap?'#define USE_AOMAP':'',ju.emissiveMap?'#define USE_EMISSIVEMAP':'',ju.bumpMap?'#define USE_BUMPMAP':'',ju.normalMap?'#define USE_NORMALMAP':'',ju.normalMap&&ju.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',ju.specularMap?'#define USE_SPECULARMAP':'',ju.roughnessMap?'#define USE_ROUGHNESSMAP':'',ju.metalnessMap?'#define USE_METALNESSMAP':'',ju.alphaMap?'#define USE_ALPHAMAP':'',ju.vertexColors?'#define USE_COLOR':'',ju.gradientMap?'#define USE_GRADIENTMAP':'',ju.flatShading?'#define FLAT_SHADED':'',ju.doubleSided?'#define DOUBLE_SIDED':'',ju.flipSided?'#define FLIP_SIDED':'',ju.shadowMapEnabled?'#define USE_SHADOWMAP':'',ju.shadowMapEnabled?'#define '+Qu:'',ju.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':'',ju.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',ju.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',ju.logarithmicDepthBuffer&&(qu.isWebGL2||Hu.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'',ju.envMap&&(qu.isWebGL2||Hu.get('EXT_shader_texture_lod'))?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',ju.toneMapping===_s?'':'#define TONE_MAPPING',ju.toneMapping===_s?'':Bc.tonemapping_pars_fragment,ju.toneMapping===_s?'':It('toneMapping',ju.toneMapping),ju.dithering?'#define DITHERING':'',ju.outputEncoding||ju.mapEncoding||ju.matcapEncoding||ju.envMapEncoding||ju.emissiveMapEncoding?Bc.encodings_pars_fragment:'',ju.mapEncoding?Ct('mapTexelToLinear',ju.mapEncoding):'',ju.matcapEncoding?Ct('matcapTexelToLinear',ju.matcapEncoding):'',ju.envMapEncoding?Ct('envMapTexelToLinear',ju.envMapEncoding):'',ju.emissiveMapEncoding?Ct('emissiveMapTexelToLinear',ju.emissiveMapEncoding):'',ju.outputEncoding?Rt('linearToOutputTexel',ju.outputEncoding):'',ju.depthPacking?'#define DEPTH_PACKING '+ku.depthPacking:'','\n'].filter(Bt).join('\n')),Zu=Ot(Zu),Zu=Ut(Zu,ju),Zu=Gt(Zu,ju),Ju=Ot(Ju),Ju=Ut(Ju,ju),Ju=Gt(Ju,ju),Zu=Ft(Zu),Ju=Ft(Ju),qu.isWebGL2&&!ku.isRawShaderMaterial){var sm=!1,lm=/^\s*#version\s+300\s+es\s*\n/;ku.isShaderMaterial&&null!==Zu.match(lm)&&null!==Ju.match(lm)&&(sm=!0,Zu=Zu.replace(lm,''),Ju=Ju.replace(lm,'')),im=['#version 300 es\n','#define attribute in','#define varying out','#define texture2D texture'].join('\n')+'\n'+im,nm=['#version 300 es\n','#define varying in',sm?'':'out highp vec4 pc_fragColor;',sm?'':'#define gl_FragColor pc_fragColor','#define gl_FragDepthEXT gl_FragDepth','#define texture2D texture','#define textureCube texture','#define texture2DProj textureProj','#define texture2DLodEXT textureLod','#define texture2DProjLodEXT textureProjLod','#define textureCubeLodEXT textureLod','#define texture2DGradEXT textureGrad','#define texture2DProjGradEXT textureProjGrad','#define textureCubeGradEXT textureGrad'].join('\n')+'\n'+nm}var pm=im+Zu,dm=nm+Ju,cm=At(Xu,35633,pm),um=At(Xu,35632,dm);Xu.attachShader(om,cm),Xu.attachShader(om,um),void 0===ku.index0AttributeName?!0===ju.morphTargets&&Xu.bindAttribLocation(om,0,'position'):Xu.bindAttribLocation(om,0,ku.index0AttributeName),Xu.linkProgram(om);var mm=Xu.getProgramInfoLog(om).trim(),gm=Xu.getShaderInfoLog(cm).trim(),fm=Xu.getShaderInfoLog(um).trim(),hm=!0,ym=!0;!1===Xu.getProgramParameter(om,35714)?(hm=!1,console.error('THREE.WebGLProgram: shader error: ',Xu.getError(),'35715',Xu.getProgramParameter(om,35715),'gl.getProgramInfoLog',mm,gm,fm)):''===mm?(''===gm||''===fm)&&(ym=!1):console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',mm),ym&&(this.diagnostics={runnable:hm,material:ku,programLog:mm,vertexShader:{log:gm,prefix:im},fragmentShader:{log:fm,prefix:nm}}),Xu.deleteShader(cm),Xu.deleteShader(um);var xm;this.getUniforms=function(){return void 0==xm&&(xm=new wt(Xu,om,Fu)),xm};var vm;return this.getAttributes=function(){return void 0==vm&&(vm=Nt(Xu,om)),vm},this.destroy=function(){Xu.deleteProgram(om),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().'),this.getUniforms()}},attributes:{get:function(){return console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().'),this.getAttributes()}}}),this.name=Wu.name,this.id=eu++,this.code=Vu,this.usedTimes=1,this.program=om,this.vertexShader=cm,this.fragmentShader=um,this}function Vt(Fu,Hu,Vu){function ku(Yu){var Zu=Yu.skeleton,Ju=Zu.bones;if(Vu.floatVertexTextures)return 1024;var Qu=Vu.maxVertexUniforms,Ku=Math.floor((Qu-20)/4),$u=Math.min(Ku,Ju.length);return $u<Ju.length?(console.warn('THREE.WebGLRenderer: Skeleton has '+Ju.length+' bones. This GPU supports '+$u+'.'),0):$u}function Wu(Yu,Zu){var Ju;return Yu?Yu.isTexture?Ju=Yu.encoding:Yu.isWebGLRenderTarget&&(console.warn('THREE.WebGLPrograms.getTextureEncodingFromMap: don\'t use render targets as textures. Use their .texture property instead.'),Ju=Yu.texture.encoding):Ju=rp,Ju===rp&&Zu&&(Ju=op),Ju}var ju=[],qu={MeshDepthMaterial:'depth',MeshDistanceMaterial:'distanceRGBA',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',MeshToonMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',MeshMatcapMaterial:'matcap',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points',ShadowMaterial:'shadow',SpriteMaterial:'sprite'},Xu=['precision','supportsVertexTextures','map','mapEncoding','matcapEncoding','envMap','envMapMode','envMapEncoding','lightMap','aoMap','emissiveMap','emissiveMapEncoding','bumpMap','normalMap','objectSpaceNormalMap','displacementMap','specularMap','roughnessMap','metalnessMap','gradientMap','alphaMap','combine','vertexColors','fog','useFog','fogExp','flatShading','sizeAttenuation','logarithmicDepthBuffer','skinning','maxBones','useVertexTexture','morphTargets','morphNormals','maxMorphTargets','maxMorphNormals','premultipliedAlpha','numDirLights','numPointLights','numSpotLights','numHemiLights','numRectAreaLights','shadowMapEnabled','shadowMapType','toneMapping','physicallyCorrectLights','alphaTest','doubleSided','flipSided','numClippingPlanes','numClipIntersection','depthPacking','dithering'];this.getParameters=function(Yu,Zu,Ju,Qu,Ku,$u,em){var tm=qu[Yu.type],rm=em.isSkinnedMesh?ku(em):0,am=Vu.precision;null!==Yu.precision&&(am=Vu.getMaxPrecision(Yu.precision),am!==Yu.precision&&console.warn('THREE.WebGLProgram.getParameters:',Yu.precision,'not supported, using',am,'instead.'));var om=Fu.getRenderTarget(),im={shaderID:tm,precision:am,supportsVertexTextures:Vu.vertexTextures,outputEncoding:Wu(om?om.texture:null,Fu.gammaOutput),map:!!Yu.map,mapEncoding:Wu(Yu.map,Fu.gammaInput),matcap:!!Yu.matcap,matcapEncoding:Wu(Yu.matcap,Fu.gammaInput),envMap:!!Yu.envMap,envMapMode:Yu.envMap&&Yu.envMap.mapping,envMapEncoding:Wu(Yu.envMap,Fu.gammaInput),envMapCubeUV:!!Yu.envMap&&(Yu.envMap.mapping===Is||Yu.envMap.mapping===Ds),lightMap:!!Yu.lightMap,aoMap:!!Yu.aoMap,emissiveMap:!!Yu.emissiveMap,emissiveMapEncoding:Wu(Yu.emissiveMap,Fu.gammaInput),bumpMap:!!Yu.bumpMap,normalMap:!!Yu.normalMap,objectSpaceNormalMap:Yu.normalMapType===1,displacementMap:!!Yu.displacementMap,roughnessMap:!!Yu.roughnessMap,metalnessMap:!!Yu.metalnessMap,specularMap:!!Yu.specularMap,alphaMap:!!Yu.alphaMap,gradientMap:!!Yu.gradientMap,combine:Yu.combine,vertexColors:Yu.vertexColors,fog:!!Qu,useFog:Yu.fog,fogExp:Qu&&Qu.isFogExp2,flatShading:Yu.flatShading,sizeAttenuation:Yu.sizeAttenuation,logarithmicDepthBuffer:Vu.logarithmicDepthBuffer,skinning:Yu.skinning&&0<rm,maxBones:rm,useVertexTexture:Vu.floatVertexTextures,morphTargets:Yu.morphTargets,morphNormals:Yu.morphNormals,maxMorphTargets:Fu.maxMorphTargets,maxMorphNormals:Fu.maxMorphNormals,numDirLights:Zu.directional.length,numPointLights:Zu.point.length,numSpotLights:Zu.spot.length,numRectAreaLights:Zu.rectArea.length,numHemiLights:Zu.hemi.length,numClippingPlanes:Ku,numClipIntersection:$u,dithering:Yu.dithering,shadowMapEnabled:Fu.shadowMap.enabled&&em.receiveShadow&&0<Ju.length,shadowMapType:Fu.shadowMap.type,toneMapping:Fu.toneMapping,physicallyCorrectLights:Fu.physicallyCorrectLights,premultipliedAlpha:Yu.premultipliedAlpha,alphaTest:Yu.alphaTest,doubleSided:Yu.side===Nn,flipSided:Yu.side===zn,depthPacking:Yu.depthPacking!==void 0&&Yu.depthPacking};return im},this.getProgramCode=function(Yu,Zu){var Ju=[];if(Zu.shaderID?Ju.push(Zu.shaderID):(Ju.push(Yu.fragmentShader),Ju.push(Yu.vertexShader)),void 0!==Yu.defines)for(var Qu in Yu.defines)Ju.push(Qu),Ju.push(Yu.defines[Qu]);for(var Ku=0;Ku<Xu.length;Ku++)Ju.push(Zu[Xu[Ku]]);return Ju.push(Yu.onBeforeCompile.toString()),Ju.push(Fu.gammaOutput),Ju.push(Fu.gammaFactor),Ju.join()},this.acquireProgram=function(Yu,Zu,Ju,Qu){for(var $u=0,em=ju.length,Ku,tm;$u<em;$u++)if(tm=ju[$u],tm.code===Qu){Ku=tm,++Ku.usedTimes;break}return void 0===Ku&&(Ku=new Ht(Fu,Hu,Qu,Yu,Zu,Ju,Vu),ju.push(Ku)),Ku},this.releaseProgram=function(Yu){if(0==--Yu.usedTimes){var Zu=ju.indexOf(Yu);ju[Zu]=ju[ju.length-1],ju.pop(),Yu.destroy()}},this.programs=ju}function kt(){var Wu=new WeakMap;return{get:function(ju){var qu=Wu.get(ju);return void 0===qu&&(qu={},Wu.set(ju,qu)),qu},remove:function(ju){Wu.delete(ju)},update:function(ju,qu,Xu){Wu.get(ju)[qu]=Xu},dispose:function(){Wu=new WeakMap}}}function Wt(Fu,Hu){return Fu.renderOrder===Hu.renderOrder?Fu.program&&Hu.program&&Fu.program!==Hu.program?Fu.program.id-Hu.program.id:Fu.material.id===Hu.material.id?Fu.z===Hu.z?Fu.id-Hu.id:Fu.z-Hu.z:Fu.material.id-Hu.material.id:Fu.renderOrder-Hu.renderOrder}function jt(Fu,Hu){return Fu.renderOrder===Hu.renderOrder?Fu.z===Hu.z?Fu.id-Hu.id:Hu.z-Fu.z:Fu.renderOrder-Hu.renderOrder}function qt(){var ku=[],Wu=0,ju=[],qu=[];return{opaque:ju,transparent:qu,init:function(){Wu=0,ju.length=0,qu.length=0},push:function(Xu,Yu,Zu,Ju,Qu){var Ku=ku[Wu];Ku===void 0?(Ku={id:Xu.id,object:Xu,geometry:Yu,material:Zu,program:Zu.program,renderOrder:Xu.renderOrder,z:Ju,group:Qu},ku[Wu]=Ku):(Ku.id=Xu.id,Ku.object=Xu,Ku.geometry=Yu,Ku.material=Zu,Ku.program=Zu.program,Ku.renderOrder=Xu.renderOrder,Ku.z=Ju,Ku.group=Qu),(!0===Zu.transparent?qu:ju).push(Ku),Wu++},sort:function(){1<ju.length&&ju.sort(Wt),1<qu.length&&qu.sort(jt)}}}function Xt(){var Vu={};return{get:function(ku,Wu){var ju=Vu[ku.id],qu;return void 0===ju?(qu=new qt,Vu[ku.id]={},Vu[ku.id][Wu.id]=qu):(qu=ju[Wu.id],void 0==qu&&(qu=new qt,ju[Wu.id]=qu)),qu},dispose:function(){Vu={}}}}function Yt(){var Fu={};return{get:function(Hu){if(void 0!==Fu[Hu.id])return Fu[Hu.id];var Vu;switch(Hu.type){case'DirectionalLight':Vu={direction:new A,color:new W,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new S};break;case'SpotLight':Vu={position:new A,direction:new A,color:new W,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new S};break;case'PointLight':Vu={position:new A,color:new W,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new S,shadowCameraNear:1,shadowCameraFar:1e3};break;case'HemisphereLight':Vu={direction:new A,skyColor:new W,groundColor:new W};break;case'RectAreaLight':Vu={color:new W,position:new A,halfWidth:new A,halfHeight:new A};}return Fu[Hu.id]=Vu,Vu}}}function Zt(){var Hu=new Yt,Vu={id:tu++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},ku=new A,Wu=new E,ju=new E;return{setup:function(qu,Xu,Yu){for(var Zu=0,Ju=0,Qu=0,Ku=0,$u=0,em=0,tm=0,rm=0,am=Yu.matrixWorldInverse,om=0,im=qu.length;om<im;om++){var nm=qu[om],sm=nm.color,lm=nm.intensity,pm=nm.distance,dm=nm.shadow&&nm.shadow.map?nm.shadow.map.texture:null;if(nm.isAmbientLight)Zu+=sm.r*lm,Ju+=sm.g*lm,Qu+=sm.b*lm;else if(nm.isDirectionalLight){var cm=Hu.get(nm);if(cm.color.copy(nm.color).multiplyScalar(nm.intensity),cm.direction.setFromMatrixPosition(nm.matrixWorld),ku.setFromMatrixPosition(nm.target.matrixWorld),cm.direction.sub(ku),cm.direction.transformDirection(am),cm.shadow=nm.castShadow,nm.castShadow){var um=nm.shadow;cm.shadowBias=um.bias,cm.shadowRadius=um.radius,cm.shadowMapSize=um.mapSize}Vu.directionalShadowMap[Ku]=dm,Vu.directionalShadowMatrix[Ku]=nm.shadow.matrix,Vu.directional[Ku]=cm,Ku++}else if(nm.isSpotLight){var cm=Hu.get(nm);if(cm.position.setFromMatrixPosition(nm.matrixWorld),cm.position.applyMatrix4(am),cm.color.copy(sm).multiplyScalar(lm),cm.distance=pm,cm.direction.setFromMatrixPosition(nm.matrixWorld),ku.setFromMatrixPosition(nm.target.matrixWorld),cm.direction.sub(ku),cm.direction.transformDirection(am),cm.coneCos=Math.cos(nm.angle),cm.penumbraCos=Math.cos(nm.angle*(1-nm.penumbra)),cm.decay=nm.decay,cm.shadow=nm.castShadow,nm.castShadow){var um=nm.shadow;cm.shadowBias=um.bias,cm.shadowRadius=um.radius,cm.shadowMapSize=um.mapSize}Vu.spotShadowMap[em]=dm,Vu.spotShadowMatrix[em]=nm.shadow.matrix,Vu.spot[em]=cm,em++}else if(nm.isRectAreaLight){var cm=Hu.get(nm);cm.color.copy(sm).multiplyScalar(lm),cm.position.setFromMatrixPosition(nm.matrixWorld),cm.position.applyMatrix4(am),ju.identity(),Wu.copy(nm.matrixWorld),Wu.premultiply(am),ju.extractRotation(Wu),cm.halfWidth.set(0.5*nm.width,0,0),cm.halfHeight.set(0,0.5*nm.height,0),cm.halfWidth.applyMatrix4(ju),cm.halfHeight.applyMatrix4(ju),Vu.rectArea[tm]=cm,tm++}else if(nm.isPointLight){var cm=Hu.get(nm);if(cm.position.setFromMatrixPosition(nm.matrixWorld),cm.position.applyMatrix4(am),cm.color.copy(nm.color).multiplyScalar(nm.intensity),cm.distance=nm.distance,cm.decay=nm.decay,cm.shadow=nm.castShadow,nm.castShadow){var um=nm.shadow;cm.shadowBias=um.bias,cm.shadowRadius=um.radius,cm.shadowMapSize=um.mapSize,cm.shadowCameraNear=um.camera.near,cm.shadowCameraFar=um.camera.far}Vu.pointShadowMap[$u]=dm,Vu.pointShadowMatrix[$u]=nm.shadow.matrix,Vu.point[$u]=cm,$u++}else if(nm.isHemisphereLight){var cm=Hu.get(nm);cm.direction.setFromMatrixPosition(nm.matrixWorld),cm.direction.transformDirection(am),cm.direction.normalize(),cm.skyColor.copy(nm.color).multiplyScalar(lm),cm.groundColor.copy(nm.groundColor).multiplyScalar(lm),Vu.hemi[rm]=cm,rm++}}Vu.ambient[0]=Zu,Vu.ambient[1]=Ju,Vu.ambient[2]=Qu,Vu.directional.length=Ku,Vu.spot.length=em,Vu.rectArea.length=tm,Vu.point.length=$u,Vu.hemi.length=rm,Vu.hash.stateID=Vu.id,Vu.hash.directionalLength=Ku,Vu.hash.pointLength=$u,Vu.hash.spotLength=em,Vu.hash.rectAreaLength=tm,Vu.hash.hemiLength=rm,Vu.hash.shadowsLength=Xu.length},state:Vu}}function Jt(){var Wu=new Zt,ju=[],qu=[];return{init:function(){ju.length=0,qu.length=0},state:{lightsArray:ju,shadowsArray:qu,lights:Wu},setupLights:function(Yu){Wu.setup(ju,qu,Yu)},pushLight:function(Yu){ju.push(Yu)},pushShadow:function(Yu){qu.push(Yu)}}}function Qt(){var Vu={};return{get:function(ku,Wu){var ju;return void 0===Vu[ku.id]?(ju=new Jt,Vu[ku.id]={},Vu[ku.id][Wu.id]=ju):void 0===Vu[ku.id][Wu.id]?(ju=new Jt,Vu[ku.id][Wu.id]=ju):ju=Vu[ku.id][Wu.id],ju},dispose:function(){Vu={}}}}function Kt(Fu){Te.call(this),this.type='MeshDepthMaterial',this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(Fu)}function $t(Fu){Te.call(this),this.type='MeshDistanceMaterial',this.referencePosition=new A,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(Fu)}function er(Fu,Hu,Vu){function ku(mm,gm,fm,hm,ym,xm){var vm=mm.geometry,_m=null,bm=em,Mm=mm.customDepthMaterial;if(fm&&(bm=tm,Mm=mm.customDistanceMaterial),!Mm){var Sm=!1;gm.morphTargets&&(vm&&vm.isBufferGeometry?Sm=vm.morphAttributes&&vm.morphAttributes.position&&0<vm.morphAttributes.position.length:vm&&vm.isGeometry&&(Sm=vm.morphTargets&&0<vm.morphTargets.length)),mm.isSkinnedMesh&&!1===gm.skinning&&console.warn('THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:',mm);var Tm=mm.isSkinnedMesh&&gm.skinning,Em=0;Sm&&(Em|=Qu),Tm&&(Em|=Ku),_m=bm[Em]}else _m=Mm;if(Fu.localClippingEnabled&&!0===gm.clipShadows&&0!==gm.clippingPlanes.length){var wm=_m.uuid,Lm=gm.uuid,Am=rm[wm];void 0===Am&&(Am={},rm[wm]=Am);var Pm=Am[Lm];void 0===Pm&&(Pm=_m.clone(),Am[Lm]=Pm),_m=Pm}return _m.visible=gm.visible,_m.wireframe=gm.wireframe,_m.side=null==gm.shadowSide?am[gm.side]:gm.shadowSide,_m.clipShadows=gm.clipShadows,_m.clippingPlanes=gm.clippingPlanes,_m.clipIntersection=gm.clipIntersection,_m.wireframeLinewidth=gm.wireframeLinewidth,_m.linewidth=gm.linewidth,fm&&_m.isMeshDistanceMaterial&&(_m.referencePosition.copy(hm),_m.nearDistance=ym,_m.farDistance=xm),_m}function Wu(mm,gm,fm,hm){if(!1!==mm.visible){var ym=mm.layers.test(gm.layers);if(ym&&(mm.isMesh||mm.isLine||mm.isPoints)&&mm.castShadow&&(!mm.frustumCulled||ju.intersectsObject(mm))){mm.modelViewMatrix.multiplyMatrices(fm.matrixWorldInverse,mm.matrixWorld);var xm=Hu.update(mm),vm=mm.material;if(Array.isArray(vm))for(var _m=xm.groups,bm=0,Mm=_m.length;bm<Mm;bm++){var Sm=_m[bm],Tm=vm[Sm.materialIndex];if(Tm&&Tm.visible){var Em=ku(mm,Tm,hm,Ju,fm.near,fm.far);Fu.renderBufferDirect(fm,null,xm,Em,mm,Sm)}}else if(vm.visible){var Em=ku(mm,vm,hm,Ju,fm.near,fm.far);Fu.renderBufferDirect(fm,null,xm,Em,mm,null)}}for(var wm=mm.children,Lm=0,Am=wm.length;Lm<Am;Lm++)Wu(wm[Lm],gm,fm,hm)}}for(var ju=new V,qu=new E,Xu=new S,Yu=new S(Vu,Vu),Zu=new A,Ju=new A,Qu=1,Ku=2,em=[,,,,],tm=[,,,,],rm={},am={0:zn,1:Dn,2:Nn},om=[new A(1,0,0),new A(-1,0,0),new A(0,0,1),new A(0,0,-1),new A(0,1,0),new A(0,-1,0)],im=[new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,0,1),new A(0,0,-1)],nm=[new I,new I,new I,new I,new I,new I],sm=0;sm!==(Qu|Ku)+1;++sm){var lm=0!=(sm&Qu),pm=0!=(sm&Ku),dm=new Kt({depthPacking:3201,morphTargets:lm,skinning:pm});em[sm]=dm;var cm=new $t({morphTargets:lm,skinning:pm});tm[sm]=cm}var um=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Rn,this.render=function(mm,gm,fm){if(!1!==um.enabled&&(!1!==um.autoUpdate||!1!==um.needsUpdate)&&0!==mm.length){var hm=Fu.context,ym=Fu.state;ym.disable(3042),ym.buffers.color.setClear(1,1,1,1),ym.buffers.depth.setTest(!0),ym.setScissorTest(!1);for(var vm=0,_m=mm.length,xm;vm<_m;vm++){var bm=mm[vm],Mm=bm.shadow,Sm=bm&&bm.isPointLight;if(void 0===Mm){console.warn('THREE.WebGLShadowMap:',bm,'has no shadow.');continue}var Tm=Mm.camera;if(Xu.copy(Mm.mapSize),Xu.min(Yu),Sm){var Em=Xu.x,wm=Xu.y;nm[0].set(2*Em,wm,Em,wm),nm[1].set(0,wm,Em,wm),nm[2].set(3*Em,wm,Em,wm),nm[3].set(Em,wm,Em,wm),nm[4].set(3*Em,0,Em,wm),nm[5].set(Em,0,Em,wm),Xu.x*=4,Xu.y*=2}if(null===Mm.map){Mm.map=new D(Xu.x,Xu.y,{minFilter:Us,magFilter:Us,format:nl}),Mm.map.texture.name=bm.name+'.shadowMap',Tm.updateProjectionMatrix()}Mm.isSpotLightShadow&&Mm.update(bm);var Am=Mm.map,Pm=Mm.matrix;Ju.setFromMatrixPosition(bm.matrixWorld),Tm.position.copy(Ju),Sm?(xm=6,Pm.makeTranslation(-Ju.x,-Ju.y,-Ju.z)):(xm=1,Zu.setFromMatrixPosition(bm.target.matrixWorld),Tm.lookAt(Zu),Tm.updateMatrixWorld(),Pm.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),Pm.multiply(Tm.projectionMatrix),Pm.multiply(Tm.matrixWorldInverse)),Fu.setRenderTarget(Am),Fu.clear();for(var Cm=0;Cm<xm;Cm++){if(Sm){Zu.copy(Tm.position),Zu.add(om[Cm]),Tm.up.copy(im[Cm]),Tm.lookAt(Zu),Tm.updateMatrixWorld();var Rm=nm[Cm];ym.viewport(Rm)}qu.multiplyMatrices(Tm.projectionMatrix,Tm.matrixWorldInverse),ju.setFromMatrix(qu),Wu(gm,fm,Tm,Sm)}}um.needsUpdate=!1}}}function tr(Fu,Hu,Vu,ku){function Xu(Qm,Km,$m){var eg=new Uint8Array(4),tg=Fu.createTexture();Fu.bindTexture(Qm,tg),Fu.texParameteri(Qm,10241,9728),Fu.texParameteri(Qm,10240,9728);for(var rg=0;rg<$m;rg++)Fu.texImage2D(Km+rg,0,6408,1,1,0,6408,5121,eg);return tg}function Ju(Qm,Km){if(bm[Qm]=1,0===Mm[Qm]&&(Fu.enableVertexAttribArray(Qm),Mm[Qm]=1),Sm[Qm]!==Km){var $m=ku.isWebGL2?Fu:Hu.get('ANGLE_instanced_arrays');$m[ku.isWebGL2?'vertexAttribDivisor':'vertexAttribDivisorANGLE'](Qm,Km),Sm[Qm]=Km}}function Ku(Qm){!0!==Tm[Qm]&&(Fu.enable(Qm),Tm[Qm]=!0)}function $u(Qm){!1!==Tm[Qm]&&(Fu.disable(Qm),Tm[Qm]=!1)}function rm(Qm,Km,$m,eg,tg,rg,ag,og){return Qm===Fn?void(Lm&&($u(3042),Lm=!1)):(Lm||(Ku(3042),Lm=!0),Qm===jn?void(tg=tg||Km,rg=rg||$m,ag=ag||eg,(Km!==Pm||tg!==Im)&&(Fu.blendEquationSeparate(Vu.convert(Km),Vu.convert(tg)),Pm=Km,Im=tg),($m!==Cm||eg!==Rm||rg!==Dm||ag!==zm)&&(Fu.blendFuncSeparate(Vu.convert($m),Vu.convert(eg),Vu.convert(rg),Vu.convert(ag)),Cm=$m,Rm=eg,Dm=rg,zm=ag),Am=Qm,Nm=null):void((Qm!==Am||og!==Nm)&&((Pm!==qn||Im!==qn)&&(Fu.blendEquation(32774),Pm=qn,Im=qn),og?Qm===Hn?Fu.blendFuncSeparate(1,771,1,771):Qm===Vn?Fu.blendFunc(1,1):Qm===kn?Fu.blendFuncSeparate(0,0,769,771):Qm===Wn?Fu.blendFuncSeparate(0,768,0,770):console.error('THREE.WebGLState: Invalid blending: ',Qm):Qm===Hn?Fu.blendFuncSeparate(770,771,1,771):Qm===Vn?Fu.blendFunc(770,1):Qm===kn?Fu.blendFunc(0,769):Qm===Wn?Fu.blendFunc(0,768):console.error('THREE.WebGLState: Invalid blending: ',Qm),Cm=null,Rm=null,Dm=null,zm=null,Am=Qm,Nm=og)))}function om(Qm){Bm!==Qm&&(Qm?Fu.frontFace(2304):Fu.frontFace(2305),Bm=Qm)}function im(Qm){Qm===0?$u(2884):(Ku(2884),Qm!==Um&&(Qm===Pn?Fu.cullFace(1029):Qm===2?Fu.cullFace(1028):Fu.cullFace(1032))),Um=Qm}function sm(Qm,Km,$m){Qm?(Ku(32823),(Om!==Km||Fm!==$m)&&(Fu.polygonOffset(Km,$m),Om=Km,Fm=$m)):$u(32823)}function pm(Qm){void 0===Qm&&(Qm=33984+Hm-1),jm!==Qm&&(Fu.activeTexture(Qm),jm=Qm)}var ym=new function(){var Qm=!1,Km=new I,$m=null,eg=new I(0,0,0,0);return{setMask:function(tg){$m===tg||Qm||(Fu.colorMask(tg,tg,tg,tg),$m=tg)},setLocked:function(tg){Qm=tg},setClear:function(tg,rg,ag,og,ig){!0===ig&&(tg*=og,rg*=og,ag*=og),Km.set(tg,rg,ag,og),!1===eg.equals(Km)&&(Fu.clearColor(tg,rg,ag,og),eg.copy(Km))},reset:function(){Qm=!1,$m=null,eg.set(-1,0,0,0)}}},xm=new function(){var Qm=!1,Km=null,$m=null,eg=null;return{setTest:function(tg){tg?Ku(2929):$u(2929)},setMask:function(tg){Km===tg||Qm||(Fu.depthMask(tg),Km=tg)},setFunc:function(tg){$m!==tg&&(tg?tg===0?Fu.depthFunc(512):tg===1?Fu.depthFunc(519):tg===2?Fu.depthFunc(513):tg===us?Fu.depthFunc(515):tg===4?Fu.depthFunc(514):tg===5?Fu.depthFunc(518):tg===6?Fu.depthFunc(516):tg===7?Fu.depthFunc(517):Fu.depthFunc(515):Fu.depthFunc(515),$m=tg)},setLocked:function(tg){Qm=tg},setClear:function(tg){eg!==tg&&(Fu.clearDepth(tg),eg=tg)},reset:function(){Qm=!1,Km=null,$m=null,eg=null}}},vm=new function(){var Qm=!1,Km=null,$m=null,eg=null,tg=null,rg=null,ag=null,og=null,ig=null;return{setTest:function(ng){ng?Ku(2960):$u(2960)},setMask:function(ng){Km===ng||Qm||(Fu.stencilMask(ng),Km=ng)},setFunc:function(ng,sg,lg){($m!==ng||eg!==sg||tg!==lg)&&(Fu.stencilFunc(ng,sg,lg),$m=ng,eg=sg,tg=lg)},setOp:function(ng,sg,lg){(rg!==ng||ag!==sg||og!==lg)&&(Fu.stencilOp(ng,sg,lg),rg=ng,ag=sg,og=lg)},setLocked:function(ng){Qm=ng},setClear:function(ng){ig!==ng&&(Fu.clearStencil(ng),ig=ng)},reset:function(){Qm=!1,Km=null,$m=null,eg=null,tg=null,rg=null,ag=null,og=null,ig=null}}},_m=Fu.getParameter(34921),bm=new Uint8Array(_m),Mm=new Uint8Array(_m),Sm=new Uint8Array(_m),Tm={},Em=null,wm=null,Lm=null,Am=null,Pm=null,Cm=null,Rm=null,Im=null,Dm=null,zm=null,Nm=!1,Bm=null,Um=null,Gm=null,Om=null,Fm=null,Hm=Fu.getParameter(35661),Vm=!1,km=0,Wm=Fu.getParameter(7938);-1===Wm.indexOf('WebGL')?-1!==Wm.indexOf('OpenGL ES')&&(km=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Wm)[1]),Vm=2<=km):(km=parseFloat(/^WebGL\ ([0-9])/.exec(Wm)[1]),Vm=1<=km);var jm=null,Xm={},Ym=new I,Zm=new I,Jm={};return Jm[3553]=Xu(3553,3553,1),Jm[34067]=Xu(34067,34069,6),ym.setClear(0,0,0,1),xm.setClear(1),vm.setClear(0),Ku(2929),xm.setFunc(us),om(!1),im(Pn),Ku(2884),rm(Fn),{buffers:{color:ym,depth:xm,stencil:vm},initAttributes:function(){for(var Qm=0,Km=bm.length;Qm<Km;Qm++)bm[Qm]=0},enableAttribute:function(Qm){Ju(Qm,0)},enableAttributeAndDivisor:Ju,disableUnusedAttributes:function(){for(var Qm=0,Km=Mm.length;Qm!==Km;++Qm)Mm[Qm]!==bm[Qm]&&(Fu.disableVertexAttribArray(Qm),Mm[Qm]=0)},enable:Ku,disable:$u,getCompressedTextureFormats:function(){if(null===Em&&(Em=[],Hu.get('WEBGL_compressed_texture_pvrtc')||Hu.get('WEBGL_compressed_texture_s3tc')||Hu.get('WEBGL_compressed_texture_etc1')||Hu.get('WEBGL_compressed_texture_astc')))for(var Qm=Fu.getParameter(34467),Km=0;Km<Qm.length;Km++)Em.push(Qm[Km]);return Em},useProgram:function(Qm){return wm!==Qm&&(Fu.useProgram(Qm),wm=Qm,!0)},setBlending:rm,setMaterial:function(Qm,Km){Qm.side===Nn?$u(2884):Ku(2884);var $m=Qm.side===zn;Km&&($m=!$m),om($m),Qm.blending===Hn&&!1===Qm.transparent?rm(Fn):rm(Qm.blending,Qm.blendEquation,Qm.blendSrc,Qm.blendDst,Qm.blendEquationAlpha,Qm.blendSrcAlpha,Qm.blendDstAlpha,Qm.premultipliedAlpha),xm.setFunc(Qm.depthFunc),xm.setTest(Qm.depthTest),xm.setMask(Qm.depthWrite),ym.setMask(Qm.colorWrite),sm(Qm.polygonOffset,Qm.polygonOffsetFactor,Qm.polygonOffsetUnits)},setFlipSided:om,setCullFace:im,setLineWidth:function(Qm){Qm!==Gm&&(Vm&&Fu.lineWidth(Qm),Gm=Qm)},setPolygonOffset:sm,setScissorTest:function(Qm){Qm?Ku(3089):$u(3089)},activeTexture:pm,bindTexture:function(Qm,Km){null===jm&&pm();var $m=Xm[jm];void 0===$m&&($m={type:void 0,texture:void 0},Xm[jm]=$m),($m.type!==Qm||$m.texture!==Km)&&(Fu.bindTexture(Qm,Km||Jm[Qm]),$m.type=Qm,$m.texture=Km)},compressedTexImage2D:function(){try{Fu.compressedTexImage2D.apply(Fu,arguments)}catch(Qm){console.error('THREE.WebGLState:',Qm)}},texImage2D:function(){try{Fu.texImage2D.apply(Fu,arguments)}catch(Qm){console.error('THREE.WebGLState:',Qm)}},texImage3D:function(){try{Fu.texImage3D.apply(Fu,arguments)}catch(Qm){console.error('THREE.WebGLState:',Qm)}},scissor:function(Qm){!1===Ym.equals(Qm)&&(Fu.scissor(Qm.x,Qm.y,Qm.z,Qm.w),Ym.copy(Qm))},viewport:function(Qm){!1===Zm.equals(Qm)&&(Fu.viewport(Qm.x,Qm.y,Qm.z,Qm.w),Zm.copy(Qm))},reset:function(){for(var Qm=0;Qm<Mm.length;Qm++)1===Mm[Qm]&&(Fu.disableVertexAttribArray(Qm),Mm[Qm]=0);Tm={},Em=null,jm=null,Xm={},wm=null,Am=null,Bm=null,Um=null,ym.reset(),xm.reset(),vm.reset()}}}function rr(Fu,Hu,Vu,ku,Wu,ju,qu){function Xu(_m,bm){if(_m.width>bm||_m.height>bm){if('data'in _m)return void console.warn('THREE.WebGLRenderer: image in DataTexture is too big ('+_m.width+'x'+_m.height+').');var Mm=bm/Math.max(_m.width,_m.height),Sm=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');Sm.width=Math.floor(_m.width*Mm),Sm.height=Math.floor(_m.height*Mm);var Tm=Sm.getContext('2d');return Tm.drawImage(_m,0,0,_m.width,_m.height,0,0,Sm.width,Sm.height),console.warn('THREE.WebGLRenderer: image is too big ('+_m.width+'x'+_m.height+'). Resized to '+Sm.width+'x'+Sm.height),Sm}return _m}function Yu(_m){return fp.isPowerOfTwo(_m.width)&&fp.isPowerOfTwo(_m.height)}function Zu(_m){if(_m instanceof HTMLImageElement||_m instanceof HTMLCanvasElement||_m instanceof ImageBitmap){void 0===vm&&(vm=document.createElementNS('http://www.w3.org/1999/xhtml','canvas')),vm.width=fp.floorPowerOfTwo(_m.width),vm.height=fp.floorPowerOfTwo(_m.height);var bm=vm.getContext('2d');return bm.drawImage(_m,0,0,vm.width,vm.height),console.warn('THREE.WebGLRenderer: image is not power of two ('+_m.width+'x'+_m.height+'). Resized to '+vm.width+'x'+vm.height),vm}return _m}function Ju(_m){return!Wu.isWebGL2&&(_m.wrapS!==Ns||_m.wrapT!==Ns||_m.minFilter!==Us&&_m.minFilter!==Fs)}function Qu(_m,bm){return _m.generateMipmaps&&bm&&_m.minFilter!==Us&&_m.minFilter!==Fs}function Ku(_m,bm,Mm,Sm){Fu.generateMipmap(_m);var Tm=ku.get(bm);Tm.__maxMipLevel=Math.log(Math.max(Mm,Sm))*Math.LOG2E}function $u(_m,bm){if(!Wu.isWebGL2)return _m;if(6403===_m){if(5126===bm)return 33326;if(5131===bm)return 33325;if(5121===bm)return 33321}if(6407===_m){if(5126===bm)return 34837;if(5131===bm)return 34843;if(5121===bm)return 32849}if(6408===_m){if(5126===bm)return 34836;if(5131===bm)return 34842;if(5121===bm)return 32856}return _m}function em(_m){return _m===Us||_m===Gs||_m===Os?9728:9729}function tm(_m){var bm=_m.target;bm.removeEventListener('dispose',tm),am(bm),bm.isVideoTexture&&delete xm[bm.id],qu.memory.textures--}function rm(_m){var bm=_m.target;bm.removeEventListener('dispose',rm),om(bm),qu.memory.textures--}function am(_m){var bm=ku.get(_m);if(_m.image&&bm.__image__webglTextureCube)Fu.deleteTexture(bm.__image__webglTextureCube);else{if(bm.__webglInit===void 0)return;Fu.deleteTexture(bm.__webglTexture)}ku.remove(_m)}function om(_m){var bm=ku.get(_m),Mm=ku.get(_m.texture);if(_m){if(void 0!==Mm.__webglTexture&&Fu.deleteTexture(Mm.__webglTexture),_m.depthTexture&&_m.depthTexture.dispose(),_m.isWebGLRenderTargetCube)for(var Sm=0;6>Sm;Sm++)Fu.deleteFramebuffer(bm.__webglFramebuffer[Sm]),bm.__webglDepthbuffer&&Fu.deleteRenderbuffer(bm.__webglDepthbuffer[Sm]);else Fu.deleteFramebuffer(bm.__webglFramebuffer),bm.__webglDepthbuffer&&Fu.deleteRenderbuffer(bm.__webglDepthbuffer);ku.remove(_m.texture),ku.remove(_m)}}function im(_m,bm){var Mm=ku.get(_m);if(_m.isVideoTexture&&ym(_m),0<_m.version&&Mm.__version!==_m.version){var Sm=_m.image;if(void 0===Sm)console.warn('THREE.WebGLRenderer: Texture marked for update but image is undefined');else if(!1===Sm.complete)console.warn('THREE.WebGLRenderer: Texture marked for update but image is incomplete');else return void dm(Mm,_m,bm)}Vu.activeTexture(33984+bm),Vu.bindTexture(3553,Mm.__webglTexture)}function pm(_m,bm,Mm){var Sm;if(Mm?(Fu.texParameteri(_m,10242,ju.convert(bm.wrapS)),Fu.texParameteri(_m,10243,ju.convert(bm.wrapT)),Fu.texParameteri(_m,10240,ju.convert(bm.magFilter)),Fu.texParameteri(_m,10241,ju.convert(bm.minFilter))):(Fu.texParameteri(_m,10242,33071),Fu.texParameteri(_m,10243,33071),(bm.wrapS!==Ns||bm.wrapT!==Ns)&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.'),Fu.texParameteri(_m,10240,em(bm.magFilter)),Fu.texParameteri(_m,10241,em(bm.minFilter)),bm.minFilter!==Us&&bm.minFilter!==Fs&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.')),Sm=Hu.get('EXT_texture_filter_anisotropic'),Sm){if(bm.type===Zs&&null===Hu.get('OES_texture_float_linear'))return;if(bm.type===Js&&null===(Wu.isWebGL2||Hu.get('OES_texture_half_float_linear')))return;(1<bm.anisotropy||ku.get(bm).__currentAnisotropy)&&(Fu.texParameterf(_m,Sm.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(bm.anisotropy,Wu.getMaxAnisotropy())),ku.get(bm).__currentAnisotropy=bm.anisotropy)}}function dm(_m,bm,Mm){var Sm;Sm=bm.isDataTexture3D?32879:3553,_m.__webglInit===void 0&&(_m.__webglInit=!0,bm.addEventListener('dispose',tm),_m.__webglTexture=Fu.createTexture(),qu.memory.textures++),Vu.activeTexture(33984+Mm),Vu.bindTexture(Sm,_m.__webglTexture),Fu.pixelStorei(37440,bm.flipY),Fu.pixelStorei(37441,bm.premultiplyAlpha),Fu.pixelStorei(3317,bm.unpackAlignment);var Tm=Xu(bm.image,Wu.maxTextureSize);Ju(bm)&&!1===Yu(Tm)&&(Tm=Zu(Tm));var Em=Yu(Tm),wm=ju.convert(bm.format),Lm=ju.convert(bm.type),Am=$u(wm,Lm);pm(Sm,bm,Em);var Cm=bm.mipmaps,Pm;if(bm.isDepthTexture){if(Am=6402,bm.type===Zs){if(!Wu.isWebGL2)throw new Error('Float Depth Texture only supported in WebGL2.0');Am=36012}else Wu.isWebGL2&&(Am=33189);bm.format===cl&&6402===Am&&bm.type!==qs&&bm.type!==Ys&&(console.warn('THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.'),bm.type=qs,Lm=ju.convert(bm.type)),bm.format===ul&&(Am=34041,bm.type!==el&&(console.warn('THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.'),bm.type=el,Lm=ju.convert(bm.type))),Vu.texImage2D(3553,0,Am,Tm.width,Tm.height,0,wm,Lm,null)}else if(bm.isDataTexture){if(0<Cm.length&&Em){for(var Rm=0,Im=Cm.length;Rm<Im;Rm++)Pm=Cm[Rm],Vu.texImage2D(3553,Rm,Am,Pm.width,Pm.height,0,wm,Lm,Pm.data);bm.generateMipmaps=!1,_m.__maxMipLevel=Cm.length-1}else Vu.texImage2D(3553,0,Am,Tm.width,Tm.height,0,wm,Lm,Tm.data),_m.__maxMipLevel=0;}else if(bm.isCompressedTexture){for(var Rm=0,Im=Cm.length;Rm<Im;Rm++)Pm=Cm[Rm],bm.format!==nl&&bm.format!==al?-1<Vu.getCompressedTextureFormats().indexOf(wm)?Vu.compressedTexImage2D(3553,Rm,Am,Pm.width,Pm.height,0,Pm.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()'):Vu.texImage2D(3553,Rm,Am,Pm.width,Pm.height,0,wm,Lm,Pm.data);_m.__maxMipLevel=Cm.length-1}else if(bm.isDataTexture3D)Vu.texImage3D(32879,0,Am,Tm.width,Tm.height,Tm.depth,0,wm,Lm,Tm.data),_m.__maxMipLevel=0;else if(0<Cm.length&&Em){for(var Rm=0,Im=Cm.length;Rm<Im;Rm++)Pm=Cm[Rm],Vu.texImage2D(3553,Rm,Am,wm,Lm,Pm);bm.generateMipmaps=!1,_m.__maxMipLevel=Cm.length-1}else Vu.texImage2D(3553,0,Am,wm,Lm,Tm),_m.__maxMipLevel=0;Qu(bm,Em)&&Ku(3553,bm,Tm.width,Tm.height),_m.__version=bm.version,bm.onUpdate&&bm.onUpdate(bm)}function cm(_m,bm,Mm,Sm){var Tm=ju.convert(bm.texture.format),Em=ju.convert(bm.texture.type),wm=$u(Tm,Em);Vu.texImage2D(Sm,0,wm,bm.width,bm.height,0,Tm,Em,null),Fu.bindFramebuffer(36160,_m),Fu.framebufferTexture2D(36160,Mm,Sm,ku.get(bm.texture).__webglTexture,0),Fu.bindFramebuffer(36160,null)}function um(_m,bm){Fu.bindRenderbuffer(36161,_m),bm.depthBuffer&&!bm.stencilBuffer?(Fu.renderbufferStorage(36161,33189,bm.width,bm.height),Fu.framebufferRenderbuffer(36160,36096,36161,_m)):bm.depthBuffer&&bm.stencilBuffer?(Fu.renderbufferStorage(36161,34041,bm.width,bm.height),Fu.framebufferRenderbuffer(36160,33306,36161,_m)):Fu.renderbufferStorage(36161,32854,bm.width,bm.height),Fu.bindRenderbuffer(36161,null)}function mm(_m,bm){var Mm=bm&&bm.isWebGLRenderTargetCube;if(Mm)throw new Error('Depth Texture with cube render targets is not supported');if(Fu.bindFramebuffer(36160,_m),!(bm.depthTexture&&bm.depthTexture.isDepthTexture))throw new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');ku.get(bm.depthTexture).__webglTexture&&bm.depthTexture.image.width===bm.width&&bm.depthTexture.image.height===bm.height||(bm.depthTexture.image.width=bm.width,bm.depthTexture.image.height=bm.height,bm.depthTexture.needsUpdate=!0),im(bm.depthTexture,0);var Sm=ku.get(bm.depthTexture).__webglTexture;if(bm.depthTexture.format===cl)Fu.framebufferTexture2D(36160,36096,3553,Sm,0);else if(bm.depthTexture.format===ul)Fu.framebufferTexture2D(36160,33306,3553,Sm,0);else throw new Error('Unknown depthTexture format')}function gm(_m){var bm=ku.get(_m),Mm=!0===_m.isWebGLRenderTargetCube;if(_m.depthTexture){if(Mm)throw new Error('target.depthTexture not supported in Cube render targets');mm(bm.__webglFramebuffer,_m)}else if(Mm){bm.__webglDepthbuffer=[];for(var Sm=0;6>Sm;Sm++)Fu.bindFramebuffer(36160,bm.__webglFramebuffer[Sm]),bm.__webglDepthbuffer[Sm]=Fu.createRenderbuffer(),um(bm.__webglDepthbuffer[Sm],_m)}else Fu.bindFramebuffer(36160,bm.__webglFramebuffer),bm.__webglDepthbuffer=Fu.createRenderbuffer(),um(bm.__webglDepthbuffer,_m);Fu.bindFramebuffer(36160,null)}function ym(_m){var bm=_m.id,Mm=qu.render.frame;xm[bm]!==Mm&&(xm[bm]=Mm,_m.update())}var xm={},vm;this.setTexture2D=im,this.setTexture3D=function(_m,bm){var Mm=ku.get(_m);return 0<_m.version&&Mm.__version!==_m.version?void dm(Mm,_m,bm):void(Vu.activeTexture(33984+bm),Vu.bindTexture(32879,Mm.__webglTexture))},this.setTextureCube=function(_m,bm){var Mm=ku.get(_m);if(6===_m.image.length)if(0<_m.version&&Mm.__version!==_m.version){Mm.__image__webglTextureCube||(_m.addEventListener('dispose',tm),Mm.__image__webglTextureCube=Fu.createTexture(),qu.memory.textures++),Vu.activeTexture(33984+bm),Vu.bindTexture(34067,Mm.__image__webglTextureCube),Fu.pixelStorei(37440,_m.flipY);for(var Sm=_m&&_m.isCompressedTexture,Tm=_m.image[0]&&_m.image[0].isDataTexture,Em=[],wm=0;6>wm;wm++)Em[wm]=Sm||Tm?Tm?_m.image[wm].image:_m.image[wm]:Xu(_m.image[wm],Wu.maxCubemapSize);var Lm=Em[0],Am=Yu(Lm),Pm=ju.convert(_m.format),Cm=ju.convert(_m.type),Rm=$u(Pm,Cm);pm(34067,_m,Am);for(var wm=0;6>wm;wm++)if(!Sm)Tm?Vu.texImage2D(34069+wm,0,Rm,Em[wm].width,Em[wm].height,0,Pm,Cm,Em[wm].data):Vu.texImage2D(34069+wm,0,Rm,Pm,Cm,Em[wm]);else for(var Dm=Em[wm].mipmaps,zm=0,Nm=Dm.length,Im;zm<Nm;zm++)Im=Dm[zm],_m.format!==nl&&_m.format!==al?-1<Vu.getCompressedTextureFormats().indexOf(Pm)?Vu.compressedTexImage2D(34069+wm,zm,Rm,Im.width,Im.height,0,Im.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()'):Vu.texImage2D(34069+wm,zm,Rm,Im.width,Im.height,0,Pm,Cm,Im.data);Mm.__maxMipLevel=Sm?Dm.length-1:0,Qu(_m,Am)&&Ku(34067,_m,Lm.width,Lm.height),Mm.__version=_m.version,_m.onUpdate&&_m.onUpdate(_m)}else Vu.activeTexture(33984+bm),Vu.bindTexture(34067,Mm.__image__webglTextureCube)},this.setTextureCubeDynamic=function(_m,bm){Vu.activeTexture(33984+bm),Vu.bindTexture(34067,ku.get(_m).__webglTexture)},this.setupRenderTarget=function(_m){var bm=ku.get(_m),Mm=ku.get(_m.texture);_m.addEventListener('dispose',rm),Mm.__webglTexture=Fu.createTexture(),qu.memory.textures++;var Sm=!0===_m.isWebGLRenderTargetCube,Tm=Yu(_m);if(Sm){bm.__webglFramebuffer=[];for(var Em=0;6>Em;Em++)bm.__webglFramebuffer[Em]=Fu.createFramebuffer()}else bm.__webglFramebuffer=Fu.createFramebuffer();if(Sm){Vu.bindTexture(34067,Mm.__webglTexture),pm(34067,_m.texture,Tm);for(var Em=0;6>Em;Em++)cm(bm.__webglFramebuffer[Em],_m,36064,34069+Em);Qu(_m.texture,Tm)&&Ku(34067,_m.texture,_m.width,_m.height),Vu.bindTexture(34067,null)}else Vu.bindTexture(3553,Mm.__webglTexture),pm(3553,_m.texture,Tm),cm(bm.__webglFramebuffer,_m,36064,3553),Qu(_m.texture,Tm)&&Ku(3553,_m.texture,_m.width,_m.height),Vu.bindTexture(3553,null);_m.depthBuffer&&gm(_m)},this.updateRenderTargetMipmap=function(_m){var bm=_m.texture,Mm=Yu(_m);if(Qu(bm,Mm)){var Sm=_m.isWebGLRenderTargetCube?34067:3553,Tm=ku.get(bm).__webglTexture;Vu.bindTexture(Sm,Tm),Ku(Sm,bm,_m.width,_m.height),Vu.bindTexture(Sm,null)}}}function ar(Fu,Hu,Vu){return{convert:function(Wu){var ju;if(Wu===zs)return 10497;if(Wu===Ns)return 33071;if(Wu===Bs)return 33648;if(Wu===Us)return 9728;if(Wu===Gs)return 9984;if(Wu===Os)return 9986;if(Wu===Fs)return 9729;if(Wu===Hs)return 9985;if(Wu===Vs)return 9987;if(Wu===ks)return 5121;if(Wu===1017)return 32819;if(Wu===1018)return 32820;if(Wu===1019)return 33635;if(Wu===1010)return 5120;if(Wu===1011)return 5122;if(Wu===qs)return 5123;if(Wu===1013)return 5124;if(Wu===Ys)return 5125;if(Wu===Zs)return 5126;if(Wu===Js){if(Vu.isWebGL2)return 5131;if(ju=Hu.get('OES_texture_half_float'),null!==ju)return ju.HALF_FLOAT_OES}if(Wu===1021)return 6406;if(Wu===al)return 6407;if(Wu===nl)return 6408;if(Wu===1024)return 6409;if(Wu===1025)return 6410;if(Wu===cl)return 6402;if(Wu===ul)return 34041;if(Wu===1028)return 6403;if(Wu===qn)return 32774;if(Wu===101)return 32778;if(Wu===102)return 32779;if(Wu===200)return 0;if(Wu===201)return 1;if(Wu===202)return 768;if(Wu===203)return 769;if(Wu===ts)return 770;if(Wu===rs)return 771;if(Wu===206)return 772;if(Wu===207)return 773;if(Wu===208)return 774;if(Wu===209)return 775;if(Wu===210)return 776;if((Wu===xl||Wu===_l||Wu===bl||Wu===Ml)&&(ju=Hu.get('WEBGL_compressed_texture_s3tc'),null!==ju)){if(Wu===xl)return ju.COMPRESSED_RGB_S3TC_DXT1_EXT;if(Wu===_l)return ju.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(Wu===bl)return ju.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(Wu===Ml)return ju.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((Wu===Sl||Wu===Tl||Wu===El||Wu===wl)&&(ju=Hu.get('WEBGL_compressed_texture_pvrtc'),null!==ju)){if(Wu===Sl)return ju.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(Wu===Tl)return ju.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(Wu===El)return ju.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(Wu===wl)return ju.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(Wu===36196&&(ju=Hu.get('WEBGL_compressed_texture_etc1'),null!==ju))return ju.COMPRESSED_RGB_ETC1_WEBGL;if((Wu===37808||Wu===37809||Wu===37810||Wu===37811||Wu===37812||Wu===37813||Wu===37814||Wu===37815||Wu===37816||Wu===37817||Wu===37818||Wu===37819||Wu===37820||Wu===37821)&&(ju=Hu.get('WEBGL_compressed_texture_astc'),null!==ju))return Wu;if(Wu===Zn||Wu===Jn){if(Vu.isWebGL2){if(Wu===Zn)return 32775;if(Wu===Jn)return 32776}if(ju=Hu.get('EXT_blend_minmax'),null!==ju){if(Wu===Zn)return ju.MIN_EXT;if(Wu===Jn)return ju.MAX_EXT}}if(Wu===el){if(Vu.isWebGL2)return 34042;if(ju=Hu.get('WEBGL_depth_texture'),null!==ju)return ju.UNSIGNED_INT_24_8_WEBGL}return 0}}}function or(){K.call(this),this.type='Group'}function ir(){K.call(this),this.type='Camera',this.matrixWorldInverse=new E,this.projectionMatrix=new E,this.projectionMatrixInverse=new E}function nr(Fu,Hu,Vu,ku){ir.call(this),this.type='PerspectiveCamera',this.fov=Fu===void 0?50:Fu,this.zoom=1,this.near=Vu===void 0?0.1:Vu,this.far=ku===void 0?2e3:ku,this.focus=10,this.aspect=Hu===void 0?1:Hu,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function sr(Fu){nr.call(this),this.cameras=Fu||[]}function lr(Fu,Hu,Vu){ru.setFromMatrixPosition(Hu.matrixWorld),au.setFromMatrixPosition(Vu.matrixWorld);var ku=ru.distanceTo(au),Wu=Hu.projectionMatrix.elements,ju=Vu.projectionMatrix.elements,qu=Wu[14]/(Wu[10]-1),Xu=Wu[14]/(Wu[10]+1),Yu=(Wu[9]+1)/Wu[5],Zu=(Wu[9]-1)/Wu[5],Ju=(Wu[8]-1)/Wu[0],Qu=(ju[8]+1)/ju[0],em=ku/(-Ju+Qu),tm=em*-Ju;Hu.matrixWorld.decompose(Fu.position,Fu.quaternion,Fu.scale),Fu.translateX(tm),Fu.translateZ(em),Fu.matrixWorld.compose(Fu.position,Fu.quaternion,Fu.scale),Fu.matrixWorldInverse.getInverse(Fu.matrixWorld);var rm=qu+em,am=Xu+em;Fu.projectionMatrix.makePerspective(qu*Ju-tm,qu*Qu+(ku-tm),Yu*Xu/am*rm,Zu*Xu/am*rm,rm,am)}function pr(Fu){function Hu(){return null!==qu&&!0===qu.isPresenting}function Vu(){if(Hu()){var dm=qu.getEyeParameters('left'),cm=dm.renderWidth*Ku,um=dm.renderHeight*Ku;sm=Fu.getPixelRatio(),nm=Fu.getSize(),Fu.setDrawingBufferSize(2*cm,um,1),pm.start()}else ju.enabled&&Fu.setDrawingBufferSize(nm.width,nm.height,sm),pm.stop()}function ku(dm){for(var cm=navigator.getGamepads&&navigator.getGamepads(),um=0,mm=0,gm=cm.length,fm;um<gm;um++)if(fm=cm[um],fm&&('Daydream Controller'===fm.id||'Gear VR Controller'===fm.id||'Oculus Go Controller'===fm.id||'OpenVR Gamepad'===fm.id||fm.id.startsWith('Oculus Touch')||fm.id.startsWith('Spatial Controller'))){if(mm===dm)return fm;mm++}}function Wu(){for(var dm=0;dm<Zu.length;dm++){var cm=Zu[dm],um=ku(dm);if(um!==void 0&&um.pose!==void 0){if(null===um.pose)return;var mm=um.pose;!1===mm.hasPosition&&cm.position.set(0.2,-0.6,-0.05),null!==mm.position&&cm.position.fromArray(mm.position),null!==mm.orientation&&cm.quaternion.fromArray(mm.orientation),cm.matrix.compose(cm.position,cm.quaternion,cm.scale),cm.matrix.premultiply(Ju),cm.matrix.decompose(cm.position,cm.quaternion,cm.scale),cm.matrixWorldNeedsUpdate=!0,cm.visible=!0;var gm='Daydream Controller'===um.id?0:1;lm[dm]!==um.buttons[gm].pressed&&(lm[dm]=um.buttons[gm].pressed,!0===lm[dm]?cm.dispatchEvent({type:'selectstart'}):(cm.dispatchEvent({type:'selectend'}),cm.dispatchEvent({type:'select'})))}else cm.visible=!1}}var ju=this,qu=null,Xu=null,Yu=null,Zu=[],Ju=new E,Qu=new E,Ku=1,$u='stage';'undefined'!=typeof window&&'VRFrameData'in window&&(Xu=new window.VRFrameData,window.addEventListener('vrdisplaypresentchange',Vu,!1));var em=new E,tm=new L,rm=new A,am=new nr;am.bounds=new I(0,0,0.5,1),am.layers.enable(1);var om=new nr;om.bounds=new I(0.5,0,0.5,1),om.layers.enable(2);var im=new sr([am,om]);im.layers.enable(1),im.layers.enable(2);var nm,sm,lm=[];this.enabled=!1,this.getController=function(dm){var cm=Zu[dm];return void 0===cm&&(cm=new or,cm.matrixAutoUpdate=!1,cm.visible=!1,Zu[dm]=cm),cm},this.getDevice=function(){return qu},this.setDevice=function(dm){dm!==void 0&&(qu=dm),pm.setContext(dm)},this.setFramebufferScaleFactor=function(dm){Ku=dm},this.setFrameOfReferenceType=function(dm){$u=dm},this.setPoseTarget=function(dm){dm!==void 0&&(Yu=dm)},this.getCamera=function(dm){var cm='stage'===$u?1.6:0;if(null===qu)return dm.position.set(0,cm,0),dm;if(qu.depthNear=dm.near,qu.depthFar=dm.far,qu.getFrameData(Xu),'stage'===$u){var um=qu.stageParameters;um?Ju.fromArray(um.sittingToStandingTransform):Ju.makeTranslation(0,cm,0)}var mm=Xu.pose,gm=null===Yu?dm:Yu;if(gm.matrix.copy(Ju),gm.matrix.decompose(gm.position,gm.quaternion,gm.scale),null!==mm.orientation&&(tm.fromArray(mm.orientation),gm.quaternion.multiply(tm)),null!==mm.position&&(tm.setFromRotationMatrix(Ju),rm.fromArray(mm.position),rm.applyQuaternion(tm),gm.position.add(rm)),gm.updateMatrixWorld(),!1===qu.isPresenting)return dm;am.near=dm.near,om.near=dm.near,am.far=dm.far,om.far=dm.far,am.matrixWorldInverse.fromArray(Xu.leftViewMatrix),om.matrixWorldInverse.fromArray(Xu.rightViewMatrix),Qu.getInverse(Ju),'stage'===$u&&(am.matrixWorldInverse.multiply(Qu),om.matrixWorldInverse.multiply(Qu));var fm=gm.parent;null!==fm&&(em.getInverse(fm.matrixWorld),am.matrixWorldInverse.multiply(em),om.matrixWorldInverse.multiply(em)),am.matrixWorld.getInverse(am.matrixWorldInverse),om.matrixWorld.getInverse(om.matrixWorldInverse),am.projectionMatrix.fromArray(Xu.leftProjectionMatrix),om.projectionMatrix.fromArray(Xu.rightProjectionMatrix),lr(im,am,om);var hm=qu.getLayers();if(hm.length){var ym=hm[0];null!==ym.leftBounds&&4===ym.leftBounds.length&&am.bounds.fromArray(ym.leftBounds),null!==ym.rightBounds&&4===ym.rightBounds.length&&om.bounds.fromArray(ym.rightBounds)}return Wu(),im},this.getStandingMatrix=function(){return Ju},this.isPresenting=Hu;var pm=new X;this.setAnimationLoop=function(dm){pm.setAnimationLoop(dm)},this.submitFrame=function(){Hu()&&qu.submitFrame()},this.dispose=function(){'undefined'!=typeof window&&window.removeEventListener('vrdisplaypresentchange',Vu)}}function dr(Fu){function Hu(){return null!==Yu&&null!==Ju}function Vu(nm){var sm=$u[em.indexOf(nm.inputSource)];sm&&sm.dispatchEvent({type:nm.type})}function ku(){Fu.setFramebuffer(null),im.stop()}function Wu(nm,sm){null===sm?nm.matrixWorld.copy(nm.matrix):nm.matrixWorld.multiplyMatrices(sm.matrixWorld,nm.matrix),nm.matrixWorldInverse.getInverse(nm.matrixWorld)}var qu=Fu.context,Xu=null,Yu=null,Zu=1,Ju=null,Qu='stage',Ku=null,$u=[],em=[],tm=new nr;tm.layers.enable(1),tm.viewport=new I;var rm=new nr;rm.layers.enable(2),rm.viewport=new I;var am=new sr([tm,rm]);am.layers.enable(1),am.layers.enable(2),this.enabled=!1,this.getController=function(nm){var sm=$u[nm];return void 0===sm&&(sm=new or,sm.matrixAutoUpdate=!1,sm.visible=!1,$u[nm]=sm),sm},this.getDevice=function(){return Xu},this.setDevice=function(nm){nm!==void 0&&(Xu=nm),nm instanceof XRDevice&&qu.setCompatibleXRDevice(nm)},this.setFramebufferScaleFactor=function(nm){Zu=nm},this.setFrameOfReferenceType=function(nm){Qu=nm},this.setSession=function(nm){Yu=nm,null!=Yu&&(Yu.addEventListener('select',Vu),Yu.addEventListener('selectstart',Vu),Yu.addEventListener('selectend',Vu),Yu.addEventListener('end',ku),Yu.baseLayer=new XRWebGLLayer(Yu,qu,{framebufferScaleFactor:Zu}),Yu.requestFrameOfReference(Qu).then(function(sm){Ju=sm,Fu.setFramebuffer(Yu.baseLayer.framebuffer),im.setContext(Yu),im.start()}),em=Yu.getInputSources(),Yu.addEventListener('inputsourceschange',function(){em=Yu.getInputSources(),console.log(em);for(var sm=0,lm;sm<$u.length;sm++)lm=$u[sm],lm.userData.inputSource=em[sm]}))},this.getCamera=function(nm){if(Hu()){var sm=nm.parent,lm=am.cameras;Wu(am,sm);for(var pm=0;pm<lm.length;pm++)Wu(lm[pm],sm);nm.matrixWorld.copy(am.matrixWorld);for(var dm=nm.children,pm=0,cm=dm.length;pm<cm;pm++)dm[pm].updateMatrixWorld(!0);return lr(am,tm,rm),am}return nm},this.isPresenting=Hu;var om=null,im=new X;im.setAnimationLoop(function(nm,sm){if(Ku=sm.getDevicePose(Ju),null!==Ku)for(var lm=Yu.baseLayer,pm=sm.views,dm=0;dm<pm.length;dm++){var cm=pm[dm],um=lm.getViewport(cm),mm=Ku.getViewMatrix(cm),gm=am.cameras[dm];gm.matrix.fromArray(mm).getInverse(gm.matrix),gm.projectionMatrix.fromArray(cm.projectionMatrix),gm.viewport.set(um.x,um.y,um.width,um.height),0===dm&&am.matrix.copy(gm.matrix)}for(var dm=0;dm<$u.length;dm++){var fm=$u[dm],hm=em[dm];if(hm){var ym=sm.getInputPose(hm,Ju);if(null!==ym){'targetRay'in ym?fm.matrix.elements=ym.targetRay.transformMatrix:'pointerMatrix'in ym&&(fm.matrix.elements=ym.pointerMatrix),fm.matrix.decompose(fm.position,fm.rotation,fm.scale),fm.visible=!0;continue}}fm.visible=!1}om&&om(nm)}),this.setAnimationLoop=function(nm){om=nm},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn('THREE.WebXRManager: getStandingMatrix() is no longer needed.'),new THREE.Matrix4},this.submitFrame=function(){}}function cr(Fu){function Hu(){return null===Dm?jm:1}function Vu(){og=new ze(rg),ig=new Ie(rg,og,Fu),ig.isWebGL2||(og.get('WEBGL_depth_texture'),og.get('OES_texture_float'),og.get('OES_texture_half_float'),og.get('OES_texture_half_float_linear'),og.get('OES_standard_derivatives'),og.get('OES_element_index_uint'),og.get('ANGLE_instanced_arrays')),og.get('OES_texture_float_linear'),_g=new ar(rg,og,ig),ng=new tr(rg,og,_g,ig),ng.scissor(Fm.copy(Ym).multiplyScalar(jm)),ng.viewport(Om.copy(Xm).multiplyScalar(jm)),sg=new Ue(rg),lg=new kt,pg=new rr(rg,og,ng,lg,ig,_g,sg),dg=new Y(rg),cg=new Ne(rg,dg,sg),ug=new Fe(cg,sg),yg=new Oe(rg),mg=new Vt(Cm,og,ig),gg=new Xt,fg=new Qt,hg=new Ce(Cm,ng,ug,Em),xg=new Re(rg,og,sg,ig),vg=new Be(rg,og,sg,ig),sg.programs=mg.programs,Cm.context=rg,Cm.capabilities=ig,Cm.extensions=og,Cm.properties=lg,Cm.renderLists=gg,Cm.state=ng,Cm.info=sg}function ku(Eg){Eg.preventDefault(),console.log('THREE.WebGLRenderer: Context Lost.'),Rm=!0}function Wu(){console.log('THREE.WebGLRenderer: Context Restored.'),Rm=!1,Vu()}function ju(Eg){var wg=Eg.target;wg.removeEventListener('dispose',ju),qu(wg)}function qu(Eg){Xu(Eg),lg.remove(Eg)}function Xu(Eg){var wg=lg.get(Eg).program;Eg.program=void 0,wg!==void 0&&mg.releaseProgram(wg)}function Yu(Eg,wg){Eg.render(function(Lg){Cm.renderBufferImmediate(Lg,wg)})}function Zu(Eg,wg,Lg){if(Lg&&Lg.isInstancedBufferGeometry&!ig.isWebGL2&&null===og.get('ANGLE_instanced_arrays'))return void console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');ng.initAttributes();var Ag=Lg.attributes,Pg=wg.getAttributes(),Cg=Eg.defaultAttributeValues;for(var Rg in Pg){var Ig=Pg[Rg];if(0<=Ig){var Dg=Ag[Rg];if(Dg!==void 0){var zg=Dg.normalized,Ng=Dg.itemSize,Bg=dg.get(Dg);if(Bg===void 0)continue;var Ug=Bg.buffer,Gg=Bg.type,Og=Bg.bytesPerElement;if(Dg.isInterleavedBufferAttribute){var Fg=Dg.data,Hg=Fg.stride,Vg=Dg.offset;Fg&&Fg.isInstancedInterleavedBuffer?(ng.enableAttributeAndDivisor(Ig,Fg.meshPerAttribute),Lg.maxInstancedCount===void 0&&(Lg.maxInstancedCount=Fg.meshPerAttribute*Fg.count)):ng.enableAttribute(Ig),rg.bindBuffer(34962,Ug),rg.vertexAttribPointer(Ig,Ng,Gg,zg,Hg*Og,Vg*Og)}else Dg.isInstancedBufferAttribute?(ng.enableAttributeAndDivisor(Ig,Dg.meshPerAttribute),void 0===Lg.maxInstancedCount&&(Lg.maxInstancedCount=Dg.meshPerAttribute*Dg.count)):ng.enableAttribute(Ig),rg.bindBuffer(34962,Ug),rg.vertexAttribPointer(Ig,Ng,Gg,zg,0,0)}else if(Cg!==void 0){var kg=Cg[Rg];if(kg!==void 0)switch(kg.length){case 2:rg.vertexAttrib2fv(Ig,kg);break;case 3:rg.vertexAttrib3fv(Ig,kg);break;case 4:rg.vertexAttrib4fv(Ig,kg);break;default:rg.vertexAttrib1fv(Ig,kg);}}}}ng.disableUnusedAttributes()}function Qu(Eg,wg,Lg){if(!1!==Eg.visible){var Ag=Eg.layers.test(wg.layers);if(Ag)if(Eg.isLight)Pm.pushLight(Eg),Eg.castShadow&&Pm.pushShadow(Eg);else if(Eg.isSprite){if(!Eg.frustumCulled||Jm.intersectsSprite(Eg)){Lg&&tg.setFromMatrixPosition(Eg.matrixWorld).applyMatrix4(eg);var Pg=ug.update(Eg),Cg=Eg.material;Am.push(Eg,Pg,Cg,tg.z,null)}}else if(Eg.isImmediateRenderObject)Lg&&tg.setFromMatrixPosition(Eg.matrixWorld).applyMatrix4(eg),Am.push(Eg,null,Eg.material,tg.z,null);else if((Eg.isMesh||Eg.isLine||Eg.isPoints)&&(Eg.isSkinnedMesh&&Eg.skeleton.update(),!Eg.frustumCulled||Jm.intersectsObject(Eg))){Lg&&tg.setFromMatrixPosition(Eg.matrixWorld).applyMatrix4(eg);var Pg=ug.update(Eg),Cg=Eg.material;if(Array.isArray(Cg))for(var Rg=Pg.groups,Ig=0,Dg=Rg.length;Ig<Dg;Ig++){var zg=Rg[Ig],Ng=Cg[zg.materialIndex];Ng&&Ng.visible&&Am.push(Eg,Pg,Ng,tg.z,zg)}else Cg.visible&&Am.push(Eg,Pg,Cg,tg.z,null)}for(var Bg=Eg.children,Ig=0,Dg=Bg.length;Ig<Dg;Ig++)Qu(Bg[Ig],wg,Lg)}}function Ku(Eg,wg,Lg,Ag){for(var Pg=0,Cg=Eg.length;Pg<Cg;Pg++){var Rg=Eg[Pg],Ig=Rg.object,Dg=Rg.geometry,zg=Ag===void 0?Rg.material:Ag,Ng=Rg.group;if(Lg.isArrayCamera){Gm=Lg;for(var Bg=Lg.cameras,Ug=0,Gg=Bg.length,Og;Ug<Gg;Ug++)if(Og=Bg[Ug],Ig.layers.test(Og.layers)){if('viewport'in Og)ng.viewport(Om.copy(Og.viewport));else{var Fg=Og.bounds,Hg=Fg.x*km,Vg=Fg.y*Wm,kg=Fg.z*km,Wg=Fg.w*Wm;ng.viewport(Om.set(Hg,Vg,kg,Wg).multiplyScalar(jm))}Pm.setupLights(Og),$u(Ig,wg,Og,Dg,zg,Ng)}}else Gm=null,$u(Ig,wg,Lg,Dg,zg,Ng)}}function $u(Eg,wg,Lg,Ag,Pg,Cg){if(Eg.onBeforeRender(Cm,wg,Lg,Ag,Pg,Cg),Pm=fg.get(wg,Gm||Lg),Eg.modelViewMatrix.multiplyMatrices(Lg.matrixWorldInverse,Eg.matrixWorld),Eg.normalMatrix.getNormalMatrix(Eg.modelViewMatrix),Eg.isImmediateRenderObject){ng.setMaterial(Pg);var Rg=tm(Lg,wg.fog,Pg,Eg);Bm.geometry=null,Bm.program=null,Bm.wireframe=!1,Yu(Eg,Rg)}else Cm.renderBufferDirect(Lg,wg.fog,Ag,Pg,Eg,Cg);Eg.onAfterRender(Cm,wg,Lg,Ag,Pg,Cg),Pm=fg.get(wg,Gm||Lg)}function em(Eg,wg,Lg){var Ag=lg.get(Eg),Pg=Pm.state.lights,Cg=Pm.state.shadowsArray,Rg=Ag.lightsHash,Ig=Pg.state.hash,Dg=mg.getParameters(Eg,Pg.state,Cg,wg,Qm.numPlanes,Qm.numIntersection,Lg),zg=mg.getProgramCode(Eg,Dg),Ng=Ag.program,Bg=!0;if(Ng===void 0)Eg.addEventListener('dispose',ju);else if(Ng.code!==zg)Xu(Eg);else if(Rg.stateID!==Ig.stateID||Rg.directionalLength!==Ig.directionalLength||Rg.pointLength!==Ig.pointLength||Rg.spotLength!==Ig.spotLength||Rg.rectAreaLength!==Ig.rectAreaLength||Rg.hemiLength!==Ig.hemiLength||Rg.shadowsLength!==Ig.shadowsLength)Rg.stateID=Ig.stateID,Rg.directionalLength=Ig.directionalLength,Rg.pointLength=Ig.pointLength,Rg.spotLength=Ig.spotLength,Rg.rectAreaLength=Ig.rectAreaLength,Rg.hemiLength=Ig.hemiLength,Rg.shadowsLength=Ig.shadowsLength,Bg=!1;else{if(Dg.shaderID!==void 0)return;Bg=!1}if(Bg){if(Dg.shaderID){var Ug=Fc[Dg.shaderID];Ag.shader={name:Eg.type,uniforms:Uc.clone(Ug.uniforms),vertexShader:Ug.vertexShader,fragmentShader:Ug.fragmentShader}}else Ag.shader={name:Eg.type,uniforms:Eg.uniforms,vertexShader:Eg.vertexShader,fragmentShader:Eg.fragmentShader};Eg.onBeforeCompile(Ag.shader,Cm),zg=mg.getProgramCode(Eg,Dg),Ng=mg.acquireProgram(Eg,Ag.shader,Dg,zg),Ag.program=Ng,Eg.program=Ng}var Gg=Ng.getAttributes();if(Eg.morphTargets){Eg.numSupportedMorphTargets=0;for(var Og=0;Og<Cm.maxMorphTargets;Og++)0<=Gg['morphTarget'+Og]&&Eg.numSupportedMorphTargets++}if(Eg.morphNormals){Eg.numSupportedMorphNormals=0;for(var Og=0;Og<Cm.maxMorphNormals;Og++)0<=Gg['morphNormal'+Og]&&Eg.numSupportedMorphNormals++}var Fg=Ag.shader.uniforms;(Eg.isShaderMaterial||Eg.isRawShaderMaterial)&&!0!==Eg.clipping||(Ag.numClippingPlanes=Qm.numPlanes,Ag.numIntersection=Qm.numIntersection,Fg.clippingPlanes=Qm.uniform),Ag.fog=wg,Rg===void 0&&(Ag.lightsHash=Rg={}),Rg.stateID=Ig.stateID,Rg.directionalLength=Ig.directionalLength,Rg.pointLength=Ig.pointLength,Rg.spotLength=Ig.spotLength,Rg.rectAreaLength=Ig.rectAreaLength,Rg.hemiLength=Ig.hemiLength,Rg.shadowsLength=Ig.shadowsLength,Eg.lights&&(Fg.ambientLightColor.value=Pg.state.ambient,Fg.directionalLights.value=Pg.state.directional,Fg.spotLights.value=Pg.state.spot,Fg.rectAreaLights.value=Pg.state.rectArea,Fg.pointLights.value=Pg.state.point,Fg.hemisphereLights.value=Pg.state.hemi,Fg.directionalShadowMap.value=Pg.state.directionalShadowMap,Fg.directionalShadowMatrix.value=Pg.state.directionalShadowMatrix,Fg.spotShadowMap.value=Pg.state.spotShadowMap,Fg.spotShadowMatrix.value=Pg.state.spotShadowMatrix,Fg.pointShadowMap.value=Pg.state.pointShadowMap,Fg.pointShadowMatrix.value=Pg.state.pointShadowMatrix);var Hg=Ag.program.getUniforms(),Vg=wt.seqWithValue(Hg.seq,Fg);Ag.uniformsList=Vg}function tm(Eg,wg,Lg,Ag){Vm=0;var Pg=lg.get(Lg),Cg=Pm.state.lights,Rg=Pg.lightsHash,Ig=Cg.state.hash;if(Km&&($m||Eg!==Um)){var Dg=Eg===Um&&Lg.id===Nm;Qm.setState(Lg.clippingPlanes,Lg.clipIntersection,Lg.clipShadows,Eg,Pg,Dg)}!1===Lg.needsUpdate&&(void 0===Pg.program?Lg.needsUpdate=!0:Lg.fog&&Pg.fog!==wg?Lg.needsUpdate=!0:Lg.lights&&(Rg.stateID!==Ig.stateID||Rg.directionalLength!==Ig.directionalLength||Rg.pointLength!==Ig.pointLength||Rg.spotLength!==Ig.spotLength||Rg.rectAreaLength!==Ig.rectAreaLength||Rg.hemiLength!==Ig.hemiLength||Rg.shadowsLength!==Ig.shadowsLength)?Lg.needsUpdate=!0:void 0!==Pg.numClippingPlanes&&(Pg.numClippingPlanes!==Qm.numPlanes||Pg.numIntersection!==Qm.numIntersection)&&(Lg.needsUpdate=!0)),Lg.needsUpdate&&(em(Lg,wg,Ag),Lg.needsUpdate=!1);var zg=!1,Ng=!1,Bg=!1,Ug=Pg.program,Gg=Ug.getUniforms(),Og=Pg.shader.uniforms;if(ng.useProgram(Ug.program)&&(zg=!0,Ng=!0,Bg=!0),Lg.id!==Nm&&(Nm=Lg.id,Ng=!0),zg||Um!==Eg){if(Gg.setValue(rg,'projectionMatrix',Eg.projectionMatrix),ig.logarithmicDepthBuffer&&Gg.setValue(rg,'logDepthBufFC',2/(Math.log(Eg.far+1)/Math.LN2)),Um!==Eg&&(Um=Eg,Ng=!0,Bg=!0),Lg.isShaderMaterial||Lg.isMeshPhongMaterial||Lg.isMeshStandardMaterial||Lg.envMap){var Fg=Gg.map.cameraPosition;void 0!==Fg&&Fg.setValue(rg,tg.setFromMatrixPosition(Eg.matrixWorld))}(Lg.isMeshPhongMaterial||Lg.isMeshLambertMaterial||Lg.isMeshBasicMaterial||Lg.isMeshStandardMaterial||Lg.isShaderMaterial||Lg.skinning)&&Gg.setValue(rg,'viewMatrix',Eg.matrixWorldInverse)}if(Lg.skinning){Gg.setOptional(rg,Ag,'bindMatrix'),Gg.setOptional(rg,Ag,'bindMatrixInverse');var Hg=Ag.skeleton;if(Hg){var Vg=Hg.bones;if(ig.floatVertexTextures){if(void 0===Hg.boneTexture){var kg=Math.sqrt(4*Vg.length);kg=fp.ceilPowerOfTwo(kg),kg=Math.max(kg,4);var Wg=new Float32Array(4*(kg*kg));Wg.set(Hg.boneMatrices);var jg=new G(Wg,kg,kg,nl,Zs);jg.needsUpdate=!0,Hg.boneMatrices=Wg,Hg.boneTexture=jg,Hg.boneTextureSize=kg}Gg.setValue(rg,'boneTexture',Hg.boneTexture),Gg.setValue(rg,'boneTextureSize',Hg.boneTextureSize)}else Gg.setOptional(rg,Hg,'boneMatrices')}}return Ng&&(Gg.setValue(rg,'toneMappingExposure',Cm.toneMappingExposure),Gg.setValue(rg,'toneMappingWhitePoint',Cm.toneMappingWhitePoint),Lg.lights&&ym(Og,Bg),wg&&Lg.fog&&sm(Og,wg),Lg.isMeshBasicMaterial?rm(Og,Lg):Lg.isMeshLambertMaterial?(rm(Og,Lg),lm(Og,Lg)):Lg.isMeshPhongMaterial?(rm(Og,Lg),Lg.isMeshToonMaterial?dm(Og,Lg):pm(Og,Lg)):Lg.isMeshStandardMaterial?(rm(Og,Lg),Lg.isMeshPhysicalMaterial?um(Og,Lg):cm(Og,Lg)):Lg.isMeshMatcapMaterial?(rm(Og,Lg),mm(Og,Lg)):Lg.isMeshDepthMaterial?(rm(Og,Lg),gm(Og,Lg)):Lg.isMeshDistanceMaterial?(rm(Og,Lg),fm(Og,Lg)):Lg.isMeshNormalMaterial?(rm(Og,Lg),hm(Og,Lg)):Lg.isLineBasicMaterial?(am(Og,Lg),Lg.isLineDashedMaterial&&om(Og,Lg)):Lg.isPointsMaterial?im(Og,Lg):Lg.isSpriteMaterial?nm(Og,Lg):Lg.isShadowMaterial&&(Og.color.value=Lg.color,Og.opacity.value=Lg.opacity),void 0!==Og.ltc_1&&(Og.ltc_1.value=Oc.LTC_1),void 0!==Og.ltc_2&&(Og.ltc_2.value=Oc.LTC_2),wt.upload(rg,Pg.uniformsList,Og,Cm)),Lg.isShaderMaterial&&!0===Lg.uniformsNeedUpdate&&(wt.upload(rg,Pg.uniformsList,Og,Cm),Lg.uniformsNeedUpdate=!1),Lg.isSpriteMaterial&&Gg.setValue(rg,'center',Ag.center),Gg.setValue(rg,'modelViewMatrix',Ag.modelViewMatrix),Gg.setValue(rg,'normalMatrix',Ag.normalMatrix),Gg.setValue(rg,'modelMatrix',Ag.matrixWorld),Ug}function rm(Eg,wg){Eg.opacity.value=wg.opacity,wg.color&&(Eg.diffuse.value=wg.color),wg.emissive&&Eg.emissive.value.copy(wg.emissive).multiplyScalar(wg.emissiveIntensity),wg.map&&(Eg.map.value=wg.map),wg.alphaMap&&(Eg.alphaMap.value=wg.alphaMap),wg.specularMap&&(Eg.specularMap.value=wg.specularMap),wg.envMap&&(Eg.envMap.value=wg.envMap,Eg.flipEnvMap.value=wg.envMap&&wg.envMap.isCubeTexture?-1:1,Eg.reflectivity.value=wg.reflectivity,Eg.refractionRatio.value=wg.refractionRatio,Eg.maxMipLevel.value=lg.get(wg.envMap).__maxMipLevel),wg.lightMap&&(Eg.lightMap.value=wg.lightMap,Eg.lightMapIntensity.value=wg.lightMapIntensity),wg.aoMap&&(Eg.aoMap.value=wg.aoMap,Eg.aoMapIntensity.value=wg.aoMapIntensity);var Lg;wg.map?Lg=wg.map:wg.specularMap?Lg=wg.specularMap:wg.displacementMap?Lg=wg.displacementMap:wg.normalMap?Lg=wg.normalMap:wg.bumpMap?Lg=wg.bumpMap:wg.roughnessMap?Lg=wg.roughnessMap:wg.metalnessMap?Lg=wg.metalnessMap:wg.alphaMap?Lg=wg.alphaMap:wg.emissiveMap&&(Lg=wg.emissiveMap),Lg!=void 0&&(Lg.isWebGLRenderTarget&&(Lg=Lg.texture),!0===Lg.matrixAutoUpdate&&Lg.updateMatrix(),Eg.uvTransform.value.copy(Lg.matrix))}function am(Eg,wg){Eg.diffuse.value=wg.color,Eg.opacity.value=wg.opacity}function om(Eg,wg){Eg.dashSize.value=wg.dashSize,Eg.totalSize.value=wg.dashSize+wg.gapSize,Eg.scale.value=wg.scale}function im(Eg,wg){Eg.diffuse.value=wg.color,Eg.opacity.value=wg.opacity,Eg.size.value=wg.size*jm,Eg.scale.value=0.5*Wm,Eg.map.value=wg.map,null!==wg.map&&(!0===wg.map.matrixAutoUpdate&&wg.map.updateMatrix(),Eg.uvTransform.value.copy(wg.map.matrix))}function nm(Eg,wg){Eg.diffuse.value=wg.color,Eg.opacity.value=wg.opacity,Eg.rotation.value=wg.rotation,Eg.map.value=wg.map,null!==wg.map&&(!0===wg.map.matrixAutoUpdate&&wg.map.updateMatrix(),Eg.uvTransform.value.copy(wg.map.matrix))}function sm(Eg,wg){Eg.fogColor.value=wg.color,wg.isFog?(Eg.fogNear.value=wg.near,Eg.fogFar.value=wg.far):wg.isFogExp2&&(Eg.fogDensity.value=wg.density)}function lm(Eg,wg){wg.emissiveMap&&(Eg.emissiveMap.value=wg.emissiveMap)}function pm(Eg,wg){Eg.specular.value=wg.specular,Eg.shininess.value=Math.max(wg.shininess,1e-4),wg.emissiveMap&&(Eg.emissiveMap.value=wg.emissiveMap),wg.bumpMap&&(Eg.bumpMap.value=wg.bumpMap,Eg.bumpScale.value=wg.bumpScale,wg.side===zn&&(Eg.bumpScale.value*=-1)),wg.normalMap&&(Eg.normalMap.value=wg.normalMap,Eg.normalScale.value.copy(wg.normalScale),wg.side===zn&&Eg.normalScale.value.negate()),wg.displacementMap&&(Eg.displacementMap.value=wg.displacementMap,Eg.displacementScale.value=wg.displacementScale,Eg.displacementBias.value=wg.displacementBias)}function dm(Eg,wg){pm(Eg,wg),wg.gradientMap&&(Eg.gradientMap.value=wg.gradientMap)}function cm(Eg,wg){Eg.roughness.value=wg.roughness,Eg.metalness.value=wg.metalness,wg.roughnessMap&&(Eg.roughnessMap.value=wg.roughnessMap),wg.metalnessMap&&(Eg.metalnessMap.value=wg.metalnessMap),wg.emissiveMap&&(Eg.emissiveMap.value=wg.emissiveMap),wg.bumpMap&&(Eg.bumpMap.value=wg.bumpMap,Eg.bumpScale.value=wg.bumpScale,wg.side===zn&&(Eg.bumpScale.value*=-1)),wg.normalMap&&(Eg.normalMap.value=wg.normalMap,Eg.normalScale.value.copy(wg.normalScale),wg.side===zn&&Eg.normalScale.value.negate()),wg.displacementMap&&(Eg.displacementMap.value=wg.displacementMap,Eg.displacementScale.value=wg.displacementScale,Eg.displacementBias.value=wg.displacementBias),wg.envMap&&(Eg.envMapIntensity.value=wg.envMapIntensity)}function um(Eg,wg){cm(Eg,wg),Eg.reflectivity.value=wg.reflectivity,Eg.clearCoat.value=wg.clearCoat,Eg.clearCoatRoughness.value=wg.clearCoatRoughness}function mm(Eg,wg){wg.matcap&&(Eg.matcap.value=wg.matcap),wg.bumpMap&&(Eg.bumpMap.value=wg.bumpMap,Eg.bumpScale.value=wg.bumpScale,wg.side===zn&&(Eg.bumpScale.value*=-1)),wg.normalMap&&(Eg.normalMap.value=wg.normalMap,Eg.normalScale.value.copy(wg.normalScale),wg.side===zn&&Eg.normalScale.value.negate()),wg.displacementMap&&(Eg.displacementMap.value=wg.displacementMap,Eg.displacementScale.value=wg.displacementScale,Eg.displacementBias.value=wg.displacementBias)}function gm(Eg,wg){wg.displacementMap&&(Eg.displacementMap.value=wg.displacementMap,Eg.displacementScale.value=wg.displacementScale,Eg.displacementBias.value=wg.displacementBias)}function fm(Eg,wg){wg.displacementMap&&(Eg.displacementMap.value=wg.displacementMap,Eg.displacementScale.value=wg.displacementScale,Eg.displacementBias.value=wg.displacementBias),Eg.referencePosition.value.copy(wg.referencePosition),Eg.nearDistance.value=wg.nearDistance,Eg.farDistance.value=wg.farDistance}function hm(Eg,wg){wg.bumpMap&&(Eg.bumpMap.value=wg.bumpMap,Eg.bumpScale.value=wg.bumpScale,wg.side===zn&&(Eg.bumpScale.value*=-1)),wg.normalMap&&(Eg.normalMap.value=wg.normalMap,Eg.normalScale.value.copy(wg.normalScale),wg.side===zn&&Eg.normalScale.value.negate()),wg.displacementMap&&(Eg.displacementMap.value=wg.displacementMap,Eg.displacementScale.value=wg.displacementScale,Eg.displacementBias.value=wg.displacementBias)}function ym(Eg,wg){Eg.ambientLightColor.needsUpdate=wg,Eg.directionalLights.needsUpdate=wg,Eg.pointLights.needsUpdate=wg,Eg.spotLights.needsUpdate=wg,Eg.rectAreaLights.needsUpdate=wg,Eg.hemisphereLights.needsUpdate=wg}console.log('THREE.WebGLRenderer','99dev'),Fu=Fu||{};var vm=Fu.canvas===void 0?document.createElementNS('http://www.w3.org/1999/xhtml','canvas'):Fu.canvas,_m=Fu.context===void 0?null:Fu.context,bm=Fu.alpha!==void 0&&Fu.alpha,Mm=!(Fu.depth!==void 0)||Fu.depth,Sm=!(Fu.stencil!==void 0)||Fu.stencil,Tm=Fu.antialias!==void 0&&Fu.antialias,Em=!(Fu.premultipliedAlpha!==void 0)||Fu.premultipliedAlpha,wm=Fu.preserveDrawingBuffer!==void 0&&Fu.preserveDrawingBuffer,Lm=Fu.powerPreference===void 0?'default':Fu.powerPreference,Am=null,Pm=null;this.domElement=vm,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ms,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Cm=this,Rm=!1,Im=null,Dm=null,zm=null,Nm=-1,Bm={geometry:null,program:null,wireframe:!1},Um=null,Gm=null,Om=new I,Fm=new I,Hm=null,Vm=0,km=vm.width,Wm=vm.height,jm=1,Xm=new I(0,0,km,Wm),Ym=new I(0,0,km,Wm),Zm=!1,Jm=new V,Qm=new De,Km=!1,$m=!1,eg=new E,tg=new A,rg;try{var ag={alpha:bm,depth:Mm,stencil:Sm,antialias:Tm,premultipliedAlpha:Em,preserveDrawingBuffer:wm,powerPreference:Lm};if(vm.addEventListener('webglcontextlost',ku,!1),vm.addEventListener('webglcontextrestored',Wu,!1),rg=_m||vm.getContext('webgl',ag)||vm.getContext('experimental-webgl',ag),null===rg)if(null!==vm.getContext('webgl'))throw new Error('Error creating WebGL context with your selected attributes.');else throw new Error('Error creating WebGL context.');void 0===rg.getShaderPrecisionFormat&&(rg.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Eg){console.error('THREE.WebGLRenderer: '+Eg.message)}var og,ig,ng,sg,lg,pg,dg,cg,ug,mg,gg,fg,hg,yg,xg,vg,_g;Vu();var bg=null;'undefined'!=typeof navigator&&(bg='xr'in navigator?new dr(Cm):new pr(Cm)),this.vr=bg;var Mg=new er(Cm,ug,ig.maxTextureSize);this.shadowMap=Mg,this.getContext=function(){return rg},this.getContextAttributes=function(){return rg.getContextAttributes()},this.forceContextLoss=function(){var Eg=og.get('WEBGL_lose_context');Eg&&Eg.loseContext()},this.forceContextRestore=function(){var Eg=og.get('WEBGL_lose_context');Eg&&Eg.restoreContext()},this.getPixelRatio=function(){return jm},this.setPixelRatio=function(Eg){void 0===Eg||(jm=Eg,this.setSize(km,Wm,!1))},this.getSize=function(){return{width:km,height:Wm}},this.setSize=function(Eg,wg,Lg){return bg.isPresenting()?void console.warn('THREE.WebGLRenderer: Can\'t change size while VR device is presenting.'):void(km=Eg,Wm=wg,vm.width=Eg*jm,vm.height=wg*jm,!1!==Lg&&(vm.style.width=Eg+'px',vm.style.height=wg+'px'),this.setViewport(0,0,Eg,wg))},this.getDrawingBufferSize=function(){return{width:km*jm,height:Wm*jm}},this.setDrawingBufferSize=function(Eg,wg,Lg){km=Eg,Wm=wg,jm=Lg,vm.width=Eg*Lg,vm.height=wg*Lg,this.setViewport(0,0,Eg,wg)},this.getCurrentViewport=function(){return Om},this.setViewport=function(Eg,wg,Lg,Ag){Xm.set(Eg,Wm-wg-Ag,Lg,Ag),ng.viewport(Om.copy(Xm).multiplyScalar(jm))},this.setScissor=function(Eg,wg,Lg,Ag){Ym.set(Eg,Wm-wg-Ag,Lg,Ag),ng.scissor(Fm.copy(Ym).multiplyScalar(jm))},this.setScissorTest=function(Eg){ng.setScissorTest(Zm=Eg)},this.getClearColor=function(){return hg.getClearColor()},this.setClearColor=function(){hg.setClearColor.apply(hg,arguments)},this.getClearAlpha=function(){return hg.getClearAlpha()},this.setClearAlpha=function(){hg.setClearAlpha.apply(hg,arguments)},this.clear=function(Eg,wg,Lg){var Ag=0;(Eg===void 0||Eg)&&(Ag|=16384),(wg===void 0||wg)&&(Ag|=256),(Lg===void 0||Lg)&&(Ag|=1024),rg.clear(Ag)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){vm.removeEventListener('webglcontextlost',ku,!1),vm.removeEventListener('webglcontextrestored',Wu,!1),gg.dispose(),fg.dispose(),lg.dispose(),ug.dispose(),bg.dispose(),Tg.stop()},this.renderBufferImmediate=function(Eg,wg){ng.initAttributes();var Lg=lg.get(Eg);Eg.hasPositions&&!Lg.position&&(Lg.position=rg.createBuffer()),Eg.hasNormals&&!Lg.normal&&(Lg.normal=rg.createBuffer()),Eg.hasUvs&&!Lg.uv&&(Lg.uv=rg.createBuffer()),Eg.hasColors&&!Lg.color&&(Lg.color=rg.createBuffer());var Ag=wg.getAttributes();Eg.hasPositions&&(rg.bindBuffer(34962,Lg.position),rg.bufferData(34962,Eg.positionArray,35048),ng.enableAttribute(Ag.position),rg.vertexAttribPointer(Ag.position,3,5126,!1,0,0)),Eg.hasNormals&&(rg.bindBuffer(34962,Lg.normal),rg.bufferData(34962,Eg.normalArray,35048),ng.enableAttribute(Ag.normal),rg.vertexAttribPointer(Ag.normal,3,5126,!1,0,0)),Eg.hasUvs&&(rg.bindBuffer(34962,Lg.uv),rg.bufferData(34962,Eg.uvArray,35048),ng.enableAttribute(Ag.uv),rg.vertexAttribPointer(Ag.uv,2,5126,!1,0,0)),Eg.hasColors&&(rg.bindBuffer(34962,Lg.color),rg.bufferData(34962,Eg.colorArray,35048),ng.enableAttribute(Ag.color),rg.vertexAttribPointer(Ag.color,3,5126,!1,0,0)),ng.disableUnusedAttributes(),rg.drawArrays(4,0,Eg.count),Eg.count=0},this.renderBufferDirect=function(Eg,wg,Lg,Ag,Pg,Cg){var Rg=Pg.isMesh&&0>Pg.normalMatrix.determinant();ng.setMaterial(Ag,Rg);var Ig=tm(Eg,wg,Ag,Pg),Dg=!1;(Bm.geometry!==Lg.id||Bm.program!==Ig.id||Bm.wireframe!==(!0===Ag.wireframe))&&(Bm.geometry=Lg.id,Bm.program=Ig.id,Bm.wireframe=!0===Ag.wireframe,Dg=!0),Pg.morphTargetInfluences&&(yg.update(Pg,Lg,Ag,Ig),Dg=!0);var zg=Lg.index,Ng=Lg.attributes.position,Bg=1;!0===Ag.wireframe&&(zg=cg.getWireframeAttribute(Lg),Bg=2);var Ug,Gg=xg;null!==zg&&(Ug=dg.get(zg),Gg=vg,Gg.setIndex(Ug)),Dg&&(Zu(Ag,Ig,Lg),null!==zg&&rg.bindBuffer(34963,Ug.buffer));var Og=Infinity;null===zg?Ng!==void 0&&(Og=Ng.count):Og=zg.count;var Fg=Lg.drawRange.start*Bg,Hg=Lg.drawRange.count*Bg,Vg=null===Cg?0:Cg.start*Bg,kg=null===Cg?Infinity:Cg.count*Bg,Wg=Math.max(Fg,Vg),jg=Math.min(Og,Fg+Hg,Vg+kg)-1,qg=Math.max(0,jg-Wg+1);if(0!==qg){if(Pg.isMesh){if(!0===Ag.wireframe)ng.setLineWidth(Ag.wireframeLinewidth*Hu()),Gg.setMode(1);else switch(Pg.drawMode){case $l:Gg.setMode(4);break;case 1:Gg.setMode(5);break;case 2:Gg.setMode(6);}}else if(Pg.isLine){var Xg=Ag.linewidth;void 0===Xg&&(Xg=1),ng.setLineWidth(Xg*Hu()),Pg.isLineSegments?Gg.setMode(1):Pg.isLineLoop?Gg.setMode(2):Gg.setMode(3)}else Pg.isPoints?Gg.setMode(0):Pg.isSprite&&Gg.setMode(4);Lg&&Lg.isInstancedBufferGeometry?0<Lg.maxInstancedCount&&Gg.renderInstances(Lg,Wg,qg):Gg.render(Wg,qg)}},this.compile=function(Eg,wg){Pm=fg.get(Eg,wg),Pm.init(),Eg.traverse(function(Lg){Lg.isLight&&(Pm.pushLight(Lg),Lg.castShadow&&Pm.pushShadow(Lg))}),Pm.setupLights(wg),Eg.traverse(function(Lg){if(Lg.material)if(Array.isArray(Lg.material))for(var Ag=0;Ag<Lg.material.length;Ag++)em(Lg.material[Ag],Eg.fog,Lg);else em(Lg.material,Eg.fog,Lg)})};var Sg=null,Tg=new X;Tg.setAnimationLoop(function(Eg){bg.isPresenting()||Sg&&Sg(Eg)}),'undefined'!=typeof window&&Tg.setContext(window),this.setAnimationLoop=function(Eg){Sg=Eg,bg.setAnimationLoop(Eg),Tg.start()},this.render=function(Eg,wg,Lg,Ag){if(!(wg&&wg.isCamera))return void console.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');if(!Rm){Bm.geometry=null,Bm.program=null,Bm.wireframe=!1,Nm=-1,Um=null,!0===Eg.autoUpdate&&Eg.updateMatrixWorld(),null===wg.parent&&wg.updateMatrixWorld(),bg.enabled&&(wg=bg.getCamera(wg)),Pm=fg.get(Eg,wg),Pm.init(),Eg.onBeforeRender(Cm,Eg,wg,Lg),eg.multiplyMatrices(wg.projectionMatrix,wg.matrixWorldInverse),Jm.setFromMatrix(eg),$m=this.localClippingEnabled,Km=Qm.init(this.clippingPlanes,$m,wg),Am=gg.get(Eg,wg),Am.init(),Qu(Eg,wg,Cm.sortObjects),!0===Cm.sortObjects&&Am.sort(),Km&&Qm.beginShadows();var Pg=Pm.state.shadowsArray;Mg.render(Pg,Eg,wg),Pm.setupLights(wg),Km&&Qm.endShadows(),this.info.autoReset&&this.info.reset(),void 0===Lg&&(Lg=null),this.setRenderTarget(Lg),hg.render(Am,Eg,wg,Ag);var Cg=Am.opaque,Rg=Am.transparent;if(Eg.overrideMaterial){var Ig=Eg.overrideMaterial;Cg.length&&Ku(Cg,Eg,wg,Ig),Rg.length&&Ku(Rg,Eg,wg,Ig)}else Cg.length&&Ku(Cg,Eg,wg),Rg.length&&Ku(Rg,Eg,wg);Lg&&pg.updateRenderTargetMipmap(Lg),ng.buffers.depth.setTest(!0),ng.buffers.depth.setMask(!0),ng.buffers.color.setMask(!0),ng.setPolygonOffset(!1),Eg.onAfterRender(Cm,Eg,wg),bg.enabled&&bg.submitFrame(),Am=null,Pm=null}},this.allocTextureUnit=function(){var Eg=Vm;return Eg>=ig.maxTextures&&console.warn('THREE.WebGLRenderer: Trying to use '+Eg+' texture units while this GPU supports only '+ig.maxTextures),Vm+=1,Eg},this.setTexture2D=function(){var Eg=!1;return function(Lg,Ag){Lg&&Lg.isWebGLRenderTarget&&(!Eg&&(console.warn('THREE.WebGLRenderer.setTexture2D: don\'t use render targets as textures. Use their .texture property instead.'),Eg=!0),Lg=Lg.texture),pg.setTexture2D(Lg,Ag)}}(),this.setTexture3D=function(){return function(wg,Lg){pg.setTexture3D(wg,Lg)}}(),this.setTexture=function(){var Eg=!1;return function(Lg,Ag){Eg||(console.warn('THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.'),Eg=!0),pg.setTexture2D(Lg,Ag)}}(),this.setTextureCube=function(){var Eg=!1;return function(Lg,Ag){Lg&&Lg.isWebGLRenderTargetCube&&(!Eg&&(console.warn('THREE.WebGLRenderer.setTextureCube: don\'t use cube render targets as textures. Use their .texture property instead.'),Eg=!0),Lg=Lg.texture),Lg&&Lg.isCubeTexture||Array.isArray(Lg.image)&&6===Lg.image.length?pg.setTextureCube(Lg,Ag):pg.setTextureCubeDynamic(Lg,Ag)}}(),this.setFramebuffer=function(Eg){Im=Eg},this.getRenderTarget=function(){return Dm},this.setRenderTarget=function(Eg){Dm=Eg,Eg&&void 0===lg.get(Eg).__webglFramebuffer&&pg.setupRenderTarget(Eg);var wg=Im,Lg=!1;if(Eg){var Ag=lg.get(Eg).__webglFramebuffer;Eg.isWebGLRenderTargetCube?(wg=Ag[Eg.activeCubeFace],Lg=!0):wg=Ag,Om.copy(Eg.viewport),Fm.copy(Eg.scissor),Hm=Eg.scissorTest}else Om.copy(Xm).multiplyScalar(jm),Fm.copy(Ym).multiplyScalar(jm),Hm=Zm;if(zm!==wg&&(rg.bindFramebuffer(36160,wg),zm=wg),ng.viewport(Om),ng.scissor(Fm),ng.setScissorTest(Hm),Lg){var Pg=lg.get(Eg.texture);rg.framebufferTexture2D(36160,36064,34069+Eg.activeCubeFace,Pg.__webglTexture,Eg.activeMipMapLevel)}},this.readRenderTargetPixels=function(Eg,wg,Lg,Ag,Pg,Cg){if(!(Eg&&Eg.isWebGLRenderTarget))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');var Rg=lg.get(Eg).__webglFramebuffer;if(Rg){var Ig=!1;Rg!==zm&&(rg.bindFramebuffer(36160,Rg),Ig=!0);try{var Dg=Eg.texture,zg=Dg.format,Ng=Dg.type;if(zg!==nl&&_g.convert(zg)!==rg.getParameter(35739))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.');if(Ng!==ks&&_g.convert(Ng)!==rg.getParameter(35738)&&!(Ng===Zs&&(ig.isWebGL2||og.get('OES_texture_float')||og.get('WEBGL_color_buffer_float')))&&!(Ng===Js&&(ig.isWebGL2?og.get('EXT_color_buffer_float'):og.get('EXT_color_buffer_half_float'))))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.');36053===rg.checkFramebufferStatus(36160)?0<=wg&&wg<=Eg.width-Ag&&0<=Lg&&Lg<=Eg.height-Pg&&rg.readPixels(wg,Lg,Ag,Pg,_g.convert(zg),_g.convert(Ng),Cg):console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.')}finally{Ig&&rg.bindFramebuffer(36160,zm)}}},this.copyFramebufferToTexture=function(Eg,wg,Lg){var Ag=wg.image.width,Pg=wg.image.height,Cg=_g.convert(wg.format);this.setTexture2D(wg,0),rg.copyTexImage2D(3553,Lg||0,Cg,Eg.x,Eg.y,Ag,Pg,0)},this.copyTextureToTexture=function(Eg,wg,Lg,Ag){var Pg=wg.image.width,Cg=wg.image.height,Rg=_g.convert(Lg.format),Ig=_g.convert(Lg.type);this.setTexture2D(Lg,0),wg.isDataTexture?rg.texSubImage2D(3553,Ag||0,Eg.x,Eg.y,Pg,Cg,Rg,Ig,wg.image.data):rg.texSubImage2D(3553,Ag||0,Eg.x,Eg.y,Rg,Ig,wg.image)}}function ur(Fu,Hu){this.name='',this.color=new W(Fu),this.density=Hu===void 0?2.5e-4:Hu}function mr(Fu,Hu,Vu){this.name='',this.color=new W(Fu),this.near=Hu===void 0?1:Hu,this.far=Vu===void 0?1e3:Vu}function gr(){K.call(this),this.type='Scene',this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function fr(Fu,Hu){this.array=Fu,this.stride=Hu,this.count=Fu===void 0?0:Fu.length/Hu,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function hr(Fu,Hu,Vu,ku){this.data=Fu,this.itemSize=Hu,this.offset=Vu,this.normalized=!0===ku}function yr(Fu){Te.call(this),this.type='SpriteMaterial',this.color=new W(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(Fu)}function xr(Fu){if(K.call(this),this.type='Sprite',void 0===ou){ou=new xe;var Hu=new Float32Array([-0.5,-0.5,0,0,0,0.5,-0.5,0,1,0,0.5,0.5,0,1,1,-0.5,0.5,0,0,1]),Vu=new fr(Hu,5);ou.setIndex([0,1,2,0,2,3]),ou.addAttribute('position',new hr(Vu,3,0,!1)),ou.addAttribute('uv',new hr(Vu,2,3,!1))}this.geometry=ou,this.material=void 0===Fu?new yr:Fu,this.center=new S(0.5,0.5)}function _r(){K.call(this),this.type='LOD',Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function br(Fu,Hu){if(Fu=Fu||[],this.bones=Fu.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===Hu)this.calculateInverses();else if(this.bones.length===Hu.length)this.boneInverses=Hu.slice(0);else{console.warn('THREE.Skeleton boneInverses is the wrong length.'),this.boneInverses=[];for(var Vu=0,ku=this.bones.length;Vu<ku;Vu++)this.boneInverses.push(new E)}}function Mr(){K.call(this),this.type='Bone'}function Sr(Fu,Hu){Pe.call(this,Fu,Hu),this.type='SkinnedMesh',this.bindMode='attached',this.bindMatrix=new E,this.bindMatrixInverse=new E;var Vu=this.initBones(),ku=new br(Vu);this.bind(ku,this.matrixWorld),this.normalizeSkinWeights()}function Tr(Fu){Te.call(this),this.type='LineBasicMaterial',this.color=new W(16777215),this.linewidth=1,this.linecap='round',this.linejoin='round',this.lights=!1,this.setValues(Fu)}function Er(Fu,Hu,Vu){1===Vu&&console.error('THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.'),K.call(this),this.type='Line',this.geometry=Fu===void 0?new xe:Fu,this.material=Hu===void 0?new Tr({color:16777215*Math.random()}):Hu}function wr(Fu,Hu){Er.call(this,Fu,Hu),this.type='LineSegments'}function Lr(Fu,Hu){Er.call(this,Fu,Hu),this.type='LineLoop'}function Ar(Fu){Te.call(this),this.type='PointsMaterial',this.color=new W(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(Fu)}function Pr(Fu,Hu){K.call(this),this.type='Points',this.geometry=Fu===void 0?new xe:Fu,this.material=Hu===void 0?new Ar({color:16777215*Math.random()}):Hu}function Cr(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu){R.call(this,Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu),this.format=qu===void 0?al:qu,this.minFilter=ju===void 0?Fs:ju,this.magFilter=Wu===void 0?Fs:Wu,this.generateMipmaps=!1}function Rr(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu){R.call(this,null,ju,qu,Xu,Yu,Zu,ku,Wu,Ju,Qu),this.image={width:Hu,height:Vu},this.mipmaps=Fu,this.flipY=!1,this.generateMipmaps=!1}function Ir(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu){R.call(this,Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu),this.needsUpdate=!0}function Dr(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu){if(Zu=void 0===Zu?cl:Zu,Zu!==cl&&Zu!==ul)throw new Error('DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat');void 0===Vu&&Zu===cl&&(Vu=qs),void 0===Vu&&Zu===ul&&(Vu=el),R.call(this,null,ku,Wu,ju,qu,Xu,Zu,Vu,Yu),this.image={width:Fu,height:Hu},this.magFilter=void 0===qu?Us:qu,this.minFilter=void 0===Xu?Us:Xu,this.flipY=!1,this.generateMipmaps=!1}function zr(Fu){xe.call(this),this.type='WireframeGeometry';var Hu=[],Vu,ku,Wu,ju,qu,Xu=[0,0],Yu={},Zu,Ju,Qu,Ku,$u=['a','b','c'],em;if(Fu&&Fu.isGeometry){var tm=Fu.faces;for(Vu=0,Wu=tm.length;Vu<Wu;Vu++){var rm=tm[Vu];for(ku=0;3>ku;ku++)Ju=rm[$u[ku]],Qu=rm[$u[(ku+1)%3]],Xu[0]=Math.min(Ju,Qu),Xu[1]=Math.max(Ju,Qu),Ku=Xu[0]+','+Xu[1],void 0===Yu[Ku]&&(Yu[Ku]={index1:Xu[0],index2:Xu[1]})}for(Ku in Yu)Zu=Yu[Ku],em=Fu.vertices[Zu.index1],Hu.push(em.x,em.y,em.z),em=Fu.vertices[Zu.index2],Hu.push(em.x,em.y,em.z)}else if(Fu&&Fu.isBufferGeometry){var am,om,im,nm,sm,lm,pm,dm;if(em=new A,null!==Fu.index){for(am=Fu.attributes.position,om=Fu.index,im=Fu.groups,0===im.length&&(im=[{start:0,count:om.count,materialIndex:0}]),(ju=0,qu=im.length);ju<qu;++ju)for(nm=im[ju],sm=nm.start,lm=nm.count,(Vu=sm,Wu=sm+lm);Vu<Wu;Vu+=3)for(ku=0;3>ku;ku++)Ju=om.getX(Vu+ku),Qu=om.getX(Vu+(ku+1)%3),Xu[0]=Math.min(Ju,Qu),Xu[1]=Math.max(Ju,Qu),Ku=Xu[0]+','+Xu[1],void 0===Yu[Ku]&&(Yu[Ku]={index1:Xu[0],index2:Xu[1]});for(Ku in Yu)Zu=Yu[Ku],em.fromBufferAttribute(am,Zu.index1),Hu.push(em.x,em.y,em.z),em.fromBufferAttribute(am,Zu.index2),Hu.push(em.x,em.y,em.z)}else for(am=Fu.attributes.position,Vu=0,Wu=am.count/3;Vu<Wu;Vu++)for(ku=0;3>ku;ku++)pm=3*Vu+ku,em.fromBufferAttribute(am,pm),Hu.push(em.x,em.y,em.z),dm=3*Vu+(ku+1)%3,em.fromBufferAttribute(am,dm),Hu.push(em.x,em.y,em.z)}this.addAttribute('position',new ge(Hu,3))}function Nr(Fu,Hu,Vu){ee.call(this),this.type='ParametricGeometry',this.parameters={func:Fu,slices:Hu,stacks:Vu},this.fromBufferGeometry(new Br(Fu,Hu,Vu)),this.mergeVertices()}function Br(Fu,Hu,Vu){xe.call(this),this.type='ParametricBufferGeometry',this.parameters={func:Fu,slices:Hu,stacks:Vu};var ku=[],Wu=[],ju=[],qu=[],Xu=1e-5,Yu=new A,Zu=new A,Ju=new A,Qu=new A,Ku=new A,$u,em;3>Fu.length&&console.error('THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.');var tm=Hu+1;for($u=0;$u<=Vu;$u++){var rm=$u/Vu;for(em=0;em<=Hu;em++){var am=em/Hu;Fu(am,rm,Zu),Wu.push(Zu.x,Zu.y,Zu.z),0<=am-Xu?(Fu(am-Xu,rm,Ju),Qu.subVectors(Zu,Ju)):(Fu(am+Xu,rm,Ju),Qu.subVectors(Ju,Zu)),0<=rm-Xu?(Fu(am,rm-Xu,Ju),Ku.subVectors(Zu,Ju)):(Fu(am,rm+Xu,Ju),Ku.subVectors(Ju,Zu)),Yu.crossVectors(Qu,Ku).normalize(),ju.push(Yu.x,Yu.y,Yu.z),qu.push(am,rm)}}for($u=0;$u<Vu;$u++)for(em=0;em<Hu;em++){var om=$u*tm+em,im=$u*tm+em+1,nm=($u+1)*tm+em+1,sm=($u+1)*tm+em;ku.push(om,im,sm),ku.push(im,nm,sm)}this.setIndex(ku),this.addAttribute('position',new ge(Wu,3)),this.addAttribute('normal',new ge(ju,3)),this.addAttribute('uv',new ge(qu,2))}function Ur(Fu,Hu,Vu,ku){ee.call(this),this.type='PolyhedronGeometry',this.parameters={vertices:Fu,indices:Hu,radius:Vu,detail:ku},this.fromBufferGeometry(new Gr(Fu,Hu,Vu,ku)),this.mergeVertices()}function Gr(Fu,Hu,Vu,ku){function ju(am,om,im,nm){var sm=Math.pow(2,nm),lm=[],pm,dm;for(pm=0;pm<=sm;pm++){lm[pm]=[];var cm=am.clone().lerp(im,pm/sm),um=om.clone().lerp(im,pm/sm),mm=sm-pm;for(dm=0;dm<=mm;dm++)lm[pm][dm]=0===dm&&pm===sm?cm:cm.clone().lerp(um,dm/mm)}for(pm=0;pm<sm;pm++)for(dm=0;dm<2*(sm-pm)-1;dm++){var gm=Math.floor(dm/2);0==dm%2?(Zu(lm[pm][gm+1]),Zu(lm[pm+1][gm]),Zu(lm[pm][gm])):(Zu(lm[pm][gm+1]),Zu(lm[pm+1][gm+1]),Zu(lm[pm+1][gm]))}}function Yu(){for(var am=0;am<rm.length;am+=6){var om=rm[am+0],im=rm[am+2],nm=rm[am+4],sm=Math.max(om,im,nm),lm=Math.min(om,im,nm);0.9<sm&&0.1>lm&&(0.2>om&&(rm[am+0]+=1),0.2>im&&(rm[am+2]+=1),0.2>nm&&(rm[am+4]+=1))}}function Zu(am){tm.push(am.x,am.y,am.z)}function Ju(am,om){var im=3*am;om.x=Fu[im+0],om.y=Fu[im+1],om.z=Fu[im+2]}function Qu(){for(var am=new A,om=new A,im=new A,nm=new A,sm=new S,lm=new S,pm=new S,dm=0,cm=0;dm<tm.length;dm+=9,cm+=6){am.set(tm[dm+0],tm[dm+1],tm[dm+2]),om.set(tm[dm+3],tm[dm+4],tm[dm+5]),im.set(tm[dm+6],tm[dm+7],tm[dm+8]),sm.set(rm[cm+0],rm[cm+1]),lm.set(rm[cm+2],rm[cm+3]),pm.set(rm[cm+4],rm[cm+5]),nm.copy(am).add(om).add(im).divideScalar(3);var um=$u(nm);Ku(sm,cm+0,am,um),Ku(lm,cm+2,om,um),Ku(pm,cm+4,im,um)}}function Ku(am,om,im,nm){0>nm&&1===am.x&&(rm[om]=am.x-1),0===im.x&&0===im.z&&(rm[om]=nm/2/Math.PI+0.5)}function $u(am){return Math.atan2(am.z,-am.x)}function em(am){return Math.atan2(-am.y,Math.sqrt(am.x*am.x+am.z*am.z))}xe.call(this),this.type='PolyhedronBufferGeometry',this.parameters={vertices:Fu,indices:Hu,radius:Vu,detail:ku},Vu=Vu||1,ku=ku||0;var tm=[],rm=[];(function(am){for(var om=new A,im=new A,nm=new A,sm=0;sm<Hu.length;sm+=3)Ju(Hu[sm+0],om),Ju(Hu[sm+1],im),Ju(Hu[sm+2],nm),ju(om,im,nm,am)})(ku),function(am){for(var om=new A,im=0;im<tm.length;im+=3)om.x=tm[im+0],om.y=tm[im+1],om.z=tm[im+2],om.normalize().multiplyScalar(am),tm[im+0]=om.x,tm[im+1]=om.y,tm[im+2]=om.z}(Vu),function(){for(var am=new A,om=0;om<tm.length;om+=3){am.x=tm[om+0],am.y=tm[om+1],am.z=tm[om+2];var im=$u(am)/2/Math.PI+0.5,nm=em(am)/Math.PI+0.5;rm.push(im,1-nm)}Qu(),Yu()}(),this.addAttribute('position',new ge(tm,3)),this.addAttribute('normal',new ge(tm.slice(),3)),this.addAttribute('uv',new ge(rm,2)),0===ku?this.computeVertexNormals():this.normalizeNormals()}function Or(Fu,Hu){ee.call(this),this.type='TetrahedronGeometry',this.parameters={radius:Fu,detail:Hu},this.fromBufferGeometry(new Fr(Fu,Hu)),this.mergeVertices()}function Fr(Fu,Hu){Gr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],Fu,Hu),this.type='TetrahedronBufferGeometry',this.parameters={radius:Fu,detail:Hu}}function Hr(Fu,Hu){ee.call(this),this.type='OctahedronGeometry',this.parameters={radius:Fu,detail:Hu},this.fromBufferGeometry(new Vr(Fu,Hu)),this.mergeVertices()}function Vr(Fu,Hu){Gr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],Fu,Hu),this.type='OctahedronBufferGeometry',this.parameters={radius:Fu,detail:Hu}}function kr(Fu,Hu){ee.call(this),this.type='IcosahedronGeometry',this.parameters={radius:Fu,detail:Hu},this.fromBufferGeometry(new Wr(Fu,Hu)),this.mergeVertices()}function Wr(Fu,Hu){var Vu=(1+Math.sqrt(5))/2;Gr.call(this,[-1,Vu,0,1,Vu,0,-1,-Vu,0,1,-Vu,0,0,-1,Vu,0,1,Vu,0,-1,-Vu,0,1,-Vu,Vu,0,-1,Vu,0,1,-Vu,0,-1,-Vu,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],Fu,Hu),this.type='IcosahedronBufferGeometry',this.parameters={radius:Fu,detail:Hu}}function jr(Fu,Hu){ee.call(this),this.type='DodecahedronGeometry',this.parameters={radius:Fu,detail:Hu},this.fromBufferGeometry(new qr(Fu,Hu)),this.mergeVertices()}function qr(Fu,Hu){var Vu=(1+Math.sqrt(5))/2,ku=1/Vu;Gr.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-ku,-Vu,0,-ku,Vu,0,ku,-Vu,0,ku,Vu,-ku,-Vu,0,-ku,Vu,0,ku,-Vu,0,ku,Vu,0,-Vu,0,-ku,Vu,0,-ku,-Vu,0,ku,Vu,0,ku],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],Fu,Hu),this.type='DodecahedronBufferGeometry',this.parameters={radius:Fu,detail:Hu}}function Xr(Fu,Hu,Vu,ku,Wu,ju){ee.call(this),this.type='TubeGeometry',this.parameters={path:Fu,tubularSegments:Hu,radius:Vu,radialSegments:ku,closed:Wu},ju!==void 0&&console.warn('THREE.TubeGeometry: taper has been removed.');var qu=new Yr(Fu,Hu,Vu,ku,Wu);this.tangents=qu.tangents,this.normals=qu.normals,this.binormals=qu.binormals,this.fromBufferGeometry(qu),this.mergeVertices()}function Yr(Fu,Hu,Vu,ku,Wu){function qu(nm){$u=Fu.getPointAt(nm/Hu,$u);var sm=Zu.normals[nm],lm=Zu.binormals[nm];for(tm=0;tm<=ku;tm++){var pm=2*(tm/ku*Math.PI),dm=Math.sin(pm),cm=-Math.cos(pm);Qu.x=cm*sm.x+dm*lm.x,Qu.y=cm*sm.y+dm*lm.y,Qu.z=cm*sm.z+dm*lm.z,Qu.normalize(),am.push(Qu.x,Qu.y,Qu.z),Ju.x=$u.x+Vu*Qu.x,Ju.y=$u.y+Vu*Qu.y,Ju.z=$u.z+Vu*Qu.z,rm.push(Ju.x,Ju.y,Ju.z)}}function Xu(){for(tm=1;tm<=Hu;tm++)for(em=1;em<=ku;em++){var nm=(ku+1)*(tm-1)+(em-1),sm=(ku+1)*tm+(em-1),lm=(ku+1)*tm+em,pm=(ku+1)*(tm-1)+em;im.push(nm,sm,pm),im.push(sm,lm,pm)}}function Yu(){for(em=0;em<=Hu;em++)for(tm=0;tm<=ku;tm++)Ku.x=em/Hu,Ku.y=tm/ku,om.push(Ku.x,Ku.y)}xe.call(this),this.type='TubeBufferGeometry',this.parameters={path:Fu,tubularSegments:Hu,radius:Vu,radialSegments:ku,closed:Wu},Hu=Hu||64,Vu=Vu||1,ku=ku||8,Wu=Wu||!1;var Zu=Fu.computeFrenetFrames(Hu,Wu);this.tangents=Zu.tangents,this.normals=Zu.normals,this.binormals=Zu.binormals;var Ju=new A,Qu=new A,Ku=new S,$u=new A,em,tm,rm=[],am=[],om=[],im=[];(function(){for(em=0;em<Hu;em++)qu(em);qu(!1===Wu?Hu:0),Yu(),Xu()})(),this.setIndex(im),this.addAttribute('position',new ge(rm,3)),this.addAttribute('normal',new ge(am,3)),this.addAttribute('uv',new ge(om,2))}function Zr(Fu,Hu,Vu,ku,Wu,ju,qu){ee.call(this),this.type='TorusKnotGeometry',this.parameters={radius:Fu,tube:Hu,tubularSegments:Vu,radialSegments:ku,p:Wu,q:ju},qu!==void 0&&console.warn('THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.'),this.fromBufferGeometry(new Jr(Fu,Hu,Vu,ku,Wu,ju)),this.mergeVertices()}function Jr(Fu,Hu,Vu,ku,Wu,ju){function qu(gm,fm,hm,ym,xm){var vm=Math.cos(gm),_m=Math.sin(gm),bm=hm/fm*gm,Mm=Math.cos(bm);xm.x=0.5*(ym*(2+Mm))*vm,xm.y=0.5*(ym*(2+Mm)*_m),xm.z=0.5*(ym*Math.sin(bm))}xe.call(this),this.type='TorusKnotBufferGeometry',this.parameters={radius:Fu,tube:Hu,tubularSegments:Vu,radialSegments:ku,p:Wu,q:ju},Fu=Fu||1,Hu=Hu||0.4,Vu=Math.floor(Vu)||64,ku=Math.floor(ku)||8,Wu=Wu||2,ju=ju||3;var Xu=[],Yu=[],Zu=[],Ju=[],Qu,Ku,$u=new A,em=new A,tm=new A,rm=new A,am=new A,om=new A,im=new A;for(Qu=0;Qu<=Vu;++Qu){var nm=2*(Qu/Vu*Wu*Math.PI);for(qu(nm,Wu,ju,Fu,tm),qu(nm+0.01,Wu,ju,Fu,rm),om.subVectors(rm,tm),im.addVectors(rm,tm),am.crossVectors(om,im),im.crossVectors(am,om),am.normalize(),im.normalize(),Ku=0;Ku<=ku;++Ku){var sm=2*(Ku/ku*Math.PI),lm=-Hu*Math.cos(sm),pm=Hu*Math.sin(sm);$u.x=tm.x+(lm*im.x+pm*am.x),$u.y=tm.y+(lm*im.y+pm*am.y),$u.z=tm.z+(lm*im.z+pm*am.z),Yu.push($u.x,$u.y,$u.z),em.subVectors($u,tm).normalize(),Zu.push(em.x,em.y,em.z),Ju.push(Qu/Vu),Ju.push(Ku/ku)}}for(Ku=1;Ku<=Vu;Ku++)for(Qu=1;Qu<=ku;Qu++){var dm=(ku+1)*(Ku-1)+(Qu-1),cm=(ku+1)*Ku+(Qu-1),um=(ku+1)*Ku+Qu,mm=(ku+1)*(Ku-1)+Qu;Xu.push(dm,cm,mm),Xu.push(cm,um,mm)}this.setIndex(Xu),this.addAttribute('position',new ge(Yu,3)),this.addAttribute('normal',new ge(Zu,3)),this.addAttribute('uv',new ge(Ju,2))}function Qr(Fu,Hu,Vu,ku,Wu){ee.call(this),this.type='TorusGeometry',this.parameters={radius:Fu,tube:Hu,radialSegments:Vu,tubularSegments:ku,arc:Wu},this.fromBufferGeometry(new Kr(Fu,Hu,Vu,ku,Wu)),this.mergeVertices()}function Kr(Fu,Hu,Vu,ku,Wu){xe.call(this),this.type='TorusBufferGeometry',this.parameters={radius:Fu,tube:Hu,radialSegments:Vu,tubularSegments:ku,arc:Wu},Fu=Fu||1,Hu=Hu||0.4,Vu=Math.floor(Vu)||8,ku=Math.floor(ku)||6,Wu=Wu||2*Math.PI;var ju=[],qu=[],Xu=[],Yu=[],Zu=new A,Ju=new A,Qu=new A,Ku,$u;for(Ku=0;Ku<=Vu;Ku++)for($u=0;$u<=ku;$u++){var em=$u/ku*Wu,tm=2*(Ku/Vu*Math.PI);Ju.x=(Fu+Hu*Math.cos(tm))*Math.cos(em),Ju.y=(Fu+Hu*Math.cos(tm))*Math.sin(em),Ju.z=Hu*Math.sin(tm),qu.push(Ju.x,Ju.y,Ju.z),Zu.x=Fu*Math.cos(em),Zu.y=Fu*Math.sin(em),Qu.subVectors(Ju,Zu).normalize(),Xu.push(Qu.x,Qu.y,Qu.z),Yu.push($u/ku),Yu.push(Ku/Vu)}for(Ku=1;Ku<=Vu;Ku++)for($u=1;$u<=ku;$u++){var rm=(ku+1)*Ku+$u-1,am=(ku+1)*(Ku-1)+$u-1,om=(ku+1)*(Ku-1)+$u,im=(ku+1)*Ku+$u;ju.push(rm,am,im),ju.push(am,om,im)}this.setIndex(ju),this.addAttribute('position',new ge(qu,3)),this.addAttribute('normal',new ge(Xu,3)),this.addAttribute('uv',new ge(Yu,2))}function $r(Fu,Hu,Vu,ku,Wu){var ju,qu;if(Wu===0<La(Fu,Hu,Vu,ku))for(ju=Hu;ju<Vu;ju+=ku)qu=Ta(ju,Fu[ju],Fu[ju+1],qu);else for(ju=Vu-ku;ju>=Hu;ju-=ku)qu=Ta(ju,Fu[ju],Fu[ju+1],qu);return qu&&ya(qu,qu.next)&&(Ea(qu),qu=qu.next),qu}function ea(Fu,Hu){if(!Fu)return Fu;Hu||(Hu=Fu);var Vu=Fu,ku;do if(ku=!1,!Vu.steiner&&(ya(Vu,Vu.next)||0===ha(Vu.prev,Vu,Vu.next))){if(Ea(Vu),Vu=Hu=Vu.prev,Vu===Vu.next)break;ku=!0}else Vu=Vu.next;while(ku||Vu!==Hu);return Hu}function ta(Fu,Hu,Vu,ku,Wu,ju,qu){if(Fu){!qu&&ju&&da(Fu,ku,Wu,ju);for(var Xu=Fu,Yu,Zu;Fu.prev!==Fu.next;){if(Yu=Fu.prev,Zu=Fu.next,ju?aa(Fu,ku,Wu,ju):ra(Fu)){Hu.push(Yu.i/Vu),Hu.push(Fu.i/Vu),Hu.push(Zu.i/Vu),Ea(Fu),Fu=Zu.next,Xu=Zu.next;continue}if(Fu=Zu,Fu===Xu){qu?1===qu?(Fu=oa(Fu,Hu,Vu),ta(Fu,Hu,Vu,ku,Wu,ju,2)):2==qu&&ia(Fu,Hu,Vu,ku,Wu,ju):ta(ea(Fu),Hu,Vu,ku,Wu,ju,1);break}}}}function ra(Fu){var Hu=Fu.prev,Vu=Fu,ku=Fu.next;if(0<=ha(Hu,Vu,ku))return!1;for(var Wu=Fu.next.next;Wu!==Fu.prev;){if(ga(Hu.x,Hu.y,Vu.x,Vu.y,ku.x,ku.y,Wu.x,Wu.y)&&0<=ha(Wu.prev,Wu,Wu.next))return!1;Wu=Wu.next}return!0}function aa(Fu,Hu,Vu,ku){var Wu=Fu.prev,ju=Fu,qu=Fu.next;if(0<=ha(Wu,ju,qu))return!1;for(var Xu=Wu.x<ju.x?Wu.x<qu.x?Wu.x:qu.x:ju.x<qu.x?ju.x:qu.x,Yu=Wu.y<ju.y?Wu.y<qu.y?Wu.y:qu.y:ju.y<qu.y?ju.y:qu.y,Zu=Wu.x>ju.x?Wu.x>qu.x?Wu.x:qu.x:ju.x>qu.x?ju.x:qu.x,Ju=Wu.y>ju.y?Wu.y>qu.y?Wu.y:qu.y:ju.y>qu.y?ju.y:qu.y,Qu=ua(Xu,Yu,Hu,Vu,ku),Ku=ua(Zu,Ju,Hu,Vu,ku),$u=Fu.nextZ;$u&&$u.z<=Ku;){if($u!==Fu.prev&&$u!==Fu.next&&ga(Wu.x,Wu.y,ju.x,ju.y,qu.x,qu.y,$u.x,$u.y)&&0<=ha($u.prev,$u,$u.next))return!1;$u=$u.nextZ}for($u=Fu.prevZ;$u&&$u.z>=Qu;){if($u!==Fu.prev&&$u!==Fu.next&&ga(Wu.x,Wu.y,ju.x,ju.y,qu.x,qu.y,$u.x,$u.y)&&0<=ha($u.prev,$u,$u.next))return!1;$u=$u.prevZ}return!0}function oa(Fu,Hu,Vu){var ku=Fu;do{var Wu=ku.prev,ju=ku.next.next;!ya(Wu,ju)&&xa(Wu,ku,ku.next,ju)&&ba(Wu,ju)&&ba(ju,Wu)&&(Hu.push(Wu.i/Vu),Hu.push(ku.i/Vu),Hu.push(ju.i/Vu),Ea(ku),Ea(ku.next),ku=Fu=ju),ku=ku.next}while(ku!==Fu);return ku}function ia(Fu,Hu,Vu,ku,Wu,ju){var qu=Fu;do{for(var Xu=qu.next.next;Xu!==qu.prev;){if(qu.i!==Xu.i&&fa(qu,Xu)){var Yu=Sa(qu,Xu);return qu=ea(qu,qu.next),Yu=ea(Yu,Yu.next),ta(qu,Hu,Vu,ku,Wu,ju),void ta(Yu,Hu,Vu,ku,Wu,ju)}Xu=Xu.next}qu=qu.next}while(qu!==Fu)}function na(Fu,Hu,Vu,ku){var Wu=[],ju,qu,Xu,Yu,Zu;for(ju=0,qu=Hu.length;ju<qu;ju++)Xu=Hu[ju]*ku,Yu=ju<qu-1?Hu[ju+1]*ku:Fu.length,Zu=$r(Fu,Xu,Yu,ku,!1),Zu===Zu.next&&(Zu.steiner=!0),Wu.push(ma(Zu));for(Wu.sort(sa),ju=0;ju<Wu.length;ju++)la(Wu[ju],Vu),Vu=ea(Vu,Vu.next);return Vu}function sa(Fu,Hu){return Fu.x-Hu.x}function la(Fu,Hu){if(Hu=pa(Fu,Hu),Hu){var Vu=Sa(Hu,Fu);ea(Vu,Vu.next)}}function pa(Fu,Hu){var Vu=Hu,ku=Fu.x,Wu=Fu.y,ju=-Infinity,qu;do{if(Wu<=Vu.y&&Wu>=Vu.next.y&&Vu.next.y!==Vu.y){var Xu=Vu.x+(Wu-Vu.y)*(Vu.next.x-Vu.x)/(Vu.next.y-Vu.y);if(Xu<=ku&&Xu>ju){if(ju=Xu,Xu===ku){if(Wu===Vu.y)return Vu;if(Wu===Vu.next.y)return Vu.next}qu=Vu.x<Vu.next.x?Vu:Vu.next}}Vu=Vu.next}while(Vu!==Hu);if(!qu)return null;if(ku===ju)return qu.prev;var Yu=qu,Zu=qu.x,Ju=qu.y,Qu=Infinity,Ku;for(Vu=qu.next;Vu!==Yu;)ku>=Vu.x&&Vu.x>=Zu&&ku!==Vu.x&&ga(Wu<Ju?ku:ju,Wu,Zu,Ju,Wu<Ju?ju:ku,Wu,Vu.x,Vu.y)&&(Ku=Math.abs(Wu-Vu.y)/(ku-Vu.x),(Ku<Qu||Ku===Qu&&Vu.x>qu.x)&&ba(Vu,Fu)&&(qu=Vu,Qu=Ku)),Vu=Vu.next;return qu}function da(Fu,Hu,Vu,ku){var Wu=Fu;do null===Wu.z&&(Wu.z=ua(Wu.x,Wu.y,Hu,Vu,ku)),Wu.prevZ=Wu.prev,Wu.nextZ=Wu.next,Wu=Wu.next;while(Wu!==Fu);Wu.prevZ.nextZ=null,Wu.prevZ=null,ca(Wu)}function ca(Fu){var Zu=1,Hu,Vu,ku,Wu,ju,qu,Xu,Yu;do{for(Vu=Fu,Fu=null,ju=null,qu=0;Vu;){for(qu++,ku=Vu,Xu=0,Hu=0;Hu<Zu&&(Xu++,ku=ku.nextZ,!!ku);Hu++);for(Yu=Zu;0<Xu||0<Yu&&ku;)0!==Xu&&(0===Yu||!ku||Vu.z<=ku.z)?(Wu=Vu,Vu=Vu.nextZ,Xu--):(Wu=ku,ku=ku.nextZ,Yu--),ju?ju.nextZ=Wu:Fu=Wu,Wu.prevZ=ju,ju=Wu;Vu=ku}ju.nextZ=null,Zu*=2}while(1<qu);return Fu}function ua(Fu,Hu,Vu,ku,Wu){return Fu=32767*(Fu-Vu)*Wu,Hu=32767*(Hu-ku)*Wu,Fu=16711935&(Fu|Fu<<8),Fu=252645135&(Fu|Fu<<4),Fu=858993459&(Fu|Fu<<2),Fu=1431655765&(Fu|Fu<<1),Hu=16711935&(Hu|Hu<<8),Hu=252645135&(Hu|Hu<<4),Hu=858993459&(Hu|Hu<<2),Hu=1431655765&(Hu|Hu<<1),Fu|Hu<<1}function ma(Fu){var Hu=Fu,Vu=Fu;do Hu.x<Vu.x&&(Vu=Hu),Hu=Hu.next;while(Hu!==Fu);return Vu}function ga(Fu,Hu,Vu,ku,Wu,ju,qu,Xu){return 0<=(Wu-qu)*(Hu-Xu)-(Fu-qu)*(ju-Xu)&&0<=(Fu-qu)*(ku-Xu)-(Vu-qu)*(Hu-Xu)&&0<=(Vu-qu)*(ju-Xu)-(Wu-qu)*(ku-Xu)}function fa(Fu,Hu){return Fu.next.i!==Hu.i&&Fu.prev.i!==Hu.i&&!_a(Fu,Hu)&&ba(Fu,Hu)&&ba(Hu,Fu)&&Ma(Fu,Hu)}function ha(Fu,Hu,Vu){return(Hu.y-Fu.y)*(Vu.x-Hu.x)-(Hu.x-Fu.x)*(Vu.y-Hu.y)}function ya(Fu,Hu){return Fu.x===Hu.x&&Fu.y===Hu.y}function xa(Fu,Hu,Vu,ku){return ya(Fu,Hu)&&ya(Vu,ku)||ya(Fu,ku)&&ya(Vu,Hu)||0<ha(Fu,Hu,Vu)!=0<ha(Fu,Hu,ku)&&0<ha(Vu,ku,Fu)!=0<ha(Vu,ku,Hu)}function _a(Fu,Hu){var Vu=Fu;do{if(Vu.i!==Fu.i&&Vu.next.i!==Fu.i&&Vu.i!==Hu.i&&Vu.next.i!==Hu.i&&xa(Vu,Vu.next,Fu,Hu))return!0;Vu=Vu.next}while(Vu!==Fu);return!1}function ba(Fu,Hu){return 0>ha(Fu.prev,Fu,Fu.next)?0<=ha(Fu,Hu,Fu.next)&&0<=ha(Fu,Fu.prev,Hu):0>ha(Fu,Hu,Fu.prev)||0>ha(Fu,Fu.next,Hu)}function Ma(Fu,Hu){var Vu=Fu,ku=!1,Wu=(Fu.x+Hu.x)/2,ju=(Fu.y+Hu.y)/2;do Vu.y>ju!=Vu.next.y>ju&&Vu.next.y!==Vu.y&&Wu<(Vu.next.x-Vu.x)*(ju-Vu.y)/(Vu.next.y-Vu.y)+Vu.x&&(ku=!ku),Vu=Vu.next;while(Vu!==Fu);return ku}function Sa(Fu,Hu){var Vu=new wa(Fu.i,Fu.x,Fu.y),ku=new wa(Hu.i,Hu.x,Hu.y),Wu=Fu.next,ju=Hu.prev;return Fu.next=Hu,Hu.prev=Fu,Vu.next=Wu,Wu.prev=Vu,ku.next=Vu,Vu.prev=ku,ju.next=ku,ku.prev=ju,ku}function Ta(Fu,Hu,Vu,ku){var Wu=new wa(Fu,Hu,Vu);return ku?(Wu.next=ku.next,Wu.prev=ku,ku.next.prev=Wu,ku.next=Wu):(Wu.prev=Wu,Wu.next=Wu),Wu}function Ea(Fu){Fu.next.prev=Fu.prev,Fu.prev.next=Fu.next,Fu.prevZ&&(Fu.prevZ.nextZ=Fu.nextZ),Fu.nextZ&&(Fu.nextZ.prevZ=Fu.prevZ)}function wa(Fu,Hu,Vu){this.i=Fu,this.x=Hu,this.y=Vu,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function La(Fu,Hu,Vu,ku){for(var Wu=0,ju=Hu,qu=Vu-ku;ju<Vu;ju+=ku)Wu+=(Fu[qu]-Fu[ju])*(Fu[ju+1]+Fu[qu+1]),qu=ju;return Wu}function Aa(Fu){var Hu=Fu.length;2<Hu&&Fu[Hu-1].equals(Fu[0])&&Fu.pop()}function Pa(Fu,Hu){for(var Vu=0;Vu<Hu.length;Vu++)Fu.push(Hu[Vu].x),Fu.push(Hu[Vu].y)}function Ca(Fu,Hu){ee.call(this),this.type='ExtrudeGeometry',this.parameters={shapes:Fu,options:Hu},this.fromBufferGeometry(new Ra(Fu,Hu)),this.mergeVertices()}function Ra(Fu,Hu){function Vu(Zu){function Ju(Zm,Jm,Qm){return Jm||console.error('THREE.ExtrudeGeometry: vec does not exist'),Jm.clone().multiplyScalar(Qm).add(Zm)}function Qu(Zm,Jm,Qm){var Km,$m,eg,tg=Zm.x-Jm.x,rg=Zm.y-Jm.y,ag=Qm.x-Zm.x,og=Qm.y-Zm.y,ig=tg*tg+rg*rg;if(Math.abs(tg*og-rg*ag)>Number.EPSILON){var sg=Math.sqrt(ig),lg=Math.sqrt(ag*ag+og*og),pg=Jm.x-rg/sg,dg=Jm.y+tg/sg,cg=Qm.x-og/lg,ug=Qm.y+ag/lg,mg=((cg-pg)*og-(ug-dg)*ag)/(tg*og-rg*ag);Km=pg+tg*mg-Zm.x,$m=dg+rg*mg-Zm.y;var gg=Km*Km+$m*$m;if(2>=gg)return new S(Km,$m);eg=Math.sqrt(gg/2)}else{var fg=!1;tg>Number.EPSILON?ag>Number.EPSILON&&(fg=!0):tg<-Number.EPSILON?ag<-Number.EPSILON&&(fg=!0):Math.sign(rg)===Math.sign(og)&&(fg=!0),fg?(Km=-rg,$m=tg,eg=Math.sqrt(ig)):(Km=tg,$m=rg,eg=Math.sqrt(ig/2))}return new S(Km/eg,$m/eg)}function em(Zm,Jm){var Qm,Km;for(Fm=Zm.length;0<=--Fm;){Qm=Fm,Km=Fm-1,0>Km&&(Km=Zm.length-1);var $m=0,eg=lm+2*mm;for($m=0;$m<eg;$m++){var tg=Bm*$m,rg=Bm*($m+1),ag=Jm+Qm+tg,og=Jm+Km+tg,ig=Jm+Km+rg,ng=Jm+Qm+rg;am(ag,og,ig,ng)}}}function tm(Zm,Jm,Qm){nm.push(Zm),nm.push(Jm),nm.push(Qm)}function rm(Zm,Jm,Qm){om(Zm),om(Jm),om(Qm);var Km=Wu.length/3,$m=fm.generateTopUV(ku,Wu,Km-3,Km-2,Km-1);im($m[0]),im($m[1]),im($m[2])}function am(Zm,Jm,Qm,Km){om(Zm),om(Jm),om(Km),om(Jm),om(Qm),om(Km);var $m=Wu.length/3,eg=fm.generateSideWallUV(ku,Wu,$m-6,$m-3,$m-2,$m-1);im(eg[0]),im(eg[1]),im(eg[3]),im(eg[1]),im(eg[2]),im(eg[3])}function om(Zm){Wu.push(nm[3*Zm+0]),Wu.push(nm[3*Zm+1]),Wu.push(nm[3*Zm+2])}function im(Zm){ju.push(Zm.x),ju.push(Zm.y)}var nm=[],sm=Hu.curveSegments===void 0?12:Hu.curveSegments,lm=Hu.steps===void 0?1:Hu.steps,pm=Hu.depth===void 0?100:Hu.depth,dm=!(Hu.bevelEnabled!==void 0)||Hu.bevelEnabled,cm=Hu.bevelThickness===void 0?6:Hu.bevelThickness,um=Hu.bevelSize===void 0?cm-2:Hu.bevelSize,mm=Hu.bevelSegments===void 0?3:Hu.bevelSegments,gm=Hu.extrudePath,fm=Hu.UVGenerator===void 0?lu:Hu.UVGenerator;Hu.amount!==void 0&&(console.warn('THREE.ExtrudeBufferGeometry: amount has been renamed to depth.'),pm=Hu.amount);var ym=!1,hm,xm,vm,_m,bm;gm&&(hm=gm.getSpacedPoints(lm),ym=!0,dm=!1,xm=gm.computeFrenetFrames(lm,!1),vm=new A,_m=new A,bm=new A),dm||(mm=0,cm=0,um=0);var Mm,Sm,Tm,Em=Zu.extractPoints(sm),wm=Em.shape,Lm=Em.holes,Am=!nu.isClockWise(wm);if(Am)for(wm=wm.reverse(),Sm=0,Tm=Lm.length;Sm<Tm;Sm++)Mm=Lm[Sm],nu.isClockWise(Mm)&&(Lm[Sm]=Mm.reverse());var Pm=nu.triangulateShape(wm,Lm),Cm=wm;for(Sm=0,Tm=Lm.length;Sm<Tm;Sm++)Mm=Lm[Sm],wm=wm.concat(Mm);for(var Bm=wm.length,Gm=Pm.length,Om=[],Fm=0,Hm=Cm.length,Vm=Hm-1,km=Fm+1,Rm,Im,Dm,zm,Nm,Um;Fm<Hm;Fm++,Vm++,km++)Vm===Hm&&(Vm=0),km===Hm&&(km=0),Om[Fm]=Qu(Cm[Fm],Cm[Vm],Cm[km]);var Wm=[],Xm=Om.concat(),jm;for(Sm=0,Tm=Lm.length;Sm<Tm;Sm++){for(Mm=Lm[Sm],jm=[],(Fm=0,Hm=Mm.length,Vm=Hm-1,km=Fm+1);Fm<Hm;Fm++,Vm++,km++)Vm===Hm&&(Vm=0),km===Hm&&(km=0),jm[Fm]=Qu(Mm[Fm],Mm[Vm],Mm[km]);Wm.push(jm),Xm=Xm.concat(jm)}for(Rm=0;Rm<mm;Rm++){for(Dm=Rm/mm,zm=cm*Math.cos(Dm*Math.PI/2),Im=um*Math.sin(Dm*Math.PI/2),(Fm=0,Hm=Cm.length);Fm<Hm;Fm++)Nm=Ju(Cm[Fm],Om[Fm],Im),tm(Nm.x,Nm.y,-zm);for(Sm=0,Tm=Lm.length;Sm<Tm;Sm++)for(Mm=Lm[Sm],jm=Wm[Sm],(Fm=0,Hm=Mm.length);Fm<Hm;Fm++)Nm=Ju(Mm[Fm],jm[Fm],Im),tm(Nm.x,Nm.y,-zm)}for(Im=um,Fm=0;Fm<Bm;Fm++)Nm=dm?Ju(wm[Fm],Xm[Fm],Im):wm[Fm],ym?(_m.copy(xm.normals[0]).multiplyScalar(Nm.x),vm.copy(xm.binormals[0]).multiplyScalar(Nm.y),bm.copy(hm[0]).add(_m).add(vm),tm(bm.x,bm.y,bm.z)):tm(Nm.x,Nm.y,0);var Ym;for(Ym=1;Ym<=lm;Ym++)for(Fm=0;Fm<Bm;Fm++)Nm=dm?Ju(wm[Fm],Xm[Fm],Im):wm[Fm],ym?(_m.copy(xm.normals[Ym]).multiplyScalar(Nm.x),vm.copy(xm.binormals[Ym]).multiplyScalar(Nm.y),bm.copy(hm[Ym]).add(_m).add(vm),tm(bm.x,bm.y,bm.z)):tm(Nm.x,Nm.y,pm/lm*Ym);for(Rm=mm-1;0<=Rm;Rm--){for(Dm=Rm/mm,zm=cm*Math.cos(Dm*Math.PI/2),Im=um*Math.sin(Dm*Math.PI/2),(Fm=0,Hm=Cm.length);Fm<Hm;Fm++)Nm=Ju(Cm[Fm],Om[Fm],Im),tm(Nm.x,Nm.y,pm+zm);for(Sm=0,Tm=Lm.length;Sm<Tm;Sm++)for(Mm=Lm[Sm],jm=Wm[Sm],(Fm=0,Hm=Mm.length);Fm<Hm;Fm++)Nm=Ju(Mm[Fm],jm[Fm],Im),ym?tm(Nm.x,Nm.y+hm[lm-1].y,hm[lm-1].x+zm):tm(Nm.x,Nm.y,pm+zm)}(function(){var Zm=Wu.length/3;if(dm){var Jm=0,Qm=Bm*Jm;for(Fm=0;Fm<Gm;Fm++)Um=Pm[Fm],rm(Um[2]+Qm,Um[1]+Qm,Um[0]+Qm);for(Jm=lm+2*mm,Qm=Bm*Jm,Fm=0;Fm<Gm;Fm++)Um=Pm[Fm],rm(Um[0]+Qm,Um[1]+Qm,Um[2]+Qm)}else{for(Fm=0;Fm<Gm;Fm++)Um=Pm[Fm],rm(Um[2],Um[1],Um[0]);for(Fm=0;Fm<Gm;Fm++)Um=Pm[Fm],rm(Um[0]+Bm*lm,Um[1]+Bm*lm,Um[2]+Bm*lm)}ku.addGroup(Zm,Wu.length/3-Zm,0)})(),function(){var Zm=Wu.length/3,Jm=0;for(em(Cm,Jm),Jm+=Cm.length,(Sm=0,Tm=Lm.length);Sm<Tm;Sm++)Mm=Lm[Sm],em(Mm,Jm),Jm+=Mm.length;ku.addGroup(Zm,Wu.length/3-Zm,1)}()}xe.call(this),this.type='ExtrudeBufferGeometry',this.parameters={shapes:Fu,options:Hu},Fu=Array.isArray(Fu)?Fu:[Fu];for(var ku=this,Wu=[],ju=[],qu=0,Xu=Fu.length,Yu;qu<Xu;qu++)Yu=Fu[qu],Vu(Yu);this.addAttribute('position',new ge(Wu,3)),this.addAttribute('uv',new ge(ju,2)),this.computeVertexNormals()}function Ia(Fu,Hu,Vu){if(Vu.shapes=[],Array.isArray(Fu))for(var ku=0,Wu=Fu.length,ju;ku<Wu;ku++)ju=Fu[ku],Vu.shapes.push(ju.uuid);else Vu.shapes.push(Fu.uuid);return void 0!==Hu.extrudePath&&(Vu.options.extrudePath=Hu.extrudePath.toJSON()),Vu}function Da(Fu,Hu){ee.call(this),this.type='TextGeometry',this.parameters={text:Fu,parameters:Hu},this.fromBufferGeometry(new za(Fu,Hu)),this.mergeVertices()}function za(Fu,Hu){Hu=Hu||{};var Vu=Hu.font;if(!(Vu&&Vu.isFont))return console.error('THREE.TextGeometry: font parameter is not an instance of THREE.Font.'),new ee;var ku=Vu.generateShapes(Fu,Hu.size);Hu.depth=Hu.height===void 0?50:Hu.height,Hu.bevelThickness===void 0&&(Hu.bevelThickness=10),Hu.bevelSize===void 0&&(Hu.bevelSize=8),Hu.bevelEnabled===void 0&&(Hu.bevelEnabled=!1),Ra.call(this,ku,Hu),this.type='TextBufferGeometry'}function Na(Fu,Hu,Vu,ku,Wu,ju,qu){ee.call(this),this.type='SphereGeometry',this.parameters={radius:Fu,widthSegments:Hu,heightSegments:Vu,phiStart:ku,phiLength:Wu,thetaStart:ju,thetaLength:qu},this.fromBufferGeometry(new Ba(Fu,Hu,Vu,ku,Wu,ju,qu)),this.mergeVertices()}function Ba(Fu,Hu,Vu,ku,Wu,ju,qu){xe.call(this),this.type='SphereBufferGeometry',this.parameters={radius:Fu,widthSegments:Hu,heightSegments:Vu,phiStart:ku,phiLength:Wu,thetaStart:ju,thetaLength:qu},Fu=Fu||1,Hu=Math.max(3,Math.floor(Hu)||8),Vu=Math.max(2,Math.floor(Vu)||6),ku=ku===void 0?0:ku,Wu=Wu===void 0?2*Math.PI:Wu,ju=ju===void 0?0:ju,qu=qu===void 0?Math.PI:qu;var Xu=ju+qu,Yu,Zu,Ju=0,Qu=[],Ku=new A,$u=new A,em=[],tm=[],rm=[],am=[];for(Zu=0;Zu<=Vu;Zu++){var om=[],im=Zu/Vu;for(Yu=0;Yu<=Hu;Yu++){var nm=Yu/Hu;Ku.x=-Fu*Math.cos(ku+nm*Wu)*Math.sin(ju+im*qu),Ku.y=Fu*Math.cos(ju+im*qu),Ku.z=Fu*Math.sin(ku+nm*Wu)*Math.sin(ju+im*qu),tm.push(Ku.x,Ku.y,Ku.z),$u.set(Ku.x,Ku.y,Ku.z).normalize(),rm.push($u.x,$u.y,$u.z),am.push(nm,1-im),om.push(Ju++)}Qu.push(om)}for(Zu=0;Zu<Vu;Zu++)for(Yu=0;Yu<Hu;Yu++){var sm=Qu[Zu][Yu+1],lm=Qu[Zu][Yu],pm=Qu[Zu+1][Yu],dm=Qu[Zu+1][Yu+1];(0!==Zu||0<ju)&&em.push(sm,lm,dm),(Zu!==Vu-1||Xu<Math.PI)&&em.push(lm,pm,dm)}this.setIndex(em),this.addAttribute('position',new ge(tm,3)),this.addAttribute('normal',new ge(rm,3)),this.addAttribute('uv',new ge(am,2))}function Ua(Fu,Hu,Vu,ku,Wu,ju){ee.call(this),this.type='RingGeometry',this.parameters={innerRadius:Fu,outerRadius:Hu,thetaSegments:Vu,phiSegments:ku,thetaStart:Wu,thetaLength:ju},this.fromBufferGeometry(new Ga(Fu,Hu,Vu,ku,Wu,ju)),this.mergeVertices()}function Ga(Fu,Hu,Vu,ku,Wu,ju){xe.call(this),this.type='RingBufferGeometry',this.parameters={innerRadius:Fu,outerRadius:Hu,thetaSegments:Vu,phiSegments:ku,thetaStart:Wu,thetaLength:ju},Fu=Fu||0.5,Hu=Hu||1,Wu=Wu===void 0?0:Wu,ju=ju===void 0?2*Math.PI:ju,Vu=Vu===void 0?8:Math.max(3,Vu),ku=ku===void 0?1:Math.max(1,ku);var qu=[],Xu=[],Yu=[],Zu=[],Ju,Qu=Fu,Ku=(Hu-Fu)/ku,$u=new A,em=new S,tm,rm;for(tm=0;tm<=ku;tm++){for(rm=0;rm<=Vu;rm++)Ju=Wu+rm/Vu*ju,$u.x=Qu*Math.cos(Ju),$u.y=Qu*Math.sin(Ju),Xu.push($u.x,$u.y,$u.z),Yu.push(0,0,1),em.x=($u.x/Hu+1)/2,em.y=($u.y/Hu+1)/2,Zu.push(em.x,em.y);Qu+=Ku}for(tm=0;tm<ku;tm++){var am=tm*(Vu+1);for(rm=0;rm<Vu;rm++){Ju=rm+am;var om=Ju,im=Ju+Vu+1,nm=Ju+Vu+2,sm=Ju+1;qu.push(om,im,sm),qu.push(im,nm,sm)}}this.setIndex(qu),this.addAttribute('position',new ge(Xu,3)),this.addAttribute('normal',new ge(Yu,3)),this.addAttribute('uv',new ge(Zu,2))}function Oa(Fu,Hu,Vu,ku){ee.call(this),this.type='LatheGeometry',this.parameters={points:Fu,segments:Hu,phiStart:Vu,phiLength:ku},this.fromBufferGeometry(new Fa(Fu,Hu,Vu,ku)),this.mergeVertices()}function Fa(Fu,Hu,Vu,ku){xe.call(this),this.type='LatheBufferGeometry',this.parameters={points:Fu,segments:Hu,phiStart:Vu,phiLength:ku},Hu=Math.floor(Hu)||12,Vu=Vu||0,ku=ku||2*Math.PI,ku=fp.clamp(ku,0,2*Math.PI);var Wu=[],ju=[],qu=[],Yu=1/Hu,Zu=new A,Ju=new S,Xu,Qu,Ku;for(Qu=0;Qu<=Hu;Qu++){var $u=Vu+Qu*Yu*ku,em=Math.sin($u),tm=Math.cos($u);for(Ku=0;Ku<=Fu.length-1;Ku++)Zu.x=Fu[Ku].x*em,Zu.y=Fu[Ku].y,Zu.z=Fu[Ku].x*tm,ju.push(Zu.x,Zu.y,Zu.z),Ju.x=Qu/Hu,Ju.y=Ku/(Fu.length-1),qu.push(Ju.x,Ju.y)}for(Qu=0;Qu<Hu;Qu++)for(Ku=0;Ku<Fu.length-1;Ku++){Xu=Ku+Qu*Fu.length;var rm=Xu,am=Xu+Fu.length,om=Xu+Fu.length+1,im=Xu+1;Wu.push(rm,am,im),Wu.push(am,om,im)}if(this.setIndex(Wu),this.addAttribute('position',new ge(ju,3)),this.addAttribute('uv',new ge(qu,2)),this.computeVertexNormals(),ku===2*Math.PI){var nm=this.attributes.normal.array,sm=new A,lm=new A,pm=new A;for(Xu=3*(Hu*Fu.length),Qu=0,Ku=0;Qu<Fu.length;Qu++,Ku+=3)sm.x=nm[Ku+0],sm.y=nm[Ku+1],sm.z=nm[Ku+2],lm.x=nm[Xu+Ku+0],lm.y=nm[Xu+Ku+1],lm.z=nm[Xu+Ku+2],pm.addVectors(sm,lm).normalize(),nm[Ku+0]=nm[Xu+Ku+0]=pm.x,nm[Ku+1]=nm[Xu+Ku+1]=pm.y,nm[Ku+2]=nm[Xu+Ku+2]=pm.z}}function Ha(Fu,Hu){ee.call(this),this.type='ShapeGeometry','object'==typeof Hu&&(console.warn('THREE.ShapeGeometry: Options parameter has been removed.'),Hu=Hu.curveSegments),this.parameters={shapes:Fu,curveSegments:Hu},this.fromBufferGeometry(new Va(Fu,Hu)),this.mergeVertices()}function Va(Fu,Hu){function Vu(Ju){var Qu,Ku,$u,em=Wu.length/3,tm=Ju.extractPoints(Hu),rm=tm.shape,am=tm.holes;if(!1===nu.isClockWise(rm))for(rm=rm.reverse(),Qu=0,Ku=am.length;Qu<Ku;Qu++)$u=am[Qu],!0===nu.isClockWise($u)&&(am[Qu]=$u.reverse());var om=nu.triangulateShape(rm,am);for(Qu=0,Ku=am.length;Qu<Ku;Qu++)$u=am[Qu],rm=rm.concat($u);for(Qu=0,Ku=rm.length;Qu<Ku;Qu++){var im=rm[Qu];Wu.push(im.x,im.y,0),ju.push(0,0,1),qu.push(im.x,im.y)}for(Qu=0,Ku=om.length;Qu<Ku;Qu++){var nm=om[Qu],sm=nm[0]+em,lm=nm[1]+em,pm=nm[2]+em;ku.push(sm,lm,pm),Yu+=3}}xe.call(this),this.type='ShapeBufferGeometry',this.parameters={shapes:Fu,curveSegments:Hu},Hu=Hu||12;var ku=[],Wu=[],ju=[],qu=[],Xu=0,Yu=0;if(!1===Array.isArray(Fu))Vu(Fu);else for(var Zu=0;Zu<Fu.length;Zu++)Vu(Fu[Zu]),this.addGroup(Xu,Yu,Zu),Xu+=Yu,Yu=0;this.setIndex(ku),this.addAttribute('position',new ge(Wu,3)),this.addAttribute('normal',new ge(ju,3)),this.addAttribute('uv',new ge(qu,2))}function ka(Fu,Hu){if(Hu.shapes=[],Array.isArray(Fu))for(var Vu=0,ku=Fu.length,Wu;Vu<ku;Vu++)Wu=Fu[Vu],Hu.shapes.push(Wu.uuid);else Hu.shapes.push(Fu.uuid);return Hu}function Wa(Fu,Hu){xe.call(this),this.type='EdgesGeometry',this.parameters={thresholdAngle:Hu},Hu=Hu===void 0?1:Hu;var Vu=[],ku=Math.cos(fp.DEG2RAD*Hu),Wu=[0,0],ju={},qu,Xu,Yu,Zu=['a','b','c'],Ju;Fu.isBufferGeometry?(Ju=new ee,Ju.fromBufferGeometry(Fu)):Ju=Fu.clone(),Ju.mergeVertices(),Ju.computeFaceNormals();for(var Qu=Ju.vertices,Ku=Ju.faces,$u=0,em=Ku.length,tm;$u<em;$u++){tm=Ku[$u];for(var rm=0;3>rm;rm++)qu=tm[Zu[rm]],Xu=tm[Zu[(rm+1)%3]],Wu[0]=Math.min(qu,Xu),Wu[1]=Math.max(qu,Xu),Yu=Wu[0]+','+Wu[1],void 0===ju[Yu]?ju[Yu]={index1:Wu[0],index2:Wu[1],face1:$u,face2:void 0}:ju[Yu].face2=$u}for(Yu in ju){var am=ju[Yu];if(am.face2===void 0||Ku[am.face1].normal.dot(Ku[am.face2].normal)<=ku){var om=Qu[am.index1];Vu.push(om.x,om.y,om.z),om=Qu[am.index2],Vu.push(om.x,om.y,om.z)}}this.addAttribute('position',new ge(Vu,3))}function ja(Fu,Hu,Vu,ku,Wu,ju,qu,Xu){ee.call(this),this.type='CylinderGeometry',this.parameters={radiusTop:Fu,radiusBottom:Hu,height:Vu,radialSegments:ku,heightSegments:Wu,openEnded:ju,thetaStart:qu,thetaLength:Xu},this.fromBufferGeometry(new Xa(Fu,Hu,Vu,ku,Wu,ju,qu,Xu)),this.mergeVertices()}function Xa(Fu,Hu,Vu,ku,Wu,ju,qu,Xu){function Zu(im){var nm,sm,lm,pm=new S,dm=new A,cm=0,um=!0===im?Fu:Hu,mm=!0===im?1:-1;for(sm=tm,nm=1;nm<=ku;nm++)Ku.push(0,am*mm,0),$u.push(0,mm,0),em.push(0.5,0.5),tm++;for(lm=tm,nm=0;nm<=ku;nm++){var gm=nm/ku,fm=gm*Xu+qu,hm=Math.cos(fm),ym=Math.sin(fm);dm.x=um*ym,dm.y=am*mm,dm.z=um*hm,Ku.push(dm.x,dm.y,dm.z),$u.push(0,mm,0),pm.x=0.5*hm+0.5,pm.y=0.5*ym*mm+0.5,em.push(pm.x,pm.y),tm++}for(nm=0;nm<ku;nm++){var xm=sm+nm,vm=lm+nm;!0===im?Qu.push(vm,vm+1,xm):Qu.push(vm+1,vm,xm),cm+=3}Ju.addGroup(om,cm,!0===im?1:2),om+=cm}xe.call(this),this.type='CylinderBufferGeometry',this.parameters={radiusTop:Fu,radiusBottom:Hu,height:Vu,radialSegments:ku,heightSegments:Wu,openEnded:ju,thetaStart:qu,thetaLength:Xu};var Ju=this;Fu=Fu===void 0?1:Fu,Hu=Hu===void 0?1:Hu,Vu=Vu||1,ku=Math.floor(ku)||8,Wu=Math.floor(Wu)||1,ju=ju!==void 0&&ju,qu=qu===void 0?0:qu,Xu=Xu===void 0?2*Math.PI:Xu;var Qu=[],Ku=[],$u=[],em=[],tm=0,rm=[],am=Vu/2,om=0;(function(){var im,nm,sm=new A,lm=new A,pm=0,dm=(Hu-Fu)/Vu;for(nm=0;nm<=Wu;nm++){var cm=[],um=nm/Wu,mm=um*(Hu-Fu)+Fu;for(im=0;im<=ku;im++){var gm=im/ku,fm=gm*Xu+qu,hm=Math.sin(fm),ym=Math.cos(fm);lm.x=mm*hm,lm.y=-um*Vu+am,lm.z=mm*ym,Ku.push(lm.x,lm.y,lm.z),sm.set(hm,dm,ym).normalize(),$u.push(sm.x,sm.y,sm.z),em.push(gm,1-um),cm.push(tm++)}rm.push(cm)}for(im=0;im<ku;im++)for(nm=0;nm<Wu;nm++){var xm=rm[nm][im],vm=rm[nm+1][im],_m=rm[nm+1][im+1],bm=rm[nm][im+1];Qu.push(xm,vm,bm),Qu.push(vm,_m,bm),pm+=6}Ju.addGroup(om,pm,0),om+=pm})(),!1===ju&&(0<Fu&&Zu(!0),0<Hu&&Zu(!1)),this.setIndex(Qu),this.addAttribute('position',new ge(Ku,3)),this.addAttribute('normal',new ge($u,3)),this.addAttribute('uv',new ge(em,2))}function Ya(Fu,Hu,Vu,ku,Wu,ju,qu){ja.call(this,0,Fu,Hu,Vu,ku,Wu,ju,qu),this.type='ConeGeometry',this.parameters={radius:Fu,height:Hu,radialSegments:Vu,heightSegments:ku,openEnded:Wu,thetaStart:ju,thetaLength:qu}}function Za(Fu,Hu,Vu,ku,Wu,ju,qu){Xa.call(this,0,Fu,Hu,Vu,ku,Wu,ju,qu),this.type='ConeBufferGeometry',this.parameters={radius:Fu,height:Hu,radialSegments:Vu,heightSegments:ku,openEnded:Wu,thetaStart:ju,thetaLength:qu}}function Ja(Fu,Hu,Vu,ku){ee.call(this),this.type='CircleGeometry',this.parameters={radius:Fu,segments:Hu,thetaStart:Vu,thetaLength:ku},this.fromBufferGeometry(new Qa(Fu,Hu,Vu,ku)),this.mergeVertices()}function Qa(Fu,Hu,Vu,ku){xe.call(this),this.type='CircleBufferGeometry',this.parameters={radius:Fu,segments:Hu,thetaStart:Vu,thetaLength:ku},Fu=Fu||1,Hu=Hu===void 0?8:Math.max(3,Hu),Vu=Vu===void 0?0:Vu,ku=ku===void 0?2*Math.PI:ku;var Wu=[],ju=[],qu=[],Xu=[],Yu,Zu,Ju=new A,Qu=new S;for(ju.push(0,0,0),qu.push(0,0,1),Xu.push(0.5,0.5),(Zu=0,Yu=3);Zu<=Hu;Zu++,Yu+=3){var Ku=Vu+Zu/Hu*ku;Ju.x=Fu*Math.cos(Ku),Ju.y=Fu*Math.sin(Ku),ju.push(Ju.x,Ju.y,Ju.z),qu.push(0,0,1),Qu.x=(ju[Yu]/Fu+1)/2,Qu.y=(ju[Yu+1]/Fu+1)/2,Xu.push(Qu.x,Qu.y)}for(Yu=1;Yu<=Hu;Yu++)Wu.push(Yu,Yu+1,0);this.setIndex(Wu),this.addAttribute('position',new ge(ju,3)),this.addAttribute('normal',new ge(qu,3)),this.addAttribute('uv',new ge(Xu,2))}function Ka(Fu){Te.call(this),this.type='ShadowMaterial',this.color=new W(0),this.transparent=!0,this.setValues(Fu)}function $a(Fu){Ee.call(this,Fu),this.type='RawShaderMaterial'}function eo(Fu){Te.call(this),this.defines={STANDARD:''},this.type='MeshStandardMaterial',this.color=new W(16777215),this.roughness=0.5,this.metalness=0.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Fu)}function ro(Fu){eo.call(this),this.defines={PHYSICAL:''},this.type='MeshPhysicalMaterial',this.reflectivity=0.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(Fu)}function ao(Fu){Te.call(this),this.type='MeshPhongMaterial',this.color=new W(16777215),this.specular=new W(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ys,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Fu)}function oo(Fu){ao.call(this),this.defines={TOON:''},this.type='MeshToonMaterial',this.gradientMap=null,this.setValues(Fu)}function io(Fu){Te.call(this),this.type='MeshNormalMaterial',this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Fu)}function no(Fu){Te.call(this),this.type='MeshLambertMaterial',this.color=new W(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ys,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Fu)}function so(Fu){if(Te.call(this),this.defines={MATCAP:''},this.type='MeshMatcapMaterial',this.color=new W(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(Fu),null===this.matcap){var Hu=document.createElement('canvas');Hu.width=1,Hu.height=1;var Vu=Hu.getContext('2d');Vu.fillStyle='#fff',Vu.fillRect(0,0,1,1),this.matcap=new THREE.CanvasTexture(Hu)}}function lo(Fu){Tr.call(this),this.type='LineDashedMaterial',this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(Fu)}function po(Fu,Hu,Vu,ku){this.parameterPositions=Fu,this._cachedIndex=0,this.resultBuffer=ku===void 0?new Hu.constructor(Vu):ku,this.sampleValues=Hu,this.valueSize=Vu}function co(Fu,Hu,Vu,ku){po.call(this,Fu,Hu,Vu,ku),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function uo(Fu,Hu,Vu,ku){po.call(this,Fu,Hu,Vu,ku)}function mo(Fu,Hu,Vu,ku){po.call(this,Fu,Hu,Vu,ku)}function go(Fu,Hu,Vu,ku){if(Fu===void 0)throw new Error('THREE.KeyframeTrack: track name is undefined');if(void 0===Hu||0===Hu.length)throw new Error('THREE.KeyframeTrack: no keyframes in track named '+Fu);this.name=Fu,this.times=mu.convertArray(Hu,this.TimeBufferType),this.values=mu.convertArray(Vu,this.ValueBufferType),this.setInterpolation(ku||this.DefaultInterpolation)}function fo(Fu,Hu,Vu){go.call(this,Fu,Hu,Vu)}function yo(Fu,Hu,Vu,ku){go.call(this,Fu,Hu,Vu,ku)}function xo(Fu,Hu,Vu,ku){go.call(this,Fu,Hu,Vu,ku)}function vo(Fu,Hu,Vu,ku){po.call(this,Fu,Hu,Vu,ku)}function _o(Fu,Hu,Vu,ku){go.call(this,Fu,Hu,Vu,ku)}function bo(Fu,Hu,Vu,ku){go.call(this,Fu,Hu,Vu,ku)}function Mo(Fu,Hu,Vu,ku){go.call(this,Fu,Hu,Vu,ku)}function So(Fu,Hu,Vu){this.name=Fu,this.tracks=Vu,this.duration=Hu===void 0?-1:Hu,this.uuid=fp.generateUUID(),0>this.duration&&this.resetDuration()}function To(Fu){switch(Fu.toLowerCase()){case'scalar':case'double':case'float':case'number':case'integer':return xo;case'vector':case'vector2':case'vector3':case'vector4':return Mo;case'color':return yo;case'quaternion':return _o;case'bool':case'boolean':return fo;case'string':return bo;}throw new Error('THREE.KeyframeTrack: Unsupported typeName: '+Fu)}function Eo(Fu){if(Fu.type===void 0)throw new Error('THREE.KeyframeTrack: track type undefined, can not parse');var Hu=To(Fu.type);if(Fu.times===void 0){var Vu=[],ku=[];mu.flattenJSON(Fu.keys,Vu,ku,'value'),Fu.times=Vu,Fu.values=ku}return void 0===Hu.parse?new Hu(Fu.name,Fu.times,Fu.values,Fu.interpolation):Hu.parse(Fu)}function wo(Fu,Hu,Vu){var ku=this,Wu=!1,ju=0,qu=0,Xu;this.onStart=void 0,this.onLoad=Fu,this.onProgress=Hu,this.onError=Vu,this.itemStart=function(Yu){qu++,!1==Wu&&ku.onStart!==void 0&&ku.onStart(Yu,ju,qu),Wu=!0},this.itemEnd=function(Yu){ju++,ku.onProgress!==void 0&&ku.onProgress(Yu,ju,qu),ju==qu&&(Wu=!1,ku.onLoad!==void 0&&ku.onLoad())},this.itemError=function(Yu){ku.onError!==void 0&&ku.onError(Yu)},this.resolveURL=function(Yu){return Xu?Xu(Yu):Yu},this.setURLModifier=function(Yu){return Xu=Yu,this}}function Lo(Fu){this.manager=Fu===void 0?fu:Fu}function Ro(Fu){this.manager=Fu===void 0?fu:Fu}function Io(Fu){this.manager=Fu===void 0?fu:Fu}function Do(Fu){this.manager=Fu===void 0?fu:Fu}function zo(){this.type='Curve',this.arcLengthDivisions=200}function No(Fu,Hu,Vu,ku,Wu,ju,qu,Xu){zo.call(this),this.type='EllipseCurve',this.aX=Fu||0,this.aY=Hu||0,this.xRadius=Vu||1,this.yRadius=ku||1,this.aStartAngle=Wu||0,this.aEndAngle=ju||2*Math.PI,this.aClockwise=qu||!1,this.aRotation=Xu||0}function Bo(Fu,Hu,Vu,ku,Wu,ju){No.call(this,Fu,Hu,Vu,Vu,ku,Wu,ju),this.type='ArcCurve'}function Uo(){function Fu(ju,qu,Xu,Yu){Hu=ju,Vu=Xu,ku=-3*ju+3*qu-2*Xu-Yu,Wu=2*ju-2*qu+Xu+Yu}var Hu=0,Vu=0,ku=0,Wu=0;return{initCatmullRom:function(ju,qu,Xu,Yu,Zu){Fu(qu,Xu,Zu*(Xu-ju),Zu*(Yu-qu))},initNonuniformCatmullRom:function(ju,qu,Xu,Yu,Zu,Ju,Qu){var Ku=(qu-ju)/Zu-(Xu-ju)/(Zu+Ju)+(Xu-qu)/Ju,$u=(Xu-qu)/Ju-(Yu-qu)/(Ju+Qu)+(Yu-Xu)/Qu;Ku*=Ju,$u*=Ju,Fu(qu,Xu,Ku,$u)},calc:function(ju){var qu=ju*ju;return Hu+Vu*ju+ku*qu+Wu*(qu*ju)}}}function Go(Fu,Hu,Vu,ku){zo.call(this),this.type='CatmullRomCurve3',this.points=Fu||[],this.closed=Hu||!1,this.curveType=Vu||'centripetal',this.tension=ku||0.5}function Oo(Fu,Hu,Vu,ku,Wu){var ju=0.5*(ku-Hu),qu=0.5*(Wu-Vu),Xu=Fu*Fu;return(2*Vu-2*ku+ju+qu)*(Fu*Xu)+(-3*Vu+3*ku-2*ju-qu)*Xu+ju*Fu+Vu}function Fo(Fu,Hu){var Vu=1-Fu;return Vu*Vu*Hu}function Ho(Fu,Hu){return 2*(1-Fu)*Fu*Hu}function Vo(Fu,Hu){return Fu*Fu*Hu}function ko(Fu,Hu,Vu,ku){return Fo(Fu,Hu)+Ho(Fu,Vu)+Vo(Fu,ku)}function Wo(Fu,Hu){var Vu=1-Fu;return Vu*Vu*Vu*Hu}function jo(Fu,Hu){var Vu=1-Fu;return 3*Vu*Vu*Fu*Hu}function qo(Fu,Hu){return 3*(1-Fu)*Fu*Fu*Hu}function Xo(Fu,Hu){return Fu*Fu*Fu*Hu}function Yo(Fu,Hu,Vu,ku,Wu){return Wo(Fu,Hu)+jo(Fu,Vu)+qo(Fu,ku)+Xo(Fu,Wu)}function Zo(Fu,Hu,Vu,ku){zo.call(this),this.type='CubicBezierCurve',this.v0=Fu||new S,this.v1=Hu||new S,this.v2=Vu||new S,this.v3=ku||new S}function Jo(Fu,Hu,Vu,ku){zo.call(this),this.type='CubicBezierCurve3',this.v0=Fu||new A,this.v1=Hu||new A,this.v2=Vu||new A,this.v3=ku||new A}function Qo(Fu,Hu){zo.call(this),this.type='LineCurve',this.v1=Fu||new S,this.v2=Hu||new S}function Ko(Fu,Hu){zo.call(this),this.type='LineCurve3',this.v1=Fu||new A,this.v2=Hu||new A}function $o(Fu,Hu,Vu){zo.call(this),this.type='QuadraticBezierCurve',this.v0=Fu||new S,this.v1=Hu||new S,this.v2=Vu||new S}function ei(Fu,Hu,Vu){zo.call(this),this.type='QuadraticBezierCurve3',this.v0=Fu||new A,this.v1=Hu||new A,this.v2=Vu||new A}function ti(Fu){zo.call(this),this.type='SplineCurve',this.points=Fu||[]}function ri(){zo.call(this),this.type='CurvePath',this.curves=[],this.autoClose=!1}function ai(Fu){ri.call(this),this.type='Path',this.currentPoint=new S,Fu&&this.setFromPoints(Fu)}function oi(Fu){ai.call(this,Fu),this.uuid=fp.generateUUID(),this.type='Shape',this.holes=[]}function ii(Fu,Hu){K.call(this),this.type='Light',this.color=new W(Fu),this.intensity=Hu===void 0?1:Hu,this.receiveShadow=void 0}function ni(Fu,Hu,Vu){ii.call(this,Fu,Vu),this.type='HemisphereLight',this.castShadow=void 0,this.position.copy(K.DefaultUp),this.updateMatrix(),this.groundColor=new W(Hu)}function si(Fu){this.camera=Fu,this.bias=0,this.radius=1,this.mapSize=new S(512,512),this.map=null,this.matrix=new E}function li(){si.call(this,new nr(50,1,0.5,500))}function pi(Fu,Hu,Vu,ku,Wu,ju){ii.call(this,Fu,Hu),this.type='SpotLight',this.position.copy(K.DefaultUp),this.updateMatrix(),this.target=new K,Object.defineProperty(this,'power',{get:function(){return this.intensity*Math.PI},set:function(qu){this.intensity=qu/Math.PI}}),this.distance=Vu===void 0?0:Vu,this.angle=ku===void 0?Math.PI/3:ku,this.penumbra=Wu===void 0?0:Wu,this.decay=ju===void 0?1:ju,this.shadow=new li}function di(Fu,Hu,Vu,ku){ii.call(this,Fu,Hu),this.type='PointLight',Object.defineProperty(this,'power',{get:function(){return 4*this.intensity*Math.PI},set:function(Wu){this.intensity=Wu/(4*Math.PI)}}),this.distance=Vu===void 0?0:Vu,this.decay=ku===void 0?1:ku,this.shadow=new si(new nr(90,1,0.5,500))}function ci(Fu,Hu,Vu,ku,Wu,ju){ir.call(this),this.type='OrthographicCamera',this.zoom=1,this.view=null,this.left=Fu===void 0?-1:Fu,this.right=Hu===void 0?1:Hu,this.top=Vu===void 0?1:Vu,this.bottom=ku===void 0?-1:ku,this.near=Wu===void 0?0.1:Wu,this.far=ju===void 0?2e3:ju,this.updateProjectionMatrix()}function ui(){si.call(this,new ci(-5,5,5,-5,0.5,500))}function mi(Fu,Hu){ii.call(this,Fu,Hu),this.type='DirectionalLight',this.position.copy(K.DefaultUp),this.updateMatrix(),this.target=new K,this.shadow=new ui}function gi(Fu,Hu){ii.call(this,Fu,Hu),this.type='AmbientLight',this.castShadow=void 0}function hi(Fu,Hu,Vu,ku){ii.call(this,Fu,Hu),this.type='RectAreaLight',this.width=Vu===void 0?10:Vu,this.height=ku===void 0?10:ku}function yi(Fu){this.manager=Fu===void 0?fu:Fu,this.textures={}}function xi(Fu){this.manager=Fu===void 0?fu:Fu}function vi(){}function _i(Fu){'boolean'==typeof Fu&&(console.warn('THREE.JSONLoader: showStatus parameter has been removed from constructor.'),Fu=void 0),this.manager=Fu===void 0?fu:Fu,this.withCredentials=!1}function bi(Fu){this.manager=Fu===void 0?fu:Fu,this.resourcePath=''}function Mi(){this.type='ShapePath',this.color=new W,this.subPaths=[],this.currentPath=null}function Si(Fu){this.type='Font',this.data=Fu}function Ti(Fu,Hu,Vu){for(var ku=Array.from?Array.from(Fu):(Fu+'').split(''),Wu=Hu/Vu.resolution,ju=(Vu.boundingBox.yMax-Vu.boundingBox.yMin+Vu.underlineThickness)*Wu,qu=[],Xu=0,Yu=0,Zu=0,Ju;Zu<ku.length;Zu++)if(Ju=ku[Zu],'\n'===Ju)Xu=0,Yu-=ju;else{var Qu=Ei(Ju,Wu,Xu,Yu,Vu);Xu+=Qu.offsetX,qu.push(Qu.path)}return qu}function Ei(Fu,Hu,Vu,ku,Wu){var ju=Wu.glyphs[Fu]||Wu.glyphs['?'];if(ju){var qu=new Mi,Xu,Yu,Zu,Ju,Qu,Ku,$u,em;if(ju.o)for(var tm=ju._cachedOutline||(ju._cachedOutline=ju.o.split(' ')),rm=0,am=tm.length,om;rm<am;)om=tm[rm++],'m'===om?(Xu=tm[rm++]*Hu+Vu,Yu=tm[rm++]*Hu+ku,qu.moveTo(Xu,Yu)):'l'===om?(Xu=tm[rm++]*Hu+Vu,Yu=tm[rm++]*Hu+ku,qu.lineTo(Xu,Yu)):'q'===om?(Zu=tm[rm++]*Hu+Vu,Ju=tm[rm++]*Hu+ku,Qu=tm[rm++]*Hu+Vu,Ku=tm[rm++]*Hu+ku,qu.quadraticCurveTo(Qu,Ku,Zu,Ju)):'b'===om?(Zu=tm[rm++]*Hu+Vu,Ju=tm[rm++]*Hu+ku,Qu=tm[rm++]*Hu+Vu,Ku=tm[rm++]*Hu+ku,$u=tm[rm++]*Hu+Vu,em=tm[rm++]*Hu+ku,qu.bezierCurveTo(Qu,Ku,$u,em,Zu,Ju)):void 0;return{offsetX:ju.ha*Hu,path:qu}}}function Li(Fu){this.manager=Fu===void 0?fu:Fu}function Pi(Fu,Hu,Vu,ku){K.call(this),this.type='CubeCamera';var Wu=90,ju=1,qu=new nr(Wu,ju,Fu,Hu);qu.up.set(0,-1,0),qu.lookAt(new A(1,0,0)),this.add(qu);var Xu=new nr(Wu,ju,Fu,Hu);Xu.up.set(0,-1,0),Xu.lookAt(new A(-1,0,0)),this.add(Xu);var Yu=new nr(Wu,ju,Fu,Hu);Yu.up.set(0,0,1),Yu.lookAt(new A(0,1,0)),this.add(Yu);var Zu=new nr(Wu,ju,Fu,Hu);Zu.up.set(0,0,-1),Zu.lookAt(new A(0,-1,0)),this.add(Zu);var Ju=new nr(Wu,ju,Fu,Hu);Ju.up.set(0,-1,0),Ju.lookAt(new A(0,0,1)),this.add(Ju);var Qu=new nr(Wu,ju,Fu,Hu);Qu.up.set(0,-1,0),Qu.lookAt(new A(0,0,-1)),this.add(Qu),ku=ku||{format:al,magFilter:Fs,minFilter:Fs},this.renderTarget=new U(Vu,Vu,ku),this.renderTarget.texture.name='CubeCamera',this.update=function(Ku,$u){null===this.parent&&this.updateMatrixWorld();var em=this.renderTarget,tm=em.texture.generateMipmaps;em.texture.generateMipmaps=!1,em.activeCubeFace=0,Ku.render($u,qu,em),em.activeCubeFace=1,Ku.render($u,Xu,em),em.activeCubeFace=2,Ku.render($u,Yu,em),em.activeCubeFace=3,Ku.render($u,Zu,em),em.activeCubeFace=4,Ku.render($u,Ju,em),em.texture.generateMipmaps=tm,em.activeCubeFace=5,Ku.render($u,Qu,em),Ku.setRenderTarget(null)},this.clear=function(Ku,$u,em,tm){for(var rm=this.renderTarget,am=0;6>am;am++)rm.activeCubeFace=am,Ku.setRenderTarget(rm),Ku.clear($u,em,tm);Ku.setRenderTarget(null)}}function Ci(Fu){this.autoStart=!(Fu!==void 0)||Fu,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ri(){K.call(this),this.type='AudioListener',this.context=Au.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Ii(Fu){K.call(this),this.type='Audio',this.listener=Fu,this.context=Fu.context,this.gain=this.context.createGain(),this.gain.connect(Fu.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType='empty',this.filters=[]}function Di(Fu){Ii.call(this,Fu),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function zi(Fu,Hu){this.analyser=Fu.context.createAnalyser(),this.analyser.fftSize=Hu===void 0?2048:Hu,this.data=new Uint8Array(this.analyser.frequencyBinCount),Fu.getOutput().connect(this.analyser)}function Ni(Fu,Hu,Vu){this.binding=Fu,this.valueSize=Vu;var ku=Float64Array,Wu;'quaternion'===Hu?Wu=this._slerp:'string'===Hu||'bool'===Hu?(ku=Array,Wu=this._select):Wu=this._lerp;this.buffer=new ku(4*Vu),this._mixBufferRegion=Wu,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Bi(Fu,Hu,Vu){var ku=Vu||Ui.parseTrackName(Hu);this._targetGroup=Fu,this._bindings=Fu.subscribe_(Hu,ku)}function Ui(Fu,Hu,Vu){this.path=Hu,this.parsedPath=Vu||Ui.parseTrackName(Hu),this.node=Ui.findNode(Fu,this.parsedPath.nodeName)||Fu,this.rootNode=Fu}function Oi(Fu,Hu,Vu){this._mixer=Fu,this._clip=Hu,this._localRoot=Vu||null;for(var ku=Hu.tracks,Wu=ku.length,ju=Array(Wu),qu={endingStart:Jl,endingEnd:Jl},Xu=0,Yu;Xu!==Wu;++Xu)Yu=ku[Xu].createInterpolant(null),ju[Xu]=Yu,Yu.settings=qu;this._interpolantSettings=qu,this._interpolants=ju,this._propertyBindings=Array(Wu),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Fi(Fu){this._root=Fu,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Hi(Fu){'string'==typeof Fu&&(console.warn('THREE.Uniform: Type parameter is no longer needed.'),Fu=arguments[1]),this.value=Fu}function Vi(){xe.call(this),this.type='InstancedBufferGeometry',this.maxInstancedCount=void 0}function ki(Fu,Hu,Vu){fr.call(this,Fu,Hu),this.meshPerAttribute=Vu||1}function Wi(Fu,Hu,Vu,ku){'number'==typeof Vu&&(ku=Vu,Vu=!1,console.error('THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.')),re.call(this,Fu,Hu,Vu),this.meshPerAttribute=ku||1}function qi(Fu,Hu){return Fu.distance-Hu.distance}function Xi(Fu,Hu,Vu,ku){if(!1!==Fu.visible&&(Fu.raycast(Hu,Vu),!0===ku))for(var Wu=Fu.children,ju=0,qu=Wu.length;ju<qu;ju++)Xi(Wu[ju],Hu,Vu,!0)}function Ji(Fu,Hu){this.min=Fu===void 0?new S(+Infinity,+Infinity):Fu,this.max=Hu===void 0?new S(-Infinity,-Infinity):Hu}function Qi(Fu,Hu){this.start=Fu===void 0?new A:Fu,this.end=Hu===void 0?new A:Hu}function Ki(Fu){K.call(this),this.material=Fu,this.render=function(){}}function $i(Fu,Hu,Vu,ku){this.object=Fu,this.size=Hu===void 0?1:Hu;var Wu=Vu===void 0?16711680:Vu,ju=ku===void 0?1:ku,qu=0,Xu=this.object.geometry;Xu&&Xu.isGeometry?qu=3*Xu.faces.length:Xu&&Xu.isBufferGeometry&&(qu=Xu.attributes.normal.count);var Yu=new xe,Zu=new ge(3*(2*qu),3);Yu.addAttribute('position',Zu),wr.call(this,Yu,new Tr({color:Wu,linewidth:ju})),this.matrixAutoUpdate=!1,this.update()}function en(Fu,Hu){K.call(this),this.light=Fu,this.light.updateMatrixWorld(),this.matrix=Fu.matrixWorld,this.matrixAutoUpdate=!1,this.color=Hu;for(var Vu=new xe,ku=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],Wu=0,ju=1,qu=32;Wu<qu;Wu++,ju++){var Xu=2*(Wu/qu*Math.PI),Yu=2*(ju/qu*Math.PI);ku.push(Math.cos(Xu),Math.sin(Xu),1,Math.cos(Yu),Math.sin(Yu),1)}Vu.addAttribute('position',new ge(ku,3));var Zu=new Tr({fog:!1});this.cone=new wr(Vu,Zu),this.add(this.cone),this.update()}function tn(Fu){var Hu=[];Fu&&Fu.isBone&&Hu.push(Fu);for(var Vu=0;Vu<Fu.children.length;Vu++)Hu.push.apply(Hu,tn(Fu.children[Vu]));return Hu}function rn(Fu){for(var Hu=tn(Fu),Vu=new xe,ku=[],Wu=[],ju=new W(0,0,1),qu=new W(0,1,0),Xu=0,Yu;Xu<Hu.length;Xu++)Yu=Hu[Xu],Yu.parent&&Yu.parent.isBone&&(ku.push(0,0,0),ku.push(0,0,0),Wu.push(ju.r,ju.g,ju.b),Wu.push(qu.r,qu.g,qu.b));Vu.addAttribute('position',new ge(ku,3)),Vu.addAttribute('color',new ge(Wu,3));var Zu=new Tr({vertexColors:On,depthTest:!1,depthWrite:!1,transparent:!0});wr.call(this,Vu,Zu),this.root=Fu,this.bones=Hu,this.matrix=Fu.matrixWorld,this.matrixAutoUpdate=!1}function on(Fu,Hu,Vu){this.light=Fu,this.light.updateMatrixWorld(),this.color=Vu;var ku=new Ba(Hu,4,2),Wu=new Ae({wireframe:!0,fog:!1});Pe.call(this,ku,Wu),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function nn(Fu,Hu){K.call(this),this.light=Fu,this.light.updateMatrixWorld(),this.matrix=Fu.matrixWorld,this.matrixAutoUpdate=!1,this.color=Hu;var Vu=new Tr({fog:!1}),ku=new xe;ku.addAttribute('position',new re(new Float32Array(15),3)),this.line=new Er(ku,Vu),this.add(this.line),this.update()}function sn(Fu,Hu,Vu){K.call(this),this.light=Fu,this.light.updateMatrixWorld(),this.matrix=Fu.matrixWorld,this.matrixAutoUpdate=!1,this.color=Vu;var ku=new Vr(Hu);ku.rotateY(0.5*Math.PI),this.material=new Ae({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=On);var Wu=ku.getAttribute('position'),ju=new Float32Array(3*Wu.count);ku.addAttribute('color',new re(ju,3)),this.add(new Pe(ku,this.material)),this.update()}function ln(Fu,Hu,Vu,ku){Fu=Fu||10,Hu=Hu||10,Vu=new W(Vu===void 0?4473924:Vu),ku=new W(ku===void 0?8947848:ku);for(var Wu=Hu/2,ju=Fu/Hu,qu=Fu/2,Xu=[],Yu=[],Zu=0,Ju=0,Qu=-qu;Zu<=Hu;Zu++,Qu+=ju){Xu.push(-qu,0,Qu,qu,0,Qu),Xu.push(Qu,0,-qu,Qu,0,qu);var Ku=Zu===Wu?Vu:ku;Ku.toArray(Yu,Ju),Ju+=3,Ku.toArray(Yu,Ju),Ju+=3,Ku.toArray(Yu,Ju),Ju+=3,Ku.toArray(Yu,Ju),Ju+=3}var $u=new xe;$u.addAttribute('position',new ge(Xu,3)),$u.addAttribute('color',new ge(Yu,3));var em=new Tr({vertexColors:On});wr.call(this,$u,em)}function pn(Fu,Hu,Vu,ku,Wu,ju){Fu=Fu||10,Hu=Hu||16,Vu=Vu||8,ku=ku||64,Wu=new W(Wu===void 0?4473924:Wu),ju=new W(ju===void 0?8947848:ju);var qu=[],Xu=[],Yu,Zu,Ju,Qu,Ku,$u,em;for(Qu=0;Qu<=Hu;Qu++)Ju=Qu/Hu*(2*Math.PI),Yu=Math.sin(Ju)*Fu,Zu=Math.cos(Ju)*Fu,qu.push(0,0,0),qu.push(Yu,0,Zu),em=1&Qu?Wu:ju,Xu.push(em.r,em.g,em.b),Xu.push(em.r,em.g,em.b);for(Qu=0;Qu<=Vu;Qu++)for(em=1&Qu?Wu:ju,$u=Fu-Fu/Vu*Qu,Ku=0;Ku<ku;Ku++)Ju=Ku/ku*(2*Math.PI),Yu=Math.sin(Ju)*$u,Zu=Math.cos(Ju)*$u,qu.push(Yu,0,Zu),Xu.push(em.r,em.g,em.b),Ju=(Ku+1)/ku*(2*Math.PI),Yu=Math.sin(Ju)*$u,Zu=Math.cos(Ju)*$u,qu.push(Yu,0,Zu),Xu.push(em.r,em.g,em.b);var tm=new xe;tm.addAttribute('position',new ge(qu,3)),tm.addAttribute('color',new ge(Xu,3));var rm=new Tr({vertexColors:On});wr.call(this,tm,rm)}function dn(Fu,Hu,Vu,ku){this.object=Fu,this.size=Hu===void 0?1:Hu;var Wu=Vu===void 0?16776960:Vu,ju=ku===void 0?1:ku,qu=0,Xu=this.object.geometry;Xu&&Xu.isGeometry?qu=Xu.faces.length:console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');var Yu=new xe,Zu=new ge(3*(2*qu),3);Yu.addAttribute('position',Zu),wr.call(this,Yu,new Tr({color:Wu,linewidth:ju})),this.matrixAutoUpdate=!1,this.update()}function cn(Fu,Hu,Vu){K.call(this),this.light=Fu,this.light.updateMatrixWorld(),this.matrix=Fu.matrixWorld,this.matrixAutoUpdate=!1,this.color=Vu,Hu===void 0&&(Hu=1);var ku=new xe;ku.addAttribute('position',new ge([-Hu,Hu,0,Hu,Hu,0,Hu,-Hu,0,-Hu,-Hu,0,-Hu,Hu,0],3));var Wu=new Tr({fog:!1});this.lightPlane=new Er(ku,Wu),this.add(this.lightPlane),ku=new xe,ku.addAttribute('position',new ge([0,0,0,0,0,1],3)),this.targetLine=new Er(ku,Wu),this.add(this.targetLine),this.update()}function un(Fu){function Hu($u,em,tm){Vu($u,tm),Vu(em,tm)}function Vu($u,em){ju.push(0,0,0),qu.push(em.r,em.g,em.b),Xu[$u]===void 0&&(Xu[$u]=[]),Xu[$u].push(ju.length/3-1)}var ku=new xe,Wu=new Tr({color:16777215,vertexColors:Gn}),ju=[],qu=[],Xu={},Yu=new W(16755200),Zu=new W(16711680),Ju=new W(43775),Qu=new W(16777215),Ku=new W(3355443);Hu('n1','n2',Yu),Hu('n2','n4',Yu),Hu('n4','n3',Yu),Hu('n3','n1',Yu),Hu('f1','f2',Yu),Hu('f2','f4',Yu),Hu('f4','f3',Yu),Hu('f3','f1',Yu),Hu('n1','f1',Yu),Hu('n2','f2',Yu),Hu('n3','f3',Yu),Hu('n4','f4',Yu),Hu('p','n1',Zu),Hu('p','n2',Zu),Hu('p','n3',Zu),Hu('p','n4',Zu),Hu('u1','u2',Ju),Hu('u2','u3',Ju),Hu('u3','u1',Ju),Hu('c','t',Qu),Hu('p','c',Ku),Hu('cn1','cn2',Ku),Hu('cn3','cn4',Ku),Hu('cf1','cf2',Ku),Hu('cf3','cf4',Ku),ku.addAttribute('position',new ge(ju,3)),ku.addAttribute('color',new ge(qu,3)),wr.call(this,ku,Wu),this.camera=Fu,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=Fu.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Xu,this.update()}function mn(Fu,Hu){this.object=Fu,Hu===void 0&&(Hu=16776960);var Vu=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ku=new Float32Array(24),Wu=new xe;Wu.setIndex(new re(Vu,1)),Wu.addAttribute('position',new re(ku,3)),wr.call(this,Wu,new Tr({color:Hu})),this.matrixAutoUpdate=!1,this.update()}function gn(Fu,Hu){this.type='Box3Helper',this.box=Fu;var Vu=Hu===void 0?16776960:Hu,ku=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ju=new xe;ju.setIndex(new re(ku,1)),ju.addAttribute('position',new ge([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),wr.call(this,ju,new Tr({color:Vu})),this.geometry.computeBoundingSphere()}function fn(Fu,Hu,Vu){this.type='PlaneHelper',this.plane=Fu,this.size=Hu===void 0?1:Hu;var ku=Vu===void 0?16776960:Vu,ju=new xe;ju.addAttribute('position',new ge([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),ju.computeBoundingSphere(),Er.call(this,ju,new Tr({color:ku}));var Xu=new xe;Xu.addAttribute('position',new ge([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),Xu.computeBoundingSphere(),this.add(new Pe(Xu,new Ae({color:ku,opacity:0.2,transparent:!0,depthWrite:!1})))}function hn(Fu,Hu,Vu,ku,Wu,ju){K.call(this),Fu===void 0&&(Fu=new THREE.Vector3(0,0,1)),Hu===void 0&&(Hu=new THREE.Vector3(0,0,0)),Vu===void 0&&(Vu=1),ku===void 0&&(ku=16776960),Wu===void 0&&(Wu=0.2*Vu),ju===void 0&&(ju=0.2*Wu),Cu===void 0&&(Cu=new xe,Cu.addAttribute('position',new ge([0,0,0,0,1,0],3)),Ru=new Xa(0,0.5,1,5,1),Ru.translate(0,-0.5,0)),this.position.copy(Hu),this.line=new Er(Cu,new Tr({color:ku})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Pe(Ru,new Ae({color:ku})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(Fu),this.setLength(Vu,Wu,ju)}function yn(Fu){Fu=Fu||1;var Hu=[0,0,0,Fu,0,0,0,0,0,0,Fu,0,0,0,0,0,0,Fu],ku=new xe;ku.addAttribute('position',new ge(Hu,3)),ku.addAttribute('color',new ge([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3));var Wu=new Tr({vertexColors:On});wr.call(this,ku,Wu)}function xn(Fu){console.warn('THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.'),Go.call(this,Fu),this.type='catmullrom'}function vn(){try{var Fu=document.createElement('canvas');return!!(window.WebGLRenderingContext&&(Fu.getContext('webgl')||Fu.getContext('experimental-webgl')))}catch(Hu){return!1}}function bn(){Du=window.innerWidth,zu=window.innerHeight,Bu=new gr,Nu=new nr(75,Du/zu,0.1,10),Nu.position.set(0,3.5,5),Nu.lookAt(Bu.position),Mn(),Sn()}function Mn(){let Fu=new _e(1.5,1.5,1.5),Hu=new io;Uu=new Pe(Fu,Hu),Uu.position.y=0.5,Bu.add(Uu)}function Sn(){Iu=new cr({antialias:!0}),Iu.setClearColor(13293815,1),Iu.setSize(Du,zu),document.body.prepend(Iu.domElement),window.addEventListener('resize',wn,!1)}function Tn(){Uu.rotation.x+=Ou,Uu.rotation.y+=Ou,Uu.rotation.z+=Ou}function En(){requestAnimationFrame(En),Tn(),Iu.render(Bu,Nu)}function wn(){zu=window.innerHeight,Du=window.innerWidth,Iu.setSize(Du,zu),Nu.aspect=Du/zu,Nu.updateProjectionMatrix()}Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(Fu){return'number'==typeof Fu&&isFinite(Fu)&&Math.floor(Fu)===Fu}),Math.sign===void 0&&(Math.sign=function(Fu){return 0>Fu?-1:0<Fu?1:+Fu}),!1=='name'in Function.prototype&&Object.defineProperty(Function.prototype,'name',{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&function(){Object.assign=function(Fu){if(Fu===void 0||null===Fu)throw new TypeError('Cannot convert undefined or null to object');for(var Hu=Object(Fu),Vu=1,ku;Vu<arguments.length;Vu++)if(ku=arguments[Vu],void 0!==ku&&null!==ku)for(var Wu in ku)Object.prototype.hasOwnProperty.call(ku,Wu)&&(Hu[Wu]=ku[Wu]);return Hu}}(),Object.assign(M.prototype,{addEventListener:function(Fu,Hu){this._listeners===void 0&&(this._listeners={});var Vu=this._listeners;Vu[Fu]===void 0&&(Vu[Fu]=[]),-1===Vu[Fu].indexOf(Hu)&&Vu[Fu].push(Hu)},hasEventListener:function(Fu,Hu){if(this._listeners===void 0)return!1;var Vu=this._listeners;return Vu[Fu]!==void 0&&-1!==Vu[Fu].indexOf(Hu)},removeEventListener:function(Fu,Hu){if(void 0!==this._listeners){var Vu=this._listeners,ku=Vu[Fu];if(void 0!==ku){var Wu=ku.indexOf(Hu);-1!==Wu&&ku.splice(Wu,1)}}},dispatchEvent:function(Fu){if(void 0!==this._listeners){var Hu=this._listeners,Vu=Hu[Fu.type];if(void 0!==Vu){Fu.target=this;for(var ku=Vu.slice(0),Wu=0,ju=ku.length;Wu<ju;Wu++)ku[Wu].call(this,Fu)}}}});var Pn=1,Rn=1,Dn=0,zn=1,Nn=2,Bn=1,Un=0,Gn=1,On=2,Fn=0,Hn=1,Vn=2,kn=3,Wn=4,jn=5,qn=100,Zn=103,Jn=104,ts=204,rs=205,us=3,ys=0,_s=0,Ms=1,ws=300,Ls=301,As=302,Ps=303,Cs=304,Rs=305,Is=306,Ds=307,zs=1e3,Ns=1001,Bs=1002,Us=1003,Gs=1004,Os=1005,Fs=1006,Hs=1007,Vs=1008,ks=1009,qs=1012,Ys=1014,Zs=1015,Js=1016,el=1020,al=1022,nl=1023,cl=1026,ul=1027,xl=33776,_l=33777,bl=33778,Ml=33779,Sl=35840,Tl=35841,El=35842,wl=35843,Xl=2300,Yl=2301,Zl=2302,Jl=2400,Ql=2401,Kl=2402,$l=0,rp=3e3,op=3007,mp=0,fp={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var Fu=[],Hu=0;256>Hu;Hu++)Fu[Hu]=(16>Hu?'0':'')+Hu.toString(16);return function(){var ku=0|4294967295*Math.random(),Wu=0|4294967295*Math.random(),ju=0|4294967295*Math.random(),qu=0|4294967295*Math.random(),Xu=Fu[255&ku]+Fu[255&ku>>8]+Fu[255&ku>>16]+Fu[255&ku>>24]+'-'+Fu[255&Wu]+Fu[255&Wu>>8]+'-'+Fu[64|15&Wu>>16]+Fu[255&Wu>>24]+'-'+Fu[128|63&ju]+Fu[255&ju>>8]+'-'+Fu[255&ju>>16]+Fu[255&ju>>24]+Fu[255&qu]+Fu[255&qu>>8]+Fu[255&qu>>16]+Fu[255&qu>>24];return Xu.toUpperCase()}}(),clamp:function(Fu,Hu,Vu){return Math.max(Hu,Math.min(Vu,Fu))},euclideanModulo:function(Fu,Hu){return(Fu%Hu+Hu)%Hu},mapLinear:function(Fu,Hu,Vu,ku,Wu){return ku+(Fu-Hu)*(Wu-ku)/(Vu-Hu)},lerp:function(Fu,Hu,Vu){return(1-Vu)*Fu+Vu*Hu},smoothstep:function(Fu,Hu,Vu){return Fu<=Hu?0:Fu>=Vu?1:(Fu=(Fu-Hu)/(Vu-Hu),Fu*Fu*(3-2*Fu))},smootherstep:function(Fu,Hu,Vu){return Fu<=Hu?0:Fu>=Vu?1:(Fu=(Fu-Hu)/(Vu-Hu),Fu*Fu*Fu*(Fu*(6*Fu-15)+10))},randInt:function(Fu,Hu){return Fu+Math.floor(Math.random()*(Hu-Fu+1))},randFloat:function(Fu,Hu){return Fu+Math.random()*(Hu-Fu)},randFloatSpread:function(Fu){return Fu*(0.5-Math.random())},degToRad:function(Fu){return Fu*fp.DEG2RAD},radToDeg:function(Fu){return Fu*fp.RAD2DEG},isPowerOfTwo:function(Fu){return 0==(Fu&Fu-1)&&0!==Fu},ceilPowerOfTwo:function(Fu){return Math.pow(2,Math.ceil(Math.log(Fu)/Math.LN2))},floorPowerOfTwo:function(Fu){return Math.pow(2,Math.floor(Math.log(Fu)/Math.LN2))}};Object.defineProperties(S.prototype,{width:{get:function(){return this.x},set:function(Fu){this.x=Fu}},height:{get:function(){return this.y},set:function(Fu){this.y=Fu}}}),Object.assign(S.prototype,{isVector2:!0,set:function(Fu,Hu){return this.x=Fu,this.y=Hu,this},setScalar:function(Fu){return this.x=Fu,this.y=Fu,this},setX:function(Fu){return this.x=Fu,this},setY:function(Fu){return this.y=Fu,this},setComponent:function(Fu,Hu){switch(Fu){case 0:this.x=Hu;break;case 1:this.y=Hu;break;default:throw new Error('index is out of range: '+Fu);}return this},getComponent:function(Fu){switch(Fu){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+Fu);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(Fu){return this.x=Fu.x,this.y=Fu.y,this},add:function(Fu,Hu){return void 0===Hu?(this.x+=Fu.x,this.y+=Fu.y,this):(console.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Fu,Hu))},addScalar:function(Fu){return this.x+=Fu,this.y+=Fu,this},addVectors:function(Fu,Hu){return this.x=Fu.x+Hu.x,this.y=Fu.y+Hu.y,this},addScaledVector:function(Fu,Hu){return this.x+=Fu.x*Hu,this.y+=Fu.y*Hu,this},sub:function(Fu,Hu){return void 0===Hu?(this.x-=Fu.x,this.y-=Fu.y,this):(console.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Fu,Hu))},subScalar:function(Fu){return this.x-=Fu,this.y-=Fu,this},subVectors:function(Fu,Hu){return this.x=Fu.x-Hu.x,this.y=Fu.y-Hu.y,this},multiply:function(Fu){return this.x*=Fu.x,this.y*=Fu.y,this},multiplyScalar:function(Fu){return this.x*=Fu,this.y*=Fu,this},divide:function(Fu){return this.x/=Fu.x,this.y/=Fu.y,this},divideScalar:function(Fu){return this.multiplyScalar(1/Fu)},applyMatrix3:function(Fu){var Hu=this.x,Vu=this.y,ku=Fu.elements;return this.x=ku[0]*Hu+ku[3]*Vu+ku[6],this.y=ku[1]*Hu+ku[4]*Vu+ku[7],this},min:function(Fu){return this.x=Math.min(this.x,Fu.x),this.y=Math.min(this.y,Fu.y),this},max:function(Fu){return this.x=Math.max(this.x,Fu.x),this.y=Math.max(this.y,Fu.y),this},clamp:function(Fu,Hu){return this.x=Math.max(Fu.x,Math.min(Hu.x,this.x)),this.y=Math.max(Fu.y,Math.min(Hu.y,this.y)),this},clampScalar:function(){var Fu=new S,Hu=new S;return function(ku,Wu){return Fu.set(ku,ku),Hu.set(Wu,Wu),this.clamp(Fu,Hu)}}(),clampLength:function(Fu,Hu){var Vu=this.length();return this.divideScalar(Vu||1).multiplyScalar(Math.max(Fu,Math.min(Hu,Vu)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(Fu){return this.x*Fu.x+this.y*Fu.y},cross:function(Fu){return this.x*Fu.y-this.y*Fu.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var Fu=Math.atan2(this.y,this.x);return 0>Fu&&(Fu+=2*Math.PI),Fu},distanceTo:function(Fu){return Math.sqrt(this.distanceToSquared(Fu))},distanceToSquared:function(Fu){var Hu=this.x-Fu.x,Vu=this.y-Fu.y;return Hu*Hu+Vu*Vu},manhattanDistanceTo:function(Fu){return Math.abs(this.x-Fu.x)+Math.abs(this.y-Fu.y)},setLength:function(Fu){return this.normalize().multiplyScalar(Fu)},lerp:function(Fu,Hu){return this.x+=(Fu.x-this.x)*Hu,this.y+=(Fu.y-this.y)*Hu,this},lerpVectors:function(Fu,Hu,Vu){return this.subVectors(Hu,Fu).multiplyScalar(Vu).add(Fu)},equals:function(Fu){return Fu.x===this.x&&Fu.y===this.y},fromArray:function(Fu,Hu){return void 0===Hu&&(Hu=0),this.x=Fu[Hu],this.y=Fu[Hu+1],this},toArray:function(Fu,Hu){return void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0),Fu[Hu]=this.x,Fu[Hu+1]=this.y,Fu},fromBufferAttribute:function(Fu,Hu,Vu){return void 0!==Vu&&console.warn('THREE.Vector2: offset has been removed from .fromBufferAttribute().'),this.x=Fu.getX(Hu),this.y=Fu.getY(Hu),this},rotateAround:function(Fu,Hu){var Vu=Math.cos(Hu),ku=Math.sin(Hu),Wu=this.x-Fu.x,ju=this.y-Fu.y;return this.x=Wu*Vu-ju*ku+Fu.x,this.y=Wu*ku+ju*Vu+Fu.y,this}}),Object.assign(E.prototype,{isMatrix4:!0,set:function(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu,Ku,$u,em,tm){var rm=this.elements;return rm[0]=Fu,rm[4]=Hu,rm[8]=Vu,rm[12]=ku,rm[1]=Wu,rm[5]=ju,rm[9]=qu,rm[13]=Xu,rm[2]=Yu,rm[6]=Zu,rm[10]=Ju,rm[14]=Qu,rm[3]=Ku,rm[7]=$u,rm[11]=em,rm[15]=tm,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new E().fromArray(this.elements)},copy:function(Fu){var Hu=this.elements,Vu=Fu.elements;return Hu[0]=Vu[0],Hu[1]=Vu[1],Hu[2]=Vu[2],Hu[3]=Vu[3],Hu[4]=Vu[4],Hu[5]=Vu[5],Hu[6]=Vu[6],Hu[7]=Vu[7],Hu[8]=Vu[8],Hu[9]=Vu[9],Hu[10]=Vu[10],Hu[11]=Vu[11],Hu[12]=Vu[12],Hu[13]=Vu[13],Hu[14]=Vu[14],Hu[15]=Vu[15],this},copyPosition:function(Fu){var Hu=this.elements,Vu=Fu.elements;return Hu[12]=Vu[12],Hu[13]=Vu[13],Hu[14]=Vu[14],this},extractBasis:function(Fu,Hu,Vu){return Fu.setFromMatrixColumn(this,0),Hu.setFromMatrixColumn(this,1),Vu.setFromMatrixColumn(this,2),this},makeBasis:function(Fu,Hu,Vu){return this.set(Fu.x,Hu.x,Vu.x,0,Fu.y,Hu.y,Vu.y,0,Fu.z,Hu.z,Vu.z,0,0,0,0,1),this},extractRotation:function(){var Fu=new A;return function(Vu){var ku=this.elements,Wu=Vu.elements,ju=1/Fu.setFromMatrixColumn(Vu,0).length(),qu=1/Fu.setFromMatrixColumn(Vu,1).length(),Xu=1/Fu.setFromMatrixColumn(Vu,2).length();return ku[0]=Wu[0]*ju,ku[1]=Wu[1]*ju,ku[2]=Wu[2]*ju,ku[3]=0,ku[4]=Wu[4]*qu,ku[5]=Wu[5]*qu,ku[6]=Wu[6]*qu,ku[7]=0,ku[8]=Wu[8]*Xu,ku[9]=Wu[9]*Xu,ku[10]=Wu[10]*Xu,ku[11]=0,ku[12]=0,ku[13]=0,ku[14]=0,ku[15]=1,this}}(),makeRotationFromEuler:function(Fu){Fu&&Fu.isEuler||console.error('THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');var Hu=this.elements,Vu=Fu.x,ku=Fu.y,Wu=Fu.z,ju=Math.cos(Vu),qu=Math.sin(Vu),Xu=Math.cos(ku),Yu=Math.sin(ku),Zu=Math.cos(Wu),Ju=Math.sin(Wu);if('XYZ'===Fu.order){var Qu=ju*Zu,Ku=ju*Ju,$u=qu*Zu,em=qu*Ju;Hu[0]=Xu*Zu,Hu[4]=-Xu*Ju,Hu[8]=Yu,Hu[1]=Ku+$u*Yu,Hu[5]=Qu-em*Yu,Hu[9]=-qu*Xu,Hu[2]=em-Qu*Yu,Hu[6]=$u+Ku*Yu,Hu[10]=ju*Xu}else if('YXZ'===Fu.order){var tm=Xu*Zu,rm=Xu*Ju,am=Yu*Zu,om=Yu*Ju;Hu[0]=tm+om*qu,Hu[4]=am*qu-rm,Hu[8]=ju*Yu,Hu[1]=ju*Ju,Hu[5]=ju*Zu,Hu[9]=-qu,Hu[2]=rm*qu-am,Hu[6]=om+tm*qu,Hu[10]=ju*Xu}else if('ZXY'===Fu.order){var tm=Xu*Zu,rm=Xu*Ju,am=Yu*Zu,om=Yu*Ju;Hu[0]=tm-om*qu,Hu[4]=-ju*Ju,Hu[8]=am+rm*qu,Hu[1]=rm+am*qu,Hu[5]=ju*Zu,Hu[9]=om-tm*qu,Hu[2]=-ju*Yu,Hu[6]=qu,Hu[10]=ju*Xu}else if('ZYX'===Fu.order){var Qu=ju*Zu,Ku=ju*Ju,$u=qu*Zu,em=qu*Ju;Hu[0]=Xu*Zu,Hu[4]=$u*Yu-Ku,Hu[8]=Qu*Yu+em,Hu[1]=Xu*Ju,Hu[5]=em*Yu+Qu,Hu[9]=Ku*Yu-$u,Hu[2]=-Yu,Hu[6]=qu*Xu,Hu[10]=ju*Xu}else if('YZX'===Fu.order){var im=ju*Xu,nm=ju*Yu,sm=qu*Xu,lm=qu*Yu;Hu[0]=Xu*Zu,Hu[4]=lm-im*Ju,Hu[8]=sm*Ju+nm,Hu[1]=Ju,Hu[5]=ju*Zu,Hu[9]=-qu*Zu,Hu[2]=-Yu*Zu,Hu[6]=nm*Ju+sm,Hu[10]=im-lm*Ju}else if('XZY'===Fu.order){var im=ju*Xu,nm=ju*Yu,sm=qu*Xu,lm=qu*Yu;Hu[0]=Xu*Zu,Hu[4]=-Ju,Hu[8]=Yu*Zu,Hu[1]=im*Ju+lm,Hu[5]=ju*Zu,Hu[9]=nm*Ju-sm,Hu[2]=sm*Ju-nm,Hu[6]=qu*Zu,Hu[10]=lm*Ju+im}return Hu[3]=0,Hu[7]=0,Hu[11]=0,Hu[12]=0,Hu[13]=0,Hu[14]=0,Hu[15]=1,this},makeRotationFromQuaternion:function(){var Fu=new A(0,0,0),Hu=new A(1,1,1);return function(ku){return this.compose(Fu,ku,Hu)}}(),lookAt:function(){var Fu=new A,Hu=new A,Vu=new A;return function(Wu,ju,qu){var Xu=this.elements;return Vu.subVectors(Wu,ju),0===Vu.lengthSq()&&(Vu.z=1),Vu.normalize(),Fu.crossVectors(qu,Vu),0===Fu.lengthSq()&&(1===Math.abs(qu.z)?Vu.x+=1e-4:Vu.z+=1e-4,Vu.normalize(),Fu.crossVectors(qu,Vu)),Fu.normalize(),Hu.crossVectors(Vu,Fu),Xu[0]=Fu.x,Xu[4]=Hu.x,Xu[8]=Vu.x,Xu[1]=Fu.y,Xu[5]=Hu.y,Xu[9]=Vu.y,Xu[2]=Fu.z,Xu[6]=Hu.z,Xu[10]=Vu.z,this}}(),multiply:function(Fu,Hu){return void 0===Hu?this.multiplyMatrices(this,Fu):(console.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.'),this.multiplyMatrices(Fu,Hu))},premultiply:function(Fu){return this.multiplyMatrices(Fu,this)},multiplyMatrices:function(Fu,Hu){var Vu=Fu.elements,ku=Hu.elements,Wu=this.elements,ju=Vu[0],qu=Vu[4],Xu=Vu[8],Yu=Vu[12],Zu=Vu[1],Ju=Vu[5],Qu=Vu[9],Ku=Vu[13],$u=Vu[2],em=Vu[6],tm=Vu[10],rm=Vu[14],am=Vu[3],om=Vu[7],im=Vu[11],nm=Vu[15],sm=ku[0],lm=ku[4],pm=ku[8],dm=ku[12],cm=ku[1],um=ku[5],mm=ku[9],gm=ku[13],fm=ku[2],hm=ku[6],ym=ku[10],xm=ku[14],vm=ku[3],_m=ku[7],bm=ku[11],Mm=ku[15];return Wu[0]=ju*sm+qu*cm+Xu*fm+Yu*vm,Wu[4]=ju*lm+qu*um+Xu*hm+Yu*_m,Wu[8]=ju*pm+qu*mm+Xu*ym+Yu*bm,Wu[12]=ju*dm+qu*gm+Xu*xm+Yu*Mm,Wu[1]=Zu*sm+Ju*cm+Qu*fm+Ku*vm,Wu[5]=Zu*lm+Ju*um+Qu*hm+Ku*_m,Wu[9]=Zu*pm+Ju*mm+Qu*ym+Ku*bm,Wu[13]=Zu*dm+Ju*gm+Qu*xm+Ku*Mm,Wu[2]=$u*sm+em*cm+tm*fm+rm*vm,Wu[6]=$u*lm+em*um+tm*hm+rm*_m,Wu[10]=$u*pm+em*mm+tm*ym+rm*bm,Wu[14]=$u*dm+em*gm+tm*xm+rm*Mm,Wu[3]=am*sm+om*cm+im*fm+nm*vm,Wu[7]=am*lm+om*um+im*hm+nm*_m,Wu[11]=am*pm+om*mm+im*ym+nm*bm,Wu[15]=am*dm+om*gm+im*xm+nm*Mm,this},multiplyScalar:function(Fu){var Hu=this.elements;return Hu[0]*=Fu,Hu[4]*=Fu,Hu[8]*=Fu,Hu[12]*=Fu,Hu[1]*=Fu,Hu[5]*=Fu,Hu[9]*=Fu,Hu[13]*=Fu,Hu[2]*=Fu,Hu[6]*=Fu,Hu[10]*=Fu,Hu[14]*=Fu,Hu[3]*=Fu,Hu[7]*=Fu,Hu[11]*=Fu,Hu[15]*=Fu,this},applyToBufferAttribute:function(){var Fu=new A;return function(Vu){for(var ku=0,Wu=Vu.count;ku<Wu;ku++)Fu.x=Vu.getX(ku),Fu.y=Vu.getY(ku),Fu.z=Vu.getZ(ku),Fu.applyMatrix4(this),Vu.setXYZ(ku,Fu.x,Fu.y,Fu.z);return Vu}}(),determinant:function(){var Fu=this.elements,Hu=Fu[0],Vu=Fu[4],ku=Fu[8],Wu=Fu[12],ju=Fu[1],qu=Fu[5],Xu=Fu[9],Yu=Fu[13],Zu=Fu[2],Ju=Fu[6],Qu=Fu[10],Ku=Fu[14],$u=Fu[3],em=Fu[7],tm=Fu[11],rm=Fu[15];return $u*(+Wu*Xu*Ju-ku*Yu*Ju-Wu*qu*Qu+Vu*Yu*Qu+ku*qu*Ku-Vu*Xu*Ku)+em*(+Hu*Xu*Ku-Hu*Yu*Qu+Wu*ju*Qu-ku*ju*Ku+ku*Yu*Zu-Wu*Xu*Zu)+tm*(+Hu*Yu*Ju-Hu*qu*Ku-Wu*ju*Ju+Vu*ju*Ku+Wu*qu*Zu-Vu*Yu*Zu)+rm*(-ku*qu*Zu-Hu*Xu*Ju+Hu*qu*Qu+ku*ju*Ju-Vu*ju*Qu+Vu*Xu*Zu)},transpose:function(){var Fu=this.elements,Hu;return Hu=Fu[1],Fu[1]=Fu[4],Fu[4]=Hu,Hu=Fu[2],Fu[2]=Fu[8],Fu[8]=Hu,Hu=Fu[6],Fu[6]=Fu[9],Fu[9]=Hu,Hu=Fu[3],Fu[3]=Fu[12],Fu[12]=Hu,Hu=Fu[7],Fu[7]=Fu[13],Fu[13]=Hu,Hu=Fu[11],Fu[11]=Fu[14],Fu[14]=Hu,this},setPosition:function(Fu){var Hu=this.elements;return Hu[12]=Fu.x,Hu[13]=Fu.y,Hu[14]=Fu.z,this},getInverse:function(Fu,Hu){var Vu=this.elements,ku=Fu.elements,Wu=ku[0],ju=ku[1],qu=ku[2],Xu=ku[3],Yu=ku[4],Zu=ku[5],Ju=ku[6],Qu=ku[7],Ku=ku[8],$u=ku[9],em=ku[10],tm=ku[11],rm=ku[12],am=ku[13],om=ku[14],im=ku[15],nm=$u*om*Qu-am*em*Qu+am*Ju*tm-Zu*om*tm-$u*Ju*im+Zu*em*im,sm=rm*em*Qu-Ku*om*Qu-rm*Ju*tm+Yu*om*tm+Ku*Ju*im-Yu*em*im,lm=Ku*am*Qu-rm*$u*Qu+rm*Zu*tm-Yu*am*tm-Ku*Zu*im+Yu*$u*im,pm=rm*$u*Ju-Ku*am*Ju-rm*Zu*em+Yu*am*em+Ku*Zu*om-Yu*$u*om,dm=Wu*nm+ju*sm+qu*lm+Xu*pm;if(0==dm){var cm='THREE.Matrix4: .getInverse() can\'t invert matrix, determinant is 0';if(!0===Hu)throw new Error(cm);else console.warn(cm);return this.identity()}var um=1/dm;return Vu[0]=nm*um,Vu[1]=(am*em*Xu-$u*om*Xu-am*qu*tm+ju*om*tm+$u*qu*im-ju*em*im)*um,Vu[2]=(Zu*om*Xu-am*Ju*Xu+am*qu*Qu-ju*om*Qu-Zu*qu*im+ju*Ju*im)*um,Vu[3]=($u*Ju*Xu-Zu*em*Xu-$u*qu*Qu+ju*em*Qu+Zu*qu*tm-ju*Ju*tm)*um,Vu[4]=sm*um,Vu[5]=(Ku*om*Xu-rm*em*Xu+rm*qu*tm-Wu*om*tm-Ku*qu*im+Wu*em*im)*um,Vu[6]=(rm*Ju*Xu-Yu*om*Xu-rm*qu*Qu+Wu*om*Qu+Yu*qu*im-Wu*Ju*im)*um,Vu[7]=(Yu*em*Xu-Ku*Ju*Xu+Ku*qu*Qu-Wu*em*Qu-Yu*qu*tm+Wu*Ju*tm)*um,Vu[8]=lm*um,Vu[9]=(rm*$u*Xu-Ku*am*Xu-rm*ju*tm+Wu*am*tm+Ku*ju*im-Wu*$u*im)*um,Vu[10]=(Yu*am*Xu-rm*Zu*Xu+rm*ju*Qu-Wu*am*Qu-Yu*ju*im+Wu*Zu*im)*um,Vu[11]=(Ku*Zu*Xu-Yu*$u*Xu-Ku*ju*Qu+Wu*$u*Qu+Yu*ju*tm-Wu*Zu*tm)*um,Vu[12]=pm*um,Vu[13]=(Ku*am*qu-rm*$u*qu+rm*ju*em-Wu*am*em-Ku*ju*om+Wu*$u*om)*um,Vu[14]=(rm*Zu*qu-Yu*am*qu-rm*ju*Ju+Wu*am*Ju+Yu*ju*om-Wu*Zu*om)*um,Vu[15]=(Yu*$u*qu-Ku*Zu*qu+Ku*ju*Ju-Wu*$u*Ju-Yu*ju*em+Wu*Zu*em)*um,this},scale:function(Fu){var Hu=this.elements,Vu=Fu.x,ku=Fu.y,Wu=Fu.z;return Hu[0]*=Vu,Hu[4]*=ku,Hu[8]*=Wu,Hu[1]*=Vu,Hu[5]*=ku,Hu[9]*=Wu,Hu[2]*=Vu,Hu[6]*=ku,Hu[10]*=Wu,Hu[3]*=Vu,Hu[7]*=ku,Hu[11]*=Wu,this},getMaxScaleOnAxis:function(){var Fu=this.elements,Hu=Fu[0]*Fu[0]+Fu[1]*Fu[1]+Fu[2]*Fu[2],Vu=Fu[4]*Fu[4]+Fu[5]*Fu[5]+Fu[6]*Fu[6],ku=Fu[8]*Fu[8]+Fu[9]*Fu[9]+Fu[10]*Fu[10];return Math.sqrt(Math.max(Hu,Vu,ku))},makeTranslation:function(Fu,Hu,Vu){return this.set(1,0,0,Fu,0,1,0,Hu,0,0,1,Vu,0,0,0,1),this},makeRotationX:function(Fu){var Hu=Math.cos(Fu),Vu=Math.sin(Fu);return this.set(1,0,0,0,0,Hu,-Vu,0,0,Vu,Hu,0,0,0,0,1),this},makeRotationY:function(Fu){var Hu=Math.cos(Fu),Vu=Math.sin(Fu);return this.set(Hu,0,Vu,0,0,1,0,0,-Vu,0,Hu,0,0,0,0,1),this},makeRotationZ:function(Fu){var Hu=Math.cos(Fu),Vu=Math.sin(Fu);return this.set(Hu,-Vu,0,0,Vu,Hu,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(Fu,Hu){var Vu=Math.cos(Hu),ku=Math.sin(Hu),Wu=1-Vu,ju=Fu.x,qu=Fu.y,Xu=Fu.z,Yu=Wu*ju,Zu=Wu*qu;return this.set(Yu*ju+Vu,Yu*qu-ku*Xu,Yu*Xu+ku*qu,0,Yu*qu+ku*Xu,Zu*qu+Vu,Zu*Xu-ku*ju,0,Yu*Xu-ku*qu,Zu*Xu+ku*ju,Wu*Xu*Xu+Vu,0,0,0,0,1),this},makeScale:function(Fu,Hu,Vu){return this.set(Fu,0,0,0,0,Hu,0,0,0,0,Vu,0,0,0,0,1),this},makeShear:function(Fu,Hu,Vu){return this.set(1,Hu,Vu,0,Fu,1,Vu,0,Fu,Hu,1,0,0,0,0,1),this},compose:function(Fu,Hu,Vu){var ku=this.elements,Wu=Hu._x,ju=Hu._y,qu=Hu._z,Xu=Hu._w,Yu=Wu+Wu,Zu=ju+ju,Ju=qu+qu,Qu=Wu*Yu,Ku=Wu*Zu,$u=Wu*Ju,em=ju*Zu,tm=ju*Ju,rm=qu*Ju,am=Xu*Yu,om=Xu*Zu,im=Xu*Ju,nm=Vu.x,sm=Vu.y,lm=Vu.z;return ku[0]=(1-(em+rm))*nm,ku[1]=(Ku+im)*nm,ku[2]=($u-om)*nm,ku[3]=0,ku[4]=(Ku-im)*sm,ku[5]=(1-(Qu+rm))*sm,ku[6]=(tm+am)*sm,ku[7]=0,ku[8]=($u+om)*lm,ku[9]=(tm-am)*lm,ku[10]=(1-(Qu+em))*lm,ku[11]=0,ku[12]=Fu.x,ku[13]=Fu.y,ku[14]=Fu.z,ku[15]=1,this},decompose:function(){var Fu=new A,Hu=new E;return function(ku,Wu,ju){var qu=this.elements,Xu=Fu.set(qu[0],qu[1],qu[2]).length(),Yu=Fu.set(qu[4],qu[5],qu[6]).length(),Zu=Fu.set(qu[8],qu[9],qu[10]).length(),Ju=this.determinant();0>Ju&&(Xu=-Xu),ku.x=qu[12],ku.y=qu[13],ku.z=qu[14],Hu.copy(this);var Qu=1/Xu,Ku=1/Yu,$u=1/Zu;return Hu.elements[0]*=Qu,Hu.elements[1]*=Qu,Hu.elements[2]*=Qu,Hu.elements[4]*=Ku,Hu.elements[5]*=Ku,Hu.elements[6]*=Ku,Hu.elements[8]*=$u,Hu.elements[9]*=$u,Hu.elements[10]*=$u,Wu.setFromRotationMatrix(Hu),ju.x=Xu,ju.y=Yu,ju.z=Zu,this}}(),makePerspective:function(Fu,Hu,Vu,ku,Wu,ju){void 0===ju&&console.warn('THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.');var qu=this.elements;return qu[0]=2*Wu/(Hu-Fu),qu[4]=0,qu[8]=(Hu+Fu)/(Hu-Fu),qu[12]=0,qu[1]=0,qu[5]=2*Wu/(Vu-ku),qu[9]=(Vu+ku)/(Vu-ku),qu[13]=0,qu[2]=0,qu[6]=0,qu[10]=-(ju+Wu)/(ju-Wu),qu[14]=-2*ju*Wu/(ju-Wu),qu[3]=0,qu[7]=0,qu[11]=-1,qu[15]=0,this},makeOrthographic:function(Fu,Hu,Vu,ku,Wu,ju){var qu=this.elements,Xu=1/(Hu-Fu),Yu=1/(Vu-ku),Zu=1/(ju-Wu);return qu[0]=2*Xu,qu[4]=0,qu[8]=0,qu[12]=-((Hu+Fu)*Xu),qu[1]=0,qu[5]=2*Yu,qu[9]=0,qu[13]=-((Vu+ku)*Yu),qu[2]=0,qu[6]=0,qu[10]=-2*Zu,qu[14]=-((ju+Wu)*Zu),qu[3]=0,qu[7]=0,qu[11]=0,qu[15]=1,this},equals:function(Fu){for(var Hu=this.elements,Vu=Fu.elements,ku=0;16>ku;ku++)if(Hu[ku]!==Vu[ku])return!1;return!0},fromArray:function(Fu,Hu){Hu===void 0&&(Hu=0);for(var Vu=0;16>Vu;Vu++)this.elements[Vu]=Fu[Vu+Hu];return this},toArray:function(Fu,Hu){void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0);var Vu=this.elements;return Fu[Hu]=Vu[0],Fu[Hu+1]=Vu[1],Fu[Hu+2]=Vu[2],Fu[Hu+3]=Vu[3],Fu[Hu+4]=Vu[4],Fu[Hu+5]=Vu[5],Fu[Hu+6]=Vu[6],Fu[Hu+7]=Vu[7],Fu[Hu+8]=Vu[8],Fu[Hu+9]=Vu[9],Fu[Hu+10]=Vu[10],Fu[Hu+11]=Vu[11],Fu[Hu+12]=Vu[12],Fu[Hu+13]=Vu[13],Fu[Hu+14]=Vu[14],Fu[Hu+15]=Vu[15],Fu}}),Object.assign(L,{slerp:function(Fu,Hu,Vu,ku){return Vu.copy(Fu).slerp(Hu,ku)},slerpFlat:function(Fu,Hu,Vu,ku,Wu,ju,qu){var Xu=Vu[ku+0],Yu=Vu[ku+1],Zu=Vu[ku+2],Ju=Vu[ku+3],Qu=Wu[ju+0],Ku=Wu[ju+1],$u=Wu[ju+2],em=Wu[ju+3];if(Ju!==em||Xu!==Qu||Yu!==Ku||Zu!==$u){var tm=1-qu,rm=Xu*Qu+Yu*Ku+Zu*$u+Ju*em,am=0<=rm?1:-1,om=1-rm*rm;if(om>Number.EPSILON){var im=Math.sqrt(om),nm=Math.atan2(im,rm*am);tm=Math.sin(tm*nm)/im,qu=Math.sin(qu*nm)/im}var sm=qu*am;if(Xu=Xu*tm+Qu*sm,Yu=Yu*tm+Ku*sm,Zu=Zu*tm+$u*sm,Ju=Ju*tm+em*sm,tm==1-qu){var lm=1/Math.sqrt(Xu*Xu+Yu*Yu+Zu*Zu+Ju*Ju);Xu*=lm,Yu*=lm,Zu*=lm,Ju*=lm}}Fu[Hu]=Xu,Fu[Hu+1]=Yu,Fu[Hu+2]=Zu,Fu[Hu+3]=Ju}}),Object.defineProperties(L.prototype,{x:{get:function(){return this._x},set:function(Fu){this._x=Fu,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Fu){this._y=Fu,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Fu){this._z=Fu,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(Fu){this._w=Fu,this.onChangeCallback()}}}),Object.assign(L.prototype,{isQuaternion:!0,set:function(Fu,Hu,Vu,ku){return this._x=Fu,this._y=Hu,this._z=Vu,this._w=ku,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(Fu){return this._x=Fu.x,this._y=Fu.y,this._z=Fu.z,this._w=Fu.w,this.onChangeCallback(),this},setFromEuler:function(Fu,Hu){if(!(Fu&&Fu.isEuler))throw new Error('THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');var Vu=Fu._x,ku=Fu._y,Wu=Fu._z,ju=Fu.order,qu=Math.cos,Xu=Math.sin,Yu=qu(Vu/2),Zu=qu(ku/2),Ju=qu(Wu/2),Qu=Xu(Vu/2),Ku=Xu(ku/2),$u=Xu(Wu/2);return'XYZ'===ju?(this._x=Qu*Zu*Ju+Yu*Ku*$u,this._y=Yu*Ku*Ju-Qu*Zu*$u,this._z=Yu*Zu*$u+Qu*Ku*Ju,this._w=Yu*Zu*Ju-Qu*Ku*$u):'YXZ'===ju?(this._x=Qu*Zu*Ju+Yu*Ku*$u,this._y=Yu*Ku*Ju-Qu*Zu*$u,this._z=Yu*Zu*$u-Qu*Ku*Ju,this._w=Yu*Zu*Ju+Qu*Ku*$u):'ZXY'===ju?(this._x=Qu*Zu*Ju-Yu*Ku*$u,this._y=Yu*Ku*Ju+Qu*Zu*$u,this._z=Yu*Zu*$u+Qu*Ku*Ju,this._w=Yu*Zu*Ju-Qu*Ku*$u):'ZYX'===ju?(this._x=Qu*Zu*Ju-Yu*Ku*$u,this._y=Yu*Ku*Ju+Qu*Zu*$u,this._z=Yu*Zu*$u-Qu*Ku*Ju,this._w=Yu*Zu*Ju+Qu*Ku*$u):'YZX'===ju?(this._x=Qu*Zu*Ju+Yu*Ku*$u,this._y=Yu*Ku*Ju+Qu*Zu*$u,this._z=Yu*Zu*$u-Qu*Ku*Ju,this._w=Yu*Zu*Ju-Qu*Ku*$u):'XZY'===ju&&(this._x=Qu*Zu*Ju-Yu*Ku*$u,this._y=Yu*Ku*Ju-Qu*Zu*$u,this._z=Yu*Zu*$u+Qu*Ku*Ju,this._w=Yu*Zu*Ju+Qu*Ku*$u),!1!==Hu&&this.onChangeCallback(),this},setFromAxisAngle:function(Fu,Hu){var Vu=Hu/2,ku=Math.sin(Vu);return this._x=Fu.x*ku,this._y=Fu.y*ku,this._z=Fu.z*ku,this._w=Math.cos(Vu),this.onChangeCallback(),this},setFromRotationMatrix:function(Fu){var Hu=Fu.elements,Vu=Hu[0],ku=Hu[4],Wu=Hu[8],ju=Hu[1],qu=Hu[5],Xu=Hu[9],Yu=Hu[2],Zu=Hu[6],Ju=Hu[10],Qu=Vu+qu+Ju,Ku;return 0<Qu?(Ku=0.5/Math.sqrt(Qu+1),this._w=0.25/Ku,this._x=(Zu-Xu)*Ku,this._y=(Wu-Yu)*Ku,this._z=(ju-ku)*Ku):Vu>qu&&Vu>Ju?(Ku=2*Math.sqrt(1+Vu-qu-Ju),this._w=(Zu-Xu)/Ku,this._x=0.25*Ku,this._y=(ku+ju)/Ku,this._z=(Wu+Yu)/Ku):qu>Ju?(Ku=2*Math.sqrt(1+qu-Vu-Ju),this._w=(Wu-Yu)/Ku,this._x=(ku+ju)/Ku,this._y=0.25*Ku,this._z=(Xu+Zu)/Ku):(Ku=2*Math.sqrt(1+Ju-Vu-qu),this._w=(ju-ku)/Ku,this._x=(Wu+Yu)/Ku,this._y=(Xu+Zu)/Ku,this._z=0.25*Ku),this.onChangeCallback(),this},setFromUnitVectors:function(){var Fu=new A,Hu;return function(Wu,ju){return void 0===Fu&&(Fu=new A),Hu=Wu.dot(ju)+1,Hu<1e-6?(Hu=0,Math.abs(Wu.x)>Math.abs(Wu.z)?Fu.set(-Wu.y,Wu.x,0):Fu.set(0,-Wu.z,Wu.y)):Fu.crossVectors(Wu,ju),this._x=Fu.x,this._y=Fu.y,this._z=Fu.z,this._w=Hu,this.normalize()}}(),angleTo:function(Fu){return 2*Math.acos(Math.abs(fp.clamp(this.dot(Fu),-1,1)))},rotateTowards:function(Fu,Hu){var Vu=this.angleTo(Fu);if(0===Vu)return this;var ku=Math.min(1,Hu/Vu);return this.slerp(Fu,ku),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(Fu){return this._x*Fu._x+this._y*Fu._y+this._z*Fu._z+this._w*Fu._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var Fu=this.length();return 0===Fu?(this._x=0,this._y=0,this._z=0,this._w=1):(Fu=1/Fu,this._x*=Fu,this._y*=Fu,this._z*=Fu,this._w*=Fu),this.onChangeCallback(),this},multiply:function(Fu,Hu){return void 0===Hu?this.multiplyQuaternions(this,Fu):(console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.'),this.multiplyQuaternions(Fu,Hu))},premultiply:function(Fu){return this.multiplyQuaternions(Fu,this)},multiplyQuaternions:function(Fu,Hu){var Vu=Fu._x,ku=Fu._y,Wu=Fu._z,ju=Fu._w,qu=Hu._x,Xu=Hu._y,Yu=Hu._z,Zu=Hu._w;return this._x=Vu*Zu+ju*qu+ku*Yu-Wu*Xu,this._y=ku*Zu+ju*Xu+Wu*qu-Vu*Yu,this._z=Wu*Zu+ju*Yu+Vu*Xu-ku*qu,this._w=ju*Zu-Vu*qu-ku*Xu-Wu*Yu,this.onChangeCallback(),this},slerp:function(Fu,Hu){if(0===Hu)return this;if(1===Hu)return this.copy(Fu);var Vu=this._x,ku=this._y,Wu=this._z,ju=this._w,qu=ju*Fu._w+Vu*Fu._x+ku*Fu._y+Wu*Fu._z;if(0>qu?(this._w=-Fu._w,this._x=-Fu._x,this._y=-Fu._y,this._z=-Fu._z,qu=-qu):this.copy(Fu),1<=qu)return this._w=ju,this._x=Vu,this._y=ku,this._z=Wu,this;var Xu=1-qu*qu;if(Xu<=Number.EPSILON){var Yu=1-Hu;return this._w=Yu*ju+Hu*this._w,this._x=Yu*Vu+Hu*this._x,this._y=Yu*ku+Hu*this._y,this._z=Yu*Wu+Hu*this._z,this.normalize()}var Zu=Math.sqrt(Xu),Ju=Math.atan2(Zu,qu),Qu=Math.sin((1-Hu)*Ju)/Zu,Ku=Math.sin(Hu*Ju)/Zu;return this._w=ju*Qu+this._w*Ku,this._x=Vu*Qu+this._x*Ku,this._y=ku*Qu+this._y*Ku,this._z=Wu*Qu+this._z*Ku,this.onChangeCallback(),this},equals:function(Fu){return Fu._x===this._x&&Fu._y===this._y&&Fu._z===this._z&&Fu._w===this._w},fromArray:function(Fu,Hu){return void 0===Hu&&(Hu=0),this._x=Fu[Hu],this._y=Fu[Hu+1],this._z=Fu[Hu+2],this._w=Fu[Hu+3],this.onChangeCallback(),this},toArray:function(Fu,Hu){return void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0),Fu[Hu]=this._x,Fu[Hu+1]=this._y,Fu[Hu+2]=this._z,Fu[Hu+3]=this._w,Fu},onChange:function(Fu){return this.onChangeCallback=Fu,this},onChangeCallback:function(){}}),Object.assign(A.prototype,{isVector3:!0,set:function(Fu,Hu,Vu){return this.x=Fu,this.y=Hu,this.z=Vu,this},setScalar:function(Fu){return this.x=Fu,this.y=Fu,this.z=Fu,this},setX:function(Fu){return this.x=Fu,this},setY:function(Fu){return this.y=Fu,this},setZ:function(Fu){return this.z=Fu,this},setComponent:function(Fu,Hu){switch(Fu){case 0:this.x=Hu;break;case 1:this.y=Hu;break;case 2:this.z=Hu;break;default:throw new Error('index is out of range: '+Fu);}return this},getComponent:function(Fu){switch(Fu){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+Fu);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(Fu){return this.x=Fu.x,this.y=Fu.y,this.z=Fu.z,this},add:function(Fu,Hu){return void 0===Hu?(this.x+=Fu.x,this.y+=Fu.y,this.z+=Fu.z,this):(console.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Fu,Hu))},addScalar:function(Fu){return this.x+=Fu,this.y+=Fu,this.z+=Fu,this},addVectors:function(Fu,Hu){return this.x=Fu.x+Hu.x,this.y=Fu.y+Hu.y,this.z=Fu.z+Hu.z,this},addScaledVector:function(Fu,Hu){return this.x+=Fu.x*Hu,this.y+=Fu.y*Hu,this.z+=Fu.z*Hu,this},sub:function(Fu,Hu){return void 0===Hu?(this.x-=Fu.x,this.y-=Fu.y,this.z-=Fu.z,this):(console.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Fu,Hu))},subScalar:function(Fu){return this.x-=Fu,this.y-=Fu,this.z-=Fu,this},subVectors:function(Fu,Hu){return this.x=Fu.x-Hu.x,this.y=Fu.y-Hu.y,this.z=Fu.z-Hu.z,this},multiply:function(Fu,Hu){return void 0===Hu?(this.x*=Fu.x,this.y*=Fu.y,this.z*=Fu.z,this):(console.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.'),this.multiplyVectors(Fu,Hu))},multiplyScalar:function(Fu){return this.x*=Fu,this.y*=Fu,this.z*=Fu,this},multiplyVectors:function(Fu,Hu){return this.x=Fu.x*Hu.x,this.y=Fu.y*Hu.y,this.z=Fu.z*Hu.z,this},applyEuler:function(){var Fu=new L;return function(Vu){return Vu&&Vu.isEuler||console.error('THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.'),this.applyQuaternion(Fu.setFromEuler(Vu))}}(),applyAxisAngle:function(){var Fu=new L;return function(Vu,ku){return this.applyQuaternion(Fu.setFromAxisAngle(Vu,ku))}}(),applyMatrix3:function(Fu){var Hu=this.x,Vu=this.y,ku=this.z,Wu=Fu.elements;return this.x=Wu[0]*Hu+Wu[3]*Vu+Wu[6]*ku,this.y=Wu[1]*Hu+Wu[4]*Vu+Wu[7]*ku,this.z=Wu[2]*Hu+Wu[5]*Vu+Wu[8]*ku,this},applyMatrix4:function(Fu){var Hu=this.x,Vu=this.y,ku=this.z,Wu=Fu.elements,ju=1/(Wu[3]*Hu+Wu[7]*Vu+Wu[11]*ku+Wu[15]);return this.x=(Wu[0]*Hu+Wu[4]*Vu+Wu[8]*ku+Wu[12])*ju,this.y=(Wu[1]*Hu+Wu[5]*Vu+Wu[9]*ku+Wu[13])*ju,this.z=(Wu[2]*Hu+Wu[6]*Vu+Wu[10]*ku+Wu[14])*ju,this},applyQuaternion:function(Fu){var Hu=this.x,Vu=this.y,ku=this.z,Wu=Fu.x,ju=Fu.y,qu=Fu.z,Xu=Fu.w,Yu=Xu*Hu+ju*ku-qu*Vu,Zu=Xu*Vu+qu*Hu-Wu*ku,Ju=Xu*ku+Wu*Vu-ju*Hu,Qu=-Wu*Hu-ju*Vu-qu*ku;return this.x=Yu*Xu+Qu*-Wu+Zu*-qu-Ju*-ju,this.y=Zu*Xu+Qu*-ju+Ju*-Wu-Yu*-qu,this.z=Ju*Xu+Qu*-qu+Yu*-ju-Zu*-Wu,this},project:function(Fu){return this.applyMatrix4(Fu.matrixWorldInverse).applyMatrix4(Fu.projectionMatrix)},unproject:function(){var Fu=new E;return function(Vu){return this.applyMatrix4(Fu.getInverse(Vu.projectionMatrix)).applyMatrix4(Vu.matrixWorld)}}(),transformDirection:function(Fu){var Hu=this.x,Vu=this.y,ku=this.z,Wu=Fu.elements;return this.x=Wu[0]*Hu+Wu[4]*Vu+Wu[8]*ku,this.y=Wu[1]*Hu+Wu[5]*Vu+Wu[9]*ku,this.z=Wu[2]*Hu+Wu[6]*Vu+Wu[10]*ku,this.normalize()},divide:function(Fu){return this.x/=Fu.x,this.y/=Fu.y,this.z/=Fu.z,this},divideScalar:function(Fu){return this.multiplyScalar(1/Fu)},min:function(Fu){return this.x=Math.min(this.x,Fu.x),this.y=Math.min(this.y,Fu.y),this.z=Math.min(this.z,Fu.z),this},max:function(Fu){return this.x=Math.max(this.x,Fu.x),this.y=Math.max(this.y,Fu.y),this.z=Math.max(this.z,Fu.z),this},clamp:function(Fu,Hu){return this.x=Math.max(Fu.x,Math.min(Hu.x,this.x)),this.y=Math.max(Fu.y,Math.min(Hu.y,this.y)),this.z=Math.max(Fu.z,Math.min(Hu.z,this.z)),this},clampScalar:function(){var Fu=new A,Hu=new A;return function(ku,Wu){return Fu.set(ku,ku,ku),Hu.set(Wu,Wu,Wu),this.clamp(Fu,Hu)}}(),clampLength:function(Fu,Hu){var Vu=this.length();return this.divideScalar(Vu||1).multiplyScalar(Math.max(Fu,Math.min(Hu,Vu)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(Fu){return this.x*Fu.x+this.y*Fu.y+this.z*Fu.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(Fu){return this.normalize().multiplyScalar(Fu)},lerp:function(Fu,Hu){return this.x+=(Fu.x-this.x)*Hu,this.y+=(Fu.y-this.y)*Hu,this.z+=(Fu.z-this.z)*Hu,this},lerpVectors:function(Fu,Hu,Vu){return this.subVectors(Hu,Fu).multiplyScalar(Vu).add(Fu)},cross:function(Fu,Hu){return void 0===Hu?this.crossVectors(this,Fu):(console.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.'),this.crossVectors(Fu,Hu))},crossVectors:function(Fu,Hu){var Vu=Fu.x,ku=Fu.y,Wu=Fu.z,ju=Hu.x,qu=Hu.y,Xu=Hu.z;return this.x=ku*Xu-Wu*qu,this.y=Wu*ju-Vu*Xu,this.z=Vu*qu-ku*ju,this},projectOnVector:function(Fu){var Hu=Fu.dot(this)/Fu.lengthSq();return this.copy(Fu).multiplyScalar(Hu)},projectOnPlane:function(){var Fu=new A;return function(Vu){return Fu.copy(this).projectOnVector(Vu),this.sub(Fu)}}(),reflect:function(){var Fu=new A;return function(Vu){return this.sub(Fu.copy(Vu).multiplyScalar(2*this.dot(Vu)))}}(),angleTo:function(Fu){var Hu=this.dot(Fu)/Math.sqrt(this.lengthSq()*Fu.lengthSq());return Math.acos(fp.clamp(Hu,-1,1))},distanceTo:function(Fu){return Math.sqrt(this.distanceToSquared(Fu))},distanceToSquared:function(Fu){var Hu=this.x-Fu.x,Vu=this.y-Fu.y,ku=this.z-Fu.z;return Hu*Hu+Vu*Vu+ku*ku},manhattanDistanceTo:function(Fu){return Math.abs(this.x-Fu.x)+Math.abs(this.y-Fu.y)+Math.abs(this.z-Fu.z)},setFromSpherical:function(Fu){return this.setFromSphericalCoords(Fu.radius,Fu.phi,Fu.theta)},setFromSphericalCoords:function(Fu,Hu,Vu){var ku=Math.sin(Hu)*Fu;return this.x=ku*Math.sin(Vu),this.y=Math.cos(Hu)*Fu,this.z=ku*Math.cos(Vu),this},setFromCylindrical:function(Fu){return this.setFromCylindricalCoords(Fu.radius,Fu.theta,Fu.y)},setFromCylindricalCoords:function(Fu,Hu,Vu){return this.x=Fu*Math.sin(Hu),this.y=Vu,this.z=Fu*Math.cos(Hu),this},setFromMatrixPosition:function(Fu){var Hu=Fu.elements;return this.x=Hu[12],this.y=Hu[13],this.z=Hu[14],this},setFromMatrixScale:function(Fu){var Hu=this.setFromMatrixColumn(Fu,0).length(),Vu=this.setFromMatrixColumn(Fu,1).length(),ku=this.setFromMatrixColumn(Fu,2).length();return this.x=Hu,this.y=Vu,this.z=ku,this},setFromMatrixColumn:function(Fu,Hu){return this.fromArray(Fu.elements,4*Hu)},equals:function(Fu){return Fu.x===this.x&&Fu.y===this.y&&Fu.z===this.z},fromArray:function(Fu,Hu){return void 0===Hu&&(Hu=0),this.x=Fu[Hu],this.y=Fu[Hu+1],this.z=Fu[Hu+2],this},toArray:function(Fu,Hu){return void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0),Fu[Hu]=this.x,Fu[Hu+1]=this.y,Fu[Hu+2]=this.z,Fu},fromBufferAttribute:function(Fu,Hu,Vu){return void 0!==Vu&&console.warn('THREE.Vector3: offset has been removed from .fromBufferAttribute().'),this.x=Fu.getX(Hu),this.y=Fu.getY(Hu),this.z=Fu.getZ(Hu),this}}),Object.assign(C.prototype,{isMatrix3:!0,set:function(Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu){var Zu=this.elements;return Zu[0]=Fu,Zu[1]=ku,Zu[2]=qu,Zu[3]=Hu,Zu[4]=Wu,Zu[5]=Xu,Zu[6]=Vu,Zu[7]=ju,Zu[8]=Yu,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(Fu){var Hu=this.elements,Vu=Fu.elements;return Hu[0]=Vu[0],Hu[1]=Vu[1],Hu[2]=Vu[2],Hu[3]=Vu[3],Hu[4]=Vu[4],Hu[5]=Vu[5],Hu[6]=Vu[6],Hu[7]=Vu[7],Hu[8]=Vu[8],this},setFromMatrix4:function(Fu){var Hu=Fu.elements;return this.set(Hu[0],Hu[4],Hu[8],Hu[1],Hu[5],Hu[9],Hu[2],Hu[6],Hu[10]),this},applyToBufferAttribute:function(){var Fu=new A;return function(Vu){for(var ku=0,Wu=Vu.count;ku<Wu;ku++)Fu.x=Vu.getX(ku),Fu.y=Vu.getY(ku),Fu.z=Vu.getZ(ku),Fu.applyMatrix3(this),Vu.setXYZ(ku,Fu.x,Fu.y,Fu.z);return Vu}}(),multiply:function(Fu){return this.multiplyMatrices(this,Fu)},premultiply:function(Fu){return this.multiplyMatrices(Fu,this)},multiplyMatrices:function(Fu,Hu){var Vu=Fu.elements,ku=Hu.elements,Wu=this.elements,ju=Vu[0],qu=Vu[3],Xu=Vu[6],Yu=Vu[1],Zu=Vu[4],Ju=Vu[7],Qu=Vu[2],Ku=Vu[5],$u=Vu[8],em=ku[0],tm=ku[3],rm=ku[6],am=ku[1],om=ku[4],im=ku[7],nm=ku[2],sm=ku[5],lm=ku[8];return Wu[0]=ju*em+qu*am+Xu*nm,Wu[3]=ju*tm+qu*om+Xu*sm,Wu[6]=ju*rm+qu*im+Xu*lm,Wu[1]=Yu*em+Zu*am+Ju*nm,Wu[4]=Yu*tm+Zu*om+Ju*sm,Wu[7]=Yu*rm+Zu*im+Ju*lm,Wu[2]=Qu*em+Ku*am+$u*nm,Wu[5]=Qu*tm+Ku*om+$u*sm,Wu[8]=Qu*rm+Ku*im+$u*lm,this},multiplyScalar:function(Fu){var Hu=this.elements;return Hu[0]*=Fu,Hu[3]*=Fu,Hu[6]*=Fu,Hu[1]*=Fu,Hu[4]*=Fu,Hu[7]*=Fu,Hu[2]*=Fu,Hu[5]*=Fu,Hu[8]*=Fu,this},determinant:function(){var Fu=this.elements,Hu=Fu[0],Vu=Fu[1],ku=Fu[2],Wu=Fu[3],ju=Fu[4],qu=Fu[5],Xu=Fu[6],Yu=Fu[7],Zu=Fu[8];return Hu*ju*Zu-Hu*qu*Yu-Vu*Wu*Zu+Vu*qu*Xu+ku*Wu*Yu-ku*ju*Xu},getInverse:function(Fu,Hu){Fu&&Fu.isMatrix4&&console.error('THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.');var Vu=Fu.elements,ku=this.elements,Wu=Vu[0],ju=Vu[1],qu=Vu[2],Xu=Vu[3],Yu=Vu[4],Zu=Vu[5],Ju=Vu[6],Qu=Vu[7],Ku=Vu[8],$u=Ku*Yu-Zu*Qu,em=Zu*Ju-Ku*Xu,tm=Qu*Xu-Yu*Ju,rm=Wu*$u+ju*em+qu*tm;if(0==rm){var am='THREE.Matrix3: .getInverse() can\'t invert matrix, determinant is 0';if(!0===Hu)throw new Error(am);else console.warn(am);return this.identity()}var om=1/rm;return ku[0]=$u*om,ku[1]=(qu*Qu-Ku*ju)*om,ku[2]=(Zu*ju-qu*Yu)*om,ku[3]=em*om,ku[4]=(Ku*Wu-qu*Ju)*om,ku[5]=(qu*Xu-Zu*Wu)*om,ku[6]=tm*om,ku[7]=(ju*Ju-Qu*Wu)*om,ku[8]=(Yu*Wu-ju*Xu)*om,this},transpose:function(){var Hu=this.elements,Fu;return Fu=Hu[1],Hu[1]=Hu[3],Hu[3]=Fu,Fu=Hu[2],Hu[2]=Hu[6],Hu[6]=Fu,Fu=Hu[5],Hu[5]=Hu[7],Hu[7]=Fu,this},getNormalMatrix:function(Fu){return this.setFromMatrix4(Fu).getInverse(this).transpose()},transposeIntoArray:function(Fu){var Hu=this.elements;return Fu[0]=Hu[0],Fu[1]=Hu[3],Fu[2]=Hu[6],Fu[3]=Hu[1],Fu[4]=Hu[4],Fu[5]=Hu[7],Fu[6]=Hu[2],Fu[7]=Hu[5],Fu[8]=Hu[8],this},setUvTransform:function(Fu,Hu,Vu,ku,Wu,ju,qu){var Xu=Math.cos(Wu),Yu=Math.sin(Wu);this.set(Vu*Xu,Vu*Yu,-Vu*(Xu*ju+Yu*qu)+ju+Fu,-ku*Yu,ku*Xu,-ku*(-Yu*ju+Xu*qu)+qu+Hu,0,0,1)},scale:function(Fu,Hu){var Vu=this.elements;return Vu[0]*=Fu,Vu[3]*=Fu,Vu[6]*=Fu,Vu[1]*=Hu,Vu[4]*=Hu,Vu[7]*=Hu,this},rotate:function(Fu){var Hu=Math.cos(Fu),Vu=Math.sin(Fu),ku=this.elements,Wu=ku[0],ju=ku[3],qu=ku[6],Xu=ku[1],Yu=ku[4],Zu=ku[7];return ku[0]=Hu*Wu+Vu*Xu,ku[3]=Hu*ju+Vu*Yu,ku[6]=Hu*qu+Vu*Zu,ku[1]=-Vu*Wu+Hu*Xu,ku[4]=-Vu*ju+Hu*Yu,ku[7]=-Vu*qu+Hu*Zu,this},translate:function(Fu,Hu){var Vu=this.elements;return Vu[0]+=Fu*Vu[2],Vu[3]+=Fu*Vu[5],Vu[6]+=Fu*Vu[8],Vu[1]+=Hu*Vu[2],Vu[4]+=Hu*Vu[5],Vu[7]+=Hu*Vu[8],this},equals:function(Fu){for(var Hu=this.elements,Vu=Fu.elements,ku=0;9>ku;ku++)if(Hu[ku]!==Vu[ku])return!1;return!0},fromArray:function(Fu,Hu){Hu===void 0&&(Hu=0);for(var Vu=0;9>Vu;Vu++)this.elements[Vu]=Fu[Vu+Hu];return this},toArray:function(Fu,Hu){void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0);var Vu=this.elements;return Fu[Hu]=Vu[0],Fu[Hu+1]=Vu[1],Fu[Hu+2]=Vu[2],Fu[Hu+3]=Vu[3],Fu[Hu+4]=Vu[4],Fu[Hu+5]=Vu[5],Fu[Hu+6]=Vu[6],Fu[Hu+7]=Vu[7],Fu[Hu+8]=Vu[8],Fu}});var hp={getDataURL:function(Fu){var Hu;if('undefined'==typeof HTMLCanvasElement)return Fu.src;if(Fu instanceof HTMLCanvasElement)Hu=Fu;else{Hu=document.createElementNS('http://www.w3.org/1999/xhtml','canvas'),Hu.width=Fu.width,Hu.height=Fu.height;var Vu=Hu.getContext('2d');Fu instanceof ImageData?Vu.putImageData(Fu,0,0):Vu.drawImage(Fu,0,0,Fu.width,Fu.height)}return 2048<Hu.width||2048<Hu.height?Hu.toDataURL('image/jpeg',0.6):Hu.toDataURL('image/png')}},yp=0;R.DEFAULT_IMAGE=void 0,R.DEFAULT_MAPPING=ws,R.prototype=Object.assign(Object.create(M.prototype),{constructor:R,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.name=Fu.name,this.image=Fu.image,this.mipmaps=Fu.mipmaps.slice(0),this.mapping=Fu.mapping,this.wrapS=Fu.wrapS,this.wrapT=Fu.wrapT,this.magFilter=Fu.magFilter,this.minFilter=Fu.minFilter,this.anisotropy=Fu.anisotropy,this.format=Fu.format,this.type=Fu.type,this.offset.copy(Fu.offset),this.repeat.copy(Fu.repeat),this.center.copy(Fu.center),this.rotation=Fu.rotation,this.matrixAutoUpdate=Fu.matrixAutoUpdate,this.matrix.copy(Fu.matrix),this.generateMipmaps=Fu.generateMipmaps,this.premultiplyAlpha=Fu.premultiplyAlpha,this.flipY=Fu.flipY,this.unpackAlignment=Fu.unpackAlignment,this.encoding=Fu.encoding,this},toJSON:function(Fu){var Hu=void 0===Fu||'string'==typeof Fu;if(!Hu&&void 0!==Fu.textures[this.uuid])return Fu.textures[this.uuid];var Vu={metadata:{version:4.5,type:'Texture',generator:'Texture.toJSON'},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var ku=this.image;if(void 0===ku.uuid&&(ku.uuid=fp.generateUUID()),!Hu&&void 0===Fu.images[ku.uuid]){var Wu;if(Array.isArray(ku)){Wu=[];for(var ju=0,qu=ku.length;ju<qu;ju++)Wu.push(hp.getDataURL(ku[ju]))}else Wu=hp.getDataURL(ku);Fu.images[ku.uuid]={uuid:ku.uuid,url:Wu}}Vu.image=ku.uuid}return Hu||(Fu.textures[this.uuid]=Vu),Vu},dispose:function(){this.dispatchEvent({type:'dispose'})},transformUv:function(Fu){if(this.mapping!==ws)return Fu;if(Fu.applyMatrix3(this.matrix),0>Fu.x||1<Fu.x)switch(this.wrapS){case zs:Fu.x-=Math.floor(Fu.x);break;case Ns:Fu.x=0>Fu.x?0:1;break;case Bs:1===Math.abs(Math.floor(Fu.x)%2)?Fu.x=Math.ceil(Fu.x)-Fu.x:Fu.x-=Math.floor(Fu.x);}if(0>Fu.y||1<Fu.y)switch(this.wrapT){case zs:Fu.y-=Math.floor(Fu.y);break;case Ns:Fu.y=0>Fu.y?0:1;break;case Bs:1===Math.abs(Math.floor(Fu.y)%2)?Fu.y=Math.ceil(Fu.y)-Fu.y:Fu.y-=Math.floor(Fu.y);}return this.flipY&&(Fu.y=1-Fu.y),Fu}}),Object.defineProperty(R.prototype,'needsUpdate',{set:function(Fu){!0===Fu&&this.version++}}),Object.assign(I.prototype,{isVector4:!0,set:function(Fu,Hu,Vu,ku){return this.x=Fu,this.y=Hu,this.z=Vu,this.w=ku,this},setScalar:function(Fu){return this.x=Fu,this.y=Fu,this.z=Fu,this.w=Fu,this},setX:function(Fu){return this.x=Fu,this},setY:function(Fu){return this.y=Fu,this},setZ:function(Fu){return this.z=Fu,this},setW:function(Fu){return this.w=Fu,this},setComponent:function(Fu,Hu){switch(Fu){case 0:this.x=Hu;break;case 1:this.y=Hu;break;case 2:this.z=Hu;break;case 3:this.w=Hu;break;default:throw new Error('index is out of range: '+Fu);}return this},getComponent:function(Fu){switch(Fu){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+Fu);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(Fu){return this.x=Fu.x,this.y=Fu.y,this.z=Fu.z,this.w=void 0===Fu.w?1:Fu.w,this},add:function(Fu,Hu){return void 0===Hu?(this.x+=Fu.x,this.y+=Fu.y,this.z+=Fu.z,this.w+=Fu.w,this):(console.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Fu,Hu))},addScalar:function(Fu){return this.x+=Fu,this.y+=Fu,this.z+=Fu,this.w+=Fu,this},addVectors:function(Fu,Hu){return this.x=Fu.x+Hu.x,this.y=Fu.y+Hu.y,this.z=Fu.z+Hu.z,this.w=Fu.w+Hu.w,this},addScaledVector:function(Fu,Hu){return this.x+=Fu.x*Hu,this.y+=Fu.y*Hu,this.z+=Fu.z*Hu,this.w+=Fu.w*Hu,this},sub:function(Fu,Hu){return void 0===Hu?(this.x-=Fu.x,this.y-=Fu.y,this.z-=Fu.z,this.w-=Fu.w,this):(console.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Fu,Hu))},subScalar:function(Fu){return this.x-=Fu,this.y-=Fu,this.z-=Fu,this.w-=Fu,this},subVectors:function(Fu,Hu){return this.x=Fu.x-Hu.x,this.y=Fu.y-Hu.y,this.z=Fu.z-Hu.z,this.w=Fu.w-Hu.w,this},multiplyScalar:function(Fu){return this.x*=Fu,this.y*=Fu,this.z*=Fu,this.w*=Fu,this},applyMatrix4:function(Fu){var Hu=this.x,Vu=this.y,ku=this.z,Wu=this.w,ju=Fu.elements;return this.x=ju[0]*Hu+ju[4]*Vu+ju[8]*ku+ju[12]*Wu,this.y=ju[1]*Hu+ju[5]*Vu+ju[9]*ku+ju[13]*Wu,this.z=ju[2]*Hu+ju[6]*Vu+ju[10]*ku+ju[14]*Wu,this.w=ju[3]*Hu+ju[7]*Vu+ju[11]*ku+ju[15]*Wu,this},divideScalar:function(Fu){return this.multiplyScalar(1/Fu)},setAxisAngleFromQuaternion:function(Fu){this.w=2*Math.acos(Fu.w);var Hu=Math.sqrt(1-Fu.w*Fu.w);return 1e-4>Hu?(this.x=1,this.y=0,this.z=0):(this.x=Fu.x/Hu,this.y=Fu.y/Hu,this.z=Fu.z/Hu),this},setAxisAngleFromRotationMatrix:function(Fu){var ju=0.01,qu=0.1,Xu=Fu.elements,Yu=Xu[0],Zu=Xu[4],Ju=Xu[8],Qu=Xu[1],Ku=Xu[5],$u=Xu[9],em=Xu[2],tm=Xu[6],rm=Xu[10],Hu,Vu,ku,Wu;if(Math.abs(Zu-Qu)<ju&&Math.abs(Ju-em)<ju&&Math.abs($u-tm)<ju){if(Math.abs(Zu+Qu)<qu&&Math.abs(Ju+em)<qu&&Math.abs($u+tm)<qu&&Math.abs(Yu+Ku+rm-3)<qu)return this.set(1,0,0,0),this;Hu=Math.PI;var am=(Yu+1)/2,om=(Ku+1)/2,im=(rm+1)/2,nm=(Zu+Qu)/4,sm=(Ju+em)/4,lm=($u+tm)/4;return am>om&&am>im?am<ju?(Vu=0,ku=0.707106781,Wu=0.707106781):(Vu=Math.sqrt(am),ku=nm/Vu,Wu=sm/Vu):om>im?om<ju?(Vu=0.707106781,ku=0,Wu=0.707106781):(ku=Math.sqrt(om),Vu=nm/ku,Wu=lm/ku):im<ju?(Vu=0.707106781,ku=0.707106781,Wu=0):(Wu=Math.sqrt(im),Vu=sm/Wu,ku=lm/Wu),this.set(Vu,ku,Wu,Hu),this}var pm=Math.sqrt((tm-$u)*(tm-$u)+(Ju-em)*(Ju-em)+(Qu-Zu)*(Qu-Zu));return 1e-3>Math.abs(pm)&&(pm=1),this.x=(tm-$u)/pm,this.y=(Ju-em)/pm,this.z=(Qu-Zu)/pm,this.w=Math.acos((Yu+Ku+rm-1)/2),this},min:function(Fu){return this.x=Math.min(this.x,Fu.x),this.y=Math.min(this.y,Fu.y),this.z=Math.min(this.z,Fu.z),this.w=Math.min(this.w,Fu.w),this},max:function(Fu){return this.x=Math.max(this.x,Fu.x),this.y=Math.max(this.y,Fu.y),this.z=Math.max(this.z,Fu.z),this.w=Math.max(this.w,Fu.w),this},clamp:function(Fu,Hu){return this.x=Math.max(Fu.x,Math.min(Hu.x,this.x)),this.y=Math.max(Fu.y,Math.min(Hu.y,this.y)),this.z=Math.max(Fu.z,Math.min(Hu.z,this.z)),this.w=Math.max(Fu.w,Math.min(Hu.w,this.w)),this},clampScalar:function(){var Fu,Hu;return function(ku,Wu){return void 0==Fu&&(Fu=new I,Hu=new I),Fu.set(ku,ku,ku,ku),Hu.set(Wu,Wu,Wu,Wu),this.clamp(Fu,Hu)}}(),clampLength:function(Fu,Hu){var Vu=this.length();return this.divideScalar(Vu||1).multiplyScalar(Math.max(Fu,Math.min(Hu,Vu)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(Fu){return this.x*Fu.x+this.y*Fu.y+this.z*Fu.z+this.w*Fu.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(Fu){return this.normalize().multiplyScalar(Fu)},lerp:function(Fu,Hu){return this.x+=(Fu.x-this.x)*Hu,this.y+=(Fu.y-this.y)*Hu,this.z+=(Fu.z-this.z)*Hu,this.w+=(Fu.w-this.w)*Hu,this},lerpVectors:function(Fu,Hu,Vu){return this.subVectors(Hu,Fu).multiplyScalar(Vu).add(Fu)},equals:function(Fu){return Fu.x===this.x&&Fu.y===this.y&&Fu.z===this.z&&Fu.w===this.w},fromArray:function(Fu,Hu){return void 0===Hu&&(Hu=0),this.x=Fu[Hu],this.y=Fu[Hu+1],this.z=Fu[Hu+2],this.w=Fu[Hu+3],this},toArray:function(Fu,Hu){return void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0),Fu[Hu]=this.x,Fu[Hu+1]=this.y,Fu[Hu+2]=this.z,Fu[Hu+3]=this.w,Fu},fromBufferAttribute:function(Fu,Hu,Vu){return void 0!==Vu&&console.warn('THREE.Vector4: offset has been removed from .fromBufferAttribute().'),this.x=Fu.getX(Hu),this.y=Fu.getY(Hu),this.z=Fu.getZ(Hu),this.w=Fu.getW(Hu),this}}),D.prototype=Object.assign(Object.create(M.prototype),{constructor:D,isWebGLRenderTarget:!0,setSize:function(Fu,Hu){(this.width!==Fu||this.height!==Hu)&&(this.width=Fu,this.height=Hu,this.dispose()),this.viewport.set(0,0,Fu,Hu),this.scissor.set(0,0,Fu,Hu)},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.width=Fu.width,this.height=Fu.height,this.viewport.copy(Fu.viewport),this.texture=Fu.texture.clone(),this.depthBuffer=Fu.depthBuffer,this.stencilBuffer=Fu.stencilBuffer,this.depthTexture=Fu.depthTexture,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),U.prototype=Object.create(D.prototype),U.prototype.constructor=U,U.prototype.isWebGLRenderTargetCube=!0,G.prototype=Object.create(R.prototype),G.prototype.constructor=G,G.prototype.isDataTexture=!0,Object.assign(O.prototype,{isBox3:!0,set:function(Fu,Hu){return this.min.copy(Fu),this.max.copy(Hu),this},setFromArray:function(Fu){for(var Hu=+Infinity,Vu=+Infinity,ku=+Infinity,Wu=-Infinity,ju=-Infinity,qu=-Infinity,Xu=0,Yu=Fu.length;Xu<Yu;Xu+=3){var Zu=Fu[Xu],Ju=Fu[Xu+1],Qu=Fu[Xu+2];Zu<Hu&&(Hu=Zu),Ju<Vu&&(Vu=Ju),Qu<ku&&(ku=Qu),Zu>Wu&&(Wu=Zu),Ju>ju&&(ju=Ju),Qu>qu&&(qu=Qu)}return this.min.set(Hu,Vu,ku),this.max.set(Wu,ju,qu),this},setFromBufferAttribute:function(Fu){for(var Hu=+Infinity,Vu=+Infinity,ku=+Infinity,Wu=-Infinity,ju=-Infinity,qu=-Infinity,Xu=0,Yu=Fu.count;Xu<Yu;Xu++){var Zu=Fu.getX(Xu),Ju=Fu.getY(Xu),Qu=Fu.getZ(Xu);Zu<Hu&&(Hu=Zu),Ju<Vu&&(Vu=Ju),Qu<ku&&(ku=Qu),Zu>Wu&&(Wu=Zu),Ju>ju&&(ju=Ju),Qu>qu&&(qu=Qu)}return this.min.set(Hu,Vu,ku),this.max.set(Wu,ju,qu),this},setFromPoints:function(Fu){this.makeEmpty();for(var Hu=0,Vu=Fu.length;Hu<Vu;Hu++)this.expandByPoint(Fu[Hu]);return this},setFromCenterAndSize:function(){var Fu=new A;return function(Vu,ku){var Wu=Fu.copy(ku).multiplyScalar(0.5);return this.min.copy(Vu).sub(Wu),this.max.copy(Vu).add(Wu),this}}(),setFromObject:function(Fu){return this.makeEmpty(),this.expandByObject(Fu)},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.min.copy(Fu.min),this.max.copy(Fu.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(Fu){return void 0===Fu&&(console.warn('THREE.Box3: .getCenter() target is now required'),Fu=new A),this.isEmpty()?Fu.set(0,0,0):Fu.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(Fu){return void 0===Fu&&(console.warn('THREE.Box3: .getSize() target is now required'),Fu=new A),this.isEmpty()?Fu.set(0,0,0):Fu.subVectors(this.max,this.min)},expandByPoint:function(Fu){return this.min.min(Fu),this.max.max(Fu),this},expandByVector:function(Fu){return this.min.sub(Fu),this.max.add(Fu),this},expandByScalar:function(Fu){return this.min.addScalar(-Fu),this.max.addScalar(Fu),this},expandByObject:function(){function Fu(ju){var qu=ju.geometry;if(qu!==void 0)if(qu.isGeometry){var Xu=qu.vertices;for(Vu=0,ku=Xu.length;Vu<ku;Vu++)Wu.copy(Xu[Vu]),Wu.applyMatrix4(ju.matrixWorld),Hu.expandByPoint(Wu)}else if(qu.isBufferGeometry){var Yu=qu.attributes.position;if(void 0!==Yu)for(Vu=0,ku=Yu.count;Vu<ku;Vu++)Wu.fromBufferAttribute(Yu,Vu).applyMatrix4(ju.matrixWorld),Hu.expandByPoint(Wu)}}var Hu,Vu,ku,Wu=new A;return function(qu){return Hu=this,qu.updateMatrixWorld(!0),qu.traverse(Fu),this}}(),containsPoint:function(Fu){return Fu.x<this.min.x||Fu.x>this.max.x||Fu.y<this.min.y||Fu.y>this.max.y||Fu.z<this.min.z||Fu.z>this.max.z?!1:!0},containsBox:function(Fu){return this.min.x<=Fu.min.x&&Fu.max.x<=this.max.x&&this.min.y<=Fu.min.y&&Fu.max.y<=this.max.y&&this.min.z<=Fu.min.z&&Fu.max.z<=this.max.z},getParameter:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Box3: .getParameter() target is now required'),Hu=new A),Hu.set((Fu.x-this.min.x)/(this.max.x-this.min.x),(Fu.y-this.min.y)/(this.max.y-this.min.y),(Fu.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(Fu){return Fu.max.x<this.min.x||Fu.min.x>this.max.x||Fu.max.y<this.min.y||Fu.min.y>this.max.y||Fu.max.z<this.min.z||Fu.min.z>this.max.z?!1:!0},intersectsSphere:function(){var Fu=new A;return function(Vu){return this.clampPoint(Vu.center,Fu),Fu.distanceToSquared(Vu.center)<=Vu.radius*Vu.radius}}(),intersectsPlane:function(Fu){var Hu,Vu;return 0<Fu.normal.x?(Hu=Fu.normal.x*this.min.x,Vu=Fu.normal.x*this.max.x):(Hu=Fu.normal.x*this.max.x,Vu=Fu.normal.x*this.min.x),0<Fu.normal.y?(Hu+=Fu.normal.y*this.min.y,Vu+=Fu.normal.y*this.max.y):(Hu+=Fu.normal.y*this.max.y,Vu+=Fu.normal.y*this.min.y),0<Fu.normal.z?(Hu+=Fu.normal.z*this.min.z,Vu+=Fu.normal.z*this.max.z):(Hu+=Fu.normal.z*this.max.z,Vu+=Fu.normal.z*this.min.z),Hu<=-Fu.constant&&Vu>=-Fu.constant},intersectsTriangle:function(){function Fu(Qu){var Ku,$u;for(Ku=0,$u=Qu.length-3;Ku<=$u;Ku+=3){Xu.fromArray(Qu,Ku);var em=Zu.x*Math.abs(Xu.x)+Zu.y*Math.abs(Xu.y)+Zu.z*Math.abs(Xu.z),tm=Hu.dot(Xu),rm=Vu.dot(Xu),am=ku.dot(Xu);if(Math.max(-Math.max(tm,rm,am),Math.min(tm,rm,am))>em)return!1}return!0}var Hu=new A,Vu=new A,ku=new A,Wu=new A,ju=new A,qu=new A,Xu=new A,Yu=new A,Zu=new A,Ju=new A;return function(Ku){if(this.isEmpty())return!1;this.getCenter(Yu),Zu.subVectors(this.max,Yu),Hu.subVectors(Ku.a,Yu),Vu.subVectors(Ku.b,Yu),ku.subVectors(Ku.c,Yu),Wu.subVectors(Vu,Hu),ju.subVectors(ku,Vu),qu.subVectors(Hu,ku);var $u=[0,-Wu.z,Wu.y,0,-ju.z,ju.y,0,-qu.z,qu.y,Wu.z,0,-Wu.x,ju.z,0,-ju.x,qu.z,0,-qu.x,-Wu.y,Wu.x,0,-ju.y,ju.x,0,-qu.y,qu.x,0];return!!Fu($u)&&($u=[1,0,0,0,1,0,0,0,1],!!Fu($u))&&(Ju.crossVectors(Wu,ju),$u=[Ju.x,Ju.y,Ju.z],Fu($u))}}(),clampPoint:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Box3: .clampPoint() target is now required'),Hu=new A),Hu.copy(Fu).clamp(this.min,this.max)},distanceToPoint:function(){var Fu=new A;return function(Vu){var ku=Fu.copy(Vu).clamp(this.min,this.max);return ku.sub(Vu).length()}}(),getBoundingSphere:function(){var Fu=new A;return function(Vu){return void 0===Vu&&(console.warn('THREE.Box3: .getBoundingSphere() target is now required'),Vu=new F),this.getCenter(Vu.center),Vu.radius=0.5*this.getSize(Fu).length(),Vu}}(),intersect:function(Fu){return this.min.max(Fu.min),this.max.min(Fu.max),this.isEmpty()&&this.makeEmpty(),this},union:function(Fu){return this.min.min(Fu.min),this.max.max(Fu.max),this},applyMatrix4:function(){var Fu=[new A,new A,new A,new A,new A,new A,new A,new A];return function(Vu){return this.isEmpty()?this:(Fu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(Vu),Fu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(Vu),Fu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(Vu),Fu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(Vu),Fu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(Vu),Fu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(Vu),Fu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(Vu),Fu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(Vu),this.setFromPoints(Fu),this)}}(),translate:function(Fu){return this.min.add(Fu),this.max.add(Fu),this},equals:function(Fu){return Fu.min.equals(this.min)&&Fu.max.equals(this.max)}}),Object.assign(F.prototype,{set:function(Fu,Hu){return this.center.copy(Fu),this.radius=Hu,this},setFromPoints:function(){var Fu=new O;return function(Vu,ku){var Wu=this.center;void 0===ku?Fu.setFromPoints(Vu).getCenter(Wu):Wu.copy(ku);for(var ju=0,qu=0,Xu=Vu.length;qu<Xu;qu++)ju=Math.max(ju,Wu.distanceToSquared(Vu[qu]));return this.radius=Math.sqrt(ju),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.center.copy(Fu.center),this.radius=Fu.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(Fu){return Fu.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(Fu){return Fu.distanceTo(this.center)-this.radius},intersectsSphere:function(Fu){var Hu=this.radius+Fu.radius;return Fu.center.distanceToSquared(this.center)<=Hu*Hu},intersectsBox:function(Fu){return Fu.intersectsSphere(this)},intersectsPlane:function(Fu){return Math.abs(Fu.distanceToPoint(this.center))<=this.radius},clampPoint:function(Fu,Hu){var Vu=this.center.distanceToSquared(Fu);return void 0===Hu&&(console.warn('THREE.Sphere: .clampPoint() target is now required'),Hu=new A),Hu.copy(Fu),Vu>this.radius*this.radius&&(Hu.sub(this.center).normalize(),Hu.multiplyScalar(this.radius).add(this.center)),Hu},getBoundingBox:function(Fu){return void 0===Fu&&(console.warn('THREE.Sphere: .getBoundingBox() target is now required'),Fu=new O),Fu.set(this.center,this.center),Fu.expandByScalar(this.radius),Fu},applyMatrix4:function(Fu){return this.center.applyMatrix4(Fu),this.radius*=Fu.getMaxScaleOnAxis(),this},translate:function(Fu){return this.center.add(Fu),this},equals:function(Fu){return Fu.center.equals(this.center)&&Fu.radius===this.radius}}),Object.assign(H.prototype,{set:function(Fu,Hu){return this.normal.copy(Fu),this.constant=Hu,this},setComponents:function(Fu,Hu,Vu,ku){return this.normal.set(Fu,Hu,Vu),this.constant=ku,this},setFromNormalAndCoplanarPoint:function(Fu,Hu){return this.normal.copy(Fu),this.constant=-Hu.dot(this.normal),this},setFromCoplanarPoints:function(){var Fu=new A,Hu=new A;return function(ku,Wu,ju){var qu=Fu.subVectors(ju,Wu).cross(Hu.subVectors(ku,Wu)).normalize();return this.setFromNormalAndCoplanarPoint(qu,ku),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.normal.copy(Fu.normal),this.constant=Fu.constant,this},normalize:function(){var Fu=1/this.normal.length();return this.normal.multiplyScalar(Fu),this.constant*=Fu,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(Fu){return this.normal.dot(Fu)+this.constant},distanceToSphere:function(Fu){return this.distanceToPoint(Fu.center)-Fu.radius},projectPoint:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Plane: .projectPoint() target is now required'),Hu=new A),Hu.copy(this.normal).multiplyScalar(-this.distanceToPoint(Fu)).add(Fu)},intersectLine:function(){var Fu=new A;return function(Vu,ku){ku===void 0&&(console.warn('THREE.Plane: .intersectLine() target is now required'),ku=new A);var Wu=Vu.delta(Fu),ju=this.normal.dot(Wu);if(0===ju)return 0===this.distanceToPoint(Vu.start)?ku.copy(Vu.start):void 0;var qu=-(Vu.start.dot(this.normal)+this.constant)/ju;return 0>qu||1<qu?void 0:ku.copy(Wu).multiplyScalar(qu).add(Vu.start)}}(),intersectsLine:function(Fu){var Hu=this.distanceToPoint(Fu.start),Vu=this.distanceToPoint(Fu.end);return 0>Hu&&0<Vu||0>Vu&&0<Hu},intersectsBox:function(Fu){return Fu.intersectsPlane(this)},intersectsSphere:function(Fu){return Fu.intersectsPlane(this)},coplanarPoint:function(Fu){return void 0===Fu&&(console.warn('THREE.Plane: .coplanarPoint() target is now required'),Fu=new A),Fu.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var Fu=new A,Hu=new C;return function(ku,Wu){var ju=Wu||Hu.getNormalMatrix(ku),qu=this.coplanarPoint(Fu).applyMatrix4(ku),Xu=this.normal.applyMatrix3(ju).normalize();return this.constant=-qu.dot(Xu),this}}(),translate:function(Fu){return this.constant-=Fu.dot(this.normal),this},equals:function(Fu){return Fu.normal.equals(this.normal)&&Fu.constant===this.constant}}),Object.assign(V.prototype,{set:function(Fu,Hu,Vu,ku,Wu,ju){var qu=this.planes;return qu[0].copy(Fu),qu[1].copy(Hu),qu[2].copy(Vu),qu[3].copy(ku),qu[4].copy(Wu),qu[5].copy(ju),this},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){for(var Hu=this.planes,Vu=0;6>Vu;Vu++)Hu[Vu].copy(Fu.planes[Vu]);return this},setFromMatrix:function(Fu){var Hu=this.planes,Vu=Fu.elements,ku=Vu[0],Wu=Vu[1],ju=Vu[2],qu=Vu[3],Xu=Vu[4],Yu=Vu[5],Zu=Vu[6],Ju=Vu[7],Qu=Vu[8],Ku=Vu[9],$u=Vu[10],em=Vu[11],tm=Vu[12],rm=Vu[13],am=Vu[14],om=Vu[15];return Hu[0].setComponents(qu-ku,Ju-Xu,em-Qu,om-tm).normalize(),Hu[1].setComponents(qu+ku,Ju+Xu,em+Qu,om+tm).normalize(),Hu[2].setComponents(qu+Wu,Ju+Yu,em+Ku,om+rm).normalize(),Hu[3].setComponents(qu-Wu,Ju-Yu,em-Ku,om-rm).normalize(),Hu[4].setComponents(qu-ju,Ju-Zu,em-$u,om-am).normalize(),Hu[5].setComponents(qu+ju,Ju+Zu,em+$u,om+am).normalize(),this},intersectsObject:function(){var Fu=new F;return function(Vu){var ku=Vu.geometry;return null===ku.boundingSphere&&ku.computeBoundingSphere(),Fu.copy(ku.boundingSphere).applyMatrix4(Vu.matrixWorld),this.intersectsSphere(Fu)}}(),intersectsSprite:function(){var Fu=new F;return function(Vu){return Fu.center.set(0,0,0),Fu.radius=0.7071067811865476,Fu.applyMatrix4(Vu.matrixWorld),this.intersectsSphere(Fu)}}(),intersectsSphere:function(Fu){for(var Hu=this.planes,Vu=Fu.center,ku=-Fu.radius,Wu=0,ju;6>Wu;Wu++)if(ju=Hu[Wu].distanceToPoint(Vu),ju<ku)return!1;return!0},intersectsBox:function(){var Fu=new A;return function(Vu){for(var ku=this.planes,Wu=0,ju;6>Wu;Wu++)if(ju=ku[Wu],Fu.x=0<ju.normal.x?Vu.max.x:Vu.min.x,Fu.y=0<ju.normal.y?Vu.max.y:Vu.min.y,Fu.z=0<ju.normal.z?Vu.max.z:Vu.min.z,0>ju.distanceToPoint(Fu))return!1;return!0}}(),containsPoint:function(Fu){for(var Hu=this.planes,Vu=0;6>Vu;Vu++)if(0>Hu[Vu].distanceToPoint(Fu))return!1;return!0}});var Bc={alphamap_fragment:'#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n',alphamap_pars_fragment:'#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n',alphatest_fragment:'#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n',aomap_fragment:'#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n',aomap_pars_fragment:'#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif',begin_vertex:'\nvec3 transformed = vec3( position );\n',beginnormal_vertex:'\nvec3 objectNormal = vec3( normal );\n',bsdfs:'float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',bumpmap_pars_fragment:'#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n',clipping_planes_fragment:'#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n',clipping_planes_pars_fragment:'#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n',clipping_planes_pars_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n',clipping_planes_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n',color_fragment:'#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif',color_pars_fragment:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n',color_pars_vertex:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif',color_vertex:'#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif',common:'#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n',cube_uv_reflection_fragment:'#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n',defaultnormal_vertex:'vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n',displacementmap_pars_vertex:'#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n',displacementmap_vertex:'#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n',emissivemap_fragment:'#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n',emissivemap_pars_fragment:'#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n',encodings_fragment:'  gl_FragColor = linearToOutputTexel( gl_FragColor );\n',encodings_pars_fragment:'\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n',envmap_fragment:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n',envmap_pars_fragment:'#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n',envmap_pars_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n',envmap_physical_pars_fragment:'#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n',envmap_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n',fog_vertex:'#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif\n',fog_pars_vertex:'#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif\n',fog_fragment:'#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n',fog_pars_fragment:'#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n',gradientmap_pars_fragment:'#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n',lightmap_fragment:'#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n',lightmap_pars_fragment:'#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif',lights_lambert_vertex:'vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n',lights_pars_begin:'uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n',lights_phong_fragment:'BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n',lights_phong_pars_fragment:'varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n',lights_physical_fragment:'PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n',lights_physical_pars_fragment:'struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n',lights_fragment_begin:'\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n',lights_fragment_maps:'#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n',lights_fragment_end:'#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n',logdepthbuf_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif',logdepthbuf_pars_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif\n',logdepthbuf_pars_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif\n',logdepthbuf_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n',map_fragment:'#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n',map_pars_fragment:'#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n',map_particle_fragment:'#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n',map_particle_pars_fragment:'#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n',metalnessmap_fragment:'float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n',metalnessmap_pars_fragment:'#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif',morphnormal_vertex:'#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n',morphtarget_pars_vertex:'#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif',morphtarget_vertex:'#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n',normal_fragment_begin:'#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n',normal_fragment_maps:'#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n',normalmap_pars_fragment:'#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n',packing:'vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n',premultiplied_alpha_fragment:'#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n',project_vertex:'vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n',dithering_fragment:'#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n',dithering_pars_fragment:'#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n',roughnessmap_fragment:'float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n',roughnessmap_pars_fragment:'#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif',shadowmap_pars_fragment:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n',shadowmap_pars_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n',shadowmap_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n',shadowmask_pars_fragment:'float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n',skinbase_vertex:'#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif',skinning_pars_vertex:'#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n',skinning_vertex:'#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n',skinnormal_vertex:'#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n',specularmap_fragment:'float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif',specularmap_pars_fragment:'#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif',tonemapping_fragment:'#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n',tonemapping_pars_fragment:'#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n',uv_pars_fragment:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif',uv_pars_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n',uv_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif',uv2_pars_fragment:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif',uv2_pars_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif',uv2_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif',worldpos_vertex:'#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n',background_frag:'uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}\n',background_vert:'varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}\n',cube_frag:'uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = envMapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}\n',cube_vert:'varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n',depth_frag:'#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n',depth_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',distanceRGBA_frag:'#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n',distanceRGBA_vert:'#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n',equirect_frag:'uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n',equirect_vert:'varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n',linedashed_frag:'uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',linedashed_vert:'uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n',meshbasic_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshbasic_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n',meshlambert_frag:'uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshlambert_vert:'#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshmatcap_frag:'#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\tvec4 matcapColor = texture2D( matcap, uv );\n\tmatcapColor = matcapTexelToLinear( matcapColor );\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshmatcap_vert:'#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}\n',meshphong_frag:'#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphong_vert:'#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshphysical_frag:'#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphysical_vert:'#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',normal_frag:'#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n',normal_vert:'#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n',points_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',points_vert:'uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n',shadow_frag:'uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n',shadow_vert:'#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',sprite_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',sprite_vert:'uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n'},Uc={merge:function(Fu){for(var Hu={},Vu=0,ku;Vu<Fu.length;Vu++)for(var Wu in ku=this.clone(Fu[Vu]),ku)Hu[Wu]=ku[Wu];return Hu},clone:function(Fu){var Hu={};for(var Vu in Fu)for(var ku in Hu[Vu]={},Fu[Vu]){var Wu=Fu[Vu][ku];Hu[Vu][ku]=Wu&&(Wu.isColor||Wu.isMatrix3||Wu.isMatrix4||Wu.isVector2||Wu.isVector3||Wu.isVector4||Wu.isTexture)?Wu.clone():Array.isArray(Wu)?Wu.slice():Wu}return Hu}},Gc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(W.prototype,{isColor:!0,r:1,g:1,b:1,set:function(Fu){return Fu&&Fu.isColor?this.copy(Fu):'number'==typeof Fu?this.setHex(Fu):'string'==typeof Fu&&this.setStyle(Fu),this},setScalar:function(Fu){return this.r=Fu,this.g=Fu,this.b=Fu,this},setHex:function(Fu){return Fu=Math.floor(Fu),this.r=(255&Fu>>16)/255,this.g=(255&Fu>>8)/255,this.b=(255&Fu)/255,this},setRGB:function(Fu,Hu,Vu){return this.r=Fu,this.g=Hu,this.b=Vu,this},setHSL:function(){function Fu(Hu,Vu,ku){return 0>ku&&(ku+=1),1<ku&&(ku-=1),ku<1/6?Hu+6*(Vu-Hu)*ku:ku<1/2?Vu:ku<2/3?Hu+6*(Vu-Hu)*(2/3-ku):Hu}return function(Vu,ku,Wu){if(Vu=fp.euclideanModulo(Vu,1),ku=fp.clamp(ku,0,1),Wu=fp.clamp(Wu,0,1),0===ku)this.r=this.g=this.b=Wu;else{var ju=0.5>=Wu?Wu*(1+ku):Wu+ku-Wu*ku,qu=2*Wu-ju;this.r=Fu(qu,ju,Vu+1/3),this.g=Fu(qu,ju,Vu),this.b=Fu(qu,ju,Vu-1/3)}return this}}(),setStyle:function(Fu){function Hu(Qu){void 0===Qu||1>parseFloat(Qu)&&console.warn('THREE.Color: Alpha component of '+Fu+' will be ignored.')}var Vu;if(Vu=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(Fu)){var ku,Wu=Vu[1],ju=Vu[2];switch(Wu){case'rgb':case'rgba':if(ku=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(ju))return this.r=Math.min(255,parseInt(ku[1],10))/255,this.g=Math.min(255,parseInt(ku[2],10))/255,this.b=Math.min(255,parseInt(ku[3],10))/255,Hu(ku[5]),this;if(ku=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(ju))return this.r=Math.min(100,parseInt(ku[1],10))/100,this.g=Math.min(100,parseInt(ku[2],10))/100,this.b=Math.min(100,parseInt(ku[3],10))/100,Hu(ku[5]),this;break;case'hsl':case'hsla':if(ku=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(ju)){var qu=parseFloat(ku[1])/360,Xu=parseInt(ku[2],10)/100,Yu=parseInt(ku[3],10)/100;return Hu(ku[5]),this.setHSL(qu,Xu,Yu)}}}else if(Vu=/^\#([A-Fa-f0-9]+)$/.exec(Fu)){var Zu=Vu[1],Ju=Zu.length;if(3===Ju)return this.r=parseInt(Zu.charAt(0)+Zu.charAt(0),16)/255,this.g=parseInt(Zu.charAt(1)+Zu.charAt(1),16)/255,this.b=parseInt(Zu.charAt(2)+Zu.charAt(2),16)/255,this;if(6===Ju)return this.r=parseInt(Zu.charAt(0)+Zu.charAt(1),16)/255,this.g=parseInt(Zu.charAt(2)+Zu.charAt(3),16)/255,this.b=parseInt(Zu.charAt(4)+Zu.charAt(5),16)/255,this}if(Fu&&0<Fu.length){var Zu=Gc[Fu];void 0===Zu?console.warn('THREE.Color: Unknown color '+Fu):this.setHex(Zu)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(Fu){return this.r=Fu.r,this.g=Fu.g,this.b=Fu.b,this},copyGammaToLinear:function(Fu,Hu){return void 0===Hu&&(Hu=2),this.r=Math.pow(Fu.r,Hu),this.g=Math.pow(Fu.g,Hu),this.b=Math.pow(Fu.b,Hu),this},copyLinearToGamma:function(Fu,Hu){void 0===Hu&&(Hu=2);var Vu=0<Hu?1/Hu:1;return this.r=Math.pow(Fu.r,Vu),this.g=Math.pow(Fu.g,Vu),this.b=Math.pow(Fu.b,Vu),this},convertGammaToLinear:function(Fu){return this.copyGammaToLinear(this,Fu),this},convertLinearToGamma:function(Fu){return this.copyLinearToGamma(this,Fu),this},copySRGBToLinear:function(){function Fu(Hu){return 0.04045>Hu?0.0773993808*Hu:Math.pow(0.9478672986*Hu+0.0521327014,2.4)}return function(Vu){return this.r=Fu(Vu.r),this.g=Fu(Vu.g),this.b=Fu(Vu.b),this}}(),copyLinearToSRGB:function(){function Fu(Hu){return 0.0031308>Hu?12.92*Hu:1.055*Math.pow(Hu,0.41666)-0.055}return function(Vu){return this.r=Fu(Vu.r),this.g=Fu(Vu.g),this.b=Fu(Vu.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function(Fu){void 0===Fu&&(console.warn('THREE.Color: .getHSL() target is now required'),Fu={h:0,s:0,l:0});var Hu=this.r,Vu=this.g,ku=this.b,Wu=Math.max(Hu,Vu,ku),ju=Math.min(Hu,Vu,ku),Yu=(ju+Wu)/2,qu,Xu;if(ju===Wu)qu=0,Xu=0;else{var Zu=Wu-ju;Xu=0.5>=Yu?Zu/(Wu+ju):Zu/(2-Wu-ju),Wu===Hu?qu=(Vu-ku)/Zu+(Vu<ku?6:0):Wu===Vu?qu=(ku-Hu)/Zu+2:Wu===ku?qu=(Hu-Vu)/Zu+4:void 0,qu/=6}return Fu.h=qu,Fu.s=Xu,Fu.l=Yu,Fu},getStyle:function(){return'rgb('+(0|255*this.r)+','+(0|255*this.g)+','+(0|255*this.b)+')'},offsetHSL:function(){var Fu={};return function(Hu,Vu,ku){return this.getHSL(Fu),Fu.h+=Hu,Fu.s+=Vu,Fu.l+=ku,this.setHSL(Fu.h,Fu.s,Fu.l),this}}(),add:function(Fu){return this.r+=Fu.r,this.g+=Fu.g,this.b+=Fu.b,this},addColors:function(Fu,Hu){return this.r=Fu.r+Hu.r,this.g=Fu.g+Hu.g,this.b=Fu.b+Hu.b,this},addScalar:function(Fu){return this.r+=Fu,this.g+=Fu,this.b+=Fu,this},sub:function(Fu){return this.r=Math.max(0,this.r-Fu.r),this.g=Math.max(0,this.g-Fu.g),this.b=Math.max(0,this.b-Fu.b),this},multiply:function(Fu){return this.r*=Fu.r,this.g*=Fu.g,this.b*=Fu.b,this},multiplyScalar:function(Fu){return this.r*=Fu,this.g*=Fu,this.b*=Fu,this},lerp:function(Fu,Hu){return this.r+=(Fu.r-this.r)*Hu,this.g+=(Fu.g-this.g)*Hu,this.b+=(Fu.b-this.b)*Hu,this},lerpHSL:function(){var Fu={h:0,s:0,l:0},Hu={h:0,s:0,l:0};return function(ku,Wu){this.getHSL(Fu),ku.getHSL(Hu);var ju=fp.lerp(Fu.h,Hu.h,Wu),qu=fp.lerp(Fu.s,Hu.s,Wu),Xu=fp.lerp(Fu.l,Hu.l,Wu);return this.setHSL(ju,qu,Xu),this}}(),equals:function(Fu){return Fu.r===this.r&&Fu.g===this.g&&Fu.b===this.b},fromArray:function(Fu,Hu){return void 0===Hu&&(Hu=0),this.r=Fu[Hu],this.g=Fu[Hu+1],this.b=Fu[Hu+2],this},toArray:function(Fu,Hu){return void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0),Fu[Hu]=this.r,Fu[Hu+1]=this.g,Fu[Hu+2]=this.b,Fu},toJSON:function(){return this.getHex()}});var Oc={common:{diffuse:{value:new W(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new C},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:0.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new S(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5e-4},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new W(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new W(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new C}},sprite:{diffuse:{value:new W(15658734)},opacity:{value:1},center:{value:new S(0.5,0.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new C}}},Fc={basic:{uniforms:Uc.merge([Oc.common,Oc.specularmap,Oc.envmap,Oc.aomap,Oc.lightmap,Oc.fog]),vertexShader:Bc.meshbasic_vert,fragmentShader:Bc.meshbasic_frag},lambert:{uniforms:Uc.merge([Oc.common,Oc.specularmap,Oc.envmap,Oc.aomap,Oc.lightmap,Oc.emissivemap,Oc.fog,Oc.lights,{emissive:{value:new W(0)}}]),vertexShader:Bc.meshlambert_vert,fragmentShader:Bc.meshlambert_frag},phong:{uniforms:Uc.merge([Oc.common,Oc.specularmap,Oc.envmap,Oc.aomap,Oc.lightmap,Oc.emissivemap,Oc.bumpmap,Oc.normalmap,Oc.displacementmap,Oc.gradientmap,Oc.fog,Oc.lights,{emissive:{value:new W(0)},specular:{value:new W(1118481)},shininess:{value:30}}]),vertexShader:Bc.meshphong_vert,fragmentShader:Bc.meshphong_frag},standard:{uniforms:Uc.merge([Oc.common,Oc.envmap,Oc.aomap,Oc.lightmap,Oc.emissivemap,Oc.bumpmap,Oc.normalmap,Oc.displacementmap,Oc.roughnessmap,Oc.metalnessmap,Oc.fog,Oc.lights,{emissive:{value:new W(0)},roughness:{value:0.5},metalness:{value:0.5},envMapIntensity:{value:1}}]),vertexShader:Bc.meshphysical_vert,fragmentShader:Bc.meshphysical_frag},matcap:{uniforms:Uc.merge([Oc.common,Oc.bumpmap,Oc.normalmap,Oc.displacementmap,Oc.fog,{matcap:{value:null}}]),vertexShader:Bc.meshmatcap_vert,fragmentShader:Bc.meshmatcap_frag},points:{uniforms:Uc.merge([Oc.points,Oc.fog]),vertexShader:Bc.points_vert,fragmentShader:Bc.points_frag},dashed:{uniforms:Uc.merge([Oc.common,Oc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bc.linedashed_vert,fragmentShader:Bc.linedashed_frag},depth:{uniforms:Uc.merge([Oc.common,Oc.displacementmap]),vertexShader:Bc.depth_vert,fragmentShader:Bc.depth_frag},normal:{uniforms:Uc.merge([Oc.common,Oc.bumpmap,Oc.normalmap,Oc.displacementmap,{opacity:{value:1}}]),vertexShader:Bc.normal_vert,fragmentShader:Bc.normal_frag},sprite:{uniforms:Uc.merge([Oc.sprite,Oc.fog]),vertexShader:Bc.sprite_vert,fragmentShader:Bc.sprite_frag},background:{uniforms:{uvTransform:{value:new C},t2D:{value:null}},vertexShader:Bc.background_vert,fragmentShader:Bc.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Bc.cube_vert,fragmentShader:Bc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bc.equirect_vert,fragmentShader:Bc.equirect_frag},distanceRGBA:{uniforms:Uc.merge([Oc.common,Oc.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bc.distanceRGBA_vert,fragmentShader:Bc.distanceRGBA_frag},shadow:{uniforms:Uc.merge([Oc.lights,Oc.fog,{color:{value:new W(0)},opacity:{value:1}}]),vertexShader:Bc.shadow_vert,fragmentShader:Bc.shadow_frag}};Fc.physical={uniforms:Uc.merge([Fc.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Bc.meshphysical_vert,fragmentShader:Bc.meshphysical_frag},Object.assign(Z.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(Fu){this.a=Fu.a,this.b=Fu.b,this.c=Fu.c,this.normal.copy(Fu.normal),this.color.copy(Fu.color),this.materialIndex=Fu.materialIndex;for(var Hu=0,Vu=Fu.vertexNormals.length;Hu<Vu;Hu++)this.vertexNormals[Hu]=Fu.vertexNormals[Hu].clone();for(var Hu=0,Vu=Fu.vertexColors.length;Hu<Vu;Hu++)this.vertexColors[Hu]=Fu.vertexColors[Hu].clone();return this}}),J.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],J.DefaultOrder='XYZ',Object.defineProperties(J.prototype,{x:{get:function(){return this._x},set:function(Fu){this._x=Fu,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Fu){this._y=Fu,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Fu){this._z=Fu,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(Fu){this._order=Fu,this.onChangeCallback()}}}),Object.assign(J.prototype,{isEuler:!0,set:function(Fu,Hu,Vu,ku){return this._x=Fu,this._y=Hu,this._z=Vu,this._order=ku||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(Fu){return this._x=Fu._x,this._y=Fu._y,this._z=Fu._z,this._order=Fu._order,this.onChangeCallback(),this},setFromRotationMatrix:function(Fu,Hu,Vu){var ku=fp.clamp,Wu=Fu.elements,ju=Wu[0],qu=Wu[4],Xu=Wu[8],Yu=Wu[1],Zu=Wu[5],Ju=Wu[9],Qu=Wu[2],Ku=Wu[6],$u=Wu[10];return Hu=Hu||this._order,'XYZ'===Hu?(this._y=Math.asin(ku(Xu,-1,1)),0.99999>Math.abs(Xu)?(this._x=Math.atan2(-Ju,$u),this._z=Math.atan2(-qu,ju)):(this._x=Math.atan2(Ku,Zu),this._z=0)):'YXZ'===Hu?(this._x=Math.asin(-ku(Ju,-1,1)),0.99999>Math.abs(Ju)?(this._y=Math.atan2(Xu,$u),this._z=Math.atan2(Yu,Zu)):(this._y=Math.atan2(-Qu,ju),this._z=0)):'ZXY'===Hu?(this._x=Math.asin(ku(Ku,-1,1)),0.99999>Math.abs(Ku)?(this._y=Math.atan2(-Qu,$u),this._z=Math.atan2(-qu,Zu)):(this._y=0,this._z=Math.atan2(Yu,ju))):'ZYX'===Hu?(this._y=Math.asin(-ku(Qu,-1,1)),0.99999>Math.abs(Qu)?(this._x=Math.atan2(Ku,$u),this._z=Math.atan2(Yu,ju)):(this._x=0,this._z=Math.atan2(-qu,Zu))):'YZX'===Hu?(this._z=Math.asin(ku(Yu,-1,1)),0.99999>Math.abs(Yu)?(this._x=Math.atan2(-Ju,Zu),this._y=Math.atan2(-Qu,ju)):(this._x=0,this._y=Math.atan2(Xu,$u))):'XZY'===Hu?(this._z=Math.asin(-ku(qu,-1,1)),0.99999>Math.abs(qu)?(this._x=Math.atan2(Ku,Zu),this._y=Math.atan2(Xu,ju)):(this._x=Math.atan2(-Ju,$u),this._y=0)):console.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: '+Hu),this._order=Hu,!1!==Vu&&this.onChangeCallback(),this},setFromQuaternion:function(){var Fu=new E;return function(Vu,ku,Wu){return Fu.makeRotationFromQuaternion(Vu),this.setFromRotationMatrix(Fu,ku,Wu)}}(),setFromVector3:function(Fu,Hu){return this.set(Fu.x,Fu.y,Fu.z,Hu||this._order)},reorder:function(){var Fu=new L;return function(Vu){return Fu.setFromEuler(this),this.setFromQuaternion(Fu,Vu)}}(),equals:function(Fu){return Fu._x===this._x&&Fu._y===this._y&&Fu._z===this._z&&Fu._order===this._order},fromArray:function(Fu){return this._x=Fu[0],this._y=Fu[1],this._z=Fu[2],void 0!==Fu[3]&&(this._order=Fu[3]),this.onChangeCallback(),this},toArray:function(Fu,Hu){return void 0===Fu&&(Fu=[]),void 0===Hu&&(Hu=0),Fu[Hu]=this._x,Fu[Hu+1]=this._y,Fu[Hu+2]=this._z,Fu[Hu+3]=this._order,Fu},toVector3:function(Fu){return Fu?Fu.set(this._x,this._y,this._z):new A(this._x,this._y,this._z)},onChange:function(Fu){return this.onChangeCallback=Fu,this},onChangeCallback:function(){}}),Object.assign(Q.prototype,{set:function(Fu){this.mask=0|1<<Fu},enable:function(Fu){this.mask|=0|1<<Fu},toggle:function(Fu){this.mask^=0|1<<Fu},disable:function(Fu){this.mask&=~(0|1<<Fu)},test:function(Fu){return 0!=(this.mask&Fu.mask)}});var Hc=0;K.DefaultUp=new A(0,1,0),K.DefaultMatrixAutoUpdate=!0,K.prototype=Object.assign(Object.create(M.prototype),{constructor:K,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(Fu){this.matrix.multiplyMatrices(Fu,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(Fu){return this.quaternion.premultiply(Fu),this},setRotationFromAxisAngle:function(Fu,Hu){this.quaternion.setFromAxisAngle(Fu,Hu)},setRotationFromEuler:function(Fu){this.quaternion.setFromEuler(Fu,!0)},setRotationFromMatrix:function(Fu){this.quaternion.setFromRotationMatrix(Fu)},setRotationFromQuaternion:function(Fu){this.quaternion.copy(Fu)},rotateOnAxis:function(){var Fu=new L;return function(Vu,ku){return Fu.setFromAxisAngle(Vu,ku),this.quaternion.multiply(Fu),this}}(),rotateOnWorldAxis:function(){var Fu=new L;return function(Vu,ku){return Fu.setFromAxisAngle(Vu,ku),this.quaternion.premultiply(Fu),this}}(),rotateX:function(){var Fu=new A(1,0,0);return function(Vu){return this.rotateOnAxis(Fu,Vu)}}(),rotateY:function(){var Fu=new A(0,1,0);return function(Vu){return this.rotateOnAxis(Fu,Vu)}}(),rotateZ:function(){var Fu=new A(0,0,1);return function(Vu){return this.rotateOnAxis(Fu,Vu)}}(),translateOnAxis:function(){var Fu=new A;return function(Vu,ku){return Fu.copy(Vu).applyQuaternion(this.quaternion),this.position.add(Fu.multiplyScalar(ku)),this}}(),translateX:function(){var Fu=new A(1,0,0);return function(Vu){return this.translateOnAxis(Fu,Vu)}}(),translateY:function(){var Fu=new A(0,1,0);return function(Vu){return this.translateOnAxis(Fu,Vu)}}(),translateZ:function(){var Fu=new A(0,0,1);return function(Vu){return this.translateOnAxis(Fu,Vu)}}(),localToWorld:function(Fu){return Fu.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var Fu=new E;return function(Vu){return Vu.applyMatrix4(Fu.getInverse(this.matrixWorld))}}(),lookAt:function(){var Fu=new L,Hu=new E,Vu=new A,ku=new A;return function(ju,qu,Xu){ju.isVector3?Vu.copy(ju):Vu.set(ju,qu,Xu);var Yu=this.parent;this.updateWorldMatrix(!0,!1),ku.setFromMatrixPosition(this.matrixWorld),this.isCamera?Hu.lookAt(ku,Vu,this.up):Hu.lookAt(Vu,ku,this.up),this.quaternion.setFromRotationMatrix(Hu),Yu&&(Hu.extractRotation(Yu.matrixWorld),Fu.setFromRotationMatrix(Hu),this.quaternion.premultiply(Fu.inverse()))}}(),add:function(Fu){if(1<arguments.length){for(var Hu=0;Hu<arguments.length;Hu++)this.add(arguments[Hu]);return this}return Fu===this?(console.error('THREE.Object3D.add: object can\'t be added as a child of itself.',Fu),this):(Fu&&Fu.isObject3D?(null!==Fu.parent&&Fu.parent.remove(Fu),Fu.parent=this,Fu.dispatchEvent({type:'added'}),this.children.push(Fu)):console.error('THREE.Object3D.add: object not an instance of THREE.Object3D.',Fu),this)},remove:function(Fu){if(1<arguments.length){for(var Hu=0;Hu<arguments.length;Hu++)this.remove(arguments[Hu]);return this}var Vu=this.children.indexOf(Fu);return-1!==Vu&&(Fu.parent=null,Fu.dispatchEvent({type:'removed'}),this.children.splice(Vu,1)),this},getObjectById:function(Fu){return this.getObjectByProperty('id',Fu)},getObjectByName:function(Fu){return this.getObjectByProperty('name',Fu)},getObjectByProperty:function(Fu,Hu){if(this[Fu]===Hu)return this;for(var Vu=0,ku=this.children.length;Vu<ku;Vu++){var Wu=this.children[Vu],ju=Wu.getObjectByProperty(Fu,Hu);if(ju!==void 0)return ju}},getWorldPosition:function(Fu){return void 0===Fu&&(console.warn('THREE.Object3D: .getWorldPosition() target is now required'),Fu=new A),this.updateMatrixWorld(!0),Fu.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var Fu=new A,Hu=new A;return function(ku){return void 0===ku&&(console.warn('THREE.Object3D: .getWorldQuaternion() target is now required'),ku=new L),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Fu,ku,Hu),ku}}(),getWorldScale:function(){var Fu=new A,Hu=new L;return function(ku){return void 0===ku&&(console.warn('THREE.Object3D: .getWorldScale() target is now required'),ku=new A),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Fu,Hu,ku),ku}}(),getWorldDirection:function(Fu){Fu===void 0&&(console.warn('THREE.Object3D: .getWorldDirection() target is now required'),Fu=new A),this.updateMatrixWorld(!0);var Hu=this.matrixWorld.elements;return Fu.set(Hu[8],Hu[9],Hu[10]).normalize()},raycast:function(){},traverse:function(Fu){Fu(this);for(var Hu=this.children,Vu=0,ku=Hu.length;Vu<ku;Vu++)Hu[Vu].traverse(Fu)},traverseVisible:function(Fu){if(!1!==this.visible){Fu(this);for(var Hu=this.children,Vu=0,ku=Hu.length;Vu<ku;Vu++)Hu[Vu].traverseVisible(Fu)}},traverseAncestors:function(Fu){var Hu=this.parent;null!==Hu&&(Fu(Hu),Hu.traverseAncestors(Fu))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(Fu){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||Fu)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,Fu=!0);for(var Hu=this.children,Vu=0,ku=Hu.length;Vu<ku;Vu++)Hu[Vu].updateMatrixWorld(Fu)},updateWorldMatrix:function(Fu,Hu){var Vu=this.parent;if(!0===Fu&&null!==Vu&&Vu.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===Hu)for(var ku=this.children,Wu=0,ju=ku.length;Wu<ju;Wu++)ku[Wu].updateWorldMatrix(!1,!0)},toJSON:function(Fu){function Hu(rm,am){return void 0===rm[am.uuid]&&(rm[am.uuid]=am.toJSON(Fu)),am.uuid}function Vu(rm){var am=[];for(var om in rm){var im=rm[om];delete im.metadata,am.push(im)}return am}var ku=void 0===Fu||'string'==typeof Fu,Wu={};ku&&(Fu={geometries:{},materials:{},textures:{},images:{},shapes:{}},Wu.metadata={version:4.5,type:'Object',generator:'Object3D.toJSON'});var ju={};if(ju.uuid=this.uuid,ju.type=this.type,''!==this.name&&(ju.name=this.name),!0===this.castShadow&&(ju.castShadow=!0),!0===this.receiveShadow&&(ju.receiveShadow=!0),!1===this.visible&&(ju.visible=!1),!1===this.frustumCulled&&(ju.frustumCulled=!1),0!==this.renderOrder&&(ju.renderOrder=this.renderOrder),'{}'!==JSON.stringify(this.userData)&&(ju.userData=this.userData),ju.layers=this.layers.mask,ju.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(ju.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){ju.geometry=Hu(Fu.geometries,this.geometry);var qu=this.geometry.parameters;if(void 0!==qu&&void 0!==qu.shapes){var Xu=qu.shapes;if(Array.isArray(Xu))for(var Yu=0,Zu=Xu.length,Ju;Yu<Zu;Yu++)Ju=Xu[Yu],Hu(Fu.shapes,Ju);else Hu(Fu.shapes,Xu)}}if(void 0!==this.material)if(Array.isArray(this.material)){for(var Qu=[],Yu=0,Zu=this.material.length;Yu<Zu;Yu++)Qu.push(Hu(Fu.materials,this.material[Yu]));ju.material=Qu}else ju.material=Hu(Fu.materials,this.material);if(0<this.children.length){ju.children=[];for(var Yu=0;Yu<this.children.length;Yu++)ju.children.push(this.children[Yu].toJSON(Fu).object)}if(ku){var Ku=Vu(Fu.geometries),$u=Vu(Fu.materials),em=Vu(Fu.textures),tm=Vu(Fu.images),Xu=Vu(Fu.shapes);0<Ku.length&&(Wu.geometries=Ku),0<$u.length&&(Wu.materials=$u),0<em.length&&(Wu.textures=em),0<tm.length&&(Wu.images=tm),0<Xu.length&&(Wu.shapes=Xu)}return Wu.object=ju,Wu},clone:function(Fu){return new this.constructor().copy(this,Fu)},copy:function(Fu,Hu){if(void 0===Hu&&(Hu=!0),this.name=Fu.name,this.up.copy(Fu.up),this.position.copy(Fu.position),this.quaternion.copy(Fu.quaternion),this.scale.copy(Fu.scale),this.matrix.copy(Fu.matrix),this.matrixWorld.copy(Fu.matrixWorld),this.matrixAutoUpdate=Fu.matrixAutoUpdate,this.matrixWorldNeedsUpdate=Fu.matrixWorldNeedsUpdate,this.layers.mask=Fu.layers.mask,this.visible=Fu.visible,this.castShadow=Fu.castShadow,this.receiveShadow=Fu.receiveShadow,this.frustumCulled=Fu.frustumCulled,this.renderOrder=Fu.renderOrder,this.userData=JSON.parse(JSON.stringify(Fu.userData)),!0===Hu)for(var Vu=0,ku;Vu<Fu.children.length;Vu++)ku=Fu.children[Vu],this.add(ku.clone());return this}});var Vc=0;ee.prototype=Object.assign(Object.create(M.prototype),{constructor:ee,isGeometry:!0,applyMatrix:function(Fu){for(var Hu=new C().getNormalMatrix(Fu),Vu=0,ku=this.vertices.length,Wu;Vu<ku;Vu++)Wu=this.vertices[Vu],Wu.applyMatrix4(Fu);for(var Vu=0,ku=this.faces.length,ju;Vu<ku;Vu++){ju=this.faces[Vu],ju.normal.applyMatrix3(Hu).normalize();for(var qu=0,Xu=ju.vertexNormals.length;qu<Xu;qu++)ju.vertexNormals[qu].applyMatrix3(Hu).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var Fu=new E;return function(Vu){return Fu.makeRotationX(Vu),this.applyMatrix(Fu),this}}(),rotateY:function(){var Fu=new E;return function(Vu){return Fu.makeRotationY(Vu),this.applyMatrix(Fu),this}}(),rotateZ:function(){var Fu=new E;return function(Vu){return Fu.makeRotationZ(Vu),this.applyMatrix(Fu),this}}(),translate:function(){var Fu=new E;return function(Vu,ku,Wu){return Fu.makeTranslation(Vu,ku,Wu),this.applyMatrix(Fu),this}}(),scale:function(){var Fu=new E;return function(Vu,ku,Wu){return Fu.makeScale(Vu,ku,Wu),this.applyMatrix(Fu),this}}(),lookAt:function(){var Fu=new K;return function(Vu){Fu.lookAt(Vu),Fu.updateMatrix(),this.applyMatrix(Fu.matrix)}}(),fromBufferGeometry:function(Fu){function Hu(am,om,im,nm){var sm=void 0===Xu?[]:[Vu.colors[am].clone(),Vu.colors[om].clone(),Vu.colors[im].clone()],lm=void 0===qu?[]:[new A().fromArray(qu,3*am),new A().fromArray(qu,3*om),new A().fromArray(qu,3*im)],pm=new Z(am,om,im,lm,sm,nm);Vu.faces.push(pm),void 0!==Yu&&Vu.faceVertexUvs[0].push([new S().fromArray(Yu,2*am),new S().fromArray(Yu,2*om),new S().fromArray(Yu,2*im)]),void 0!==Zu&&Vu.faceVertexUvs[1].push([new S().fromArray(Zu,2*am),new S().fromArray(Zu,2*om),new S().fromArray(Zu,2*im)])}var Vu=this,ku=null===Fu.index?void 0:Fu.index.array,Wu=Fu.attributes,ju=Wu.position.array,qu=void 0===Wu.normal?void 0:Wu.normal.array,Xu=void 0===Wu.color?void 0:Wu.color.array,Yu=void 0===Wu.uv?void 0:Wu.uv.array,Zu=void 0===Wu.uv2?void 0:Wu.uv2.array;void 0!==Zu&&(this.faceVertexUvs[1]=[]);for(var Ju=0,Qu=0;Ju<ju.length;Ju+=3,Qu+=2)Vu.vertices.push(new A().fromArray(ju,Ju)),void 0!==Xu&&Vu.colors.push(new W().fromArray(Xu,Ju));var Ku=Fu.groups;if(0<Ku.length)for(var Ju=0;Ju<Ku.length;Ju++)for(var $u=Ku[Ju],em=$u.start,tm=$u.count,Qu=em;Qu<em+tm;Qu+=3)void 0===ku?Hu(Qu,Qu+1,Qu+2,$u.materialIndex):Hu(ku[Qu],ku[Qu+1],ku[Qu+2],$u.materialIndex);else if(void 0!==ku)for(var Ju=0;Ju<ku.length;Ju+=3)Hu(ku[Ju],ku[Ju+1],ku[Ju+2]);else for(var Ju=0;Ju<ju.length/3;Ju+=3)Hu(Ju,Ju+1,Ju+2);return this.computeFaceNormals(),null!==Fu.boundingBox&&(this.boundingBox=Fu.boundingBox.clone()),null!==Fu.boundingSphere&&(this.boundingSphere=Fu.boundingSphere.clone()),this},center:function(){var Fu=new A;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fu).negate(),this.translate(Fu.x,Fu.y,Fu.z),this}}(),normalize:function(){this.computeBoundingSphere();var Fu=this.boundingSphere.center,Hu=this.boundingSphere.radius,Vu=0===Hu?1:1/Hu,ku=new E;return ku.set(Vu,0,0,-Vu*Fu.x,0,Vu,0,-Vu*Fu.y,0,0,Vu,-Vu*Fu.z,0,0,0,1),this.applyMatrix(ku),this},computeFaceNormals:function(){for(var Fu=new A,Hu=new A,Vu=0,ku=this.faces.length;Vu<ku;Vu++){var Wu=this.faces[Vu],ju=this.vertices[Wu.a],qu=this.vertices[Wu.b],Xu=this.vertices[Wu.c];Fu.subVectors(Xu,qu),Hu.subVectors(ju,qu),Fu.cross(Hu),Fu.normalize(),Wu.normal.copy(Fu)}},computeVertexNormals:function(Fu){Fu===void 0&&(Fu=!0);var Hu,Vu,ku,Wu,ju,qu;for(qu=Array(this.vertices.length),Hu=0,Vu=this.vertices.length;Hu<Vu;Hu++)qu[Hu]=new A;if(Fu){var Xu,Yu,Zu,Ju=new A,Qu=new A;for(ku=0,Wu=this.faces.length;ku<Wu;ku++)ju=this.faces[ku],Xu=this.vertices[ju.a],Yu=this.vertices[ju.b],Zu=this.vertices[ju.c],Ju.subVectors(Zu,Yu),Qu.subVectors(Xu,Yu),Ju.cross(Qu),qu[ju.a].add(Ju),qu[ju.b].add(Ju),qu[ju.c].add(Ju)}else for(this.computeFaceNormals(),ku=0,Wu=this.faces.length;ku<Wu;ku++)ju=this.faces[ku],qu[ju.a].add(ju.normal),qu[ju.b].add(ju.normal),qu[ju.c].add(ju.normal);for(Hu=0,Vu=this.vertices.length;Hu<Vu;Hu++)qu[Hu].normalize();for(ku=0,Wu=this.faces.length;ku<Wu;ku++){ju=this.faces[ku];var Ku=ju.vertexNormals;3===Ku.length?(Ku[0].copy(qu[ju.a]),Ku[1].copy(qu[ju.b]),Ku[2].copy(qu[ju.c])):(Ku[0]=qu[ju.a].clone(),Ku[1]=qu[ju.b].clone(),Ku[2]=qu[ju.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var Fu,Hu,Vu;for(this.computeFaceNormals(),Fu=0,Hu=this.faces.length;Fu<Hu;Fu++){Vu=this.faces[Fu];var ku=Vu.vertexNormals;3===ku.length?(ku[0].copy(Vu.normal),ku[1].copy(Vu.normal),ku[2].copy(Vu.normal)):(ku[0]=Vu.normal.clone(),ku[1]=Vu.normal.clone(),ku[2]=Vu.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var Fu,Hu,Vu,ku,Wu;for(Vu=0,ku=this.faces.length;Vu<ku;Vu++)for(Wu=this.faces[Vu],Wu.__originalFaceNormal?Wu.__originalFaceNormal.copy(Wu.normal):Wu.__originalFaceNormal=Wu.normal.clone(),Wu.__originalVertexNormals||(Wu.__originalVertexNormals=[]),(Fu=0,Hu=Wu.vertexNormals.length);Fu<Hu;Fu++)Wu.__originalVertexNormals[Fu]?Wu.__originalVertexNormals[Fu].copy(Wu.vertexNormals[Fu]):Wu.__originalVertexNormals[Fu]=Wu.vertexNormals[Fu].clone();var ju=new ee;for(ju.faces=this.faces,Fu=0,Hu=this.morphTargets.length;Fu<Hu;Fu++){if(!this.morphNormals[Fu]){this.morphNormals[Fu]={},this.morphNormals[Fu].faceNormals=[],this.morphNormals[Fu].vertexNormals=[];var qu=this.morphNormals[Fu].faceNormals,Xu=this.morphNormals[Fu].vertexNormals,Yu,Zu;for(Vu=0,ku=this.faces.length;Vu<ku;Vu++)Yu=new A,Zu={a:new A,b:new A,c:new A},qu.push(Yu),Xu.push(Zu)}var Ju=this.morphNormals[Fu];ju.vertices=this.morphTargets[Fu].vertices,ju.computeFaceNormals(),ju.computeVertexNormals();var Yu,Zu;for(Vu=0,ku=this.faces.length;Vu<ku;Vu++)Wu=this.faces[Vu],Yu=Ju.faceNormals[Vu],Zu=Ju.vertexNormals[Vu],Yu.copy(Wu.normal),Zu.a.copy(Wu.vertexNormals[0]),Zu.b.copy(Wu.vertexNormals[1]),Zu.c.copy(Wu.vertexNormals[2])}for(Vu=0,ku=this.faces.length;Vu<ku;Vu++)Wu=this.faces[Vu],Wu.normal=Wu.__originalFaceNormal,Wu.vertexNormals=Wu.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new O),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new F),this.boundingSphere.setFromPoints(this.vertices)},merge:function(Fu,Hu,Vu){if(!(Fu&&Fu.isGeometry))return void console.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.',Fu);var Wu=this.vertices.length,ju=this.vertices,qu=Fu.vertices,Xu=this.faces,Yu=Fu.faces,Zu=this.faceVertexUvs[0],Ju=Fu.faceVertexUvs[0],Qu=this.colors,Ku=Fu.colors,ku;Vu===void 0&&(Vu=0),Hu!==void 0&&(ku=new C().getNormalMatrix(Hu));for(var $u=0,em=qu.length;$u<em;$u++){var tm=qu[$u],rm=tm.clone();Hu!==void 0&&rm.applyMatrix4(Hu),ju.push(rm)}for(var $u=0,em=Ku.length;$u<em;$u++)Qu.push(Ku[$u].clone());for($u=0,em=Yu.length;$u<em;$u++){var am=Yu[$u],sm=am.vertexNormals,lm=am.vertexColors,om,im,nm;om=new Z(am.a+Wu,am.b+Wu,am.c+Wu),om.normal.copy(am.normal),ku!=void 0&&om.normal.applyMatrix3(ku).normalize();for(var pm=0,dm=sm.length;pm<dm;pm++)im=sm[pm].clone(),void 0!=ku&&im.applyMatrix3(ku).normalize(),om.vertexNormals.push(im);om.color.copy(am.color);for(var pm=0,dm=lm.length;pm<dm;pm++)nm=lm[pm],om.vertexColors.push(nm.clone());om.materialIndex=am.materialIndex+Vu,Xu.push(om)}for($u=0,em=Ju.length;$u<em;$u++){var cm=Ju[$u],um=[];if(void 0!==cm){for(var pm=0,dm=cm.length;pm<dm;pm++)um.push(cm[pm].clone());Zu.push(um)}}},mergeMesh:function(Fu){return Fu&&Fu.isMesh?void(Fu.matrixAutoUpdate&&Fu.updateMatrix(),this.merge(Fu.geometry,Fu.matrix)):void console.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.',Fu)},mergeVertices:function(){var Fu={},Hu=[],Vu=[],qu=Math.pow(10,4),ku,Wu,Xu,Yu,Zu,Ju,Qu,Ku;for(Xu=0,Yu=this.vertices.length;Xu<Yu;Xu++)ku=this.vertices[Xu],Wu=Math.round(ku.x*qu)+'_'+Math.round(ku.y*qu)+'_'+Math.round(ku.z*qu),void 0===Fu[Wu]?(Fu[Wu]=Xu,Hu.push(this.vertices[Xu]),Vu[Xu]=Hu.length-1):Vu[Xu]=Vu[Fu[Wu]];var $u=[];for(Xu=0,Yu=this.faces.length;Xu<Yu;Xu++){Zu=this.faces[Xu],Zu.a=Vu[Zu.a],Zu.b=Vu[Zu.b],Zu.c=Vu[Zu.c],Ju=[Zu.a,Zu.b,Zu.c];for(var em=0;3>em;em++)if(Ju[em]===Ju[(em+1)%3]){$u.push(Xu);break}}for(Xu=$u.length-1;0<=Xu;Xu--){var tm=$u[Xu];for(this.faces.splice(tm,1),Qu=0,Ku=this.faceVertexUvs.length;Qu<Ku;Qu++)this.faceVertexUvs[Qu].splice(tm,1)}var rm=this.vertices.length-Hu.length;return this.vertices=Hu,rm},setFromPoints:function(Fu){this.vertices=[];for(var Hu=0,Vu=Fu.length,ku;Hu<Vu;Hu++)ku=Fu[Hu],this.vertices.push(new A(ku.x,ku.y,ku.z||0));return this},sortFacesByMaterialIndex:function(){for(var Hu=this.faces,Vu=Hu.length,ku=0;ku<Vu;ku++)Hu[ku]._id=ku;Hu.sort(function(Zu,Ju){return Zu.materialIndex-Ju.materialIndex});var Wu=this.faceVertexUvs[0],ju=this.faceVertexUvs[1],qu,Xu;Wu&&Wu.length===Vu&&(qu=[]),ju&&ju.length===Vu&&(Xu=[]);for(var ku=0,Yu;ku<Vu;ku++)Yu=Hu[ku]._id,qu&&qu.push(Wu[Yu]),Xu&&Xu.push(ju[Yu]);qu&&(this.faceVertexUvs[0]=qu),Xu&&(this.faceVertexUvs[1]=Xu)},toJSON:function(){function Fu(fm,hm,ym){return ym?fm|1<<hm:fm&~(1<<hm)}function Hu(fm){var hm=fm.x.toString()+fm.y.toString()+fm.z.toString();return void 0===Ku[hm]?(Ku[hm]=Qu.length/3,Qu.push(fm.x,fm.y,fm.z),Ku[hm]):Ku[hm]}function Vu(fm){var hm=fm.r.toString()+fm.g.toString()+fm.b.toString();return void 0===em[hm]?(em[hm]=$u.length,$u.push(fm.getHex()),em[hm]):em[hm]}function ku(fm){var hm=fm.x.toString()+fm.y.toString();return void 0===rm[hm]?(rm[hm]=tm.length/2,tm.push(fm.x,fm.y),rm[hm]):rm[hm]}var Wu={metadata:{version:4.5,type:'Geometry',generator:'Geometry.toJSON'}};if(Wu.uuid=this.uuid,Wu.type=this.type,''!==this.name&&(Wu.name=this.name),void 0!==this.parameters){var ju=this.parameters;for(var qu in ju)void 0!==ju[qu]&&(Wu[qu]=ju[qu]);return Wu}for(var Xu=[],Yu=0,Zu;Yu<this.vertices.length;Yu++)Zu=this.vertices[Yu],Xu.push(Zu.x,Zu.y,Zu.z);for(var Ju=[],Qu=[],Ku={},$u=[],em={},tm=[],rm={},Yu=0;Yu<this.faces.length;Yu++){var am=this.faces[Yu],nm=void 0!==this.faceVertexUvs[0][Yu],sm=0<am.normal.length(),lm=0<am.vertexNormals.length,pm=1!==am.color.r||1!==am.color.g||1!==am.color.b,dm=0<am.vertexColors.length,cm=0;if(cm=Fu(cm,0,0),cm=Fu(cm,1,!0),cm=Fu(cm,2,!1),cm=Fu(cm,3,nm),cm=Fu(cm,4,sm),cm=Fu(cm,5,lm),cm=Fu(cm,6,pm),cm=Fu(cm,7,dm),Ju.push(cm),Ju.push(am.a,am.b,am.c),Ju.push(am.materialIndex),nm){var um=this.faceVertexUvs[0][Yu];Ju.push(ku(um[0]),ku(um[1]),ku(um[2]))}if(sm&&Ju.push(Hu(am.normal)),lm){var mm=am.vertexNormals;Ju.push(Hu(mm[0]),Hu(mm[1]),Hu(mm[2]))}if(pm&&Ju.push(Vu(am.color)),dm){var gm=am.vertexColors;Ju.push(Vu(gm[0]),Vu(gm[1]),Vu(gm[2]))}}return Wu.data={},Wu.data.vertices=Xu,Wu.data.normals=Qu,0<$u.length&&(Wu.data.colors=$u),0<tm.length&&(Wu.data.uvs=[tm]),Wu.data.faces=Ju,Wu},clone:function(){return new ee().copy(this)},copy:function(Fu){var Hu,Vu,ku,Wu,ju,qu;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=Fu.name;var Xu=Fu.vertices;for(Hu=0,Vu=Xu.length;Hu<Vu;Hu++)this.vertices.push(Xu[Hu].clone());var Yu=Fu.colors;for(Hu=0,Vu=Yu.length;Hu<Vu;Hu++)this.colors.push(Yu[Hu].clone());var Zu=Fu.faces;for(Hu=0,Vu=Zu.length;Hu<Vu;Hu++)this.faces.push(Zu[Hu].clone());for(Hu=0,Vu=Fu.faceVertexUvs.length;Hu<Vu;Hu++){var Ju=Fu.faceVertexUvs[Hu];for(void 0===this.faceVertexUvs[Hu]&&(this.faceVertexUvs[Hu]=[]),ku=0,Wu=Ju.length;ku<Wu;ku++){var Qu=Ju[ku],Ku=[];for(ju=0,qu=Qu.length;ju<qu;ju++){var $u=Qu[ju];Ku.push($u.clone())}this.faceVertexUvs[Hu].push(Ku)}}var em=Fu.morphTargets;for(Hu=0,Vu=em.length;Hu<Vu;Hu++){var tm={name:em[Hu].name};if(void 0!==em[Hu].vertices)for(tm.vertices=[],ku=0,Wu=em[Hu].vertices.length;ku<Wu;ku++)tm.vertices.push(em[Hu].vertices[ku].clone());if(void 0!==em[Hu].normals)for(tm.normals=[],ku=0,Wu=em[Hu].normals.length;ku<Wu;ku++)tm.normals.push(em[Hu].normals[ku].clone());this.morphTargets.push(tm)}var rm=Fu.morphNormals;for(Hu=0,Vu=rm.length;Hu<Vu;Hu++){var am={};if(void 0!==rm[Hu].vertexNormals)for(am.vertexNormals=[],ku=0,Wu=rm[Hu].vertexNormals.length;ku<Wu;ku++){var om=rm[Hu].vertexNormals[ku],im={};im.a=om.a.clone(),im.b=om.b.clone(),im.c=om.c.clone(),am.vertexNormals.push(im)}if(void 0!==rm[Hu].faceNormals)for(am.faceNormals=[],ku=0,Wu=rm[Hu].faceNormals.length;ku<Wu;ku++)am.faceNormals.push(rm[Hu].faceNormals[ku].clone());this.morphNormals.push(am)}var nm=Fu.skinWeights;for(Hu=0,Vu=nm.length;Hu<Vu;Hu++)this.skinWeights.push(nm[Hu].clone());var sm=Fu.skinIndices;for(Hu=0,Vu=sm.length;Hu<Vu;Hu++)this.skinIndices.push(sm[Hu].clone());var lm=Fu.lineDistances;for(Hu=0,Vu=lm.length;Hu<Vu;Hu++)this.lineDistances.push(lm[Hu]);var pm=Fu.boundingBox;null!==pm&&(this.boundingBox=pm.clone());var dm=Fu.boundingSphere;return null!==dm&&(this.boundingSphere=dm.clone()),this.elementsNeedUpdate=Fu.elementsNeedUpdate,this.verticesNeedUpdate=Fu.verticesNeedUpdate,this.uvsNeedUpdate=Fu.uvsNeedUpdate,this.normalsNeedUpdate=Fu.normalsNeedUpdate,this.colorsNeedUpdate=Fu.colorsNeedUpdate,this.lineDistancesNeedUpdate=Fu.lineDistancesNeedUpdate,this.groupsNeedUpdate=Fu.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),Object.defineProperty(re.prototype,'needsUpdate',{set:function(Fu){!0===Fu&&this.version++}}),Object.assign(re.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(Fu){if(Array.isArray(Fu))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');return this.count=void 0===Fu?0:Fu.length/this.itemSize,this.array=Fu,this},setDynamic:function(Fu){return this.dynamic=Fu,this},copy:function(Fu){return this.name=Fu.name,this.array=new Fu.array.constructor(Fu.array),this.itemSize=Fu.itemSize,this.count=Fu.count,this.normalized=Fu.normalized,this.dynamic=Fu.dynamic,this},copyAt:function(Fu,Hu,Vu){Fu*=this.itemSize,Vu*=Hu.itemSize;for(var ku=0,Wu=this.itemSize;ku<Wu;ku++)this.array[Fu+ku]=Hu.array[Vu+ku];return this},copyArray:function(Fu){return this.array.set(Fu),this},copyColorsArray:function(Fu){for(var Hu=this.array,Vu=0,ku=0,Wu=Fu.length,ju;ku<Wu;ku++)ju=Fu[ku],void 0===ju&&(console.warn('THREE.BufferAttribute.copyColorsArray(): color is undefined',ku),ju=new W),Hu[Vu++]=ju.r,Hu[Vu++]=ju.g,Hu[Vu++]=ju.b;return this},copyVector2sArray:function(Fu){for(var Hu=this.array,Vu=0,ku=0,Wu=Fu.length,ju;ku<Wu;ku++)ju=Fu[ku],void 0===ju&&(console.warn('THREE.BufferAttribute.copyVector2sArray(): vector is undefined',ku),ju=new S),Hu[Vu++]=ju.x,Hu[Vu++]=ju.y;return this},copyVector3sArray:function(Fu){for(var Hu=this.array,Vu=0,ku=0,Wu=Fu.length,ju;ku<Wu;ku++)ju=Fu[ku],void 0===ju&&(console.warn('THREE.BufferAttribute.copyVector3sArray(): vector is undefined',ku),ju=new A),Hu[Vu++]=ju.x,Hu[Vu++]=ju.y,Hu[Vu++]=ju.z;return this},copyVector4sArray:function(Fu){for(var Hu=this.array,Vu=0,ku=0,Wu=Fu.length,ju;ku<Wu;ku++)ju=Fu[ku],void 0===ju&&(console.warn('THREE.BufferAttribute.copyVector4sArray(): vector is undefined',ku),ju=new I),Hu[Vu++]=ju.x,Hu[Vu++]=ju.y,Hu[Vu++]=ju.z,Hu[Vu++]=ju.w;return this},set:function(Fu,Hu){return void 0===Hu&&(Hu=0),this.array.set(Fu,Hu),this},getX:function(Fu){return this.array[Fu*this.itemSize]},setX:function(Fu,Hu){return this.array[Fu*this.itemSize]=Hu,this},getY:function(Fu){return this.array[Fu*this.itemSize+1]},setY:function(Fu,Hu){return this.array[Fu*this.itemSize+1]=Hu,this},getZ:function(Fu){return this.array[Fu*this.itemSize+2]},setZ:function(Fu,Hu){return this.array[Fu*this.itemSize+2]=Hu,this},getW:function(Fu){return this.array[Fu*this.itemSize+3]},setW:function(Fu,Hu){return this.array[Fu*this.itemSize+3]=Hu,this},setXY:function(Fu,Hu,Vu){return Fu*=this.itemSize,this.array[Fu+0]=Hu,this.array[Fu+1]=Vu,this},setXYZ:function(Fu,Hu,Vu,ku){return Fu*=this.itemSize,this.array[Fu+0]=Hu,this.array[Fu+1]=Vu,this.array[Fu+2]=ku,this},setXYZW:function(Fu,Hu,Vu,ku,Wu){return Fu*=this.itemSize,this.array[Fu+0]=Hu,this.array[Fu+1]=Vu,this.array[Fu+2]=ku,this.array[Fu+3]=Wu,this},onUpload:function(Fu){return this.onUploadCallback=Fu,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),oe.prototype=Object.create(re.prototype),oe.prototype.constructor=oe,ie.prototype=Object.create(re.prototype),ie.prototype.constructor=ie,ne.prototype=Object.create(re.prototype),ne.prototype.constructor=ne,se.prototype=Object.create(re.prototype),se.prototype.constructor=se,le.prototype=Object.create(re.prototype),le.prototype.constructor=le,pe.prototype=Object.create(re.prototype),pe.prototype.constructor=pe,ue.prototype=Object.create(re.prototype),ue.prototype.constructor=ue,ge.prototype=Object.create(re.prototype),ge.prototype.constructor=ge,fe.prototype=Object.create(re.prototype),fe.prototype.constructor=fe,Object.assign(he.prototype,{computeGroups:function(Fu){for(var Vu=[],ku=void 0,Wu=Fu.faces,ju=0,Hu,qu;ju<Wu.length;ju++)qu=Wu[ju],qu.materialIndex!==ku&&(ku=qu.materialIndex,void 0!=Hu&&(Hu.count=3*ju-Hu.start,Vu.push(Hu)),Hu={start:3*ju,materialIndex:ku});Hu!==void 0&&(Hu.count=3*ju-Hu.start,Vu.push(Hu)),this.groups=Vu},fromGeometry:function(Fu){var Hu=Fu.faces,Vu=Fu.vertices,ku=Fu.faceVertexUvs,Wu=ku[0]&&0<ku[0].length,ju=ku[1]&&0<ku[1].length,qu=Fu.morphTargets,Xu=qu.length,Yu;if(0<Xu){Yu=[];for(var Zu=0;Zu<Xu;Zu++)Yu[Zu]={name:qu[Zu].name,data:[]};this.morphTargets.position=Yu}var Ju=Fu.morphNormals,Qu=Ju.length,Ku;if(0<Qu){Ku=[];for(var Zu=0;Zu<Qu;Zu++)Ku[Zu]={name:Ju[Zu].name,data:[]};this.morphTargets.normal=Ku}var $u=Fu.skinIndices,em=Fu.skinWeights,tm=$u.length===Vu.length,rm=em.length===Vu.length;0<Vu.length&&0===Hu.length&&console.error('THREE.DirectGeometry: Faceless geometries are not supported.');for(var Zu=0,am;Zu<Hu.length;Zu++){am=Hu[Zu],this.vertices.push(Vu[am.a],Vu[am.b],Vu[am.c]);var om=am.vertexNormals;if(3===om.length)this.normals.push(om[0],om[1],om[2]);else{var im=am.normal;this.normals.push(im,im,im)}var nm=am.vertexColors;if(3===nm.length)this.colors.push(nm[0],nm[1],nm[2]);else{var sm=am.color;this.colors.push(sm,sm,sm)}if(!0===Wu){var lm=ku[0][Zu];void 0===lm?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ',Zu),this.uvs.push(new S,new S,new S)):this.uvs.push(lm[0],lm[1],lm[2])}if(!0===ju){var lm=ku[1][Zu];void 0===lm?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ',Zu),this.uvs2.push(new S,new S,new S)):this.uvs2.push(lm[0],lm[1],lm[2])}for(var pm=0,dm;pm<Xu;pm++)dm=qu[pm].vertices,Yu[pm].data.push(dm[am.a],dm[am.b],dm[am.c]);for(var pm=0,cm;pm<Qu;pm++)cm=Ju[pm].vertexNormals[Zu],Ku[pm].data.push(cm.a,cm.b,cm.c);tm&&this.skinIndices.push($u[am.a],$u[am.b],$u[am.c]),rm&&this.skinWeights.push(em[am.a],em[am.b],em[am.c])}return this.computeGroups(Fu),this.verticesNeedUpdate=Fu.verticesNeedUpdate,this.normalsNeedUpdate=Fu.normalsNeedUpdate,this.colorsNeedUpdate=Fu.colorsNeedUpdate,this.uvsNeedUpdate=Fu.uvsNeedUpdate,this.groupsNeedUpdate=Fu.groupsNeedUpdate,this}});var kc=1;xe.prototype=Object.assign(Object.create(M.prototype),{constructor:xe,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(Fu){this.index=Array.isArray(Fu)?new(65535<ye(Fu)?ue:le)(Fu,1):Fu},addAttribute:function(Fu,Hu){return Hu&&Hu.isBufferAttribute||Hu&&Hu.isInterleavedBufferAttribute?'index'===Fu?(console.warn('THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.'),this.setIndex(Hu),this):(this.attributes[Fu]=Hu,this):(console.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).'),this.addAttribute(Fu,new re(arguments[1],arguments[2])))},getAttribute:function(Fu){return this.attributes[Fu]},removeAttribute:function(Fu){return delete this.attributes[Fu],this},addGroup:function(Fu,Hu,Vu){this.groups.push({start:Fu,count:Hu,materialIndex:Vu===void 0?0:Vu})},clearGroups:function(){this.groups=[]},setDrawRange:function(Fu,Hu){this.drawRange.start=Fu,this.drawRange.count=Hu},applyMatrix:function(Fu){var Hu=this.attributes.position;void 0!==Hu&&(Fu.applyToBufferAttribute(Hu),Hu.needsUpdate=!0);var Vu=this.attributes.normal;if(void 0!==Vu){var ku=new C().getNormalMatrix(Fu);ku.applyToBufferAttribute(Vu),Vu.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var Fu=new E;return function(Vu){return Fu.makeRotationX(Vu),this.applyMatrix(Fu),this}}(),rotateY:function(){var Fu=new E;return function(Vu){return Fu.makeRotationY(Vu),this.applyMatrix(Fu),this}}(),rotateZ:function(){var Fu=new E;return function(Vu){return Fu.makeRotationZ(Vu),this.applyMatrix(Fu),this}}(),translate:function(){var Fu=new E;return function(Vu,ku,Wu){return Fu.makeTranslation(Vu,ku,Wu),this.applyMatrix(Fu),this}}(),scale:function(){var Fu=new E;return function(Vu,ku,Wu){return Fu.makeScale(Vu,ku,Wu),this.applyMatrix(Fu),this}}(),lookAt:function(){var Fu=new K;return function(Vu){Fu.lookAt(Vu),Fu.updateMatrix(),this.applyMatrix(Fu.matrix)}}(),center:function(){var Fu=new A;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fu).negate(),this.translate(Fu.x,Fu.y,Fu.z),this}}(),setFromObject:function(Fu){var Hu=Fu.geometry;if(Fu.isPoints||Fu.isLine){var Vu=new ge(3*Hu.vertices.length,3),ku=new ge(3*Hu.colors.length,3);if(this.addAttribute('position',Vu.copyVector3sArray(Hu.vertices)),this.addAttribute('color',ku.copyColorsArray(Hu.colors)),Hu.lineDistances&&Hu.lineDistances.length===Hu.vertices.length){var Wu=new ge(Hu.lineDistances.length,1);this.addAttribute('lineDistance',Wu.copyArray(Hu.lineDistances))}null!==Hu.boundingSphere&&(this.boundingSphere=Hu.boundingSphere.clone()),null!==Hu.boundingBox&&(this.boundingBox=Hu.boundingBox.clone())}else Fu.isMesh&&Hu&&Hu.isGeometry&&this.fromGeometry(Hu);return this},setFromPoints:function(Fu){for(var Hu=[],Vu=0,ku=Fu.length,Wu;Vu<ku;Vu++)Wu=Fu[Vu],Hu.push(Wu.x,Wu.y,Wu.z||0);return this.addAttribute('position',new ge(Hu,3)),this},updateFromObject:function(Fu){var Hu=Fu.geometry;if(Fu.isMesh){var Vu=Hu.__directGeometry;if(!0===Hu.elementsNeedUpdate&&(Vu=void 0,Hu.elementsNeedUpdate=!1),void 0===Vu)return this.fromGeometry(Hu);Vu.verticesNeedUpdate=Hu.verticesNeedUpdate,Vu.normalsNeedUpdate=Hu.normalsNeedUpdate,Vu.colorsNeedUpdate=Hu.colorsNeedUpdate,Vu.uvsNeedUpdate=Hu.uvsNeedUpdate,Vu.groupsNeedUpdate=Hu.groupsNeedUpdate,Hu.verticesNeedUpdate=!1,Hu.normalsNeedUpdate=!1,Hu.colorsNeedUpdate=!1,Hu.uvsNeedUpdate=!1,Hu.groupsNeedUpdate=!1,Hu=Vu}var ku;return!0===Hu.verticesNeedUpdate&&(ku=this.attributes.position,void 0!=ku&&(ku.copyVector3sArray(Hu.vertices),ku.needsUpdate=!0),Hu.verticesNeedUpdate=!1),!0===Hu.normalsNeedUpdate&&(ku=this.attributes.normal,void 0!=ku&&(ku.copyVector3sArray(Hu.normals),ku.needsUpdate=!0),Hu.normalsNeedUpdate=!1),!0===Hu.colorsNeedUpdate&&(ku=this.attributes.color,void 0!=ku&&(ku.copyColorsArray(Hu.colors),ku.needsUpdate=!0),Hu.colorsNeedUpdate=!1),Hu.uvsNeedUpdate&&(ku=this.attributes.uv,void 0!=ku&&(ku.copyVector2sArray(Hu.uvs),ku.needsUpdate=!0),Hu.uvsNeedUpdate=!1),Hu.lineDistancesNeedUpdate&&(ku=this.attributes.lineDistance,void 0!=ku&&(ku.copyArray(Hu.lineDistances),ku.needsUpdate=!0),Hu.lineDistancesNeedUpdate=!1),Hu.groupsNeedUpdate&&(Hu.computeGroups(Fu.geometry),this.groups=Hu.groups,Hu.groupsNeedUpdate=!1),this},fromGeometry:function(Fu){return Fu.__directGeometry=new he().fromGeometry(Fu),this.fromDirectGeometry(Fu.__directGeometry)},fromDirectGeometry:function(Fu){var Hu=new Float32Array(3*Fu.vertices.length);if(this.addAttribute('position',new re(Hu,3).copyVector3sArray(Fu.vertices)),0<Fu.normals.length){var Vu=new Float32Array(3*Fu.normals.length);this.addAttribute('normal',new re(Vu,3).copyVector3sArray(Fu.normals))}if(0<Fu.colors.length){var ku=new Float32Array(3*Fu.colors.length);this.addAttribute('color',new re(ku,3).copyColorsArray(Fu.colors))}if(0<Fu.uvs.length){var Wu=new Float32Array(2*Fu.uvs.length);this.addAttribute('uv',new re(Wu,2).copyVector2sArray(Fu.uvs))}if(0<Fu.uvs2.length){var ju=new Float32Array(2*Fu.uvs2.length);this.addAttribute('uv2',new re(ju,2).copyVector2sArray(Fu.uvs2))}for(var qu in this.groups=Fu.groups,Fu.morphTargets){for(var Xu=[],Yu=Fu.morphTargets[qu],Zu=0,Ju=Yu.length;Zu<Ju;Zu++){var Qu=Yu[Zu],Ku=new ge(3*Qu.data.length,3);Ku.name=Qu.name,Xu.push(Ku.copyVector3sArray(Qu.data))}this.morphAttributes[qu]=Xu}if(0<Fu.skinIndices.length){var $u=new ge(4*Fu.skinIndices.length,4);this.addAttribute('skinIndex',$u.copyVector4sArray(Fu.skinIndices))}if(0<Fu.skinWeights.length){var em=new ge(4*Fu.skinWeights.length,4);this.addAttribute('skinWeight',em.copyVector4sArray(Fu.skinWeights))}return null!==Fu.boundingSphere&&(this.boundingSphere=Fu.boundingSphere.clone()),null!==Fu.boundingBox&&(this.boundingBox=Fu.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new O);var Fu=this.attributes.position;Fu===void 0?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(Fu),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var Fu=new O,Hu=new A;return function(){null===this.boundingSphere&&(this.boundingSphere=new F);var ku=this.attributes.position;if(ku){var Wu=this.boundingSphere.center;Fu.setFromBufferAttribute(ku),Fu.getCenter(Wu);for(var ju=0,qu=0,Xu=ku.count;qu<Xu;qu++)Hu.x=ku.getX(qu),Hu.y=ku.getY(qu),Hu.z=ku.getZ(qu),ju=Math.max(ju,Wu.distanceToSquared(Hu));this.boundingSphere.radius=Math.sqrt(ju),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var Fu=this.index,Hu=this.attributes;if(Hu.position){var Vu=Hu.position.array;if(Hu.normal===void 0)this.addAttribute('normal',new re(new Float32Array(Vu.length),3));else for(var ku=Hu.normal.array,Wu=0,ju=ku.length;Wu<ju;Wu++)ku[Wu]=0;var qu=Hu.normal.array,Xu,Yu,Zu,Ju=new A,Qu=new A,Ku=new A,$u=new A,em=new A;if(Fu)for(var tm=Fu.array,Wu=0,ju=Fu.count;Wu<ju;Wu+=3)Xu=3*tm[Wu+0],Yu=3*tm[Wu+1],Zu=3*tm[Wu+2],Ju.fromArray(Vu,Xu),Qu.fromArray(Vu,Yu),Ku.fromArray(Vu,Zu),$u.subVectors(Ku,Qu),em.subVectors(Ju,Qu),$u.cross(em),qu[Xu]+=$u.x,qu[Xu+1]+=$u.y,qu[Xu+2]+=$u.z,qu[Yu]+=$u.x,qu[Yu+1]+=$u.y,qu[Yu+2]+=$u.z,qu[Zu]+=$u.x,qu[Zu+1]+=$u.y,qu[Zu+2]+=$u.z;else for(var Wu=0,ju=Vu.length;Wu<ju;Wu+=9)Ju.fromArray(Vu,Wu),Qu.fromArray(Vu,Wu+3),Ku.fromArray(Vu,Wu+6),$u.subVectors(Ku,Qu),em.subVectors(Ju,Qu),$u.cross(em),qu[Wu]=$u.x,qu[Wu+1]=$u.y,qu[Wu+2]=$u.z,qu[Wu+3]=$u.x,qu[Wu+4]=$u.y,qu[Wu+5]=$u.z,qu[Wu+6]=$u.x,qu[Wu+7]=$u.y,qu[Wu+8]=$u.z;this.normalizeNormals(),Hu.normal.needsUpdate=!0}},merge:function(Fu,Hu){if(!(Fu&&Fu.isBufferGeometry))return void console.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.',Fu);Hu===void 0&&(Hu=0,console.warn('THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'));var Vu=this.attributes;for(var ku in Vu)if(Fu.attributes[ku]!==void 0)for(var Wu=Vu[ku],ju=Wu.array,qu=Fu.attributes[ku],Xu=qu.array,Yu=qu.itemSize,Zu=0,Ju=Yu*Hu;Zu<Xu.length;Zu++,Ju++)ju[Ju]=Xu[Zu];return this},normalizeNormals:function(){var Fu=new A;return function(){for(var Vu=this.attributes.normal,ku=0,Wu=Vu.count;ku<Wu;ku++)Fu.x=Vu.getX(ku),Fu.y=Vu.getY(ku),Fu.z=Vu.getZ(ku),Fu.normalize(),Vu.setXYZ(ku,Fu.x,Fu.y,Fu.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn('THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.'),this;var Fu=new xe,Hu=this.index.array,Vu=this.attributes;for(var ku in Vu){for(var Wu=Vu[ku],ju=Wu.array,qu=Wu.itemSize,Xu=new ju.constructor(Hu.length*qu),Yu=0,Zu=0,Ju=0,Qu=Hu.length;Ju<Qu;Ju++){Yu=Hu[Ju]*qu;for(var Ku=0;Ku<qu;Ku++)Xu[Zu++]=ju[Yu++]}Fu.addAttribute(ku,new re(Xu,qu))}for(var $u=this.groups,Ju=0,Qu=$u.length,em;Ju<Qu;Ju++)em=$u[Ju],Fu.addGroup(em.start,em.count,em.materialIndex);return Fu},toJSON:function(){var Fu={metadata:{version:4.5,type:'BufferGeometry',generator:'BufferGeometry.toJSON'}};if(Fu.uuid=this.uuid,Fu.type=this.type,''!==this.name&&(Fu.name=this.name),0<Object.keys(this.userData).length&&(Fu.userData=this.userData),void 0!==this.parameters){var Hu=this.parameters;for(var Vu in Hu)void 0!==Hu[Vu]&&(Fu[Vu]=Hu[Vu]);return Fu}Fu.data={attributes:{}};var ku=this.index;if(null!==ku){var Wu=Array.prototype.slice.call(ku.array);Fu.data.index={type:ku.array.constructor.name,array:Wu}}var ju=this.attributes;for(var Vu in ju){var qu=ju[Vu],Wu=Array.prototype.slice.call(qu.array);Fu.data.attributes[Vu]={itemSize:qu.itemSize,type:qu.array.constructor.name,array:Wu,normalized:qu.normalized}}var Xu=this.groups;0<Xu.length&&(Fu.data.groups=JSON.parse(JSON.stringify(Xu)));var Yu=this.boundingSphere;return null!==Yu&&(Fu.data.boundingSphere={center:Yu.center.toArray(),radius:Yu.radius}),Fu},clone:function(){return new xe().copy(this)},copy:function(Fu){var Hu,Vu,ku;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=Fu.name;var Wu=Fu.index;null!==Wu&&this.setIndex(Wu.clone());var ju=Fu.attributes;for(Hu in ju){var qu=ju[Hu];this.addAttribute(Hu,qu.clone())}var Xu=Fu.morphAttributes;for(Hu in Xu){var Yu=[],Zu=Xu[Hu];for(Vu=0,ku=Zu.length;Vu<ku;Vu++)Yu.push(Zu[Vu].clone());this.morphAttributes[Hu]=Yu}var Ju=Fu.groups;for(Vu=0,ku=Ju.length;Vu<ku;Vu++){var Qu=Ju[Vu];this.addGroup(Qu.start,Qu.count,Qu.materialIndex)}var Ku=Fu.boundingBox;null!==Ku&&(this.boundingBox=Ku.clone());var $u=Fu.boundingSphere;return null!==$u&&(this.boundingSphere=$u.clone()),this.drawRange.start=Fu.drawRange.start,this.drawRange.count=Fu.drawRange.count,this.userData=Fu.userData,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),ve.prototype=Object.create(ee.prototype),ve.prototype.constructor=ve,_e.prototype=Object.create(xe.prototype),_e.prototype.constructor=_e,Me.prototype=Object.create(ee.prototype),Me.prototype.constructor=Me,Se.prototype=Object.create(xe.prototype),Se.prototype.constructor=Se;var Wc=0;Te.prototype=Object.assign(Object.create(M.prototype),{constructor:Te,isMaterial:!0,onBeforeCompile:function(){},setValues:function(Fu){if(void 0!==Fu)for(var Hu in Fu){var Vu=Fu[Hu];if(void 0===Vu){console.warn('THREE.Material: \''+Hu+'\' parameter is undefined.');continue}if('shading'==Hu){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=Vu===Bn;continue}var ku=this[Hu];if(void 0===ku){console.warn('THREE.'+this.type+': \''+Hu+'\' is not a property of this material.');continue}ku&&ku.isColor?ku.set(Vu):ku&&ku.isVector3&&Vu&&Vu.isVector3?ku.copy(Vu):this[Hu]=Vu}},toJSON:function(Fu){function Hu(qu){var Xu=[];for(var Yu in qu){var Zu=qu[Yu];delete Zu.metadata,Xu.push(Zu)}return Xu}var Vu=void 0===Fu||'string'==typeof Fu;Vu&&(Fu={textures:{},images:{}});var ku={metadata:{version:4.5,type:'Material',generator:'Material.toJSON'}};if(ku.uuid=this.uuid,ku.type=this.type,''!==this.name&&(ku.name=this.name),this.color&&this.color.isColor&&(ku.color=this.color.getHex()),void 0!==this.roughness&&(ku.roughness=this.roughness),void 0!==this.metalness&&(ku.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(ku.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(ku.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(ku.specular=this.specular.getHex()),void 0!==this.shininess&&(ku.shininess=this.shininess),void 0!==this.clearCoat&&(ku.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(ku.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(ku.map=this.map.toJSON(Fu).uuid),this.alphaMap&&this.alphaMap.isTexture&&(ku.alphaMap=this.alphaMap.toJSON(Fu).uuid),this.lightMap&&this.lightMap.isTexture&&(ku.lightMap=this.lightMap.toJSON(Fu).uuid),this.aoMap&&this.aoMap.isTexture&&(ku.aoMap=this.aoMap.toJSON(Fu).uuid,ku.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(ku.bumpMap=this.bumpMap.toJSON(Fu).uuid,ku.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(ku.normalMap=this.normalMap.toJSON(Fu).uuid,ku.normalMapType=this.normalMapType,ku.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(ku.displacementMap=this.displacementMap.toJSON(Fu).uuid,ku.displacementScale=this.displacementScale,ku.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(ku.roughnessMap=this.roughnessMap.toJSON(Fu).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(ku.metalnessMap=this.metalnessMap.toJSON(Fu).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(ku.emissiveMap=this.emissiveMap.toJSON(Fu).uuid),this.specularMap&&this.specularMap.isTexture&&(ku.specularMap=this.specularMap.toJSON(Fu).uuid),this.envMap&&this.envMap.isTexture&&(ku.envMap=this.envMap.toJSON(Fu).uuid,ku.reflectivity=this.reflectivity,void 0!==this.combine&&(ku.combine=this.combine),void 0!==this.envMapIntensity&&(ku.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(ku.gradientMap=this.gradientMap.toJSON(Fu).uuid),void 0!==this.size&&(ku.size=this.size),void 0!==this.sizeAttenuation&&(ku.sizeAttenuation=this.sizeAttenuation),this.blending!==Hn&&(ku.blending=this.blending),!0===this.flatShading&&(ku.flatShading=this.flatShading),this.side!==Dn&&(ku.side=this.side),this.vertexColors!==Un&&(ku.vertexColors=this.vertexColors),1>this.opacity&&(ku.opacity=this.opacity),!0===this.transparent&&(ku.transparent=this.transparent),ku.depthFunc=this.depthFunc,ku.depthTest=this.depthTest,ku.depthWrite=this.depthWrite,0!==this.rotation&&(ku.rotation=this.rotation),!0===this.polygonOffset&&(ku.polygonOffset=!0),0!==this.polygonOffsetFactor&&(ku.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(ku.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(ku.linewidth=this.linewidth),void 0!==this.dashSize&&(ku.dashSize=this.dashSize),void 0!==this.gapSize&&(ku.gapSize=this.gapSize),void 0!==this.scale&&(ku.scale=this.scale),!0===this.dithering&&(ku.dithering=!0),0<this.alphaTest&&(ku.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(ku.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(ku.wireframe=this.wireframe),1<this.wireframeLinewidth&&(ku.wireframeLinewidth=this.wireframeLinewidth),'round'!==this.wireframeLinecap&&(ku.wireframeLinecap=this.wireframeLinecap),'round'!==this.wireframeLinejoin&&(ku.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(ku.morphTargets=!0),!0===this.skinning&&(ku.skinning=!0),!1===this.visible&&(ku.visible=!1),'{}'!==JSON.stringify(this.userData)&&(ku.userData=this.userData),Vu){var Wu=Hu(Fu.textures),ju=Hu(Fu.images);0<Wu.length&&(ku.textures=Wu),0<ju.length&&(ku.images=ju)}return ku},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){this.name=Fu.name,this.fog=Fu.fog,this.lights=Fu.lights,this.blending=Fu.blending,this.side=Fu.side,this.flatShading=Fu.flatShading,this.vertexColors=Fu.vertexColors,this.opacity=Fu.opacity,this.transparent=Fu.transparent,this.blendSrc=Fu.blendSrc,this.blendDst=Fu.blendDst,this.blendEquation=Fu.blendEquation,this.blendSrcAlpha=Fu.blendSrcAlpha,this.blendDstAlpha=Fu.blendDstAlpha,this.blendEquationAlpha=Fu.blendEquationAlpha,this.depthFunc=Fu.depthFunc,this.depthTest=Fu.depthTest,this.depthWrite=Fu.depthWrite,this.colorWrite=Fu.colorWrite,this.precision=Fu.precision,this.polygonOffset=Fu.polygonOffset,this.polygonOffsetFactor=Fu.polygonOffsetFactor,this.polygonOffsetUnits=Fu.polygonOffsetUnits,this.dithering=Fu.dithering,this.alphaTest=Fu.alphaTest,this.premultipliedAlpha=Fu.premultipliedAlpha,this.visible=Fu.visible,this.userData=JSON.parse(JSON.stringify(Fu.userData)),this.clipShadows=Fu.clipShadows,this.clipIntersection=Fu.clipIntersection;var Hu=Fu.clippingPlanes,Vu=null;if(null!==Hu){var ku=Hu.length;Vu=Array(ku);for(var Wu=0;Wu!==ku;++Wu)Vu[Wu]=Hu[Wu].clone()}return this.clippingPlanes=Vu,this.shadowSide=Fu.shadowSide,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),Ee.prototype=Object.create(Te.prototype),Ee.prototype.constructor=Ee,Ee.prototype.isShaderMaterial=!0,Ee.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.fragmentShader=Fu.fragmentShader,this.vertexShader=Fu.vertexShader,this.uniforms=Uc.clone(Fu.uniforms),this.defines=Object.assign({},Fu.defines),this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this.lights=Fu.lights,this.clipping=Fu.clipping,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.morphNormals=Fu.morphNormals,this.extensions=Fu.extensions,this},Ee.prototype.toJSON=function(Fu){var Hu=Te.prototype.toJSON.call(this,Fu);for(var Vu in Hu.uniforms={},this.uniforms){var ku=this.uniforms[Vu],Wu=ku.value;Hu.uniforms[Vu]=Wu.isTexture?{type:'t',value:Wu.toJSON(Fu).uuid}:Wu.isColor?{type:'c',value:Wu.getHex()}:Wu.isVector2?{type:'v2',value:Wu.toArray()}:Wu.isVector3?{type:'v3',value:Wu.toArray()}:Wu.isVector4?{type:'v4',value:Wu.toArray()}:Wu.isMatrix4?{type:'m4',value:Wu.toArray()}:{value:Wu}}return 0<Object.keys(this.defines).length&&(Hu.defines=this.defines),Hu.vertexShader=this.vertexShader,Hu.fragmentShader=this.fragmentShader,Hu},Object.assign(we.prototype,{set:function(Fu,Hu){return this.origin.copy(Fu),this.direction.copy(Hu),this},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.origin.copy(Fu.origin),this.direction.copy(Fu.direction),this},at:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Ray: .at() target is now required'),Hu=new A),Hu.copy(this.direction).multiplyScalar(Fu).add(this.origin)},lookAt:function(Fu){return this.direction.copy(Fu).sub(this.origin).normalize(),this},recast:function(){var Fu=new A;return function(Vu){return this.origin.copy(this.at(Vu,Fu)),this}}(),closestPointToPoint:function(Fu,Hu){Hu===void 0&&(console.warn('THREE.Ray: .closestPointToPoint() target is now required'),Hu=new A),Hu.subVectors(Fu,this.origin);var Vu=Hu.dot(this.direction);return 0>Vu?Hu.copy(this.origin):Hu.copy(this.direction).multiplyScalar(Vu).add(this.origin)},distanceToPoint:function(Fu){return Math.sqrt(this.distanceSqToPoint(Fu))},distanceSqToPoint:function(){var Fu=new A;return function(Vu){var ku=Fu.subVectors(Vu,this.origin).dot(this.direction);return 0>ku?this.origin.distanceToSquared(Vu):(Fu.copy(this.direction).multiplyScalar(ku).add(this.origin),Fu.distanceToSquared(Vu))}}(),distanceSqToSegment:function(){var Fu=new A,Hu=new A,Vu=new A;return function(Wu,ju,qu,Xu){Fu.copy(Wu).add(ju).multiplyScalar(0.5),Hu.copy(ju).sub(Wu).normalize(),Vu.copy(this.origin).sub(Fu);var Yu=0.5*Wu.distanceTo(ju),Zu=-this.direction.dot(Hu),Ju=Vu.dot(this.direction),Qu=-Vu.dot(Hu),Ku=Vu.lengthSq(),$u=Math.abs(1-Zu*Zu),em,tm,rm,am;if(!(0<$u))tm=0<Zu?-Yu:Yu,em=Math.max(0,-(Zu*tm+Ju)),rm=-em*em+tm*(tm+2*Qu)+Ku;else if(em=Zu*Qu-Ju,tm=Zu*Ju-Qu,am=Yu*$u,!(0<=em))tm<=-am?(em=Math.max(0,-(-Zu*Yu+Ju)),tm=0<em?-Yu:Math.min(Math.max(-Yu,-Qu),Yu),rm=-em*em+tm*(tm+2*Qu)+Ku):tm<=am?(em=0,tm=Math.min(Math.max(-Yu,-Qu),Yu),rm=tm*(tm+2*Qu)+Ku):(em=Math.max(0,-(Zu*Yu+Ju)),tm=0<em?Yu:Math.min(Math.max(-Yu,-Qu),Yu),rm=-em*em+tm*(tm+2*Qu)+Ku);else if(!(tm>=-am))tm=-Yu,em=Math.max(0,-(Zu*tm+Ju)),rm=-em*em+tm*(tm+2*Qu)+Ku;else if(tm<=am){var om=1/$u;em*=om,tm*=om,rm=em*(em+Zu*tm+2*Ju)+tm*(Zu*em+tm+2*Qu)+Ku}else tm=Yu,em=Math.max(0,-(Zu*tm+Ju)),rm=-em*em+tm*(tm+2*Qu)+Ku;return qu&&qu.copy(this.direction).multiplyScalar(em).add(this.origin),Xu&&Xu.copy(Hu).multiplyScalar(tm).add(Fu),rm}}(),intersectSphere:function(){var Fu=new A;return function(Vu,ku){Fu.subVectors(Vu.center,this.origin);var Wu=Fu.dot(this.direction),ju=Fu.dot(Fu)-Wu*Wu,qu=Vu.radius*Vu.radius;if(ju>qu)return null;var Xu=Math.sqrt(qu-ju),Yu=Wu-Xu,Zu=Wu+Xu;return 0>Yu&&0>Zu?null:0>Yu?this.at(Zu,ku):this.at(Yu,ku)}}(),intersectsSphere:function(Fu){return this.distanceSqToPoint(Fu.center)<=Fu.radius*Fu.radius},distanceToPlane:function(Fu){var Hu=Fu.normal.dot(this.direction);if(0===Hu)return 0===Fu.distanceToPoint(this.origin)?0:null;var Vu=-(this.origin.dot(Fu.normal)+Fu.constant)/Hu;return 0<=Vu?Vu:null},intersectPlane:function(Fu,Hu){var Vu=this.distanceToPlane(Fu);return null===Vu?null:this.at(Vu,Hu)},intersectsPlane:function(Fu){var Hu=Fu.distanceToPoint(this.origin);if(0===Hu)return!0;var Vu=Fu.normal.dot(this.direction);return!!(0>Vu*Hu)},intersectBox:function(Fu,Hu){var Yu=1/this.direction.x,Zu=1/this.direction.y,Ju=1/this.direction.z,Qu=this.origin,Vu,ku,Wu,ju,qu,Xu;return(0<=Yu?(Vu=(Fu.min.x-Qu.x)*Yu,ku=(Fu.max.x-Qu.x)*Yu):(Vu=(Fu.max.x-Qu.x)*Yu,ku=(Fu.min.x-Qu.x)*Yu),0<=Zu?(Wu=(Fu.min.y-Qu.y)*Zu,ju=(Fu.max.y-Qu.y)*Zu):(Wu=(Fu.max.y-Qu.y)*Zu,ju=(Fu.min.y-Qu.y)*Zu),Vu>ju||Wu>ku)?null:((Wu>Vu||Vu!=Vu)&&(Vu=Wu),(ju<ku||ku!=ku)&&(ku=ju),0<=Ju?(qu=(Fu.min.z-Qu.z)*Ju,Xu=(Fu.max.z-Qu.z)*Ju):(qu=(Fu.max.z-Qu.z)*Ju,Xu=(Fu.min.z-Qu.z)*Ju),Vu>Xu||qu>ku)?null:((qu>Vu||Vu!=Vu)&&(Vu=qu),(Xu<ku||ku!=ku)&&(ku=Xu),0>ku?null:this.at(0<=Vu?Vu:ku,Hu))},intersectsBox:function(){var Fu=new A;return function(Vu){return null!==this.intersectBox(Vu,Fu)}}(),intersectTriangle:function(){var Fu=new A,Hu=new A,Vu=new A,ku=new A;return function(ju,qu,Xu,Yu,Zu){Hu.subVectors(qu,ju),Vu.subVectors(Xu,ju),ku.crossVectors(Hu,Vu);var Ju=this.direction.dot(ku),Qu;if(0<Ju){if(Yu)return null;Qu=1}else if(0>Ju)Qu=-1,Ju=-Ju;else return null;Fu.subVectors(this.origin,ju);var Ku=Qu*this.direction.dot(Vu.crossVectors(Fu,Vu));if(0>Ku)return null;var $u=Qu*this.direction.dot(Hu.cross(Fu));if(0>$u)return null;if(Ku+$u>Ju)return null;var em=-Qu*Fu.dot(ku);return 0>em?null:this.at(em/Ju,Zu)}}(),applyMatrix4:function(Fu){return this.origin.applyMatrix4(Fu),this.direction.transformDirection(Fu),this},equals:function(Fu){return Fu.origin.equals(this.origin)&&Fu.direction.equals(this.direction)}}),Object.assign(Le,{getNormal:function(){var Fu=new A;return function(Vu,ku,Wu,ju){ju===void 0&&(console.warn('THREE.Triangle: .getNormal() target is now required'),ju=new A),ju.subVectors(Wu,ku),Fu.subVectors(Vu,ku),ju.cross(Fu);var qu=ju.lengthSq();return 0<qu?ju.multiplyScalar(1/Math.sqrt(qu)):ju.set(0,0,0)}}(),getBarycoord:function(){var Fu=new A,Hu=new A,Vu=new A;return function(Wu,ju,qu,Xu,Yu){Fu.subVectors(Xu,ju),Hu.subVectors(qu,ju),Vu.subVectors(Wu,ju);var Zu=Fu.dot(Fu),Ju=Fu.dot(Hu),Qu=Fu.dot(Vu),Ku=Hu.dot(Hu),$u=Hu.dot(Vu),em=Zu*Ku-Ju*Ju;if(void 0===Yu&&(console.warn('THREE.Triangle: .getBarycoord() target is now required'),Yu=new A),0==em)return Yu.set(-2,-1,-1);var tm=1/em,rm=(Ku*Qu-Ju*$u)*tm,am=(Zu*$u-Ju*Qu)*tm;return Yu.set(1-rm-am,am,rm)}}(),containsPoint:function(){var Fu=new A;return function(Vu,ku,Wu,ju){return Le.getBarycoord(Vu,ku,Wu,ju,Fu),0<=Fu.x&&0<=Fu.y&&1>=Fu.x+Fu.y}}(),getUV:function(){var Fu=new A;return function(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){return this.getBarycoord(Vu,ku,Wu,ju,Fu),Zu.set(0,0),Zu.addScaledVector(qu,Fu.x),Zu.addScaledVector(Xu,Fu.y),Zu.addScaledVector(Yu,Fu.z),Zu}}()}),Object.assign(Le.prototype,{set:function(Fu,Hu,Vu){return this.a.copy(Fu),this.b.copy(Hu),this.c.copy(Vu),this},setFromPointsAndIndices:function(Fu,Hu,Vu,ku){return this.a.copy(Fu[Hu]),this.b.copy(Fu[Vu]),this.c.copy(Fu[ku]),this},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.a.copy(Fu.a),this.b.copy(Fu.b),this.c.copy(Fu.c),this},getArea:function(){var Fu=new A,Hu=new A;return function(){return Fu.subVectors(this.c,this.b),Hu.subVectors(this.a,this.b),0.5*Fu.cross(Hu).length()}}(),getMidpoint:function(Fu){return void 0===Fu&&(console.warn('THREE.Triangle: .getMidpoint() target is now required'),Fu=new A),Fu.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(Fu){return Le.getNormal(this.a,this.b,this.c,Fu)},getPlane:function(Fu){return void 0===Fu&&(console.warn('THREE.Triangle: .getPlane() target is now required'),Fu=new A),Fu.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(Fu,Hu){return Le.getBarycoord(Fu,this.a,this.b,this.c,Hu)},containsPoint:function(Fu){return Le.containsPoint(Fu,this.a,this.b,this.c)},getUV:function(Fu,Hu,Vu,ku,Wu){return Le.getUV(Fu,this.a,this.b,this.c,Hu,Vu,ku,Wu)},intersectsBox:function(Fu){return Fu.intersectsTriangle(this)},closestPointToPoint:function(){var Fu=new A,Hu=new A,Vu=new A,ku=new A,Wu=new A,ju=new A;return function(Xu,Yu){void 0===Yu&&(console.warn('THREE.Triangle: .closestPointToPoint() target is now required'),Yu=new A);var Zu=this.a,Ju=this.b,Qu=this.c,Ku,$u;Fu.subVectors(Ju,Zu),Hu.subVectors(Qu,Zu),ku.subVectors(Xu,Zu);var em=Fu.dot(ku),tm=Hu.dot(ku);if(0>=em&&0>=tm)return Yu.copy(Zu);Wu.subVectors(Xu,Ju);var rm=Fu.dot(Wu),am=Hu.dot(Wu);if(0<=rm&&am<=rm)return Yu.copy(Ju);var om=em*am-rm*tm;if(0>=om&&0<=em&&0>=rm)return Ku=em/(em-rm),Yu.copy(Zu).addScaledVector(Fu,Ku);ju.subVectors(Xu,Qu);var im=Fu.dot(ju),nm=Hu.dot(ju);if(0<=nm&&im<=nm)return Yu.copy(Qu);var sm=im*tm-em*nm;if(0>=sm&&0<=tm&&0>=nm)return $u=tm/(tm-nm),Yu.copy(Zu).addScaledVector(Hu,$u);var lm=rm*nm-im*am;if(0>=lm&&0<=am-rm&&0<=im-nm)return Vu.subVectors(Qu,Ju),$u=(am-rm)/(am-rm+(im-nm)),Yu.copy(Ju).addScaledVector(Vu,$u);var pm=1/(lm+sm+om);return Ku=sm*pm,$u=om*pm,Yu.copy(Zu).addScaledVector(Fu,Ku).addScaledVector(Hu,$u)}}(),equals:function(Fu){return Fu.a.equals(this.a)&&Fu.b.equals(this.b)&&Fu.c.equals(this.c)}}),Ae.prototype=Object.create(Te.prototype),Ae.prototype.constructor=Ae,Ae.prototype.isMeshBasicMaterial=!0,Ae.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.map=Fu.map,this.lightMap=Fu.lightMap,this.lightMapIntensity=Fu.lightMapIntensity,this.aoMap=Fu.aoMap,this.aoMapIntensity=Fu.aoMapIntensity,this.specularMap=Fu.specularMap,this.alphaMap=Fu.alphaMap,this.envMap=Fu.envMap,this.combine=Fu.combine,this.reflectivity=Fu.reflectivity,this.refractionRatio=Fu.refractionRatio,this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this.wireframeLinecap=Fu.wireframeLinecap,this.wireframeLinejoin=Fu.wireframeLinejoin,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this},Pe.prototype=Object.assign(Object.create(K.prototype),{constructor:Pe,isMesh:!0,setDrawMode:function(Fu){this.drawMode=Fu},copy:function(Fu){return K.prototype.copy.call(this,Fu),this.drawMode=Fu.drawMode,void 0!==Fu.morphTargetInfluences&&(this.morphTargetInfluences=Fu.morphTargetInfluences.slice()),void 0!==Fu.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},Fu.morphTargetDictionary)),this},updateMorphTargets:function(){var Fu=this.geometry,Hu,Vu,ku;if(Fu.isBufferGeometry){var Wu=Fu.morphAttributes,ju=Object.keys(Wu);if(0<ju.length){var qu=Wu[ju[0]];if(qu!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},(Hu=0,Vu=qu.length);Hu<Vu;Hu++)ku=qu[Hu].name||Hu+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[ku]=Hu}}else{var Xu=Fu.morphTargets;if(Xu!==void 0&&0<Xu.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},(Hu=0,Vu=Xu.length);Hu<Vu;Hu++)ku=Xu[Hu].name||Hu+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[ku]=Hu}},raycast:function(){function Fu(rm,am,om,im,nm,sm,lm,pm){var dm;if(dm=am.side===zn?im.intersectTriangle(lm,sm,nm,!0,pm):im.intersectTriangle(nm,sm,lm,am.side!==Nn,pm),null===dm)return null;tm.copy(pm),tm.applyMatrix4(rm.matrixWorld);var cm=om.ray.origin.distanceTo(tm);return cm<om.near||cm>om.far?null:{distance:cm,point:tm.clone(),object:rm}}function Hu(rm,am,om,im,nm,sm,lm,pm,dm){ju.fromBufferAttribute(nm,lm),qu.fromBufferAttribute(nm,pm),Xu.fromBufferAttribute(nm,dm);var cm=Fu(rm,am,om,im,ju,qu,Xu,em);if(cm){sm&&(Qu.fromBufferAttribute(sm,lm),Ku.fromBufferAttribute(sm,pm),$u.fromBufferAttribute(sm,dm),cm.uv=Le.getUV(em,ju,qu,Xu,Qu,Ku,$u,new S));var um=new Z(lm,pm,dm);Le.getNormal(ju,qu,Xu,um.normal),cm.face=um}return cm}var Vu=new E,ku=new we,Wu=new F,ju=new A,qu=new A,Xu=new A,Yu=new A,Zu=new A,Ju=new A,Qu=new S,Ku=new S,$u=new S,em=new A,tm=new A;return function(am,om){var im=this.geometry,nm=this.material,sm=this.matrixWorld;if(void 0!==nm&&(null===im.boundingSphere&&im.computeBoundingSphere(),Wu.copy(im.boundingSphere),Wu.applyMatrix4(sm),!1!==am.ray.intersectsSphere(Wu))&&(Vu.getInverse(sm),ku.copy(am.ray).applyMatrix4(Vu),null===im.boundingBox||!1!==ku.intersectsBox(im.boundingBox))){var lm;if(im.isBufferGeometry){var um=im.index,mm=im.attributes.position,gm=im.attributes.uv,fm=im.groups,hm=im.drawRange,pm,dm,cm,ym,xm,vm,_m,bm,Mm,Sm,Tm;if(null!==um){if(Array.isArray(nm))for(ym=0,vm=fm.length;ym<vm;ym++)for(bm=fm[ym],Mm=nm[bm.materialIndex],Sm=Math.max(bm.start,hm.start),Tm=Math.min(bm.start+bm.count,hm.start+hm.count),(xm=Sm,_m=Tm);xm<_m;xm+=3)pm=um.getX(xm),dm=um.getX(xm+1),cm=um.getX(xm+2),lm=Hu(this,Mm,am,ku,mm,gm,pm,dm,cm),lm&&(lm.faceIndex=Math.floor(xm/3),om.push(lm));else for(Sm=Math.max(0,hm.start),Tm=Math.min(um.count,hm.start+hm.count),(ym=Sm,vm=Tm);ym<vm;ym+=3)pm=um.getX(ym),dm=um.getX(ym+1),cm=um.getX(ym+2),lm=Hu(this,nm,am,ku,mm,gm,pm,dm,cm),lm&&(lm.faceIndex=Math.floor(ym/3),om.push(lm));}else if(void 0!==mm)if(Array.isArray(nm))for(ym=0,vm=fm.length;ym<vm;ym++)for(bm=fm[ym],Mm=nm[bm.materialIndex],Sm=Math.max(bm.start,hm.start),Tm=Math.min(bm.start+bm.count,hm.start+hm.count),(xm=Sm,_m=Tm);xm<_m;xm+=3)pm=xm,dm=xm+1,cm=xm+2,lm=Hu(this,Mm,am,ku,mm,gm,pm,dm,cm),lm&&(lm.faceIndex=Math.floor(xm/3),om.push(lm));else for(Sm=Math.max(0,hm.start),Tm=Math.min(mm.count,hm.start+hm.count),(ym=Sm,vm=Tm);ym<vm;ym+=3)pm=ym,dm=ym+1,cm=ym+2,lm=Hu(this,nm,am,ku,mm,gm,pm,dm,cm),lm&&(lm.faceIndex=Math.floor(ym/3),om.push(lm))}else if(im.isGeometry){var Am=Array.isArray(nm),Pm=im.vertices,Cm=im.faces,Im=im.faceVertexUvs[0],Em,wm,Lm,Rm;0<Im.length&&(Rm=Im);for(var Dm=0,zm=Cm.length;Dm<zm;Dm++){var Nm=Cm[Dm],Bm=Am?nm[Nm.materialIndex]:nm;if(void 0!==Bm){if(Em=Pm[Nm.a],wm=Pm[Nm.b],Lm=Pm[Nm.c],!0===Bm.morphTargets){var Um=im.morphTargets,Gm=this.morphTargetInfluences;ju.set(0,0,0),qu.set(0,0,0),Xu.set(0,0,0);for(var Om=0,Fm=Um.length,Hm;Om<Fm;Om++)if(Hm=Gm[Om],0!==Hm){var Vm=Um[Om].vertices;ju.addScaledVector(Yu.subVectors(Vm[Nm.a],Em),Hm),qu.addScaledVector(Zu.subVectors(Vm[Nm.b],wm),Hm),Xu.addScaledVector(Ju.subVectors(Vm[Nm.c],Lm),Hm)}ju.add(Em),qu.add(wm),Xu.add(Lm),Em=ju,wm=qu,Lm=Xu}if(lm=Fu(this,Bm,am,ku,Em,wm,Lm,em),lm){if(Rm&&Rm[Dm]){var km=Rm[Dm];Qu.copy(km[0]),Ku.copy(km[1]),$u.copy(km[2]),lm.uv=Le.getUV(em,Em,wm,Lm,Qu,Ku,$u,new S)}lm.face=Nm,lm.faceIndex=Dm,om.push(lm)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),He.prototype=Object.create(R.prototype),He.prototype.constructor=He,He.prototype.isCubeTexture=!0,Object.defineProperty(He.prototype,'images',{get:function(){return this.image},set:function(Fu){this.image=Fu}}),Ve.prototype=Object.create(R.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isDataTexture3D=!0;var jc=new R,qc=new Ve,Xc=new He,Yc=[],Zc=[],Jc=new Float32Array(16),Qc=new Float32Array(9),Kc=new Float32Array(4);Mt.prototype.updateCache=function(Fu){var Hu=this.cache;Fu instanceof Float32Array&&Hu.length!==Fu.length&&(this.cache=new Float32Array(Fu.length)),qe(Hu,Fu)},St.prototype.setValue=function(Fu,Hu,Vu){for(var ku=this.seq,Wu=0,ju=ku.length,qu;Wu!==ju;++Wu)qu=ku[Wu],qu.setValue(Fu,Hu[qu.id],Vu)};var $c=/([\w\d_]+)(\])?(\[|\.)?/g;wt.prototype.setValue=function(Fu,Hu,Vu){var ku=this.map[Hu];ku!==void 0&&ku.setValue(Fu,Vu,this.renderer)},wt.prototype.setOptional=function(Fu,Hu,Vu){var ku=Hu[Vu];ku!==void 0&&this.setValue(Fu,Vu,ku)},wt.upload=function(Fu,Hu,Vu,ku){for(var Wu=0,ju=Hu.length;Wu!==ju;++Wu){var qu=Hu[Wu],Xu=Vu[qu.id];!1!==Xu.needsUpdate&&qu.setValue(Fu,Xu.value,ku)}},wt.seqWithValue=function(Fu,Hu){for(var Vu=[],ku=0,Wu=Fu.length,ju;ku!==Wu;++ku)ju=Fu[ku],ju.id in Hu&&Vu.push(ju);return Vu};var eu=0,tu=0;Kt.prototype=Object.create(Te.prototype),Kt.prototype.constructor=Kt,Kt.prototype.isMeshDepthMaterial=!0,Kt.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.depthPacking=Fu.depthPacking,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.map=Fu.map,this.alphaMap=Fu.alphaMap,this.displacementMap=Fu.displacementMap,this.displacementScale=Fu.displacementScale,this.displacementBias=Fu.displacementBias,this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this},$t.prototype=Object.create(Te.prototype),$t.prototype.constructor=$t,$t.prototype.isMeshDistanceMaterial=!0,$t.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.referencePosition.copy(Fu.referencePosition),this.nearDistance=Fu.nearDistance,this.farDistance=Fu.farDistance,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.map=Fu.map,this.alphaMap=Fu.alphaMap,this.displacementMap=Fu.displacementMap,this.displacementScale=Fu.displacementScale,this.displacementBias=Fu.displacementBias,this},or.prototype=Object.assign(Object.create(K.prototype),{constructor:or,isGroup:!0}),ir.prototype=Object.assign(Object.create(K.prototype),{constructor:ir,isCamera:!0,copy:function(Fu,Hu){return K.prototype.copy.call(this,Fu,Hu),this.matrixWorldInverse.copy(Fu.matrixWorldInverse),this.projectionMatrix.copy(Fu.projectionMatrix),this.projectionMatrixInverse.copy(Fu.projectionMatrixInverse),this},getWorldDirection:function(Fu){Fu===void 0&&(console.warn('THREE.Camera: .getWorldDirection() target is now required'),Fu=new A),this.updateMatrixWorld(!0);var Hu=this.matrixWorld.elements;return Fu.set(-Hu[8],-Hu[9],-Hu[10]).normalize()},updateMatrixWorld:function(Fu){K.prototype.updateMatrixWorld.call(this,Fu),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),nr.prototype=Object.assign(Object.create(ir.prototype),{constructor:nr,isPerspectiveCamera:!0,copy:function(Fu,Hu){return ir.prototype.copy.call(this,Fu,Hu),this.fov=Fu.fov,this.zoom=Fu.zoom,this.near=Fu.near,this.far=Fu.far,this.focus=Fu.focus,this.aspect=Fu.aspect,this.view=null===Fu.view?null:Object.assign({},Fu.view),this.filmGauge=Fu.filmGauge,this.filmOffset=Fu.filmOffset,this},setFocalLength:function(Fu){var Hu=0.5*this.getFilmHeight()/Fu;this.fov=2*fp.RAD2DEG*Math.atan(Hu),this.updateProjectionMatrix()},getFocalLength:function(){var Fu=Math.tan(0.5*fp.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/Fu},getEffectiveFOV:function(){return 2*fp.RAD2DEG*Math.atan(Math.tan(0.5*fp.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(Fu,Hu,Vu,ku,Wu,ju){this.aspect=Fu/Hu,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=Fu,this.view.fullHeight=Hu,this.view.offsetX=Vu,this.view.offsetY=ku,this.view.width=Wu,this.view.height=ju,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var Fu=this.near,Hu=Fu*Math.tan(0.5*fp.DEG2RAD*this.fov)/this.zoom,Vu=2*Hu,ku=this.aspect*Vu,Wu=-0.5*ku,ju=this.view;if(null!==this.view&&this.view.enabled){var qu=ju.fullWidth,Xu=ju.fullHeight;Wu+=ju.offsetX*ku/qu,Hu-=ju.offsetY*Vu/Xu,ku*=ju.width/qu,Vu*=ju.height/Xu}var Yu=this.filmOffset;0!==Yu&&(Wu+=Fu*Yu/this.getFilmWidth()),this.projectionMatrix.makePerspective(Wu,Wu+ku,Hu,Hu-Vu,Fu,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(Fu){var Hu=K.prototype.toJSON.call(this,Fu);return Hu.object.fov=this.fov,Hu.object.zoom=this.zoom,Hu.object.near=this.near,Hu.object.far=this.far,Hu.object.focus=this.focus,Hu.object.aspect=this.aspect,null!==this.view&&(Hu.object.view=Object.assign({},this.view)),Hu.object.filmGauge=this.filmGauge,Hu.object.filmOffset=this.filmOffset,Hu}}),sr.prototype=Object.assign(Object.create(nr.prototype),{constructor:sr,isArrayCamera:!0});var ru=new A,au=new A;ur.prototype.isFogExp2=!0,ur.prototype.clone=function(){return new ur(this.color,this.density)},ur.prototype.toJSON=function(){return{type:'FogExp2',color:this.color.getHex(),density:this.density}},mr.prototype.isFog=!0,mr.prototype.clone=function(){return new mr(this.color,this.near,this.far)},mr.prototype.toJSON=function(){return{type:'Fog',color:this.color.getHex(),near:this.near,far:this.far}},gr.prototype=Object.assign(Object.create(K.prototype),{constructor:gr,copy:function(Fu,Hu){return K.prototype.copy.call(this,Fu,Hu),null!==Fu.background&&(this.background=Fu.background.clone()),null!==Fu.fog&&(this.fog=Fu.fog.clone()),null!==Fu.overrideMaterial&&(this.overrideMaterial=Fu.overrideMaterial.clone()),this.autoUpdate=Fu.autoUpdate,this.matrixAutoUpdate=Fu.matrixAutoUpdate,this},toJSON:function(Fu){var Hu=K.prototype.toJSON.call(this,Fu);return null!==this.background&&(Hu.object.background=this.background.toJSON(Fu)),null!==this.fog&&(Hu.object.fog=this.fog.toJSON()),Hu}}),Object.defineProperty(fr.prototype,'needsUpdate',{set:function(Fu){!0===Fu&&this.version++}}),Object.assign(fr.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(Fu){if(Array.isArray(Fu))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');return this.count=void 0===Fu?0:Fu.length/this.stride,this.array=Fu,this},setDynamic:function(Fu){return this.dynamic=Fu,this},copy:function(Fu){return this.array=new Fu.array.constructor(Fu.array),this.count=Fu.count,this.stride=Fu.stride,this.dynamic=Fu.dynamic,this},copyAt:function(Fu,Hu,Vu){Fu*=this.stride,Vu*=Hu.stride;for(var ku=0,Wu=this.stride;ku<Wu;ku++)this.array[Fu+ku]=Hu.array[Vu+ku];return this},set:function(Fu,Hu){return void 0===Hu&&(Hu=0),this.array.set(Fu,Hu),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(Fu){return this.onUploadCallback=Fu,this}}),Object.defineProperties(hr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(hr.prototype,{isInterleavedBufferAttribute:!0,setX:function(Fu,Hu){return this.data.array[Fu*this.data.stride+this.offset]=Hu,this},setY:function(Fu,Hu){return this.data.array[Fu*this.data.stride+this.offset+1]=Hu,this},setZ:function(Fu,Hu){return this.data.array[Fu*this.data.stride+this.offset+2]=Hu,this},setW:function(Fu,Hu){return this.data.array[Fu*this.data.stride+this.offset+3]=Hu,this},getX:function(Fu){return this.data.array[Fu*this.data.stride+this.offset]},getY:function(Fu){return this.data.array[Fu*this.data.stride+this.offset+1]},getZ:function(Fu){return this.data.array[Fu*this.data.stride+this.offset+2]},getW:function(Fu){return this.data.array[Fu*this.data.stride+this.offset+3]},setXY:function(Fu,Hu,Vu){return Fu=Fu*this.data.stride+this.offset,this.data.array[Fu+0]=Hu,this.data.array[Fu+1]=Vu,this},setXYZ:function(Fu,Hu,Vu,ku){return Fu=Fu*this.data.stride+this.offset,this.data.array[Fu+0]=Hu,this.data.array[Fu+1]=Vu,this.data.array[Fu+2]=ku,this},setXYZW:function(Fu,Hu,Vu,ku,Wu){return Fu=Fu*this.data.stride+this.offset,this.data.array[Fu+0]=Hu,this.data.array[Fu+1]=Vu,this.data.array[Fu+2]=ku,this.data.array[Fu+3]=Wu,this}}),yr.prototype=Object.create(Te.prototype),yr.prototype.constructor=yr,yr.prototype.isSpriteMaterial=!0,yr.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.map=Fu.map,this.rotation=Fu.rotation,this.sizeAttenuation=Fu.sizeAttenuation,this};var ou;xr.prototype=Object.assign(Object.create(K.prototype),{constructor:xr,isSprite:!0,raycast:function(){function Fu($u,em,tm,rm,am,om){Wu.subVectors($u,tm).addScalar(0.5).multiply(rm),am===void 0?ju.copy(Wu):(ju.x=om*Wu.x-am*Wu.y,ju.y=am*Wu.x+om*Wu.y),$u.copy(em),$u.x+=ju.x,$u.y+=ju.y,$u.applyMatrix4(qu)}var Hu=new A,Vu=new A,ku=new A,Wu=new S,ju=new S,qu=new E,Xu=new A,Yu=new A,Zu=new A,Ju=new S,Qu=new S,Ku=new S;return function(em,tm){Vu.setFromMatrixScale(this.matrixWorld),qu.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),ku.setFromMatrixPosition(this.modelViewMatrix);var rm=this.material.rotation,am,om;0!==rm&&(om=Math.cos(rm),am=Math.sin(rm));var im=this.center;Fu(Xu.set(-0.5,-0.5,0),ku,im,Vu,am,om),Fu(Yu.set(0.5,-0.5,0),ku,im,Vu,am,om),Fu(Zu.set(0.5,0.5,0),ku,im,Vu,am,om),Ju.set(0,0),Qu.set(1,0),Ku.set(1,1);var nm=em.ray.intersectTriangle(Xu,Yu,Zu,!1,Hu);if(!(null===nm&&(Fu(Yu.set(-0.5,0.5,0),ku,im,Vu,am,om),Qu.set(0,1),nm=em.ray.intersectTriangle(Xu,Zu,Yu,!1,Hu),null===nm))){var sm=em.ray.origin.distanceTo(Hu);sm<em.near||sm>em.far||tm.push({distance:sm,point:Hu.clone(),uv:Le.getUV(Hu,Xu,Yu,Zu,Ju,Qu,Ku,new S),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(Fu){return K.prototype.copy.call(this,Fu),void 0!==Fu.center&&this.center.copy(Fu.center),this}}),_r.prototype=Object.assign(Object.create(K.prototype),{constructor:_r,copy:function(Fu){K.prototype.copy.call(this,Fu,!1);for(var Hu=Fu.levels,Vu=0,ku=Hu.length,Wu;Vu<ku;Vu++)Wu=Hu[Vu],this.addLevel(Wu.object.clone(),Wu.distance);return this},addLevel:function(Fu,Hu){Hu===void 0&&(Hu=0),Hu=Math.abs(Hu);for(var Vu=this.levels,ku=0;ku<Vu.length&&!(Hu<Vu[ku].distance);ku++);Vu.splice(ku,0,{distance:Hu,object:Fu}),this.add(Fu)},getObjectForDistance:function(Fu){for(var Hu=this.levels,Vu=1,ku=Hu.length;Vu<ku&&!(Fu<Hu[Vu].distance);Vu++);return Hu[Vu-1].object},raycast:function(){var Fu=new A;return function(Vu,ku){Fu.setFromMatrixPosition(this.matrixWorld);var Wu=Vu.ray.origin.distanceTo(Fu);this.getObjectForDistance(Wu).raycast(Vu,ku)}}(),update:function(){var Fu=new A,Hu=new A;return function(ku){var Wu=this.levels;if(1<Wu.length){Fu.setFromMatrixPosition(ku.matrixWorld),Hu.setFromMatrixPosition(this.matrixWorld);var ju=Fu.distanceTo(Hu);Wu[0].object.visible=!0;for(var qu=1,Xu=Wu.length;qu<Xu&&ju>=Wu[qu].distance;qu++)Wu[qu-1].object.visible=!1,Wu[qu].object.visible=!0;for(;qu<Xu;qu++)Wu[qu].object.visible=!1}}}(),toJSON:function(Fu){var Hu=K.prototype.toJSON.call(this,Fu);Hu.object.levels=[];for(var Vu=this.levels,ku=0,Wu=Vu.length,ju;ku<Wu;ku++)ju=Vu[ku],Hu.object.levels.push({object:ju.object.uuid,distance:ju.distance});return Hu}}),Object.assign(br.prototype,{calculateInverses:function(){this.boneInverses=[];for(var Fu=0,Hu=this.bones.length,Vu;Fu<Hu;Fu++)Vu=new E,this.bones[Fu]&&Vu.getInverse(this.bones[Fu].matrixWorld),this.boneInverses.push(Vu)},pose:function(){var Fu,Hu,Vu;for(Hu=0,Vu=this.bones.length;Hu<Vu;Hu++)Fu=this.bones[Hu],Fu&&Fu.matrixWorld.getInverse(this.boneInverses[Hu]);for(Hu=0,Vu=this.bones.length;Hu<Vu;Hu++)Fu=this.bones[Hu],Fu&&(Fu.parent&&Fu.parent.isBone?(Fu.matrix.getInverse(Fu.parent.matrixWorld),Fu.matrix.multiply(Fu.matrixWorld)):Fu.matrix.copy(Fu.matrixWorld),Fu.matrix.decompose(Fu.position,Fu.quaternion,Fu.scale))},update:function(){var Fu=new E,Hu=new E;return function(){for(var ku=this.bones,Wu=this.boneInverses,ju=this.boneMatrices,qu=this.boneTexture,Xu=0,Yu=ku.length,Zu;Xu<Yu;Xu++)Zu=ku[Xu]?ku[Xu].matrixWorld:Hu,Fu.multiplyMatrices(Zu,Wu[Xu]),Fu.toArray(ju,16*Xu);qu!==void 0&&(qu.needsUpdate=!0)}}(),clone:function(){return new br(this.bones,this.boneInverses)},getBoneByName:function(Fu){for(var Hu=0,Vu=this.bones.length,ku;Hu<Vu;Hu++)if(ku=this.bones[Hu],ku.name===Fu)return ku}}),Mr.prototype=Object.assign(Object.create(K.prototype),{constructor:Mr,isBone:!0}),Sr.prototype=Object.assign(Object.create(Pe.prototype),{constructor:Sr,isSkinnedMesh:!0,initBones:function(){var Fu=[],Hu,Vu,ku,Wu;if(this.geometry&&void 0!==this.geometry.bones){for(ku=0,Wu=this.geometry.bones.length;ku<Wu;ku++)Vu=this.geometry.bones[ku],Hu=new Mr,Fu.push(Hu),Hu.name=Vu.name,Hu.position.fromArray(Vu.pos),Hu.quaternion.fromArray(Vu.rotq),void 0!==Vu.scl&&Hu.scale.fromArray(Vu.scl);for(ku=0,Wu=this.geometry.bones.length;ku<Wu;ku++)Vu=this.geometry.bones[ku],-1!==Vu.parent&&null!==Vu.parent&&void 0!==Fu[Vu.parent]?Fu[Vu.parent].add(Fu[ku]):this.add(Fu[ku])}return this.updateMatrixWorld(!0),Fu},bind:function(Fu,Hu){this.skeleton=Fu,Hu===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),Hu=this.matrixWorld),this.bindMatrix.copy(Hu),this.bindMatrixInverse.getInverse(Hu)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var Fu,Hu;if(this.geometry&&this.geometry.isGeometry)for(Hu=0;Hu<this.geometry.skinWeights.length;Hu++){var Vu=this.geometry.skinWeights[Hu];Fu=1/Vu.manhattanLength(),Fu===Infinity?Vu.set(1,0,0,0):Vu.multiplyScalar(Fu)}else if(this.geometry&&this.geometry.isBufferGeometry){var ku=new I,Wu=this.geometry.attributes.skinWeight;for(Hu=0;Hu<Wu.count;Hu++)ku.x=Wu.getX(Hu),ku.y=Wu.getY(Hu),ku.z=Wu.getZ(Hu),ku.w=Wu.getW(Hu),Fu=1/ku.manhattanLength(),Fu===Infinity?ku.set(1,0,0,0):ku.multiplyScalar(Fu),Wu.setXYZW(Hu,ku.x,ku.y,ku.z,ku.w)}},updateMatrixWorld:function(Fu){Pe.prototype.updateMatrixWorld.call(this,Fu),'attached'===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):'detached'===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn('THREE.SkinnedMesh: Unrecognized bindMode: '+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Tr.prototype=Object.create(Te.prototype),Tr.prototype.constructor=Tr,Tr.prototype.isLineBasicMaterial=!0,Tr.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.linewidth=Fu.linewidth,this.linecap=Fu.linecap,this.linejoin=Fu.linejoin,this},Er.prototype=Object.assign(Object.create(K.prototype),{constructor:Er,isLine:!0,computeLineDistances:function(){var Fu=new A,Hu=new A;return function(){var ku=this.geometry;if(ku.isBufferGeometry){if(null===ku.index){for(var Wu=ku.attributes.position,ju=[0],qu=1,Xu=Wu.count;qu<Xu;qu++)Fu.fromBufferAttribute(Wu,qu-1),Hu.fromBufferAttribute(Wu,qu),ju[qu]=ju[qu-1],ju[qu]+=Fu.distanceTo(Hu);ku.addAttribute('lineDistance',new ge(ju,1))}else console.warn('THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.');}else if(ku.isGeometry){var Yu=ku.vertices,ju=ku.lineDistances;ju[0]=0;for(var qu=1,Xu=Yu.length;qu<Xu;qu++)ju[qu]=ju[qu-1],ju[qu]+=Yu[qu-1].distanceTo(Yu[qu])}return this}}(),raycast:function(){var Fu=new E,Hu=new we,Vu=new F;return function(Wu,ju){var qu=Wu.linePrecision,Xu=this.geometry,Yu=this.matrixWorld;if(null===Xu.boundingSphere&&Xu.computeBoundingSphere(),Vu.copy(Xu.boundingSphere),Vu.applyMatrix4(Yu),Vu.radius+=qu,!1!==Wu.ray.intersectsSphere(Vu)){Fu.getInverse(Yu),Hu.copy(Wu.ray).applyMatrix4(Fu);var Zu=qu/((this.scale.x+this.scale.y+this.scale.z)/3),Ju=Zu*Zu,Qu=new A,Ku=new A,$u=new A,em=new A,tm=this&&this.isLineSegments?2:1;if(Xu.isBufferGeometry){var rm=Xu.index,am=Xu.attributes,om=am.position.array;if(null!==rm)for(var im=rm.array,nm=0,sm=im.length-1;nm<sm;nm+=tm){var lm=im[nm],pm=im[nm+1];Qu.fromArray(om,3*lm),Ku.fromArray(om,3*pm);var dm=Hu.distanceSqToSegment(Qu,Ku,em,$u);if(!(dm>Ju)){em.applyMatrix4(this.matrixWorld);var cm=Wu.ray.origin.distanceTo(em);cm<Wu.near||cm>Wu.far||ju.push({distance:cm,point:$u.clone().applyMatrix4(this.matrixWorld),index:nm,face:null,faceIndex:null,object:this})}}else for(var nm=0,sm=om.length/3-1;nm<sm;nm+=tm){Qu.fromArray(om,3*nm),Ku.fromArray(om,3*nm+3);var dm=Hu.distanceSqToSegment(Qu,Ku,em,$u);if(!(dm>Ju)){em.applyMatrix4(this.matrixWorld);var cm=Wu.ray.origin.distanceTo(em);cm<Wu.near||cm>Wu.far||ju.push({distance:cm,point:$u.clone().applyMatrix4(this.matrixWorld),index:nm,face:null,faceIndex:null,object:this})}}}else if(Xu.isGeometry)for(var um=Xu.vertices,mm=um.length,nm=0,dm;nm<mm-1;nm+=tm)if(dm=Hu.distanceSqToSegment(um[nm],um[nm+1],em,$u),!(dm>Ju)){em.applyMatrix4(this.matrixWorld);var cm=Wu.ray.origin.distanceTo(em);cm<Wu.near||cm>Wu.far||ju.push({distance:cm,point:$u.clone().applyMatrix4(this.matrixWorld),index:nm,face:null,faceIndex:null,object:this})}}}}(),copy:function(Fu){return K.prototype.copy.call(this,Fu),this.geometry.copy(Fu.geometry),this.material.copy(Fu.material),this},clone:function(){return new this.constructor().copy(this)}}),wr.prototype=Object.assign(Object.create(Er.prototype),{constructor:wr,isLineSegments:!0,computeLineDistances:function(){var Fu=new A,Hu=new A;return function(){var ku=this.geometry;if(ku.isBufferGeometry){if(null===ku.index){for(var Wu=ku.attributes.position,ju=[],qu=0,Xu=Wu.count;qu<Xu;qu+=2)Fu.fromBufferAttribute(Wu,qu),Hu.fromBufferAttribute(Wu,qu+1),ju[qu]=0==qu?0:ju[qu-1],ju[qu+1]=ju[qu]+Fu.distanceTo(Hu);ku.addAttribute('lineDistance',new ge(ju,1))}else console.warn('THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.');}else if(ku.isGeometry)for(var Yu=ku.vertices,ju=ku.lineDistances,qu=0,Xu=Yu.length;qu<Xu;qu+=2)Fu.copy(Yu[qu]),Hu.copy(Yu[qu+1]),ju[qu]=0==qu?0:ju[qu-1],ju[qu+1]=ju[qu]+Fu.distanceTo(Hu);return this}}()}),Lr.prototype=Object.assign(Object.create(Er.prototype),{constructor:Lr,isLineLoop:!0}),Ar.prototype=Object.create(Te.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isPointsMaterial=!0,Ar.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.map=Fu.map,this.size=Fu.size,this.sizeAttenuation=Fu.sizeAttenuation,this.morphTargets=Fu.morphTargets,this},Pr.prototype=Object.assign(Object.create(K.prototype),{constructor:Pr,isPoints:!0,raycast:function(){var Fu=new E,Hu=new we,Vu=new F;return function(Wu,ju){function qu(dm,cm){var um=Hu.distanceSqToPoint(dm);if(um<Ku){Hu.closestPointToPoint(dm,em),em.applyMatrix4(Zu);var mm=Wu.ray.origin.distanceTo(em);if(mm<Wu.near||mm>Wu.far)return;ju.push({distance:mm,distanceToRay:Math.sqrt(um),point:em.clone(),index:cm,face:null,object:Xu})}}var Xu=this,Yu=this.geometry,Zu=this.matrixWorld,Ju=Wu.params.Points.threshold;if(null===Yu.boundingSphere&&Yu.computeBoundingSphere(),Vu.copy(Yu.boundingSphere),Vu.applyMatrix4(Zu),Vu.radius+=Ju,!1!==Wu.ray.intersectsSphere(Vu)){Fu.getInverse(Zu),Hu.copy(Wu.ray).applyMatrix4(Fu);var Qu=Ju/((this.scale.x+this.scale.y+this.scale.z)/3),Ku=Qu*Qu,$u=new A,em=new A;if(Yu.isBufferGeometry){var tm=Yu.index,rm=Yu.attributes,am=rm.position.array;if(null!==tm)for(var om=tm.array,im=0,nm=om.length,sm;im<nm;im++)sm=om[im],$u.fromArray(am,3*sm),qu($u,sm);else for(var im=0,lm=am.length/3;im<lm;im++)$u.fromArray(am,3*im),qu($u,im)}else for(var pm=Yu.vertices,im=0,lm=pm.length;im<lm;im++)qu(pm[im],im)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Cr.prototype=Object.assign(Object.create(R.prototype),{constructor:Cr,isVideoTexture:!0,update:function(){var Fu=this.image;Fu.readyState>=Fu.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Rr.prototype=Object.create(R.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isCompressedTexture=!0,Ir.prototype=Object.create(R.prototype),Ir.prototype.constructor=Ir,Ir.prototype.isCanvasTexture=!0,Dr.prototype=Object.create(R.prototype),Dr.prototype.constructor=Dr,Dr.prototype.isDepthTexture=!0,zr.prototype=Object.create(xe.prototype),zr.prototype.constructor=zr,Nr.prototype=Object.create(ee.prototype),Nr.prototype.constructor=Nr,Br.prototype=Object.create(xe.prototype),Br.prototype.constructor=Br,Ur.prototype=Object.create(ee.prototype),Ur.prototype.constructor=Ur,Gr.prototype=Object.create(xe.prototype),Gr.prototype.constructor=Gr,Or.prototype=Object.create(ee.prototype),Or.prototype.constructor=Or,Fr.prototype=Object.create(Gr.prototype),Fr.prototype.constructor=Fr,Hr.prototype=Object.create(ee.prototype),Hr.prototype.constructor=Hr,Vr.prototype=Object.create(Gr.prototype),Vr.prototype.constructor=Vr,kr.prototype=Object.create(ee.prototype),kr.prototype.constructor=kr,Wr.prototype=Object.create(Gr.prototype),Wr.prototype.constructor=Wr,jr.prototype=Object.create(ee.prototype),jr.prototype.constructor=jr,qr.prototype=Object.create(Gr.prototype),qr.prototype.constructor=qr,Xr.prototype=Object.create(ee.prototype),Xr.prototype.constructor=Xr,Yr.prototype=Object.create(xe.prototype),Yr.prototype.constructor=Yr,Zr.prototype=Object.create(ee.prototype),Zr.prototype.constructor=Zr,Jr.prototype=Object.create(xe.prototype),Jr.prototype.constructor=Jr,Qr.prototype=Object.create(ee.prototype),Qr.prototype.constructor=Qr,Kr.prototype=Object.create(xe.prototype),Kr.prototype.constructor=Kr;var iu={triangulate:function(Fu,Hu,Vu){Vu=Vu||2;var ku=Hu&&Hu.length,Wu=ku?Hu[0]*Vu:Fu.length,ju=$r(Fu,0,Wu,Vu,!0),qu=[];if(!ju)return qu;var Xu,Yu,Zu,Ju,Qu,Ku,$u;if(ku&&(ju=na(Fu,Hu,ju,Vu)),Fu.length>80*Vu){Xu=Zu=Fu[0],Yu=Ju=Fu[1];for(var em=Vu;em<Wu;em+=Vu)Qu=Fu[em],Ku=Fu[em+1],Qu<Xu&&(Xu=Qu),Ku<Yu&&(Yu=Ku),Qu>Zu&&(Zu=Qu),Ku>Ju&&(Ju=Ku);$u=Math.max(Zu-Xu,Ju-Yu),$u=0===$u?0:1/$u}return ta(ju,qu,Vu,Xu,Yu,$u),qu}},nu={area:function(Fu){for(var Hu=Fu.length,Vu=0,ku=Hu-1,Wu=0;Wu<Hu;ku=Wu++)Vu+=Fu[ku].x*Fu[Wu].y-Fu[Wu].x*Fu[ku].y;return 0.5*Vu},isClockWise:function(Fu){return 0>nu.area(Fu)},triangulateShape:function(Fu,Hu){var Vu=[],ku=[],Wu=[];Aa(Fu),Pa(Vu,Fu);var ju=Fu.length;Hu.forEach(Aa);for(var qu=0;qu<Hu.length;qu++)ku.push(ju),ju+=Hu[qu].length,Pa(Vu,Hu[qu]);for(var Xu=iu.triangulate(Vu,ku),qu=0;qu<Xu.length;qu+=3)Wu.push(Xu.slice(qu,qu+3));return Wu}};Ca.prototype=Object.create(ee.prototype),Ca.prototype.constructor=Ca,Ca.prototype.toJSON=function(){var Fu=ee.prototype.toJSON.call(this),Hu=this.parameters.shapes,Vu=this.parameters.options;return Ia(Hu,Vu,Fu)},Ra.prototype=Object.create(xe.prototype),Ra.prototype.constructor=Ra,Ra.prototype.toJSON=function(){var Fu=xe.prototype.toJSON.call(this),Hu=this.parameters.shapes,Vu=this.parameters.options;return Ia(Hu,Vu,Fu)};var lu={generateTopUV:function(Fu,Hu,Vu,ku,Wu){var ju=Hu[3*Vu],qu=Hu[3*Vu+1],Xu=Hu[3*ku],Yu=Hu[3*ku+1],Zu=Hu[3*Wu],Ju=Hu[3*Wu+1];return[new S(ju,qu),new S(Xu,Yu),new S(Zu,Ju)]},generateSideWallUV:function(Fu,Hu,Vu,ku,Wu,ju){var qu=Hu[3*Vu],Xu=Hu[3*Vu+1],Yu=Hu[3*Vu+2],Zu=Hu[3*ku],Ju=Hu[3*ku+1],Qu=Hu[3*ku+2],Ku=Hu[3*Wu],$u=Hu[3*Wu+1],em=Hu[3*Wu+2],tm=Hu[3*ju],rm=Hu[3*ju+1],am=Hu[3*ju+2];return 0.01>Math.abs(Xu-Ju)?[new S(qu,1-Yu),new S(Zu,1-Qu),new S(Ku,1-em),new S(tm,1-am)]:[new S(Xu,1-Yu),new S(Ju,1-Qu),new S($u,1-em),new S(rm,1-am)]}};Da.prototype=Object.create(ee.prototype),Da.prototype.constructor=Da,za.prototype=Object.create(Ra.prototype),za.prototype.constructor=za,Na.prototype=Object.create(ee.prototype),Na.prototype.constructor=Na,Ba.prototype=Object.create(xe.prototype),Ba.prototype.constructor=Ba,Ua.prototype=Object.create(ee.prototype),Ua.prototype.constructor=Ua,Ga.prototype=Object.create(xe.prototype),Ga.prototype.constructor=Ga,Oa.prototype=Object.create(ee.prototype),Oa.prototype.constructor=Oa,Fa.prototype=Object.create(xe.prototype),Fa.prototype.constructor=Fa,Ha.prototype=Object.create(ee.prototype),Ha.prototype.constructor=Ha,Ha.prototype.toJSON=function(){var Fu=ee.prototype.toJSON.call(this),Hu=this.parameters.shapes;return ka(Hu,Fu)},Va.prototype=Object.create(xe.prototype),Va.prototype.constructor=Va,Va.prototype.toJSON=function(){var Fu=xe.prototype.toJSON.call(this),Hu=this.parameters.shapes;return ka(Hu,Fu)},Wa.prototype=Object.create(xe.prototype),Wa.prototype.constructor=Wa,ja.prototype=Object.create(ee.prototype),ja.prototype.constructor=ja,Xa.prototype=Object.create(xe.prototype),Xa.prototype.constructor=Xa,Ya.prototype=Object.create(ja.prototype),Ya.prototype.constructor=Ya,Za.prototype=Object.create(Xa.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(ee.prototype),Ja.prototype.constructor=Ja,Qa.prototype=Object.create(xe.prototype),Qa.prototype.constructor=Qa;var du=Object.freeze({WireframeGeometry:zr,ParametricGeometry:Nr,ParametricBufferGeometry:Br,TetrahedronGeometry:Or,TetrahedronBufferGeometry:Fr,OctahedronGeometry:Hr,OctahedronBufferGeometry:Vr,IcosahedronGeometry:kr,IcosahedronBufferGeometry:Wr,DodecahedronGeometry:jr,DodecahedronBufferGeometry:qr,PolyhedronGeometry:Ur,PolyhedronBufferGeometry:Gr,TubeGeometry:Xr,TubeBufferGeometry:Yr,TorusKnotGeometry:Zr,TorusKnotBufferGeometry:Jr,TorusGeometry:Qr,TorusBufferGeometry:Kr,TextGeometry:Da,TextBufferGeometry:za,SphereGeometry:Na,SphereBufferGeometry:Ba,RingGeometry:Ua,RingBufferGeometry:Ga,PlaneGeometry:Me,PlaneBufferGeometry:Se,LatheGeometry:Oa,LatheBufferGeometry:Fa,ShapeGeometry:Ha,ShapeBufferGeometry:Va,ExtrudeGeometry:Ca,ExtrudeBufferGeometry:Ra,EdgesGeometry:Wa,ConeGeometry:Ya,ConeBufferGeometry:Za,CylinderGeometry:ja,CylinderBufferGeometry:Xa,CircleGeometry:Ja,CircleBufferGeometry:Qa,BoxGeometry:ve,BoxBufferGeometry:_e});Ka.prototype=Object.create(Te.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isShadowMaterial=!0,Ka.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this},$a.prototype=Object.create(Ee.prototype),$a.prototype.constructor=$a,$a.prototype.isRawShaderMaterial=!0,eo.prototype=Object.create(Te.prototype),eo.prototype.constructor=eo,eo.prototype.isMeshStandardMaterial=!0,eo.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.defines={STANDARD:''},this.color.copy(Fu.color),this.roughness=Fu.roughness,this.metalness=Fu.metalness,this.map=Fu.map,this.lightMap=Fu.lightMap,this.lightMapIntensity=Fu.lightMapIntensity,this.aoMap=Fu.aoMap,this.aoMapIntensity=Fu.aoMapIntensity,this.emissive.copy(Fu.emissive),this.emissiveMap=Fu.emissiveMap,this.emissiveIntensity=Fu.emissiveIntensity,this.bumpMap=Fu.bumpMap,this.bumpScale=Fu.bumpScale,this.normalMap=Fu.normalMap,this.normalMapType=Fu.normalMapType,this.normalScale.copy(Fu.normalScale),this.displacementMap=Fu.displacementMap,this.displacementScale=Fu.displacementScale,this.displacementBias=Fu.displacementBias,this.roughnessMap=Fu.roughnessMap,this.metalnessMap=Fu.metalnessMap,this.alphaMap=Fu.alphaMap,this.envMap=Fu.envMap,this.envMapIntensity=Fu.envMapIntensity,this.refractionRatio=Fu.refractionRatio,this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this.wireframeLinecap=Fu.wireframeLinecap,this.wireframeLinejoin=Fu.wireframeLinejoin,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.morphNormals=Fu.morphNormals,this},ro.prototype=Object.create(eo.prototype),ro.prototype.constructor=ro,ro.prototype.isMeshPhysicalMaterial=!0,ro.prototype.copy=function(Fu){return eo.prototype.copy.call(this,Fu),this.defines={PHYSICAL:''},this.reflectivity=Fu.reflectivity,this.clearCoat=Fu.clearCoat,this.clearCoatRoughness=Fu.clearCoatRoughness,this},ao.prototype=Object.create(Te.prototype),ao.prototype.constructor=ao,ao.prototype.isMeshPhongMaterial=!0,ao.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.specular.copy(Fu.specular),this.shininess=Fu.shininess,this.map=Fu.map,this.lightMap=Fu.lightMap,this.lightMapIntensity=Fu.lightMapIntensity,this.aoMap=Fu.aoMap,this.aoMapIntensity=Fu.aoMapIntensity,this.emissive.copy(Fu.emissive),this.emissiveMap=Fu.emissiveMap,this.emissiveIntensity=Fu.emissiveIntensity,this.bumpMap=Fu.bumpMap,this.bumpScale=Fu.bumpScale,this.normalMap=Fu.normalMap,this.normalMapType=Fu.normalMapType,this.normalScale.copy(Fu.normalScale),this.displacementMap=Fu.displacementMap,this.displacementScale=Fu.displacementScale,this.displacementBias=Fu.displacementBias,this.specularMap=Fu.specularMap,this.alphaMap=Fu.alphaMap,this.envMap=Fu.envMap,this.combine=Fu.combine,this.reflectivity=Fu.reflectivity,this.refractionRatio=Fu.refractionRatio,this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this.wireframeLinecap=Fu.wireframeLinecap,this.wireframeLinejoin=Fu.wireframeLinejoin,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.morphNormals=Fu.morphNormals,this},oo.prototype=Object.create(ao.prototype),oo.prototype.constructor=oo,oo.prototype.isMeshToonMaterial=!0,oo.prototype.copy=function(Fu){return ao.prototype.copy.call(this,Fu),this.gradientMap=Fu.gradientMap,this},io.prototype=Object.create(Te.prototype),io.prototype.constructor=io,io.prototype.isMeshNormalMaterial=!0,io.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.bumpMap=Fu.bumpMap,this.bumpScale=Fu.bumpScale,this.normalMap=Fu.normalMap,this.normalMapType=Fu.normalMapType,this.normalScale.copy(Fu.normalScale),this.displacementMap=Fu.displacementMap,this.displacementScale=Fu.displacementScale,this.displacementBias=Fu.displacementBias,this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.morphNormals=Fu.morphNormals,this},no.prototype=Object.create(Te.prototype),no.prototype.constructor=no,no.prototype.isMeshLambertMaterial=!0,no.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.map=Fu.map,this.lightMap=Fu.lightMap,this.lightMapIntensity=Fu.lightMapIntensity,this.aoMap=Fu.aoMap,this.aoMapIntensity=Fu.aoMapIntensity,this.emissive.copy(Fu.emissive),this.emissiveMap=Fu.emissiveMap,this.emissiveIntensity=Fu.emissiveIntensity,this.specularMap=Fu.specularMap,this.alphaMap=Fu.alphaMap,this.envMap=Fu.envMap,this.combine=Fu.combine,this.reflectivity=Fu.reflectivity,this.refractionRatio=Fu.refractionRatio,this.wireframe=Fu.wireframe,this.wireframeLinewidth=Fu.wireframeLinewidth,this.wireframeLinecap=Fu.wireframeLinecap,this.wireframeLinejoin=Fu.wireframeLinejoin,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.morphNormals=Fu.morphNormals,this},so.prototype=Object.create(Te.prototype),so.prototype.constructor=so,so.prototype.isMeshMatcapMaterial=!0,so.prototype.copy=function(Fu){return Te.prototype.copy.call(this,Fu),this.defines={MATCAP:''},this.color.copy(Fu.color),this.matcap=Fu.matcap,this.map=Fu.map,this.bumpMap=Fu.bumpMap,this.bumpScale=Fu.bumpScale,this.normalMap=Fu.normalMap,this.normalMapType=Fu.normalMapType,this.normalScale.copy(Fu.normalScale),this.displacementMap=Fu.displacementMap,this.displacementScale=Fu.displacementScale,this.displacementBias=Fu.displacementBias,this.alphaMap=Fu.alphaMap,this.skinning=Fu.skinning,this.morphTargets=Fu.morphTargets,this.morphNormals=Fu.morphNormals,this},lo.prototype=Object.create(Tr.prototype),lo.prototype.constructor=lo,lo.prototype.isLineDashedMaterial=!0,lo.prototype.copy=function(Fu){return Tr.prototype.copy.call(this,Fu),this.scale=Fu.scale,this.dashSize=Fu.dashSize,this.gapSize=Fu.gapSize,this};var uu=Object.freeze({ShadowMaterial:Ka,SpriteMaterial:yr,RawShaderMaterial:$a,ShaderMaterial:Ee,PointsMaterial:Ar,MeshPhysicalMaterial:ro,MeshStandardMaterial:eo,MeshPhongMaterial:ao,MeshToonMaterial:oo,MeshNormalMaterial:io,MeshLambertMaterial:no,MeshDepthMaterial:Kt,MeshDistanceMaterial:$t,MeshBasicMaterial:Ae,MeshMatcapMaterial:so,LineDashedMaterial:lo,LineBasicMaterial:Tr,Material:Te}),mu={arraySlice:function(Fu,Hu,Vu){return mu.isTypedArray(Fu)?new Fu.constructor(Fu.subarray(Hu,void 0===Vu?Fu.length:Vu)):Fu.slice(Hu,Vu)},convertArray:function(Fu,Hu,Vu){return Fu&&(Vu||Fu.constructor!==Hu)?'number'==typeof Hu.BYTES_PER_ELEMENT?new Hu(Fu):Array.prototype.slice.call(Fu):Fu},isTypedArray:function(Fu){return ArrayBuffer.isView(Fu)&&!(Fu instanceof DataView)},getKeyframeOrder:function(Fu){for(var Vu=Fu.length,ku=Array(Vu),Wu=0;Wu!==Vu;++Wu)ku[Wu]=Wu;return ku.sort(function(ju,qu){return Fu[ju]-Fu[qu]}),ku},sortedArray:function(Fu,Hu,Vu){for(var ku=Fu.length,Wu=new Fu.constructor(ku),ju=0,qu=0,Xu;qu!==ku;++ju){Xu=Vu[ju]*Hu;for(var Yu=0;Yu!==Hu;++Yu)Wu[qu++]=Fu[Xu+Yu]}return Wu},flattenJSON:function(Fu,Hu,Vu,ku){for(var Wu=1,ju=Fu[0];ju!==void 0&&ju[ku]===void 0;)ju=Fu[Wu++];if(void 0!==ju){var qu=ju[ku];if(void 0!==qu)if(Array.isArray(qu))do qu=ju[ku],void 0!==qu&&(Hu.push(ju.time),Vu.push.apply(Vu,qu)),ju=Fu[Wu++];while(void 0!==ju);else if(void 0!==qu.toArray)do qu=ju[ku],void 0!==qu&&(Hu.push(ju.time),qu.toArray(Vu,Vu.length)),ju=Fu[Wu++];while(void 0!==ju);else do qu=ju[ku],void 0!==qu&&(Hu.push(ju.time),Vu.push(qu)),ju=Fu[Wu++];while(void 0!==ju)}}};Object.assign(po.prototype,{evaluate:function(Fu){var Hu=this.parameterPositions,Vu=this._cachedIndex,ku=Hu[Vu],Wu=Hu[Vu-1];validate_interval:{seek:{var ju;linear_scan:{forward_scan:if(!(Fu<ku)){for(var qu=Vu+2;;){if(void 0===ku){if(Fu<Wu)break forward_scan;return Vu=Hu.length,this._cachedIndex=Vu,this.afterEnd_(Vu-1,Fu,Wu)}if(Vu===qu)break;if(Wu=ku,ku=Hu[++Vu],Fu<ku)break seek}ju=Hu.length;break linear_scan}if(!(Fu>=Wu)){var Xu=Hu[1];Fu<Xu&&(Vu=2,Wu=Xu);for(var qu=Vu-2;;){if(void 0===Wu)return this._cachedIndex=0,this.beforeStart_(0,Fu,ku);if(Vu===qu)break;if(ku=Wu,Wu=Hu[--Vu-1],Fu>=Wu)break seek}ju=Vu,Vu=0;break linear_scan}break validate_interval}for(;Vu<ju;){var Yu=Vu+ju>>>1;Fu<Hu[Yu]?ju=Yu:Vu=Yu+1}if(ku=Hu[Vu],Wu=Hu[Vu-1],void 0===Wu)return this._cachedIndex=0,this.beforeStart_(0,Fu,ku);if(void 0===ku)return Vu=Hu.length,this._cachedIndex=Vu,this.afterEnd_(Vu-1,Wu,Fu)}this._cachedIndex=Vu,this.intervalChanged_(Vu,Wu,ku)}return this.interpolate_(Vu,Wu,Fu,ku)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(Fu){for(var Hu=this.resultBuffer,Vu=this.sampleValues,ku=this.valueSize,ju=0;ju!==ku;++ju)Hu[ju]=Vu[Fu*ku+ju];return Hu},interpolate_:function(){throw new Error('call to abstract method')},intervalChanged_:function(){}}),Object.assign(po.prototype,{beforeStart_:po.prototype.copySampleValue_,afterEnd_:po.prototype.copySampleValue_}),co.prototype=Object.assign(Object.create(po.prototype),{constructor:co,DefaultSettings_:{endingStart:Jl,endingEnd:Jl},intervalChanged_:function(Fu,Hu,Vu){var ku=this.parameterPositions,Wu=Fu-2,ju=Fu+1,qu=ku[Wu],Xu=ku[ju];if(qu===void 0)switch(this.getSettings_().endingStart){case Ql:Wu=Fu,qu=2*Hu-Vu;break;case Kl:Wu=ku.length-2,qu=Hu+ku[Wu]-ku[Wu+1];break;default:Wu=Fu,qu=Vu;}if(void 0===Xu)switch(this.getSettings_().endingEnd){case Ql:ju=Fu,Xu=2*Vu-Hu;break;case Kl:ju=1,Xu=Vu+ku[1]-ku[0];break;default:ju=Fu-1,Xu=Hu;}var Yu=0.5*(Vu-Hu),Zu=this.valueSize;this._weightPrev=Yu/(Hu-qu),this._weightNext=Yu/(Xu-Vu),this._offsetPrev=Wu*Zu,this._offsetNext=ju*Zu},interpolate_:function(Fu,Hu,Vu,ku){for(var Wu=this.resultBuffer,ju=this.sampleValues,qu=this.valueSize,Xu=Fu*qu,Zu=this._offsetPrev,Ju=this._offsetNext,Qu=this._weightPrev,Ku=this._weightNext,$u=(Vu-Hu)/(ku-Hu),em=$u*$u,tm=em*$u,nm=0;nm!==qu;++nm)Wu[nm]=(-Qu*tm+2*Qu*em-Qu*$u)*ju[Zu+nm]+((1+Qu)*tm+(-1.5-2*Qu)*em+(-0.5+Qu)*$u+1)*ju[Xu-qu+nm]+((-1-Ku)*tm+(1.5+Ku)*em+0.5*$u)*ju[Xu+nm]+(Ku*tm-Ku*em)*ju[Ju+nm];return Wu}}),uo.prototype=Object.assign(Object.create(po.prototype),{constructor:uo,interpolate_:function(Fu,Hu,Vu,ku){for(var Wu=this.resultBuffer,ju=this.sampleValues,qu=this.valueSize,Xu=Fu*qu,Zu=(Vu-Hu)/(ku-Hu),Qu=0;Qu!==qu;++Qu)Wu[Qu]=ju[Xu-qu+Qu]*(1-Zu)+ju[Xu+Qu]*Zu;return Wu}}),mo.prototype=Object.assign(Object.create(po.prototype),{constructor:mo,interpolate_:function(Fu){return this.copySampleValue_(Fu-1)}}),Object.assign(go,{toJSON:function(Fu){var Hu=Fu.constructor,Vu;if(void 0!==Hu.toJSON)Vu=Hu.toJSON(Fu);else{Vu={name:Fu.name,times:mu.convertArray(Fu.times,Array),values:mu.convertArray(Fu.values,Array)};var ku=Fu.getInterpolation();ku!==Fu.DefaultInterpolation&&(Vu.interpolation=ku)}return Vu.type=Fu.ValueTypeName,Vu}}),Object.assign(go.prototype,{constructor:go,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Yl,InterpolantFactoryMethodDiscrete:function(Fu){return new mo(this.times,this.values,this.getValueSize(),Fu)},InterpolantFactoryMethodLinear:function(Fu){return new uo(this.times,this.values,this.getValueSize(),Fu)},InterpolantFactoryMethodSmooth:function(Fu){return new co(this.times,this.values,this.getValueSize(),Fu)},setInterpolation:function(Fu){var Hu;if(Fu===Xl?Hu=this.InterpolantFactoryMethodDiscrete:Fu===Yl?Hu=this.InterpolantFactoryMethodLinear:Fu===Zl?Hu=this.InterpolantFactoryMethodSmooth:void 0,void 0===Hu){var Vu='unsupported interpolation for '+this.ValueTypeName+' keyframe track named '+this.name;if(void 0===this.createInterpolant)if(Fu!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(Vu);return console.warn('THREE.KeyframeTrack:',Vu),this}return this.createInterpolant=Hu,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Xl;case this.InterpolantFactoryMethodLinear:return Yl;case this.InterpolantFactoryMethodSmooth:return Zl;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(Fu){if(0!==Fu)for(var Hu=this.times,Vu=0,ku=Hu.length;Vu!==ku;++Vu)Hu[Vu]+=Fu;return this},scale:function(Fu){if(1!==Fu)for(var Hu=this.times,Vu=0,ku=Hu.length;Vu!==ku;++Vu)Hu[Vu]*=Fu;return this},trim:function(Fu,Hu){for(var Vu=this.times,ku=Vu.length,Wu=0,ju=ku-1;Wu!==ku&&Vu[Wu]<Fu;)++Wu;for(;-1!=ju&&Vu[ju]>Hu;)--ju;if(++ju,0!==Wu||ju!==ku){Wu>=ju&&(ju=Math.max(ju,1),Wu=ju-1);var qu=this.getValueSize();this.times=mu.arraySlice(Vu,Wu,ju),this.values=mu.arraySlice(this.values,Wu*qu,ju*qu)}return this},validate:function(){var Fu=!0,Hu=this.getValueSize();0!=Hu-Math.floor(Hu)&&(console.error('THREE.KeyframeTrack: Invalid value size in track.',this),Fu=!1);var Vu=this.times,ku=this.values,Wu=Vu.length;0===Wu&&(console.error('THREE.KeyframeTrack: Track is empty.',this),Fu=!1);for(var ju=null,qu=0,Xu;qu!==Wu;qu++){if(Xu=Vu[qu],'number'==typeof Xu&&isNaN(Xu)){console.error('THREE.KeyframeTrack: Time is not a valid number.',this,qu,Xu),Fu=!1;break}if(null!=ju&&ju>Xu){console.error('THREE.KeyframeTrack: Out of order keys.',this,qu,Xu,ju),Fu=!1;break}ju=Xu}if(ku!==void 0&&mu.isTypedArray(ku))for(var qu=0,Yu=ku.length,Zu;qu!==Yu;++qu)if(Zu=ku[qu],isNaN(Zu)){console.error('THREE.KeyframeTrack: Value is not a valid number.',this,qu,Zu),Fu=!1;break}return Fu},optimize:function(){for(var Fu=this.times,Hu=this.values,Vu=this.getValueSize(),ku=this.getInterpolation()===Zl,Wu=1,ju=Fu.length-1,qu=1;qu<ju;++qu){var Xu=!1,Yu=Fu[qu],Zu=Fu[qu+1];if(Yu!==Zu&&(1!==qu||Yu!==Yu[0]))if(!ku){for(var Ju=qu*Vu,$u=0,em;$u!==Vu;++$u)if(em=Hu[Ju+$u],em!==Hu[Ju-Vu+$u]||em!==Hu[Ju+Vu+$u]){Xu=!0;break}}else Xu=!0;if(Xu){if(qu!==Wu){Fu[Wu]=Fu[qu];for(var tm=qu*Vu,rm=Wu*Vu,$u=0;$u!==Vu;++$u)Hu[rm+$u]=Hu[tm+$u]}++Wu}}if(0<ju){Fu[Wu]=Fu[ju];for(var tm=ju*Vu,rm=Wu*Vu,$u=0;$u!==Vu;++$u)Hu[rm+$u]=Hu[tm+$u];++Wu}return Wu!==Fu.length&&(this.times=mu.arraySlice(Fu,0,Wu),this.values=mu.arraySlice(Hu,0,Wu*Vu)),this}}),fo.prototype=Object.assign(Object.create(go.prototype),{constructor:fo,ValueTypeName:'bool',ValueBufferType:Array,DefaultInterpolation:Xl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),yo.prototype=Object.assign(Object.create(go.prototype),{constructor:yo,ValueTypeName:'color'}),xo.prototype=Object.assign(Object.create(go.prototype),{constructor:xo,ValueTypeName:'number'}),vo.prototype=Object.assign(Object.create(po.prototype),{constructor:vo,interpolate_:function(Fu,Hu,Vu,ku){for(var Wu=this.resultBuffer,ju=this.sampleValues,qu=this.valueSize,Xu=Fu*qu,Zu=Xu+qu;Xu!==Zu;Xu+=4)L.slerpFlat(Wu,0,ju,Xu-qu,ju,Xu,(Vu-Hu)/(ku-Hu));return Wu}}),_o.prototype=Object.assign(Object.create(go.prototype),{constructor:_o,ValueTypeName:'quaternion',DefaultInterpolation:Yl,InterpolantFactoryMethodLinear:function(Fu){return new vo(this.times,this.values,this.getValueSize(),Fu)},InterpolantFactoryMethodSmooth:void 0}),bo.prototype=Object.assign(Object.create(go.prototype),{constructor:bo,ValueTypeName:'string',ValueBufferType:Array,DefaultInterpolation:Xl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Mo.prototype=Object.assign(Object.create(go.prototype),{constructor:Mo,ValueTypeName:'vector'}),Object.assign(So,{parse:function(Fu){for(var Hu=[],Vu=Fu.tracks,ku=1/(Fu.fps||1),Wu=0,ju=Vu.length;Wu!==ju;++Wu)Hu.push(Eo(Vu[Wu]).scale(ku));return new So(Fu.name,Fu.duration,Hu)},toJSON:function(Fu){for(var Hu=[],Vu=Fu.tracks,ku={name:Fu.name,duration:Fu.duration,tracks:Hu,uuid:Fu.uuid},Wu=0,ju=Vu.length;Wu!==ju;++Wu)Hu.push(go.toJSON(Vu[Wu]));return ku},CreateFromMorphTargetSequence:function(Fu,Hu,Vu,ku){for(var Wu=Hu.length,ju=[],qu=0;qu<Wu;qu++){var Xu=[],Yu=[];Xu.push((qu+Wu-1)%Wu,qu,(qu+1)%Wu),Yu.push(0,1,0);var Zu=mu.getKeyframeOrder(Xu);Xu=mu.sortedArray(Xu,1,Zu),Yu=mu.sortedArray(Yu,1,Zu),ku||0!==Xu[0]||(Xu.push(Wu),Yu.push(Yu[0])),ju.push(new xo('.morphTargetInfluences['+Hu[qu].name+']',Xu,Yu).scale(1/Vu))}return new So(Fu,-1,ju)},findByName:function(Fu,Hu){var Vu=Fu;if(!Array.isArray(Fu)){var ku=Fu;Vu=ku.geometry&&ku.geometry.animations||ku.animations}for(var Wu=0;Wu<Vu.length;Wu++)if(Vu[Wu].name===Hu)return Vu[Wu];return null},CreateClipsFromMorphTargetSequences:function(Fu,Hu,Vu){for(var ku={},Wu=/^([\w-]*?)([\d]+)$/,ju=0,qu=Fu.length;ju<qu;ju++){var Xu=Fu[ju],Yu=Xu.name.match(Wu);if(Yu&&1<Yu.length){var Zu=Yu[1],Ju=ku[Zu];Ju||(ku[Zu]=Ju=[]),Ju.push(Xu)}}var Qu=[];for(var Zu in ku)Qu.push(So.CreateFromMorphTargetSequence(Zu,ku[Zu],Hu,Vu));return Qu},parseAnimation:function(Fu,Hu){if(!Fu)return console.error('THREE.AnimationClip: No animation in JSONLoader data.'),null;for(var Vu=function(im,nm,sm,lm,pm){if(0!==sm.length){var dm=[],cm=[];mu.flattenJSON(sm,dm,cm,lm),0!==dm.length&&pm.push(new im(nm,dm,cm))}},ku=[],Wu=Fu.name||'default',ju=Fu.length||-1,qu=Fu.fps||30,Xu=Fu.hierarchy||[],Yu=0,Zu;Yu<Xu.length;Yu++)if(Zu=Xu[Yu].keys,Zu&&0!==Zu.length)if(Zu[0].morphTargets){for(var Ju={},Qu=0;Qu<Zu.length;Qu++)if(Zu[Qu].morphTargets)for(var Ku=0;Ku<Zu[Qu].morphTargets.length;Ku++)Ju[Zu[Qu].morphTargets[Ku]]=-1;for(var $u in Ju){for(var em=[],tm=[],Ku=0,rm;Ku!==Zu[Qu].morphTargets.length;++Ku)rm=Zu[Qu],em.push(rm.time),tm.push(rm.morphTarget===$u?1:0);ku.push(new xo('.morphTargetInfluence['+$u+']',em,tm))}ju=Ju.length*(qu||1)}else{var am='.bones['+Hu[Yu].name+']';Vu(Mo,am+'.position',Zu,'pos',ku),Vu(_o,am+'.quaternion',Zu,'rot',ku),Vu(Mo,am+'.scale',Zu,'scl',ku)}if(0===ku.length)return null;var om=new So(Wu,ju,ku);return om}}),Object.assign(So.prototype,{resetDuration:function(){for(var Fu=this.tracks,Hu=0,Vu=0,ku=Fu.length,Wu;Vu!==ku;++Vu)Wu=this.tracks[Vu],Hu=Math.max(Hu,Wu.times[Wu.times.length-1]);return this.duration=Hu,this},trim:function(){for(var Fu=0;Fu<this.tracks.length;Fu++)this.tracks[Fu].trim(0,this.duration);return this},validate:function(){for(var Fu=!0,Hu=0;Hu<this.tracks.length;Hu++)Fu=Fu&&this.tracks[Hu].validate();return Fu},optimize:function(){for(var Fu=0;Fu<this.tracks.length;Fu++)this.tracks[Fu].optimize();return this}});var gu={enabled:!1,files:{},add:function(Fu,Hu){!1===this.enabled||(this.files[Fu]=Hu)},get:function(Fu){return!1===this.enabled?void 0:this.files[Fu]},remove:function(Fu){delete this.files[Fu]},clear:function(){this.files={}}},fu=new wo,hu={};Object.assign(Lo.prototype,{load:function(Fu,Hu,Vu,ku){void 0===Fu&&(Fu=''),void 0!==this.path&&(Fu=this.path+Fu),Fu=this.manager.resolveURL(Fu);var Wu=this,ju=gu.get(Fu);if(void 0!==ju)return Wu.manager.itemStart(Fu),setTimeout(function(){Hu&&Hu(ju),Wu.manager.itemEnd(Fu)},0),ju;if(void 0!==hu[Fu])return void hu[Fu].push({onLoad:Hu,onProgress:Vu,onError:ku});var qu=/^data:(.*?)(;base64)?,(.*)$/,Xu=Fu.match(qu);if(Xu){var Yu=Xu[1],Zu=!!Xu[2],Ju=Xu[3];Ju=decodeURIComponent(Ju),Zu&&(Ju=atob(Ju));try{var Ku=(this.responseType||'').toLowerCase(),Qu;switch(Ku){case'arraybuffer':case'blob':for(var $u=new Uint8Array(Ju.length),em=0;em<Ju.length;em++)$u[em]=Ju.charCodeAt(em);Qu='blob'===Ku?new Blob([$u.buffer],{type:Yu}):$u.buffer;break;case'document':var tm=new DOMParser;Qu=tm.parseFromString(Ju,Yu);break;case'json':Qu=JSON.parse(Ju);break;default:Qu=Ju;}setTimeout(function(){Hu&&Hu(Qu),Wu.manager.itemEnd(Fu)},0)}catch(om){setTimeout(function(){ku&&ku(om),Wu.manager.itemError(Fu),Wu.manager.itemEnd(Fu)},0)}}else{hu[Fu]=[],hu[Fu].push({onLoad:Hu,onProgress:Vu,onError:ku});var rm=new XMLHttpRequest;for(var am in rm.open('GET',Fu,!0),rm.addEventListener('load',function(om){var im=this.response;gu.add(Fu,im);var nm=hu[Fu];if(delete hu[Fu],200===this.status||0===this.status){0===this.status&&console.warn('THREE.FileLoader: HTTP Status 0 received.');for(var sm=0,lm=nm.length,pm;sm<lm;sm++)pm=nm[sm],pm.onLoad&&pm.onLoad(im);Wu.manager.itemEnd(Fu)}else{for(var sm=0,lm=nm.length,pm;sm<lm;sm++)pm=nm[sm],pm.onError&&pm.onError(om);Wu.manager.itemError(Fu),Wu.manager.itemEnd(Fu)}},!1),rm.addEventListener('progress',function(om){for(var im=hu[Fu],nm=0,sm=im.length,lm;nm<sm;nm++)lm=im[nm],lm.onProgress&&lm.onProgress(om)},!1),rm.addEventListener('error',function(om){var im=hu[Fu];delete hu[Fu];for(var nm=0,sm=im.length,lm;nm<sm;nm++)lm=im[nm],lm.onError&&lm.onError(om);Wu.manager.itemError(Fu),Wu.manager.itemEnd(Fu)},!1),rm.addEventListener('abort',function(om){var im=hu[Fu];delete hu[Fu];for(var nm=0,sm=im.length,lm;nm<sm;nm++)lm=im[nm],lm.onError&&lm.onError(om);Wu.manager.itemError(Fu),Wu.manager.itemEnd(Fu)},!1),void 0!==this.responseType&&(rm.responseType=this.responseType),void 0!==this.withCredentials&&(rm.withCredentials=this.withCredentials),rm.overrideMimeType&&rm.overrideMimeType(void 0===this.mimeType?'text/plain':this.mimeType),this.requestHeader)rm.setRequestHeader(am,this.requestHeader[am]);rm.send(null)}return Wu.manager.itemStart(Fu),rm},setPath:function(Fu){return this.path=Fu,this},setResponseType:function(Fu){return this.responseType=Fu,this},setWithCredentials:function(Fu){return this.withCredentials=Fu,this},setMimeType:function(Fu){return this.mimeType=Fu,this},setRequestHeader:function(Fu){return this.requestHeader=Fu,this}}),Object.assign(function(Fu){this.manager=Fu===void 0?fu:Fu}.prototype,{load:function(Fu,Hu,Vu,ku){var Wu=this,ju=new Lo(Wu.manager);ju.setPath(Wu.path),ju.load(Fu,function(qu){Hu(Wu.parse(JSON.parse(qu)))},Vu,ku)},parse:function(Fu,Hu){for(var Vu=[],ku=0,Wu;ku<Fu.length;ku++)Wu=So.parse(Fu[ku]),Vu.push(Wu);Hu(Vu)},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(function(Fu){this.manager=Fu===void 0?fu:Fu,this._parser=null}.prototype,{load:function(Fu,Hu,Vu,ku){function Wu(Ku){Yu.load(Fu[Ku],function($u){var em=ju._parser($u,!0);qu[Ku]={width:em.width,height:em.height,format:em.format,mipmaps:em.mipmaps},Zu+=1,6===Zu&&(1===em.mipmapCount&&(Xu.minFilter=Fs),Xu.format=em.format,Xu.needsUpdate=!0,Hu&&Hu(Xu))},Vu,ku)}var ju=this,qu=[],Xu=new Rr;Xu.image=qu;var Yu=new Lo(this.manager);if(Yu.setPath(this.path),Yu.setResponseType('arraybuffer'),Array.isArray(Fu))for(var Zu=0,Ju=0,Qu=Fu.length;Ju<Qu;++Ju)Wu(Ju);else Yu.load(Fu,function(Ku){var $u=ju._parser(Ku,!0);if($u.isCubemap)for(var em=$u.mipmaps.length/$u.mipmapCount,tm=0;tm<em;tm++){qu[tm]={mipmaps:[]};for(var rm=0;rm<$u.mipmapCount;rm++)qu[tm].mipmaps.push($u.mipmaps[tm*$u.mipmapCount+rm]),qu[tm].format=$u.format,qu[tm].width=$u.width,qu[tm].height=$u.height}else Xu.image.width=$u.width,Xu.image.height=$u.height,Xu.mipmaps=$u.mipmaps;1===$u.mipmapCount&&(Xu.minFilter=Fs),Xu.format=$u.format,Xu.needsUpdate=!0,Hu&&Hu(Xu)},Vu,ku);return Xu},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(function(Fu){this.manager=Fu===void 0?fu:Fu,this._parser=null}.prototype,{load:function(Fu,Hu,Vu,ku){var Wu=this,ju=new G,qu=new Lo(this.manager);return qu.setResponseType('arraybuffer'),qu.setPath(this.path),qu.load(Fu,function(Xu){var Yu=Wu._parser(Xu);Yu&&(void 0===Yu.image?void 0!==Yu.data&&(ju.image.width=Yu.width,ju.image.height=Yu.height,ju.image.data=Yu.data):ju.image=Yu.image,ju.wrapS=void 0===Yu.wrapS?Ns:Yu.wrapS,ju.wrapT=void 0===Yu.wrapT?Ns:Yu.wrapT,ju.magFilter=void 0===Yu.magFilter?Fs:Yu.magFilter,ju.minFilter=void 0===Yu.minFilter?Vs:Yu.minFilter,ju.anisotropy=void 0===Yu.anisotropy?1:Yu.anisotropy,void 0!==Yu.format&&(ju.format=Yu.format),void 0!==Yu.type&&(ju.type=Yu.type),void 0!==Yu.mipmaps&&(ju.mipmaps=Yu.mipmaps),1===Yu.mipmapCount&&(ju.minFilter=Fs),ju.needsUpdate=!0,Hu&&Hu(ju,Yu))},Vu,ku),ju},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(Ro.prototype,{crossOrigin:'anonymous',load:function(Fu,Hu,Vu,ku){function Wu(){Yu.removeEventListener('load',Wu,!1),Yu.removeEventListener('error',ju,!1),gu.add(Fu,this),Hu&&Hu(this),qu.manager.itemEnd(Fu)}function ju(Zu){Yu.removeEventListener('load',Wu,!1),Yu.removeEventListener('error',ju,!1),ku&&ku(Zu),qu.manager.itemError(Fu),qu.manager.itemEnd(Fu)}void 0===Fu&&(Fu=''),void 0!==this.path&&(Fu=this.path+Fu),Fu=this.manager.resolveURL(Fu);var qu=this,Xu=gu.get(Fu);if(void 0!==Xu)return qu.manager.itemStart(Fu),setTimeout(function(){Hu&&Hu(Xu),qu.manager.itemEnd(Fu)},0),Xu;var Yu=document.createElementNS('http://www.w3.org/1999/xhtml','img');return Yu.addEventListener('load',Wu,!1),Yu.addEventListener('error',ju,!1),'data:'!==Fu.substr(0,5)&&void 0!==this.crossOrigin&&(Yu.crossOrigin=this.crossOrigin),qu.manager.itemStart(Fu),Yu.src=Fu,Yu},setCrossOrigin:function(Fu){return this.crossOrigin=Fu,this},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(Io.prototype,{crossOrigin:'anonymous',load:function(Fu,Hu,Vu,ku){function Wu(Zu){qu.load(Fu[Zu],function(Ju){ju.images[Zu]=Ju,Xu++,6===Xu&&(ju.needsUpdate=!0,Hu&&Hu(ju))},void 0,ku)}var ju=new He,qu=new Ro(this.manager);qu.setCrossOrigin(this.crossOrigin),qu.setPath(this.path);for(var Xu=0,Yu=0;Yu<Fu.length;++Yu)Wu(Yu);return ju},setCrossOrigin:function(Fu){return this.crossOrigin=Fu,this},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(Do.prototype,{crossOrigin:'anonymous',load:function(Fu,Hu,Vu,ku){var Wu=new R,ju=new Ro(this.manager);return ju.setCrossOrigin(this.crossOrigin),ju.setPath(this.path),ju.load(Fu,function(qu){Wu.image=qu;var Xu=0<Fu.search(/\.jpe?g$/i)||0===Fu.search(/^data\:image\/jpeg/);Wu.format=Xu?al:nl,Wu.needsUpdate=!0,void 0!==Hu&&Hu(Wu)},Vu,ku),Wu},setCrossOrigin:function(Fu){return this.crossOrigin=Fu,this},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(zo.prototype,{getPoint:function(){return console.warn('THREE.Curve: .getPoint() not implemented.'),null},getPointAt:function(Fu,Hu){var Vu=this.getUtoTmapping(Fu);return this.getPoint(Vu,Hu)},getPoints:function(Fu){Fu===void 0&&(Fu=5);for(var Hu=[],Vu=0;Vu<=Fu;Vu++)Hu.push(this.getPoint(Vu/Fu));return Hu},getSpacedPoints:function(Fu){Fu===void 0&&(Fu=5);for(var Hu=[],Vu=0;Vu<=Fu;Vu++)Hu.push(this.getPointAt(Vu/Fu));return Hu},getLength:function(){var Fu=this.getLengths();return Fu[Fu.length-1]},getLengths:function(Fu){if(void 0===Fu&&(Fu=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===Fu+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Hu=[],ku=this.getPoint(0),ju=0,Vu,Wu;for(Hu.push(0),Wu=1;Wu<=Fu;Wu++)Vu=this.getPoint(Wu/Fu),ju+=Vu.distanceTo(ku),Hu.push(ju),ku=Vu;return this.cacheArcLengths=Hu,Hu},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(Fu,Hu){var Vu=this.getLengths(),ku=0,Wu=Vu.length,ju;ju=Hu?Hu:Fu*Vu[Wu-1];for(var qu=0,Xu=Wu-1,Yu;qu<=Xu;)if(ku=Math.floor(qu+(Xu-qu)/2),Yu=Vu[ku]-ju,0>Yu)qu=ku+1;else if(0<Yu)Xu=ku-1;else{Xu=ku;break}if(ku=Xu,Vu[ku]===ju)return ku/(Wu-1);var Zu=Vu[ku],Ju=Vu[ku+1],Ku=(ju-Zu)/(Ju-Zu),$u=(ku+Ku)/(Wu-1);return $u},getTangent:function(Fu){var Hu=1e-4,Vu=Fu-Hu,ku=Fu+Hu;0>Vu&&(Vu=0),1<ku&&(ku=1);var Wu=this.getPoint(Vu),ju=this.getPoint(ku),qu=ju.clone().sub(Wu);return qu.normalize()},getTangentAt:function(Fu){var Hu=this.getUtoTmapping(Fu);return this.getTangent(Hu)},computeFrenetFrames:function(Fu,Hu){var Vu=new A,ku=[],Wu=[],ju=[],qu=new A,Xu=new E,Yu,Zu,Ju;for(Yu=0;Yu<=Fu;Yu++)Zu=Yu/Fu,ku[Yu]=this.getTangentAt(Zu),ku[Yu].normalize();Wu[0]=new A,ju[0]=new A;var Qu=Number.MAX_VALUE,Ku=Math.abs(ku[0].x),$u=Math.abs(ku[0].y),em=Math.abs(ku[0].z);for(Ku<=Qu&&(Qu=Ku,Vu.set(1,0,0)),$u<=Qu&&(Qu=$u,Vu.set(0,1,0)),em<=Qu&&Vu.set(0,0,1),qu.crossVectors(ku[0],Vu).normalize(),Wu[0].crossVectors(ku[0],qu),ju[0].crossVectors(ku[0],Wu[0]),Yu=1;Yu<=Fu;Yu++)Wu[Yu]=Wu[Yu-1].clone(),ju[Yu]=ju[Yu-1].clone(),qu.crossVectors(ku[Yu-1],ku[Yu]),qu.length()>Number.EPSILON&&(qu.normalize(),Ju=Math.acos(fp.clamp(ku[Yu-1].dot(ku[Yu]),-1,1)),Wu[Yu].applyMatrix4(Xu.makeRotationAxis(qu,Ju))),ju[Yu].crossVectors(ku[Yu],Wu[Yu]);if(!0===Hu)for(Ju=Math.acos(fp.clamp(Wu[0].dot(Wu[Fu]),-1,1)),Ju/=Fu,0<ku[0].dot(qu.crossVectors(Wu[0],Wu[Fu]))&&(Ju=-Ju),Yu=1;Yu<=Fu;Yu++)Wu[Yu].applyMatrix4(Xu.makeRotationAxis(ku[Yu],Ju*Yu)),ju[Yu].crossVectors(ku[Yu],Wu[Yu]);return{tangents:ku,normals:Wu,binormals:ju}},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.arcLengthDivisions=Fu.arcLengthDivisions,this},toJSON:function(){var Fu={metadata:{version:4.5,type:'Curve',generator:'Curve.toJSON'},arcLengthDivisions:this.arcLengthDivisions,type:this.type};return Fu},fromJSON:function(Fu){return this.arcLengthDivisions=Fu.arcLengthDivisions,this}}),No.prototype=Object.create(zo.prototype),No.prototype.constructor=No,No.prototype.isEllipseCurve=!0,No.prototype.getPoint=function(Fu,Hu){for(var Vu=Hu||new S,ku=2*Math.PI,Wu=this.aEndAngle-this.aStartAngle,ju=Math.abs(Wu)<Number.EPSILON;0>Wu;)Wu+=ku;for(;Wu>ku;)Wu-=ku;Wu<Number.EPSILON&&(ju?Wu=0:Wu=ku),!0!==this.aClockwise||ju||(Wu==ku?Wu=-ku:Wu-=ku);var qu=this.aStartAngle+Fu*Wu,Xu=this.aX+this.xRadius*Math.cos(qu),Yu=this.aY+this.yRadius*Math.sin(qu);if(0!==this.aRotation){var Zu=Math.cos(this.aRotation),Ju=Math.sin(this.aRotation),Qu=Xu-this.aX,Ku=Yu-this.aY;Xu=Qu*Zu-Ku*Ju+this.aX,Yu=Qu*Ju+Ku*Zu+this.aY}return Vu.set(Xu,Yu)},No.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.aX=Fu.aX,this.aY=Fu.aY,this.xRadius=Fu.xRadius,this.yRadius=Fu.yRadius,this.aStartAngle=Fu.aStartAngle,this.aEndAngle=Fu.aEndAngle,this.aClockwise=Fu.aClockwise,this.aRotation=Fu.aRotation,this},No.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.aX=this.aX,Fu.aY=this.aY,Fu.xRadius=this.xRadius,Fu.yRadius=this.yRadius,Fu.aStartAngle=this.aStartAngle,Fu.aEndAngle=this.aEndAngle,Fu.aClockwise=this.aClockwise,Fu.aRotation=this.aRotation,Fu},No.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.aX=Fu.aX,this.aY=Fu.aY,this.xRadius=Fu.xRadius,this.yRadius=Fu.yRadius,this.aStartAngle=Fu.aStartAngle,this.aEndAngle=Fu.aEndAngle,this.aClockwise=Fu.aClockwise,this.aRotation=Fu.aRotation,this},Bo.prototype=Object.create(No.prototype),Bo.prototype.constructor=Bo,Bo.prototype.isArcCurve=!0;var yu=new A,xu=new Uo,vu=new Uo,_u=new Uo;Go.prototype=Object.create(zo.prototype),Go.prototype.constructor=Go,Go.prototype.isCatmullRomCurve3=!0,Go.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new A,ku=this.points,Wu=ku.length,ju=(Wu-(this.closed?0:1))*Fu,qu=Math.floor(ju),Xu=ju-qu;this.closed?qu+=0<qu?0:(Math.floor(Math.abs(qu)/Wu)+1)*Wu:0==Xu&&qu===Wu-1&&(qu=Wu-2,Xu=1);var Yu,Zu,Ju,Qu;if(this.closed||0<qu?Yu=ku[(qu-1)%Wu]:(yu.subVectors(ku[0],ku[1]).add(ku[0]),Yu=yu),Zu=ku[qu%Wu],Ju=ku[(qu+1)%Wu],this.closed||qu+2<Wu?Qu=ku[(qu+2)%Wu]:(yu.subVectors(ku[Wu-1],ku[Wu-2]).add(ku[Wu-1]),Qu=yu),'centripetal'===this.curveType||'chordal'===this.curveType){var Ku='chordal'===this.curveType?0.5:0.25,$u=Math.pow(Yu.distanceToSquared(Zu),Ku),em=Math.pow(Zu.distanceToSquared(Ju),Ku),tm=Math.pow(Ju.distanceToSquared(Qu),Ku);1e-4>em&&(em=1),1e-4>$u&&($u=em),1e-4>tm&&(tm=em),xu.initNonuniformCatmullRom(Yu.x,Zu.x,Ju.x,Qu.x,$u,em,tm),vu.initNonuniformCatmullRom(Yu.y,Zu.y,Ju.y,Qu.y,$u,em,tm),_u.initNonuniformCatmullRom(Yu.z,Zu.z,Ju.z,Qu.z,$u,em,tm)}else'catmullrom'===this.curveType&&(xu.initCatmullRom(Yu.x,Zu.x,Ju.x,Qu.x,this.tension),vu.initCatmullRom(Yu.y,Zu.y,Ju.y,Qu.y,this.tension),_u.initCatmullRom(Yu.z,Zu.z,Ju.z,Qu.z,this.tension));return Vu.set(xu.calc(Xu),vu.calc(Xu),_u.calc(Xu)),Vu},Go.prototype.copy=function(Fu){zo.prototype.copy.call(this,Fu),this.points=[];for(var Hu=0,Vu=Fu.points.length,ku;Hu<Vu;Hu++)ku=Fu.points[Hu],this.points.push(ku.clone());return this.closed=Fu.closed,this.curveType=Fu.curveType,this.tension=Fu.tension,this},Go.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);Fu.points=[];for(var Hu=0,Vu=this.points.length,ku;Hu<Vu;Hu++)ku=this.points[Hu],Fu.points.push(ku.toArray());return Fu.closed=this.closed,Fu.curveType=this.curveType,Fu.tension=this.tension,Fu},Go.prototype.fromJSON=function(Fu){zo.prototype.fromJSON.call(this,Fu),this.points=[];for(var Hu=0,Vu=Fu.points.length,ku;Hu<Vu;Hu++)ku=Fu.points[Hu],this.points.push(new A().fromArray(ku));return this.closed=Fu.closed,this.curveType=Fu.curveType,this.tension=Fu.tension,this},Zo.prototype=Object.create(zo.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isCubicBezierCurve=!0,Zo.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new S,ku=this.v0,Wu=this.v1,ju=this.v2,qu=this.v3;return Vu.set(Yo(Fu,ku.x,Wu.x,ju.x,qu.x),Yo(Fu,ku.y,Wu.y,ju.y,qu.y)),Vu},Zo.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.v0.copy(Fu.v0),this.v1.copy(Fu.v1),this.v2.copy(Fu.v2),this.v3.copy(Fu.v3),this},Zo.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.v0=this.v0.toArray(),Fu.v1=this.v1.toArray(),Fu.v2=this.v2.toArray(),Fu.v3=this.v3.toArray(),Fu},Zo.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.v0.fromArray(Fu.v0),this.v1.fromArray(Fu.v1),this.v2.fromArray(Fu.v2),this.v3.fromArray(Fu.v3),this},Jo.prototype=Object.create(zo.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isCubicBezierCurve3=!0,Jo.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new A,ku=this.v0,Wu=this.v1,ju=this.v2,qu=this.v3;return Vu.set(Yo(Fu,ku.x,Wu.x,ju.x,qu.x),Yo(Fu,ku.y,Wu.y,ju.y,qu.y),Yo(Fu,ku.z,Wu.z,ju.z,qu.z)),Vu},Jo.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.v0.copy(Fu.v0),this.v1.copy(Fu.v1),this.v2.copy(Fu.v2),this.v3.copy(Fu.v3),this},Jo.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.v0=this.v0.toArray(),Fu.v1=this.v1.toArray(),Fu.v2=this.v2.toArray(),Fu.v3=this.v3.toArray(),Fu},Jo.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.v0.fromArray(Fu.v0),this.v1.fromArray(Fu.v1),this.v2.fromArray(Fu.v2),this.v3.fromArray(Fu.v3),this},Qo.prototype=Object.create(zo.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isLineCurve=!0,Qo.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new S;return 1===Fu?Vu.copy(this.v2):(Vu.copy(this.v2).sub(this.v1),Vu.multiplyScalar(Fu).add(this.v1)),Vu},Qo.prototype.getPointAt=function(Fu,Hu){return this.getPoint(Fu,Hu)},Qo.prototype.getTangent=function(){var Fu=this.v2.clone().sub(this.v1);return Fu.normalize()},Qo.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.v1.copy(Fu.v1),this.v2.copy(Fu.v2),this},Qo.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.v1=this.v1.toArray(),Fu.v2=this.v2.toArray(),Fu},Qo.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.v1.fromArray(Fu.v1),this.v2.fromArray(Fu.v2),this},Ko.prototype=Object.create(zo.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isLineCurve3=!0,Ko.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new A;return 1===Fu?Vu.copy(this.v2):(Vu.copy(this.v2).sub(this.v1),Vu.multiplyScalar(Fu).add(this.v1)),Vu},Ko.prototype.getPointAt=function(Fu,Hu){return this.getPoint(Fu,Hu)},Ko.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.v1.copy(Fu.v1),this.v2.copy(Fu.v2),this},Ko.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.v1=this.v1.toArray(),Fu.v2=this.v2.toArray(),Fu},Ko.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.v1.fromArray(Fu.v1),this.v2.fromArray(Fu.v2),this},$o.prototype=Object.create(zo.prototype),$o.prototype.constructor=$o,$o.prototype.isQuadraticBezierCurve=!0,$o.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new S,ku=this.v0,Wu=this.v1,ju=this.v2;return Vu.set(ko(Fu,ku.x,Wu.x,ju.x),ko(Fu,ku.y,Wu.y,ju.y)),Vu},$o.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.v0.copy(Fu.v0),this.v1.copy(Fu.v1),this.v2.copy(Fu.v2),this},$o.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.v0=this.v0.toArray(),Fu.v1=this.v1.toArray(),Fu.v2=this.v2.toArray(),Fu},$o.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.v0.fromArray(Fu.v0),this.v1.fromArray(Fu.v1),this.v2.fromArray(Fu.v2),this},ei.prototype=Object.create(zo.prototype),ei.prototype.constructor=ei,ei.prototype.isQuadraticBezierCurve3=!0,ei.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new A,ku=this.v0,Wu=this.v1,ju=this.v2;return Vu.set(ko(Fu,ku.x,Wu.x,ju.x),ko(Fu,ku.y,Wu.y,ju.y),ko(Fu,ku.z,Wu.z,ju.z)),Vu},ei.prototype.copy=function(Fu){return zo.prototype.copy.call(this,Fu),this.v0.copy(Fu.v0),this.v1.copy(Fu.v1),this.v2.copy(Fu.v2),this},ei.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);return Fu.v0=this.v0.toArray(),Fu.v1=this.v1.toArray(),Fu.v2=this.v2.toArray(),Fu},ei.prototype.fromJSON=function(Fu){return zo.prototype.fromJSON.call(this,Fu),this.v0.fromArray(Fu.v0),this.v1.fromArray(Fu.v1),this.v2.fromArray(Fu.v2),this},ti.prototype=Object.create(zo.prototype),ti.prototype.constructor=ti,ti.prototype.isSplineCurve=!0,ti.prototype.getPoint=function(Fu,Hu){var Vu=Hu||new S,ku=this.points,Wu=(ku.length-1)*Fu,ju=Math.floor(Wu),qu=Wu-ju,Xu=ku[0===ju?ju:ju-1],Yu=ku[ju],Zu=ku[ju>ku.length-2?ku.length-1:ju+1],Ju=ku[ju>ku.length-3?ku.length-1:ju+2];return Vu.set(Oo(qu,Xu.x,Yu.x,Zu.x,Ju.x),Oo(qu,Xu.y,Yu.y,Zu.y,Ju.y)),Vu},ti.prototype.copy=function(Fu){zo.prototype.copy.call(this,Fu),this.points=[];for(var Hu=0,Vu=Fu.points.length,ku;Hu<Vu;Hu++)ku=Fu.points[Hu],this.points.push(ku.clone());return this},ti.prototype.toJSON=function(){var Fu=zo.prototype.toJSON.call(this);Fu.points=[];for(var Hu=0,Vu=this.points.length,ku;Hu<Vu;Hu++)ku=this.points[Hu],Fu.points.push(ku.toArray());return Fu},ti.prototype.fromJSON=function(Fu){zo.prototype.fromJSON.call(this,Fu),this.points=[];for(var Hu=0,Vu=Fu.points.length,ku;Hu<Vu;Hu++)ku=Fu.points[Hu],this.points.push(new S().fromArray(ku));return this};var bu=Object.freeze({ArcCurve:Bo,CatmullRomCurve3:Go,CubicBezierCurve:Zo,CubicBezierCurve3:Jo,EllipseCurve:No,LineCurve:Qo,LineCurve3:Ko,QuadraticBezierCurve:$o,QuadraticBezierCurve3:ei,SplineCurve:ti});ri.prototype=Object.assign(Object.create(zo.prototype),{constructor:ri,add:function(Fu){this.curves.push(Fu)},closePath:function(){var Fu=this.curves[0].getPoint(0),Hu=this.curves[this.curves.length-1].getPoint(1);Fu.equals(Hu)||this.curves.push(new Qo(Hu,Fu))},getPoint:function(Fu){for(var Hu=Fu*this.getLength(),Vu=this.getCurveLengths(),ku=0;ku<Vu.length;){if(Vu[ku]>=Hu){var Wu=Vu[ku]-Hu,ju=this.curves[ku],qu=ju.getLength(),Xu=0===qu?0:1-Wu/qu;return ju.getPointAt(Xu)}ku++}return null},getLength:function(){var Fu=this.getCurveLengths();return Fu[Fu.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var Fu=[],Hu=0,Vu=0,ku=this.curves.length;Vu<ku;Vu++)Hu+=this.curves[Vu].getLength(),Fu.push(Hu);return this.cacheLengths=Fu,Fu},getSpacedPoints:function(Fu){void 0===Fu&&(Fu=40);for(var Hu=[],Vu=0;Vu<=Fu;Vu++)Hu.push(this.getPoint(Vu/Fu));return this.autoClose&&Hu.push(Hu[0]),Hu},getPoints:function(Fu){Fu=Fu||12;for(var Hu=[],ku=0,Wu=this.curves,Vu;ku<Wu.length;ku++)for(var ju=Wu[ku],qu=ju&&ju.isEllipseCurve?2*Fu:ju&&(ju.isLineCurve||ju.isLineCurve3)?1:ju&&ju.isSplineCurve?Fu*ju.points.length:Fu,Xu=ju.getPoints(qu),Yu=0,Zu;Yu<Xu.length;Yu++)Zu=Xu[Yu],Vu&&Vu.equals(Zu)||(Hu.push(Zu),Vu=Zu);return this.autoClose&&1<Hu.length&&!Hu[Hu.length-1].equals(Hu[0])&&Hu.push(Hu[0]),Hu},copy:function(Fu){zo.prototype.copy.call(this,Fu),this.curves=[];for(var Hu=0,Vu=Fu.curves.length,ku;Hu<Vu;Hu++)ku=Fu.curves[Hu],this.curves.push(ku.clone());return this.autoClose=Fu.autoClose,this},toJSON:function(){var Fu=zo.prototype.toJSON.call(this);Fu.autoClose=this.autoClose,Fu.curves=[];for(var Hu=0,Vu=this.curves.length,ku;Hu<Vu;Hu++)ku=this.curves[Hu],Fu.curves.push(ku.toJSON());return Fu},fromJSON:function(Fu){zo.prototype.fromJSON.call(this,Fu),this.autoClose=Fu.autoClose,this.curves=[];for(var Hu=0,Vu=Fu.curves.length,ku;Hu<Vu;Hu++)ku=Fu.curves[Hu],this.curves.push(new bu[ku.type]().fromJSON(ku));return this}}),ai.prototype=Object.assign(Object.create(ri.prototype),{constructor:ai,setFromPoints:function(Fu){this.moveTo(Fu[0].x,Fu[0].y);for(var Hu=1,Vu=Fu.length;Hu<Vu;Hu++)this.lineTo(Fu[Hu].x,Fu[Hu].y)},moveTo:function(Fu,Hu){this.currentPoint.set(Fu,Hu)},lineTo:function(Fu,Hu){var Vu=new Qo(this.currentPoint.clone(),new S(Fu,Hu));this.curves.push(Vu),this.currentPoint.set(Fu,Hu)},quadraticCurveTo:function(Fu,Hu,Vu,ku){var Wu=new $o(this.currentPoint.clone(),new S(Fu,Hu),new S(Vu,ku));this.curves.push(Wu),this.currentPoint.set(Vu,ku)},bezierCurveTo:function(Fu,Hu,Vu,ku,Wu,ju){var qu=new Zo(this.currentPoint.clone(),new S(Fu,Hu),new S(Vu,ku),new S(Wu,ju));this.curves.push(qu),this.currentPoint.set(Wu,ju)},splineThru:function(Fu){var Hu=[this.currentPoint.clone()].concat(Fu),Vu=new ti(Hu);this.curves.push(Vu),this.currentPoint.copy(Fu[Fu.length-1])},arc:function(Fu,Hu,Vu,ku,Wu,ju){var qu=this.currentPoint.x,Xu=this.currentPoint.y;this.absarc(Fu+qu,Hu+Xu,Vu,ku,Wu,ju)},absarc:function(Fu,Hu,Vu,ku,Wu,ju){this.absellipse(Fu,Hu,Vu,Vu,ku,Wu,ju)},ellipse:function(Fu,Hu,Vu,ku,Wu,ju,qu,Xu){var Yu=this.currentPoint.x,Zu=this.currentPoint.y;this.absellipse(Fu+Yu,Hu+Zu,Vu,ku,Wu,ju,qu,Xu)},absellipse:function(Fu,Hu,Vu,ku,Wu,ju,qu,Xu){var Yu=new No(Fu,Hu,Vu,ku,Wu,ju,qu,Xu);if(0<this.curves.length){var Zu=Yu.getPoint(0);Zu.equals(this.currentPoint)||this.lineTo(Zu.x,Zu.y)}this.curves.push(Yu);var Ju=Yu.getPoint(1);this.currentPoint.copy(Ju)},copy:function(Fu){return ri.prototype.copy.call(this,Fu),this.currentPoint.copy(Fu.currentPoint),this},toJSON:function(){var Fu=ri.prototype.toJSON.call(this);return Fu.currentPoint=this.currentPoint.toArray(),Fu},fromJSON:function(Fu){return ri.prototype.fromJSON.call(this,Fu),this.currentPoint.fromArray(Fu.currentPoint),this}}),oi.prototype=Object.assign(Object.create(ai.prototype),{constructor:oi,getPointsHoles:function(Fu){for(var Hu=[],Vu=0,ku=this.holes.length;Vu<ku;Vu++)Hu[Vu]=this.holes[Vu].getPoints(Fu);return Hu},extractPoints:function(Fu){return{shape:this.getPoints(Fu),holes:this.getPointsHoles(Fu)}},copy:function(Fu){ai.prototype.copy.call(this,Fu),this.holes=[];for(var Hu=0,Vu=Fu.holes.length,ku;Hu<Vu;Hu++)ku=Fu.holes[Hu],this.holes.push(ku.clone());return this},toJSON:function(){var Fu=ai.prototype.toJSON.call(this);Fu.uuid=this.uuid,Fu.holes=[];for(var Hu=0,Vu=this.holes.length,ku;Hu<Vu;Hu++)ku=this.holes[Hu],Fu.holes.push(ku.toJSON());return Fu},fromJSON:function(Fu){ai.prototype.fromJSON.call(this,Fu),this.uuid=Fu.uuid,this.holes=[];for(var Hu=0,Vu=Fu.holes.length,ku;Hu<Vu;Hu++)ku=Fu.holes[Hu],this.holes.push(new ai().fromJSON(ku));return this}}),ii.prototype=Object.assign(Object.create(K.prototype),{constructor:ii,isLight:!0,copy:function(Fu){return K.prototype.copy.call(this,Fu),this.color.copy(Fu.color),this.intensity=Fu.intensity,this},toJSON:function(Fu){var Hu=K.prototype.toJSON.call(this,Fu);return Hu.object.color=this.color.getHex(),Hu.object.intensity=this.intensity,void 0!==this.groundColor&&(Hu.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(Hu.object.distance=this.distance),void 0!==this.angle&&(Hu.object.angle=this.angle),void 0!==this.decay&&(Hu.object.decay=this.decay),void 0!==this.penumbra&&(Hu.object.penumbra=this.penumbra),void 0!==this.shadow&&(Hu.object.shadow=this.shadow.toJSON()),Hu}}),ni.prototype=Object.assign(Object.create(ii.prototype),{constructor:ni,isHemisphereLight:!0,copy:function(Fu){return ii.prototype.copy.call(this,Fu),this.groundColor.copy(Fu.groundColor),this}}),Object.assign(si.prototype,{copy:function(Fu){return this.camera=Fu.camera.clone(),this.bias=Fu.bias,this.radius=Fu.radius,this.mapSize.copy(Fu.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var Fu={};return 0!==this.bias&&(Fu.bias=this.bias),1!==this.radius&&(Fu.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(Fu.mapSize=this.mapSize.toArray()),Fu.camera=this.camera.toJSON(!1).object,delete Fu.camera.matrix,Fu}}),li.prototype=Object.assign(Object.create(si.prototype),{constructor:li,isSpotLightShadow:!0,update:function(Fu){var Hu=this.camera,Vu=2*fp.RAD2DEG*Fu.angle,ku=this.mapSize.width/this.mapSize.height,Wu=Fu.distance||Hu.far;(Vu!==Hu.fov||ku!==Hu.aspect||Wu!==Hu.far)&&(Hu.fov=Vu,Hu.aspect=ku,Hu.far=Wu,Hu.updateProjectionMatrix())}}),pi.prototype=Object.assign(Object.create(ii.prototype),{constructor:pi,isSpotLight:!0,copy:function(Fu){return ii.prototype.copy.call(this,Fu),this.distance=Fu.distance,this.angle=Fu.angle,this.penumbra=Fu.penumbra,this.decay=Fu.decay,this.target=Fu.target.clone(),this.shadow=Fu.shadow.clone(),this}}),di.prototype=Object.assign(Object.create(ii.prototype),{constructor:di,isPointLight:!0,copy:function(Fu){return ii.prototype.copy.call(this,Fu),this.distance=Fu.distance,this.decay=Fu.decay,this.shadow=Fu.shadow.clone(),this}}),ci.prototype=Object.assign(Object.create(ir.prototype),{constructor:ci,isOrthographicCamera:!0,copy:function(Fu,Hu){return ir.prototype.copy.call(this,Fu,Hu),this.left=Fu.left,this.right=Fu.right,this.top=Fu.top,this.bottom=Fu.bottom,this.near=Fu.near,this.far=Fu.far,this.zoom=Fu.zoom,this.view=null===Fu.view?null:Object.assign({},Fu.view),this},setViewOffset:function(Fu,Hu,Vu,ku,Wu,ju){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=Fu,this.view.fullHeight=Hu,this.view.offsetX=Vu,this.view.offsetY=ku,this.view.width=Wu,this.view.height=ju,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var Fu=(this.right-this.left)/(2*this.zoom),Hu=(this.top-this.bottom)/(2*this.zoom),Vu=(this.right+this.left)/2,ku=(this.top+this.bottom)/2,Wu=Vu-Fu,ju=Vu+Fu,qu=ku+Hu,Xu=ku-Hu;if(null!==this.view&&this.view.enabled){var Yu=this.zoom/(this.view.width/this.view.fullWidth),Zu=this.zoom/(this.view.height/this.view.fullHeight),Ju=(this.right-this.left)/this.view.width,Qu=(this.top-this.bottom)/this.view.height;Wu+=Ju*(this.view.offsetX/Yu),ju=Wu+Ju*(this.view.width/Yu),qu-=Qu*(this.view.offsetY/Zu),Xu=qu-Qu*(this.view.height/Zu)}this.projectionMatrix.makeOrthographic(Wu,ju,qu,Xu,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(Fu){var Hu=K.prototype.toJSON.call(this,Fu);return Hu.object.zoom=this.zoom,Hu.object.left=this.left,Hu.object.right=this.right,Hu.object.top=this.top,Hu.object.bottom=this.bottom,Hu.object.near=this.near,Hu.object.far=this.far,null!==this.view&&(Hu.object.view=Object.assign({},this.view)),Hu}}),ui.prototype=Object.assign(Object.create(si.prototype),{constructor:ui}),mi.prototype=Object.assign(Object.create(ii.prototype),{constructor:mi,isDirectionalLight:!0,copy:function(Fu){return ii.prototype.copy.call(this,Fu),this.target=Fu.target.clone(),this.shadow=Fu.shadow.clone(),this}}),gi.prototype=Object.assign(Object.create(ii.prototype),{constructor:gi,isAmbientLight:!0}),hi.prototype=Object.assign(Object.create(ii.prototype),{constructor:hi,isRectAreaLight:!0,copy:function(Fu){return ii.prototype.copy.call(this,Fu),this.width=Fu.width,this.height=Fu.height,this},toJSON:function(Fu){var Hu=ii.prototype.toJSON.call(this,Fu);return Hu.object.width=this.width,Hu.object.height=this.height,Hu}}),Object.assign(yi.prototype,{load:function(Fu,Hu,Vu,ku){var Wu=this,ju=new Lo(Wu.manager);ju.setPath(Wu.path),ju.load(Fu,function(qu){Hu(Wu.parse(JSON.parse(qu)))},Vu,ku)},parse:function(Fu){function Hu(Xu){return void 0===Vu[Xu]&&console.warn('THREE.MaterialLoader: Undefined texture',Xu),Vu[Xu]}var Vu=this.textures,ku=new uu[Fu.type];if(void 0!==Fu.uuid&&(ku.uuid=Fu.uuid),void 0!==Fu.name&&(ku.name=Fu.name),void 0!==Fu.color&&ku.color.setHex(Fu.color),void 0!==Fu.roughness&&(ku.roughness=Fu.roughness),void 0!==Fu.metalness&&(ku.metalness=Fu.metalness),void 0!==Fu.emissive&&ku.emissive.setHex(Fu.emissive),void 0!==Fu.specular&&ku.specular.setHex(Fu.specular),void 0!==Fu.shininess&&(ku.shininess=Fu.shininess),void 0!==Fu.clearCoat&&(ku.clearCoat=Fu.clearCoat),void 0!==Fu.clearCoatRoughness&&(ku.clearCoatRoughness=Fu.clearCoatRoughness),void 0!==Fu.vertexColors&&(ku.vertexColors=Fu.vertexColors),void 0!==Fu.fog&&(ku.fog=Fu.fog),void 0!==Fu.flatShading&&(ku.flatShading=Fu.flatShading),void 0!==Fu.blending&&(ku.blending=Fu.blending),void 0!==Fu.combine&&(ku.combine=Fu.combine),void 0!==Fu.side&&(ku.side=Fu.side),void 0!==Fu.opacity&&(ku.opacity=Fu.opacity),void 0!==Fu.transparent&&(ku.transparent=Fu.transparent),void 0!==Fu.alphaTest&&(ku.alphaTest=Fu.alphaTest),void 0!==Fu.depthTest&&(ku.depthTest=Fu.depthTest),void 0!==Fu.depthWrite&&(ku.depthWrite=Fu.depthWrite),void 0!==Fu.colorWrite&&(ku.colorWrite=Fu.colorWrite),void 0!==Fu.wireframe&&(ku.wireframe=Fu.wireframe),void 0!==Fu.wireframeLinewidth&&(ku.wireframeLinewidth=Fu.wireframeLinewidth),void 0!==Fu.wireframeLinecap&&(ku.wireframeLinecap=Fu.wireframeLinecap),void 0!==Fu.wireframeLinejoin&&(ku.wireframeLinejoin=Fu.wireframeLinejoin),void 0!==Fu.rotation&&(ku.rotation=Fu.rotation),1!==Fu.linewidth&&(ku.linewidth=Fu.linewidth),void 0!==Fu.dashSize&&(ku.dashSize=Fu.dashSize),void 0!==Fu.gapSize&&(ku.gapSize=Fu.gapSize),void 0!==Fu.scale&&(ku.scale=Fu.scale),void 0!==Fu.polygonOffset&&(ku.polygonOffset=Fu.polygonOffset),void 0!==Fu.polygonOffsetFactor&&(ku.polygonOffsetFactor=Fu.polygonOffsetFactor),void 0!==Fu.polygonOffsetUnits&&(ku.polygonOffsetUnits=Fu.polygonOffsetUnits),void 0!==Fu.skinning&&(ku.skinning=Fu.skinning),void 0!==Fu.morphTargets&&(ku.morphTargets=Fu.morphTargets),void 0!==Fu.dithering&&(ku.dithering=Fu.dithering),void 0!==Fu.visible&&(ku.visible=Fu.visible),void 0!==Fu.userData&&(ku.userData=Fu.userData),void 0!==Fu.uniforms)for(var Wu in Fu.uniforms){var ju=Fu.uniforms[Wu];switch(ku.uniforms[Wu]={},ju.type){case't':ku.uniforms[Wu].value=Hu(ju.value);break;case'c':ku.uniforms[Wu].value=new W().setHex(ju.value);break;case'v2':ku.uniforms[Wu].value=new S().fromArray(ju.value);break;case'v3':ku.uniforms[Wu].value=new A().fromArray(ju.value);break;case'v4':ku.uniforms[Wu].value=new I().fromArray(ju.value);break;case'm4':ku.uniforms[Wu].value=new E().fromArray(ju.value);break;default:ku.uniforms[Wu].value=ju.value;}}if(void 0!==Fu.defines&&(ku.defines=Fu.defines),void 0!==Fu.vertexShader&&(ku.vertexShader=Fu.vertexShader),void 0!==Fu.fragmentShader&&(ku.fragmentShader=Fu.fragmentShader),void 0!==Fu.shading&&(ku.flatShading=1===Fu.shading),void 0!==Fu.size&&(ku.size=Fu.size),void 0!==Fu.sizeAttenuation&&(ku.sizeAttenuation=Fu.sizeAttenuation),void 0!==Fu.map&&(ku.map=Hu(Fu.map)),void 0!==Fu.alphaMap&&(ku.alphaMap=Hu(Fu.alphaMap),ku.transparent=!0),void 0!==Fu.bumpMap&&(ku.bumpMap=Hu(Fu.bumpMap)),void 0!==Fu.bumpScale&&(ku.bumpScale=Fu.bumpScale),void 0!==Fu.normalMap&&(ku.normalMap=Hu(Fu.normalMap)),void 0!==Fu.normalMapType&&(ku.normalMapType=Fu.normalMapType),void 0!==Fu.normalScale){var qu=Fu.normalScale;!1===Array.isArray(qu)&&(qu=[qu,qu]),ku.normalScale=new S().fromArray(qu)}return void 0!==Fu.displacementMap&&(ku.displacementMap=Hu(Fu.displacementMap)),void 0!==Fu.displacementScale&&(ku.displacementScale=Fu.displacementScale),void 0!==Fu.displacementBias&&(ku.displacementBias=Fu.displacementBias),void 0!==Fu.roughnessMap&&(ku.roughnessMap=Hu(Fu.roughnessMap)),void 0!==Fu.metalnessMap&&(ku.metalnessMap=Hu(Fu.metalnessMap)),void 0!==Fu.emissiveMap&&(ku.emissiveMap=Hu(Fu.emissiveMap)),void 0!==Fu.emissiveIntensity&&(ku.emissiveIntensity=Fu.emissiveIntensity),void 0!==Fu.specularMap&&(ku.specularMap=Hu(Fu.specularMap)),void 0!==Fu.envMap&&(ku.envMap=Hu(Fu.envMap)),void 0!==Fu.envMapIntensity&&(ku.envMapIntensity=Fu.envMapIntensity),void 0!==Fu.reflectivity&&(ku.reflectivity=Fu.reflectivity),void 0!==Fu.lightMap&&(ku.lightMap=Hu(Fu.lightMap)),void 0!==Fu.lightMapIntensity&&(ku.lightMapIntensity=Fu.lightMapIntensity),void 0!==Fu.aoMap&&(ku.aoMap=Hu(Fu.aoMap)),void 0!==Fu.aoMapIntensity&&(ku.aoMapIntensity=Fu.aoMapIntensity),void 0!==Fu.gradientMap&&(ku.gradientMap=Hu(Fu.gradientMap)),ku},setPath:function(Fu){return this.path=Fu,this},setTextures:function(Fu){return this.textures=Fu,this}});var Mu={decodeText:function(Fu){if('undefined'!=typeof TextDecoder)return new TextDecoder().decode(Fu);for(var Hu='',Vu=0,ku=Fu.length;Vu<ku;Vu++)Hu+=String.fromCharCode(Fu[Vu]);return decodeURIComponent(escape(Hu))},extractUrlBase:function(Fu){var Hu=Fu.lastIndexOf('/');return-1===Hu?'./':Fu.substr(0,Hu+1)}};Object.assign(xi.prototype,{load:function(Fu,Hu,Vu,ku){var Wu=this,ju=new Lo(Wu.manager);ju.setPath(Wu.path),ju.load(Fu,function(qu){Hu(Wu.parse(JSON.parse(qu)))},Vu,ku)},parse:function(Fu){var Hu=new xe,Vu=Fu.data.index;if(Vu!==void 0){var ku=new Su[Vu.type](Vu.array);Hu.setIndex(new re(ku,1))}var Wu=Fu.data.attributes;for(var ju in Wu){var qu=Wu[ju],ku=new Su[qu.type](qu.array);Hu.addAttribute(ju,new re(ku,qu.itemSize,qu.normalized))}var Xu=Fu.data.groups||Fu.data.drawcalls||Fu.data.offsets;if(Xu!==void 0)for(var Yu=0,Zu=Xu.length,Ju;Yu!==Zu;++Yu)Ju=Xu[Yu],Hu.addGroup(Ju.start,Ju.count,Ju.materialIndex);var Qu=Fu.data.boundingSphere;if(Qu!==void 0){var Ku=new A;Qu.center!==void 0&&Ku.fromArray(Qu.center),Hu.boundingSphere=new F(Ku,Qu.radius)}return Hu},setPath:function(Fu){return this.path=Fu,this}});var Su={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:'undefined'==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};vi.Handlers={handlers:[],add:function(Fu,Hu){this.handlers.push(Fu,Hu)},get:function(Fu){for(var Hu=this.handlers,Vu=0,ku=Hu.length;Vu<ku;Vu+=2){var Wu=Hu[Vu],ju=Hu[Vu+1];if(Wu.test(Fu))return ju}return null}},Object.assign(vi.prototype,{crossOrigin:'anonymous',onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(Fu,Hu,Vu){for(var ku=[],Wu=0;Wu<Fu.length;++Wu)ku[Wu]=this.createMaterial(Fu[Wu],Hu,Vu);return ku},createMaterial:function(){var Fu={NoBlending:Fn,NormalBlending:Hn,AdditiveBlending:Vn,SubtractiveBlending:kn,MultiplyBlending:Wn,CustomBlending:jn},Hu=new W,Vu=new Do,ku=new yi;return function(ju,qu,Xu){function Yu($u,em,tm,rm,am){var om=qu+$u,im=vi.Handlers.get(om),nm;null===im?(Vu.setCrossOrigin(Xu),nm=Vu.load(om)):nm=im.load(om),void 0!==em&&(nm.repeat.fromArray(em),1!==em[0]&&(nm.wrapS=zs),1!==em[1]&&(nm.wrapT=zs)),void 0!==tm&&nm.offset.fromArray(tm),void 0!==rm&&('repeat'===rm[0]&&(nm.wrapS=zs),'mirror'===rm[0]&&(nm.wrapS=Bs),'repeat'===rm[1]&&(nm.wrapT=zs),'mirror'===rm[1]&&(nm.wrapT=Bs)),void 0!==am&&(nm.anisotropy=am);var sm=fp.generateUUID();return Zu[sm]=nm,sm}var Zu={},Ju={uuid:fp.generateUUID(),type:'MeshLambertMaterial'};for(var Qu in ju){var Ku=ju[Qu];switch(Qu){case'DbgColor':case'DbgIndex':case'opticalDensity':case'illumination':break;case'DbgName':Ju.name=Ku;break;case'blending':Ju.blending=Fu[Ku];break;case'colorAmbient':case'mapAmbient':console.warn('THREE.Loader.createMaterial:',Qu,'is no longer supported.');break;case'colorDiffuse':Ju.color=Hu.fromArray(Ku).getHex();break;case'colorSpecular':Ju.specular=Hu.fromArray(Ku).getHex();break;case'colorEmissive':Ju.emissive=Hu.fromArray(Ku).getHex();break;case'specularCoef':Ju.shininess=Ku;break;case'shading':'basic'===Ku.toLowerCase()&&(Ju.type='MeshBasicMaterial'),'phong'===Ku.toLowerCase()&&(Ju.type='MeshPhongMaterial'),'standard'===Ku.toLowerCase()&&(Ju.type='MeshStandardMaterial');break;case'mapDiffuse':Ju.map=Yu(Ku,ju.mapDiffuseRepeat,ju.mapDiffuseOffset,ju.mapDiffuseWrap,ju.mapDiffuseAnisotropy);break;case'mapDiffuseRepeat':case'mapDiffuseOffset':case'mapDiffuseWrap':case'mapDiffuseAnisotropy':break;case'mapEmissive':Ju.emissiveMap=Yu(Ku,ju.mapEmissiveRepeat,ju.mapEmissiveOffset,ju.mapEmissiveWrap,ju.mapEmissiveAnisotropy);break;case'mapEmissiveRepeat':case'mapEmissiveOffset':case'mapEmissiveWrap':case'mapEmissiveAnisotropy':break;case'mapLight':Ju.lightMap=Yu(Ku,ju.mapLightRepeat,ju.mapLightOffset,ju.mapLightWrap,ju.mapLightAnisotropy);break;case'mapLightRepeat':case'mapLightOffset':case'mapLightWrap':case'mapLightAnisotropy':break;case'mapAO':Ju.aoMap=Yu(Ku,ju.mapAORepeat,ju.mapAOOffset,ju.mapAOWrap,ju.mapAOAnisotropy);break;case'mapAORepeat':case'mapAOOffset':case'mapAOWrap':case'mapAOAnisotropy':break;case'mapBump':Ju.bumpMap=Yu(Ku,ju.mapBumpRepeat,ju.mapBumpOffset,ju.mapBumpWrap,ju.mapBumpAnisotropy);break;case'mapBumpScale':Ju.bumpScale=Ku;break;case'mapBumpRepeat':case'mapBumpOffset':case'mapBumpWrap':case'mapBumpAnisotropy':break;case'mapNormal':Ju.normalMap=Yu(Ku,ju.mapNormalRepeat,ju.mapNormalOffset,ju.mapNormalWrap,ju.mapNormalAnisotropy);break;case'mapNormalFactor':Ju.normalScale=Ku;break;case'mapNormalRepeat':case'mapNormalOffset':case'mapNormalWrap':case'mapNormalAnisotropy':break;case'mapSpecular':Ju.specularMap=Yu(Ku,ju.mapSpecularRepeat,ju.mapSpecularOffset,ju.mapSpecularWrap,ju.mapSpecularAnisotropy);break;case'mapSpecularRepeat':case'mapSpecularOffset':case'mapSpecularWrap':case'mapSpecularAnisotropy':break;case'mapMetalness':Ju.metalnessMap=Yu(Ku,ju.mapMetalnessRepeat,ju.mapMetalnessOffset,ju.mapMetalnessWrap,ju.mapMetalnessAnisotropy);break;case'mapMetalnessRepeat':case'mapMetalnessOffset':case'mapMetalnessWrap':case'mapMetalnessAnisotropy':break;case'mapRoughness':Ju.roughnessMap=Yu(Ku,ju.mapRoughnessRepeat,ju.mapRoughnessOffset,ju.mapRoughnessWrap,ju.mapRoughnessAnisotropy);break;case'mapRoughnessRepeat':case'mapRoughnessOffset':case'mapRoughnessWrap':case'mapRoughnessAnisotropy':break;case'mapAlpha':Ju.alphaMap=Yu(Ku,ju.mapAlphaRepeat,ju.mapAlphaOffset,ju.mapAlphaWrap,ju.mapAlphaAnisotropy);break;case'mapAlphaRepeat':case'mapAlphaOffset':case'mapAlphaWrap':case'mapAlphaAnisotropy':break;case'flipSided':Ju.side=zn;break;case'doubleSided':Ju.side=Nn;break;case'transparency':console.warn('THREE.Loader.createMaterial: transparency has been renamed to opacity'),Ju.opacity=Ku;break;case'depthTest':case'depthWrite':case'colorWrite':case'opacity':case'reflectivity':case'transparent':case'visible':case'wireframe':Ju[Qu]=Ku;break;case'vertexColors':!0===Ku&&(Ju.vertexColors=On),'face'===Ku&&(Ju.vertexColors=Gn);break;default:console.error('THREE.Loader.createMaterial: Unsupported',Qu,Ku);}}return'MeshBasicMaterial'===Ju.type&&delete Ju.emissive,'MeshPhongMaterial'!==Ju.type&&delete Ju.specular,1>Ju.opacity&&(Ju.transparent=!0),ku.setTextures(Zu),ku.parse(Ju)}}()}),Object.assign(_i.prototype,{crossOrigin:'anonymous',load:function(Fu,Hu,Vu,ku){var Wu=this,ju=this.path===void 0?Mu.extractUrlBase(Fu):this.path,qu=new Lo(this.manager);qu.setPath(this.path),qu.setWithCredentials(this.withCredentials),qu.load(Fu,function(Xu){var Yu=JSON.parse(Xu),Zu=Yu.metadata;if(Zu!==void 0){var Ju=Zu.type;if(Ju!==void 0&&'object'===Ju.toLowerCase())return void console.error('THREE.JSONLoader: '+Fu+' should be loaded with THREE.ObjectLoader instead.')}var Qu=Wu.parse(Yu,ju);Hu(Qu.geometry,Qu.materials)},Vu,ku)},setPath:function(Fu){return this.path=Fu,this},setResourcePath:function(Fu){return this.resourcePath=Fu,this},setCrossOrigin:function(Fu){return this.crossOrigin=Fu,this},parse:function(){function Fu(Wu,ju){function qu(wm,Lm){return wm&1<<Lm}var _m=Wu.faces,bm=Wu.vertices,Mm=Wu.normals,Sm=Wu.colors,Tm=Wu.scale,Em=0,Xu,Yu,Zu,Ju,Qu,Ku,$u,em,tm,rm,am,om,im,nm,sm,lm,pm,dm,cm,um,mm,gm,fm,hm,ym,xm,vm;if(Wu.uvs!==void 0){for(Xu=0;Xu<Wu.uvs.length;Xu++)Wu.uvs[Xu].length&&Em++;for(Xu=0;Xu<Em;Xu++)ju.faceVertexUvs[Xu]=[]}for(Ju=0,Qu=bm.length;Ju<Qu;)dm=new A,dm.x=bm[Ju++]*Tm,dm.y=bm[Ju++]*Tm,dm.z=bm[Ju++]*Tm,ju.vertices.push(dm);for(Ju=0,Qu=_m.length;Ju<Qu;)if(rm=_m[Ju++],am=qu(rm,0),om=qu(rm,1),im=qu(rm,3),nm=qu(rm,4),sm=qu(rm,5),lm=qu(rm,6),pm=qu(rm,7),am){if(um=new Z,um.a=_m[Ju],um.b=_m[Ju+1],um.c=_m[Ju+3],mm=new Z,mm.a=_m[Ju+1],mm.b=_m[Ju+2],mm.c=_m[Ju+3],Ju+=4,om&&(tm=_m[Ju++],um.materialIndex=tm,mm.materialIndex=tm),Zu=ju.faces.length,im)for(Xu=0;Xu<Em;Xu++)for(hm=Wu.uvs[Xu],ju.faceVertexUvs[Xu][Zu]=[],ju.faceVertexUvs[Xu][Zu+1]=[],Yu=0;4>Yu;Yu++)em=_m[Ju++],xm=hm[2*em],vm=hm[2*em+1],ym=new S(xm,vm),2!==Yu&&ju.faceVertexUvs[Xu][Zu].push(ym),0!==Yu&&ju.faceVertexUvs[Xu][Zu+1].push(ym);if(nm&&($u=3*_m[Ju++],um.normal.set(Mm[$u++],Mm[$u++],Mm[$u]),mm.normal.copy(um.normal)),sm)for(Xu=0;4>Xu;Xu++)$u=3*_m[Ju++],fm=new A(Mm[$u++],Mm[$u++],Mm[$u]),2!==Xu&&um.vertexNormals.push(fm),0!==Xu&&mm.vertexNormals.push(fm);if(lm&&(Ku=_m[Ju++],gm=Sm[Ku],um.color.setHex(gm),mm.color.setHex(gm)),pm)for(Xu=0;4>Xu;Xu++)Ku=_m[Ju++],gm=Sm[Ku],2!==Xu&&um.vertexColors.push(new W(gm)),0!==Xu&&mm.vertexColors.push(new W(gm));ju.faces.push(um),ju.faces.push(mm)}else{if(cm=new Z,cm.a=_m[Ju++],cm.b=_m[Ju++],cm.c=_m[Ju++],om&&(tm=_m[Ju++],cm.materialIndex=tm),Zu=ju.faces.length,im)for(Xu=0;Xu<Em;Xu++)for(hm=Wu.uvs[Xu],ju.faceVertexUvs[Xu][Zu]=[],Yu=0;3>Yu;Yu++)em=_m[Ju++],xm=hm[2*em],vm=hm[2*em+1],ym=new S(xm,vm),ju.faceVertexUvs[Xu][Zu].push(ym);if(nm&&($u=3*_m[Ju++],cm.normal.set(Mm[$u++],Mm[$u++],Mm[$u])),sm)for(Xu=0;3>Xu;Xu++)$u=3*_m[Ju++],fm=new A(Mm[$u++],Mm[$u++],Mm[$u]),cm.vertexNormals.push(fm);if(lm&&(Ku=_m[Ju++],cm.color.setHex(Sm[Ku])),pm)for(Xu=0;3>Xu;Xu++)Ku=_m[Ju++],cm.vertexColors.push(new W(Sm[Ku]));ju.faces.push(cm)}}function Hu(Wu,ju){var qu=Wu.influencesPerVertex===void 0?2:Wu.influencesPerVertex;if(Wu.skinWeights)for(var Xu=0,Yu=Wu.skinWeights.length;Xu<Yu;Xu+=qu){var Zu=Wu.skinWeights[Xu],Ju=1<qu?Wu.skinWeights[Xu+1]:0,Qu=2<qu?Wu.skinWeights[Xu+2]:0,Ku=3<qu?Wu.skinWeights[Xu+3]:0;ju.skinWeights.push(new I(Zu,Ju,Qu,Ku))}if(Wu.skinIndices)for(var Xu=0,Yu=Wu.skinIndices.length;Xu<Yu;Xu+=qu){var $u=Wu.skinIndices[Xu],em=1<qu?Wu.skinIndices[Xu+1]:0,tm=2<qu?Wu.skinIndices[Xu+2]:0,rm=3<qu?Wu.skinIndices[Xu+3]:0;ju.skinIndices.push(new I($u,em,tm,rm))}ju.bones=Wu.bones,ju.bones&&0<ju.bones.length&&(ju.skinWeights.length!==ju.skinIndices.length||ju.skinIndices.length!==ju.vertices.length)&&console.warn('When skinning, number of vertices ('+ju.vertices.length+'), skinIndices ('+ju.skinIndices.length+'), and skinWeights ('+ju.skinWeights.length+') should match.')}function Vu(Wu,ju){var qu=Wu.scale;if(Wu.morphTargets!==void 0)for(var Xu=0,Yu=Wu.morphTargets.length;Xu<Yu;Xu++){ju.morphTargets[Xu]={},ju.morphTargets[Xu].name=Wu.morphTargets[Xu].name,ju.morphTargets[Xu].vertices=[];for(var Zu=ju.morphTargets[Xu].vertices,Ju=Wu.morphTargets[Xu].vertices,Qu=0,Ku=Ju.length,$u;Qu<Ku;Qu+=3)$u=new A,$u.x=Ju[Qu]*qu,$u.y=Ju[Qu+1]*qu,$u.z=Ju[Qu+2]*qu,Zu.push($u)}if(void 0!==Wu.morphColors&&0<Wu.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var em=ju.faces,tm=Wu.morphColors[0].colors,Xu=0,Yu=em.length;Xu<Yu;Xu++)em[Xu].color.fromArray(tm,3*Xu)}}function ku(Wu,ju){var qu=[],Xu=[];Wu.animation!==void 0&&Xu.push(Wu.animation),Wu.animations!==void 0&&(Wu.animations.length?Xu=Xu.concat(Wu.animations):Xu.push(Wu.animations));for(var Yu=0,Zu;Yu<Xu.length;Yu++)Zu=So.parseAnimation(Xu[Yu],ju.bones),Zu&&qu.push(Zu);if(ju.morphTargets){var Ju=So.CreateClipsFromMorphTargetSequences(ju.morphTargets,10);qu=qu.concat(Ju)}0<qu.length&&(ju.animations=qu)}return function(ju,qu){void 0!==ju.data&&(ju=ju.data),ju.scale=void 0===ju.scale?1:1/ju.scale;var Xu=new ee;if(Fu(ju,Xu),Hu(ju,Xu),Vu(ju,Xu),ku(ju,Xu),Xu.computeFaceNormals(),Xu.computeBoundingSphere(),void 0===ju.materials||0===ju.materials.length)return{geometry:Xu};var Yu=vi.prototype.initMaterials(ju.materials,this.resourcePath||qu,this.crossOrigin);return{geometry:Xu,materials:Yu}}}()}),Object.assign(bi.prototype,{crossOrigin:'anonymous',load:function(Fu,Hu,Vu,ku){var Wu=this,ju=this.path===void 0?Mu.extractUrlBase(Fu):this.path;this.resourcePath=this.resourcePath||ju;var qu=new Lo(Wu.manager);qu.setPath(this.path),qu.load(Fu,function(Xu){var Yu=null;try{Yu=JSON.parse(Xu)}catch(Ju){return void 0!==ku&&ku(Ju),void console.error('THREE:ObjectLoader: Can\'t parse '+Fu+'.',Ju.message)}var Zu=Yu.metadata;return void 0===Zu||void 0===Zu.type||'geometry'===Zu.type.toLowerCase()?void console.error('THREE.ObjectLoader: Can\'t load '+Fu+'. Use THREE.JSONLoader instead.'):void Wu.parse(Yu,Hu)},Vu,ku)},setPath:function(Fu){return this.path=Fu,this},setResourcePath:function(Fu){return this.resourcePath=Fu,this},setCrossOrigin:function(Fu){return this.crossOrigin=Fu,this},parse:function(Fu,Hu){var Vu=this.parseShape(Fu.shapes),ku=this.parseGeometries(Fu.geometries,Vu),Wu=this.parseImages(Fu.images,function(){void 0!==Hu&&Hu(Xu)}),ju=this.parseTextures(Fu.textures,Wu),qu=this.parseMaterials(Fu.materials,ju),Xu=this.parseObject(Fu.object,ku,qu);return Fu.animations&&(Xu.animations=this.parseAnimations(Fu.animations)),(void 0===Fu.images||0===Fu.images.length)&&void 0!==Hu&&Hu(Xu),Xu},parseShape:function(Fu){var Hu={};if(Fu!==void 0)for(var Vu=0,ku=Fu.length,Wu;Vu<ku;Vu++)Wu=new oi().fromJSON(Fu[Vu]),Hu[Wu.uuid]=Wu;return Hu},parseGeometries:function(Fu,Hu){var Vu={};if(Fu!==void 0)for(var ku=new _i,Wu=new xi,ju=0,qu=Fu.length;ju<qu;ju++){var Yu=Fu[ju],Xu;switch(Yu.type){case'PlaneGeometry':case'PlaneBufferGeometry':Xu=new du[Yu.type](Yu.width,Yu.height,Yu.widthSegments,Yu.heightSegments);break;case'BoxGeometry':case'BoxBufferGeometry':case'CubeGeometry':Xu=new du[Yu.type](Yu.width,Yu.height,Yu.depth,Yu.widthSegments,Yu.heightSegments,Yu.depthSegments);break;case'CircleGeometry':case'CircleBufferGeometry':Xu=new du[Yu.type](Yu.radius,Yu.segments,Yu.thetaStart,Yu.thetaLength);break;case'CylinderGeometry':case'CylinderBufferGeometry':Xu=new du[Yu.type](Yu.radiusTop,Yu.radiusBottom,Yu.height,Yu.radialSegments,Yu.heightSegments,Yu.openEnded,Yu.thetaStart,Yu.thetaLength);break;case'ConeGeometry':case'ConeBufferGeometry':Xu=new du[Yu.type](Yu.radius,Yu.height,Yu.radialSegments,Yu.heightSegments,Yu.openEnded,Yu.thetaStart,Yu.thetaLength);break;case'SphereGeometry':case'SphereBufferGeometry':Xu=new du[Yu.type](Yu.radius,Yu.widthSegments,Yu.heightSegments,Yu.phiStart,Yu.phiLength,Yu.thetaStart,Yu.thetaLength);break;case'DodecahedronGeometry':case'DodecahedronBufferGeometry':case'IcosahedronGeometry':case'IcosahedronBufferGeometry':case'OctahedronGeometry':case'OctahedronBufferGeometry':case'TetrahedronGeometry':case'TetrahedronBufferGeometry':Xu=new du[Yu.type](Yu.radius,Yu.detail);break;case'RingGeometry':case'RingBufferGeometry':Xu=new du[Yu.type](Yu.innerRadius,Yu.outerRadius,Yu.thetaSegments,Yu.phiSegments,Yu.thetaStart,Yu.thetaLength);break;case'TorusGeometry':case'TorusBufferGeometry':Xu=new du[Yu.type](Yu.radius,Yu.tube,Yu.radialSegments,Yu.tubularSegments,Yu.arc);break;case'TorusKnotGeometry':case'TorusKnotBufferGeometry':Xu=new du[Yu.type](Yu.radius,Yu.tube,Yu.tubularSegments,Yu.radialSegments,Yu.p,Yu.q);break;case'LatheGeometry':case'LatheBufferGeometry':Xu=new du[Yu.type](Yu.points,Yu.segments,Yu.phiStart,Yu.phiLength);break;case'PolyhedronGeometry':case'PolyhedronBufferGeometry':Xu=new du[Yu.type](Yu.vertices,Yu.indices,Yu.radius,Yu.details);break;case'ShapeGeometry':case'ShapeBufferGeometry':for(var Zu=[],Ju=0,Qu=Yu.shapes.length,Ku;Ju<Qu;Ju++)Ku=Hu[Yu.shapes[Ju]],Zu.push(Ku);Xu=new du[Yu.type](Zu,Yu.curveSegments);break;case'ExtrudeGeometry':case'ExtrudeBufferGeometry':for(var Zu=[],Ju=0,Qu=Yu.shapes.length,Ku;Ju<Qu;Ju++)Ku=Hu[Yu.shapes[Ju]],Zu.push(Ku);var $u=Yu.options.extrudePath;void 0!==$u&&(Yu.options.extrudePath=new bu[$u.type]().fromJSON($u)),Xu=new du[Yu.type](Zu,Yu.options);break;case'BufferGeometry':Xu=Wu.parse(Yu);break;case'Geometry':Xu=ku.parse(Yu,this.resourcePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Yu.type+'"');continue;}Xu.uuid=Yu.uuid,void 0!==Yu.name&&(Xu.name=Yu.name),!0===Xu.isBufferGeometry&&void 0!==Yu.userData&&(Xu.userData=Yu.userData),Vu[Yu.uuid]=Xu}return Vu},parseMaterials:function(Fu,Hu){var Vu={},ku={};if(Fu!==void 0){var Wu=new yi;Wu.setTextures(Hu);for(var ju=0,qu=Fu.length,Xu;ju<qu;ju++)if(Xu=Fu[ju],'MultiMaterial'===Xu.type){for(var Yu=[],Zu=0,Ju;Zu<Xu.materials.length;Zu++)Ju=Xu.materials[Zu],void 0===Vu[Ju.uuid]&&(Vu[Ju.uuid]=Wu.parse(Ju)),Yu.push(Vu[Ju.uuid]);ku[Xu.uuid]=Yu}else ku[Xu.uuid]=Wu.parse(Xu),Vu[Xu.uuid]=ku[Xu.uuid]}return ku},parseAnimations:function(Fu){for(var Hu=[],Vu=0;Vu<Fu.length;Vu++){var ku=Fu[Vu],Wu=So.parse(ku);ku.uuid!==void 0&&(Wu.uuid=ku.uuid),Hu.push(Wu)}return Hu},parseImages:function(Fu,Hu){function Vu(tm){return ku.manager.itemStart(tm),qu.load(tm,function(){ku.manager.itemEnd(tm)},void 0,function(){ku.manager.itemError(tm),ku.manager.itemEnd(tm)})}var ku=this,Wu={};if(Fu!==void 0&&0<Fu.length){var ju=new wo(Hu),qu=new Ro(ju);qu.setCrossOrigin(this.crossOrigin);for(var Xu=0,Yu=Fu.length;Xu<Yu;Xu++){var Zu=Fu[Xu],Ju=Zu.url;if(Array.isArray(Ju)){Wu[Zu.uuid]=[];for(var Qu=0,Ku=Ju.length;Qu<Ku;Qu++){var $u=Ju[Qu],em=/^(\/\/)|([a-z]+:(\/\/)?)/i.test($u)?$u:ku.resourcePath+$u;Wu[Zu.uuid].push(Vu(em))}}else{var em=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Zu.url)?Zu.url:ku.resourcePath+Zu.url;Wu[Zu.uuid]=Vu(em)}}}return Wu},parseTextures:function(Fu,Hu){function Vu(Yu,Zu){return'number'==typeof Yu?Yu:(console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.',Yu),Zu[Yu])}var ku={};if(Fu!==void 0)for(var Wu=0,ju=Fu.length,qu;Wu<ju;Wu++){qu=Fu[Wu],void 0===qu.image&&console.warn('THREE.ObjectLoader: No "image" specified for',qu.uuid),void 0===Hu[qu.image]&&console.warn('THREE.ObjectLoader: Undefined image',qu.image);var Xu;Xu=Array.isArray(Hu[qu.image])?new He(Hu[qu.image]):new R(Hu[qu.image]),Xu.needsUpdate=!0,Xu.uuid=qu.uuid,void 0!==qu.name&&(Xu.name=qu.name),void 0!==qu.mapping&&(Xu.mapping=Vu(qu.mapping,Tu)),void 0!==qu.offset&&Xu.offset.fromArray(qu.offset),void 0!==qu.repeat&&Xu.repeat.fromArray(qu.repeat),void 0!==qu.center&&Xu.center.fromArray(qu.center),void 0!==qu.rotation&&(Xu.rotation=qu.rotation),void 0!==qu.wrap&&(Xu.wrapS=Vu(qu.wrap[0],Eu),Xu.wrapT=Vu(qu.wrap[1],Eu)),void 0!==qu.format&&(Xu.format=qu.format),void 0!==qu.minFilter&&(Xu.minFilter=Vu(qu.minFilter,wu)),void 0!==qu.magFilter&&(Xu.magFilter=Vu(qu.magFilter,wu)),void 0!==qu.anisotropy&&(Xu.anisotropy=qu.anisotropy),void 0!==qu.flipY&&(Xu.flipY=qu.flipY),ku[qu.uuid]=Xu}return ku},parseObject:function(Fu,Hu,Vu){function ku(em){return void 0===Hu[em]&&console.warn('THREE.ObjectLoader: Undefined geometry',em),Hu[em]}function Wu(em){if(void 0!==em){if(Array.isArray(em)){for(var tm=[],rm=0,am=em.length,om;rm<am;rm++)om=em[rm],void 0===Vu[om]&&console.warn('THREE.ObjectLoader: Undefined material',om),tm.push(Vu[om]);return tm}return void 0===Vu[em]&&console.warn('THREE.ObjectLoader: Undefined material',em),Vu[em]}}var ju;switch(Fu.type){case'Scene':ju=new gr,void 0!==Fu.background&&Number.isInteger(Fu.background)&&(ju.background=new W(Fu.background)),void 0!==Fu.fog&&('Fog'===Fu.fog.type?ju.fog=new mr(Fu.fog.color,Fu.fog.near,Fu.fog.far):'FogExp2'===Fu.fog.type&&(ju.fog=new ur(Fu.fog.color,Fu.fog.density)));break;case'PerspectiveCamera':ju=new nr(Fu.fov,Fu.aspect,Fu.near,Fu.far),void 0!==Fu.focus&&(ju.focus=Fu.focus),void 0!==Fu.zoom&&(ju.zoom=Fu.zoom),void 0!==Fu.filmGauge&&(ju.filmGauge=Fu.filmGauge),void 0!==Fu.filmOffset&&(ju.filmOffset=Fu.filmOffset),void 0!==Fu.view&&(ju.view=Object.assign({},Fu.view));break;case'OrthographicCamera':ju=new ci(Fu.left,Fu.right,Fu.top,Fu.bottom,Fu.near,Fu.far),void 0!==Fu.zoom&&(ju.zoom=Fu.zoom),void 0!==Fu.view&&(ju.view=Object.assign({},Fu.view));break;case'AmbientLight':ju=new gi(Fu.color,Fu.intensity);break;case'DirectionalLight':ju=new mi(Fu.color,Fu.intensity);break;case'PointLight':ju=new di(Fu.color,Fu.intensity,Fu.distance,Fu.decay);break;case'RectAreaLight':ju=new hi(Fu.color,Fu.intensity,Fu.width,Fu.height);break;case'SpotLight':ju=new pi(Fu.color,Fu.intensity,Fu.distance,Fu.angle,Fu.penumbra,Fu.decay);break;case'HemisphereLight':ju=new ni(Fu.color,Fu.groundColor,Fu.intensity);break;case'SkinnedMesh':console.warn('THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.');case'Mesh':var qu=ku(Fu.geometry),Xu=Wu(Fu.material);ju=qu.bones&&0<qu.bones.length?new Sr(qu,Xu):new Pe(qu,Xu);break;case'LOD':ju=new _r;break;case'Line':ju=new Er(ku(Fu.geometry),Wu(Fu.material),Fu.mode);break;case'LineLoop':ju=new Lr(ku(Fu.geometry),Wu(Fu.material));break;case'LineSegments':ju=new wr(ku(Fu.geometry),Wu(Fu.material));break;case'PointCloud':case'Points':ju=new Pr(ku(Fu.geometry),Wu(Fu.material));break;case'Sprite':ju=new xr(Wu(Fu.material));break;case'Group':ju=new or;break;default:ju=new K;}if(ju.uuid=Fu.uuid,void 0!==Fu.name&&(ju.name=Fu.name),void 0===Fu.matrix?(void 0!==Fu.position&&ju.position.fromArray(Fu.position),void 0!==Fu.rotation&&ju.rotation.fromArray(Fu.rotation),void 0!==Fu.quaternion&&ju.quaternion.fromArray(Fu.quaternion),void 0!==Fu.scale&&ju.scale.fromArray(Fu.scale)):(ju.matrix.fromArray(Fu.matrix),void 0!==Fu.matrixAutoUpdate&&(ju.matrixAutoUpdate=Fu.matrixAutoUpdate),ju.matrixAutoUpdate&&ju.matrix.decompose(ju.position,ju.quaternion,ju.scale)),void 0!==Fu.castShadow&&(ju.castShadow=Fu.castShadow),void 0!==Fu.receiveShadow&&(ju.receiveShadow=Fu.receiveShadow),Fu.shadow&&(void 0!==Fu.shadow.bias&&(ju.shadow.bias=Fu.shadow.bias),void 0!==Fu.shadow.radius&&(ju.shadow.radius=Fu.shadow.radius),void 0!==Fu.shadow.mapSize&&ju.shadow.mapSize.fromArray(Fu.shadow.mapSize),void 0!==Fu.shadow.camera&&(ju.shadow.camera=this.parseObject(Fu.shadow.camera))),void 0!==Fu.visible&&(ju.visible=Fu.visible),void 0!==Fu.frustumCulled&&(ju.frustumCulled=Fu.frustumCulled),void 0!==Fu.renderOrder&&(ju.renderOrder=Fu.renderOrder),void 0!==Fu.userData&&(ju.userData=Fu.userData),void 0!==Fu.layers&&(ju.layers.mask=Fu.layers),void 0!==Fu.children)for(var Yu=Fu.children,Zu=0;Zu<Yu.length;Zu++)ju.add(this.parseObject(Yu[Zu],Hu,Vu));if('LOD'===Fu.type)for(var Ju=Fu.levels,Qu=0;Qu<Ju.length;Qu++){var Ku=Ju[Qu],$u=ju.getObjectByProperty('uuid',Ku.object);void 0!==$u&&ju.addLevel($u,Ku.distance)}return ju}});var Tu={UVMapping:ws,CubeReflectionMapping:Ls,CubeRefractionMapping:As,EquirectangularReflectionMapping:Ps,EquirectangularRefractionMapping:Cs,SphericalReflectionMapping:Rs,CubeUVReflectionMapping:Is,CubeUVRefractionMapping:Ds},Eu={RepeatWrapping:zs,ClampToEdgeWrapping:Ns,MirroredRepeatWrapping:Bs},wu={NearestFilter:Us,NearestMipMapNearestFilter:Gs,NearestMipMapLinearFilter:Os,LinearFilter:Fs,LinearMipMapNearestFilter:Hs,LinearMipMapLinearFilter:Vs};Object.assign(Mi.prototype,{moveTo:function(Fu,Hu){this.currentPath=new ai,this.subPaths.push(this.currentPath),this.currentPath.moveTo(Fu,Hu)},lineTo:function(Fu,Hu){this.currentPath.lineTo(Fu,Hu)},quadraticCurveTo:function(Fu,Hu,Vu,ku){this.currentPath.quadraticCurveTo(Fu,Hu,Vu,ku)},bezierCurveTo:function(Fu,Hu,Vu,ku,Wu,ju){this.currentPath.bezierCurveTo(Fu,Hu,Vu,ku,Wu,ju)},splineThru:function(Fu){this.currentPath.splineThru(Fu)},toShapes:function(Fu,Hu){function Vu(ym){for(var xm=[],vm=0,_m=ym.length;vm<_m;vm++){var bm=ym[vm],Mm=new oi;Mm.curves=bm.curves,xm.push(Mm)}return xm}function ku(ym,xm){for(var vm=xm.length,_m=!1,bm=vm-1,Mm=0;Mm<vm;bm=Mm++){var Sm=xm[bm],Tm=xm[Mm],Em=Tm.x-Sm.x,wm=Tm.y-Sm.y;if(Math.abs(wm)>Number.EPSILON){if(0>wm&&(Sm=xm[Mm],Em=-Em,Tm=xm[bm],wm=-wm),ym.y<Sm.y||ym.y>Tm.y)continue;if(ym.y!==Sm.y){var Lm=wm*(ym.x-Sm.x)-Em*(ym.y-Sm.y);if(0==Lm)return!0;if(0>Lm)continue;_m=!_m}else if(ym.x===Sm.x)return!0}else{if(ym.y!==Sm.y)continue;if(Tm.x<=ym.x&&ym.x<=Sm.x||Sm.x<=ym.x&&ym.x<=Tm.x)return!0}}return _m}var Wu=nu.isClockWise,ju=this.subPaths;if(0===ju.length)return[];if(!0===Hu)return Vu(ju);var Zu=[],qu,Xu,Yu;if(1===ju.length)return Xu=ju[0],Yu=new oi,Yu.curves=Xu.curves,Zu.push(Yu),Zu;var Ju=!Wu(ju[0].getPoints());Ju=Fu?!Ju:Ju;var Qu=[],Ku=[],$u=[],em=0,tm;Ku[em]=void 0,$u[em]=[];for(var rm=0,am=ju.length;rm<am;rm++)Xu=ju[rm],tm=Xu.getPoints(),qu=Wu(tm),qu=Fu?!qu:qu,qu?(!Ju&&Ku[em]&&em++,Ku[em]={s:new oi,p:tm},Ku[em].s.curves=Xu.curves,Ju&&em++,$u[em]=[]):$u[em].push({h:Xu,p:tm[0]});if(!Ku[0])return Vu(ju);if(1<Ku.length){for(var om=!1,im=[],nm=0,sm=Ku.length;nm<sm;nm++)Qu[nm]=[];for(var nm=0,sm=Ku.length,lm;nm<sm;nm++){lm=$u[nm];for(var pm=0;pm<lm.length;pm++){for(var dm=lm[pm],cm=!0,um=0;um<Ku.length;um++)ku(dm.p,Ku[um].p)&&(nm!==um&&im.push({froms:nm,tos:um,hole:pm}),cm?(cm=!1,Qu[um].push(dm)):om=!0);cm&&Qu[nm].push(dm)}}0<im.length&&!om&&($u=Qu)}for(var rm=0,gm=Ku.length,mm;rm<gm;rm++){Yu=Ku[rm].s,Zu.push(Yu),mm=$u[rm];for(var fm=0,hm=mm.length;fm<hm;fm++)Yu.holes.push(mm[fm].h)}return Zu}}),Object.assign(Si.prototype,{isFont:!0,generateShapes:function(Fu,Hu){Hu===void 0&&(Hu=100);for(var Vu=[],ku=Ti(Fu,Hu,this.data),Wu=0,ju=ku.length;Wu<ju;Wu++)Array.prototype.push.apply(Vu,ku[Wu].toShapes());return Vu}}),Object.assign(function(Fu){this.manager=Fu===void 0?fu:Fu}.prototype,{load:function(Fu,Hu,Vu,ku){var Wu=this,ju=new Lo(this.manager);ju.setPath(this.path),ju.load(Fu,function(qu){var Xu;try{Xu=JSON.parse(qu)}catch(Zu){console.warn('THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.'),Xu=JSON.parse(qu.substring(65,qu.length-2))}var Yu=Wu.parse(Xu);Hu&&Hu(Yu)},Vu,ku)},parse:function(Fu){return new Si(Fu)},setPath:function(Fu){return this.path=Fu,this}});var Lu,Au={getContext:function(){return void 0==Lu&&(Lu=new(window.AudioContext||window.webkitAudioContext)),Lu},setContext:function(Fu){Lu=Fu}};Object.assign(Li.prototype,{load:function(Fu,Hu,Vu,ku){var Wu=new Lo(this.manager);Wu.setResponseType('arraybuffer'),Wu.setPath(this.path),Wu.load(Fu,function(ju){var qu=ju.slice(0),Xu=Au.getContext();Xu.decodeAudioData(qu,function(Yu){Hu(Yu)})},Vu,ku)},setPath:function(Fu){return this.path=Fu,this}}),Object.assign(function(){this.type='StereoCamera',this.aspect=1,this.eyeSep=0.064,this.cameraL=new nr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new nr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}.prototype,{update:function(){var Fu,Hu,Vu,ku,Wu,ju,qu,Xu,Yu=new E,Zu=new E;return function(Qu){var Ku=Fu!==this||Hu!==Qu.focus||Vu!==Qu.fov||ku!==Qu.aspect*this.aspect||Wu!==Qu.near||ju!==Qu.far||qu!==Qu.zoom||Xu!==this.eyeSep;if(Ku){Fu=this,Hu=Qu.focus,Vu=Qu.fov,ku=Qu.aspect*this.aspect,Wu=Qu.near,ju=Qu.far,qu=Qu.zoom;var $u=Qu.projectionMatrix.clone();Xu=this.eyeSep/2;var em=Xu*Wu/Hu,tm=Wu*Math.tan(0.5*(fp.DEG2RAD*Vu))/qu,rm,am;Zu.elements[12]=-Xu,Yu.elements[12]=Xu,rm=-tm*ku+em,am=tm*ku+em,$u.elements[0]=2*Wu/(am-rm),$u.elements[8]=(am+rm)/(am-rm),this.cameraL.projectionMatrix.copy($u),rm=-tm*ku-em,am=tm*ku-em,$u.elements[0]=2*Wu/(am-rm),$u.elements[8]=(am+rm)/(am-rm),this.cameraR.projectionMatrix.copy($u)}this.cameraL.matrixWorld.copy(Qu.matrixWorld).multiply(Zu),this.cameraR.matrixWorld.copy(Qu.matrixWorld).multiply(Yu)}}()}),Pi.prototype=Object.create(K.prototype),Pi.prototype.constructor=Pi,Object.assign(Ci.prototype,{start:function(){this.startTime=('undefined'==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var Fu=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var Hu=('undefined'==typeof performance?Date:performance).now();Fu=(Hu-this.oldTime)/1e3,this.oldTime=Hu,this.elapsedTime+=Fu}return Fu}}),Ri.prototype=Object.assign(Object.create(K.prototype),{constructor:Ri,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(Fu){return null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=Fu,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(Fu){return this.gain.gain.setTargetAtTime(Fu,this.context.currentTime,0.01),this},updateMatrixWorld:function(){var Fu=new A,Hu=new L,Vu=new A,ku=new A,Wu=new Ci;return function(qu){K.prototype.updateMatrixWorld.call(this,qu);var Xu=this.context.listener,Yu=this.up;if(this.timeDelta=Wu.getDelta(),this.matrixWorld.decompose(Fu,Hu,Vu),ku.set(0,0,-1).applyQuaternion(Hu),Xu.positionX){var Zu=this.context.currentTime+this.timeDelta;Xu.positionX.linearRampToValueAtTime(Fu.x,Zu),Xu.positionY.linearRampToValueAtTime(Fu.y,Zu),Xu.positionZ.linearRampToValueAtTime(Fu.z,Zu),Xu.forwardX.linearRampToValueAtTime(ku.x,Zu),Xu.forwardY.linearRampToValueAtTime(ku.y,Zu),Xu.forwardZ.linearRampToValueAtTime(ku.z,Zu),Xu.upX.linearRampToValueAtTime(Yu.x,Zu),Xu.upY.linearRampToValueAtTime(Yu.y,Zu),Xu.upZ.linearRampToValueAtTime(Yu.z,Zu)}else Xu.setPosition(Fu.x,Fu.y,Fu.z),Xu.setOrientation(ku.x,ku.y,ku.z,Yu.x,Yu.y,Yu.z)}}()}),Ii.prototype=Object.assign(Object.create(K.prototype),{constructor:Ii,getOutput:function(){return this.gain},setNodeSource:function(Fu){return this.hasPlaybackControl=!1,this.sourceType='audioNode',this.source=Fu,this.connect(),this},setMediaElementSource:function(Fu){return this.hasPlaybackControl=!1,this.sourceType='mediaNode',this.source=this.context.createMediaElementSource(Fu),this.connect(),this},setBuffer:function(Fu){return this.buffer=Fu,this.sourceType='buffer',this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var Fu=this.context.createBufferSource();return Fu.buffer=this.buffer,Fu.loop=this.loop,Fu.onended=this.onEnded.bind(this),Fu.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,Fu.start(this.startTime,this.offset),this.isPlaying=!0,this.source=Fu,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var Fu=1,Hu=this.filters.length;Fu<Hu;Fu++)this.filters[Fu-1].connect(this.filters[Fu]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var Fu=1,Hu=this.filters.length;Fu<Hu;Fu++)this.filters[Fu-1].disconnect(this.filters[Fu]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(Fu){return Fu||(Fu=[]),!0===this.isPlaying?(this.disconnect(),this.filters=Fu,this.connect()):this.filters=Fu,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(Fu){return this.setFilters(Fu?[Fu]:[])},setPlaybackRate:function(Fu){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.playbackRate=Fu,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn('THREE.Audio: this Audio has no playback control.'),!1):this.loop},setLoop:function(Fu){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.loop=Fu,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(Fu){return this.gain.gain.setTargetAtTime(Fu,this.context.currentTime,0.01),this}}),Di.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Di,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(Fu){return this.panner.refDistance=Fu,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(Fu){return this.panner.rolloffFactor=Fu,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(Fu){return this.panner.distanceModel=Fu,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(Fu){return this.panner.maxDistance=Fu,this},setDirectionalCone:function(Fu,Hu,Vu){return this.panner.coneInnerAngle=Fu,this.panner.coneOuterAngle=Hu,this.panner.coneOuterGain=Vu,this},updateMatrixWorld:function(){var Fu=new A,Hu=new L,Vu=new A,ku=new A;return function(ju){K.prototype.updateMatrixWorld.call(this,ju);var qu=this.panner;if(this.matrixWorld.decompose(Fu,Hu,Vu),ku.set(0,0,1).applyQuaternion(Hu),qu.positionX){var Xu=this.context.currentTime+this.listener.timeDelta;qu.positionX.linearRampToValueAtTime(Fu.x,Xu),qu.positionY.linearRampToValueAtTime(Fu.y,Xu),qu.positionZ.linearRampToValueAtTime(Fu.z,Xu),qu.orientationX.linearRampToValueAtTime(ku.x,Xu),qu.orientationY.linearRampToValueAtTime(ku.y,Xu),qu.orientationZ.linearRampToValueAtTime(ku.z,Xu)}else qu.setPosition(Fu.x,Fu.y,Fu.z),qu.setOrientation(ku.x,ku.y,ku.z)}}()}),Object.assign(zi.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var Fu=0,Hu=this.getFrequencyData(),Vu=0;Vu<Hu.length;Vu++)Fu+=Hu[Vu];return Fu/Hu.length}}),Object.assign(Ni.prototype,{accumulate:function(Fu,Hu){var Vu=this.buffer,ku=this.valueSize,Wu=Fu*ku+ku,ju=this.cumulativeWeight;if(0===ju){for(var qu=0;qu!==ku;++qu)Vu[Wu+qu]=Vu[qu];ju=Hu}else{ju+=Hu;var Xu=Hu/ju;this._mixBufferRegion(Vu,Wu,0,Xu,ku)}this.cumulativeWeight=ju},apply:function(Fu){var Hu=this.valueSize,Vu=this.buffer,ku=Fu*Hu+Hu,Wu=this.cumulativeWeight,ju=this.binding;if(this.cumulativeWeight=0,1>Wu){this._mixBufferRegion(Vu,ku,3*Hu,1-Wu,Hu)}for(var Xu=Hu;Xu!==Hu+Hu;++Xu)if(Vu[Xu]!==Vu[Xu+Hu]){ju.setValue(Vu,ku);break}},saveOriginalState:function(){var Fu=this.binding,Hu=this.buffer,Vu=this.valueSize,ku=3*Vu;Fu.getValue(Hu,ku);for(var Wu=Vu;Wu!==ku;++Wu)Hu[Wu]=Hu[ku+Wu%Vu];this.cumulativeWeight=0},restoreOriginalState:function(){var Fu=3*this.valueSize;this.binding.setValue(this.buffer,Fu)},_select:function(Fu,Hu,Vu,ku,Wu){if(0.5<=ku)for(var ju=0;ju!==Wu;++ju)Fu[Hu+ju]=Fu[Vu+ju]},_slerp:function(Fu,Hu,Vu,ku){L.slerpFlat(Fu,Hu,Fu,Hu,Fu,Vu,ku)},_lerp:function(Fu,Hu,Vu,ku,Wu){for(var qu=0,Xu;qu!==Wu;++qu)Xu=Hu+qu,Fu[Xu]=Fu[Xu]*(1-ku)+Fu[Vu+qu]*ku}});var Pu='\\[\\]\\.:\\/';Object.assign(Bi.prototype,{getValue:function(Fu,Hu){this.bind();var Vu=this._targetGroup.nCachedObjects_,ku=this._bindings[Vu];ku!==void 0&&ku.getValue(Fu,Hu)},setValue:function(Fu,Hu){for(var Vu=this._bindings,ku=this._targetGroup.nCachedObjects_,Wu=Vu.length;ku!==Wu;++ku)Vu[ku].setValue(Fu,Hu)},bind:function(){for(var Fu=this._bindings,Hu=this._targetGroup.nCachedObjects_,Vu=Fu.length;Hu!==Vu;++Hu)Fu[Hu].bind()},unbind:function(){for(var Fu=this._bindings,Hu=this._targetGroup.nCachedObjects_,Vu=Fu.length;Hu!==Vu;++Hu)Fu[Hu].unbind()}}),Object.assign(Ui,{Composite:Bi,create:function(Fu,Hu,Vu){return Fu&&Fu.isAnimationObjectGroup?new Ui.Composite(Fu,Hu,Vu):new Ui(Fu,Hu,Vu)},sanitizeNodeName:function(){var Fu=/[\[\]\.:\/]/g;return function(Vu){return Vu.replace(/\s/g,'_').replace(Fu,'')}}(),parseTrackName:function(){var Fu='[^'+Pu+']',Hu='[^'+Pu.replace('\\.','')+']',Vu=/((?:WC+[\/:])*)/.source.replace('WC',Fu),ku=/(WCOD+)?/.source.replace('WCOD',Hu),Wu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace('WC',Fu),ju=/\.(WC+)(?:\[(.+)\])?/.source.replace('WC',Fu),qu=new RegExp('^'+Vu+ku+Wu+ju+'$'),Xu=['material','materials','bones'];return function(Zu){var Ju=qu.exec(Zu);if(!Ju)throw new Error('PropertyBinding: Cannot parse trackName: '+Zu);var Qu={nodeName:Ju[2],objectName:Ju[3],objectIndex:Ju[4],propertyName:Ju[5],propertyIndex:Ju[6]},Ku=Qu.nodeName&&Qu.nodeName.lastIndexOf('.');if(Ku!==void 0&&-1!==Ku){var $u=Qu.nodeName.substring(Ku+1);-1!==Xu.indexOf($u)&&(Qu.nodeName=Qu.nodeName.substring(0,Ku),Qu.objectName=$u)}if(null===Qu.propertyName||0===Qu.propertyName.length)throw new Error('PropertyBinding: can not parse propertyName from trackName: '+Zu);return Qu}}(),findNode:function(Fu,Hu){if(!Hu||''===Hu||'root'===Hu||'.'===Hu||-1===Hu||Hu===Fu.name||Hu===Fu.uuid)return Fu;if(Fu.skeleton){var Vu=Fu.skeleton.getBoneByName(Hu);if(void 0!==Vu)return Vu}if(Fu.children){var ku=function(ju){for(var qu=0,Xu;qu<ju.length;qu++){if(Xu=ju[qu],Xu.name===Hu||Xu.uuid===Hu)return Xu;var Yu=ku(Xu.children);if(Yu)return Yu}return null},Wu=ku(Fu.children);if(Wu)return Wu}return null}}),Object.assign(Ui.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(Hu,Vu){Hu[Vu]=this.node[this.propertyName]},function(Hu,Vu){for(var ku=this.resolvedProperty,Wu=0,ju=ku.length;Wu!==ju;++Wu)Hu[Vu++]=ku[Wu]},function(Hu,Vu){Hu[Vu]=this.resolvedProperty[this.propertyIndex]},function(Hu,Vu){this.resolvedProperty.toArray(Hu,Vu)}],SetterByBindingTypeAndVersioning:[[function(Hu,Vu){this.targetObject[this.propertyName]=Hu[Vu]},function(Hu,Vu){this.targetObject[this.propertyName]=Hu[Vu],this.targetObject.needsUpdate=!0},function(Hu,Vu){this.targetObject[this.propertyName]=Hu[Vu],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Hu,Vu){for(var ku=this.resolvedProperty,Wu=0,ju=ku.length;Wu!==ju;++Wu)ku[Wu]=Hu[Vu++]},function(Hu,Vu){for(var ku=this.resolvedProperty,Wu=0,ju=ku.length;Wu!==ju;++Wu)ku[Wu]=Hu[Vu++];this.targetObject.needsUpdate=!0},function(Hu,Vu){for(var ku=this.resolvedProperty,Wu=0,ju=ku.length;Wu!==ju;++Wu)ku[Wu]=Hu[Vu++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Hu,Vu){this.resolvedProperty[this.propertyIndex]=Hu[Vu]},function(Hu,Vu){this.resolvedProperty[this.propertyIndex]=Hu[Vu],this.targetObject.needsUpdate=!0},function(Hu,Vu){this.resolvedProperty[this.propertyIndex]=Hu[Vu],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Hu,Vu){this.resolvedProperty.fromArray(Hu,Vu)},function(Hu,Vu){this.resolvedProperty.fromArray(Hu,Vu),this.targetObject.needsUpdate=!0},function(Hu,Vu){this.resolvedProperty.fromArray(Hu,Vu),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(Hu,Vu){this.bind(),this.getValue(Hu,Vu)},setValue:function(Hu,Vu){this.bind(),this.setValue(Hu,Vu)},bind:function(){var Fu=this.node,Hu=this.parsedPath,Vu=Hu.objectName,ku=Hu.propertyName,Wu=Hu.propertyIndex;if(Fu||(Fu=Ui.findNode(this.rootNode,Hu.nodeName)||this.rootNode,this.node=Fu),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!Fu)return void console.error('THREE.PropertyBinding: Trying to update node for track: '+this.path+' but it wasn\'t found.');if(Vu){var ju=Hu.objectIndex;switch(Vu){case'materials':if(!Fu.material)return void console.error('THREE.PropertyBinding: Can not bind to material as node does not have a material.',this);if(!Fu.material.materials)return void console.error('THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.',this);Fu=Fu.material.materials;break;case'bones':if(!Fu.skeleton)return void console.error('THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.',this);Fu=Fu.skeleton.bones;for(var qu=0;qu<Fu.length;qu++)if(Fu[qu].name===ju){ju=qu;break}break;default:if(void 0===Fu[Vu])return void console.error('THREE.PropertyBinding: Can not bind to objectName of node undefined.',this);Fu=Fu[Vu];}if(void 0!==ju){if(void 0===Fu[ju])return void console.error('THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.',this,Fu);Fu=Fu[ju]}}var Xu=Fu[ku];if(void 0===Xu){var Yu=Hu.nodeName;return void console.error('THREE.PropertyBinding: Trying to update property for track: '+Yu+'.'+ku+' but it wasn\'t found.',Fu)}var Zu=this.Versioning.None;this.targetObject=Fu,void 0===Fu.needsUpdate?void 0!==Fu.matrixWorldNeedsUpdate&&(Zu=this.Versioning.MatrixWorldNeedsUpdate):Zu=this.Versioning.NeedsUpdate;var Ju=this.BindingType.Direct;if(void 0!==Wu){if('morphTargetInfluences'===ku){if(!Fu.geometry)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.',this);if(Fu.geometry.isBufferGeometry){if(!Fu.geometry.morphAttributes)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.',this);for(var qu=0;qu<this.node.geometry.morphAttributes.position.length;qu++)if(Fu.geometry.morphAttributes.position[qu].name===Wu){Wu=qu;break}}else{if(!Fu.geometry.morphTargets)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.',this);for(var qu=0;qu<this.node.geometry.morphTargets.length;qu++)if(Fu.geometry.morphTargets[qu].name===Wu){Wu=qu;break}}}Ju=this.BindingType.ArrayElement,this.resolvedProperty=Xu,this.propertyIndex=Wu}else void 0!==Xu.fromArray&&void 0!==Xu.toArray?(Ju=this.BindingType.HasFromToArray,this.resolvedProperty=Xu):Array.isArray(Xu)?(Ju=this.BindingType.EntireArray,this.resolvedProperty=Xu):this.propertyName=ku;this.getValue=this.GetterByBindingType[Ju],this.setValue=this.SetterByBindingTypeAndVersioning[Ju][Zu]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ui.prototype,{_getValue_unbound:Ui.prototype.getValue,_setValue_unbound:Ui.prototype.setValue}),Object.assign(function(){this.uuid=fp.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var Fu={};this._indicesByUUID=Fu;for(var Hu=0,Vu=arguments.length;Hu!==Vu;++Hu)Fu[arguments[Hu].uuid]=Hu;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var ku=this;this.stats={objects:{get total(){return ku._objects.length},get inUse(){return this.total-ku.nCachedObjects_}},get bindingsPerObject(){return ku._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var Fu=this._objects,Hu=Fu.length,Vu=this.nCachedObjects_,ku=this._indicesByUUID,Wu=this._paths,ju=this._parsedPaths,qu=this._bindings,Xu=qu.length,Yu=void 0,Zu=0,Ju=arguments.length;Zu!==Ju;++Zu){var Qu=arguments[Zu],Ku=Qu.uuid,$u=ku[Ku];if($u===void 0){$u=Hu++,ku[Ku]=$u,Fu.push(Qu);for(var em=0,tm=Xu;em!==tm;++em)qu[em].push(new Ui(Qu,Wu[em],ju[em]))}else if($u<Vu){Yu=Fu[$u];var rm=--Vu,am=Fu[rm];ku[am.uuid]=$u,Fu[$u]=am,ku[Ku]=rm,Fu[rm]=Qu;for(var em=0,tm=Xu;em!==tm;++em){var om=qu[em],im=om[rm],nm=om[$u];om[$u]=im,nm===void 0&&(nm=new Ui(Qu,Wu[em],ju[em])),om[rm]=nm}}else Fu[$u]!==Yu&&console.error('THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.')}this.nCachedObjects_=Vu},remove:function(){for(var Fu=this._objects,Hu=this.nCachedObjects_,Vu=this._indicesByUUID,ku=this._bindings,Wu=ku.length,ju=0,qu=arguments.length;ju!==qu;++ju){var Xu=arguments[ju],Yu=Xu.uuid,Zu=Vu[Yu];if(Zu!==void 0&&Zu>=Hu){var Ju=Hu++,Qu=Fu[Ju];Vu[Qu.uuid]=Zu,Fu[Zu]=Qu,Vu[Yu]=Ju,Fu[Ju]=Xu;for(var Ku=0;Ku!==Wu;++Ku){var em=ku[Ku],tm=em[Ju],rm=em[Zu];em[Zu]=tm,em[Ju]=rm}}}this.nCachedObjects_=Hu},uncache:function(){for(var Fu=this._objects,Hu=Fu.length,Vu=this.nCachedObjects_,ku=this._indicesByUUID,Wu=this._bindings,ju=Wu.length,qu=0,Xu=arguments.length;qu!==Xu;++qu){var Yu=arguments[qu],Zu=Yu.uuid,Ju=ku[Zu];if(void 0!==Ju)if(delete ku[Zu],Ju<Vu){var Qu=--Vu,Ku=Fu[Qu],$u=--Hu,em=Fu[$u];ku[Ku.uuid]=Ju,Fu[Ju]=Ku,ku[em.uuid]=Qu,Fu[Qu]=em,Fu.pop();for(var tm=0,rm=ju;tm!==rm;++tm){var am=Wu[tm],om=am[Qu],im=am[$u];am[Ju]=om,am[Qu]=im,am.pop()}}else{var $u=--Hu,em=Fu[$u];ku[em.uuid]=Ju,Fu[Ju]=em,Fu.pop();for(var tm=0,rm=ju,am;tm!==rm;++tm)am=Wu[tm],am[Ju]=am[$u],am.pop()}}this.nCachedObjects_=Vu},subscribe_:function(Fu,Hu){var Vu=this._bindingsIndicesByPath,ku=Vu[Fu],Wu=this._bindings;if(ku!==void 0)return Wu[ku];var ju=this._paths,qu=this._parsedPaths,Xu=this._objects,Yu=Xu.length,Zu=this.nCachedObjects_,Ju=Array(Yu);ku=Wu.length,Vu[Fu]=ku,ju.push(Fu),qu.push(Hu),Wu.push(Ju);for(var Qu=Zu,Ku=Xu.length,$u;Qu!==Ku;++Qu)$u=Xu[Qu],Ju[Qu]=new Ui($u,Fu,Hu);return Ju},unsubscribe_:function(Fu){var Hu=this._bindingsIndicesByPath,Vu=Hu[Fu];if(Vu!==void 0){var ku=this._paths,Wu=this._parsedPaths,ju=this._bindings,qu=ju.length-1,Xu=ju[qu],Yu=Fu[qu];Hu[Yu]=Vu,ju[Vu]=Xu,ju.pop(),Wu[Vu]=Wu[qu],Wu.pop(),ku[Vu]=ku[qu],ku.pop()}}}),Object.assign(Oi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(Fu){return this._startTime=Fu,this},setLoop:function(Fu,Hu){return this.loop=Fu,this.repetitions=Hu,this},setEffectiveWeight:function(Fu){return this.weight=Fu,this._effectiveWeight=this.enabled?Fu:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(Fu){return this._scheduleFading(Fu,0,1)},fadeOut:function(Fu){return this._scheduleFading(Fu,1,0)},crossFadeFrom:function(Fu,Hu,Vu){if(Fu.fadeOut(Hu),this.fadeIn(Hu),Vu){var ku=this._clip.duration,Wu=Fu._clip.duration;Fu.warp(1,Wu/ku,Hu),this.warp(ku/Wu,1,Hu)}return this},crossFadeTo:function(Fu,Hu,Vu){return Fu.crossFadeFrom(this,Hu,Vu)},stopFading:function(){var Fu=this._weightInterpolant;return null!==Fu&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(Fu)),this},setEffectiveTimeScale:function(Fu){return this.timeScale=Fu,this._effectiveTimeScale=this.paused?0:Fu,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(Fu){return this.timeScale=this._clip.duration/Fu,this.stopWarping()},syncWith:function(Fu){return this.time=Fu.time,this.timeScale=Fu.timeScale,this.stopWarping()},halt:function(Fu){return this.warp(this._effectiveTimeScale,0,Fu)},warp:function(Fu,Hu,Vu){var ku=this._mixer,Wu=ku.time,ju=this._timeScaleInterpolant,qu=this.timeScale;null===ju&&(ju=ku._lendControlInterpolant(),this._timeScaleInterpolant=ju);var Xu=ju.parameterPositions,Yu=ju.sampleValues;return Xu[0]=Wu,Xu[1]=Wu+Vu,Yu[0]=Fu/qu,Yu[1]=Hu/qu,this},stopWarping:function(){var Fu=this._timeScaleInterpolant;return null!==Fu&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(Fu)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(Fu,Hu,Vu,ku){if(!this.enabled)return void this._updateWeight(Fu);var Wu=this._startTime;if(null!==Wu){var ju=(Fu-Wu)*Vu;if(0>ju||0===Vu)return;this._startTime=null,Hu=Vu*ju}Hu*=this._updateTimeScale(Fu);var qu=this._updateTime(Hu),Xu=this._updateWeight(Fu);if(0<Xu)for(var Yu=this._interpolants,Zu=this._propertyBindings,Ju=0,Qu=Yu.length;Ju!==Qu;++Ju)Yu[Ju].evaluate(qu),Zu[Ju].accumulate(ku,Xu)},_updateWeight:function(Fu){var Hu=0;if(this.enabled){Hu=this.weight;var Vu=this._weightInterpolant;if(null!==Vu){var ku=Vu.evaluate(Fu)[0];Hu*=ku,Fu>Vu.parameterPositions[1]&&(this.stopFading(),0===ku&&(this.enabled=!1))}}return this._effectiveWeight=Hu,Hu},_updateTimeScale:function(Fu){var Hu=0;if(!this.paused){Hu=this.timeScale;var Vu=this._timeScaleInterpolant;if(null!==Vu){var ku=Vu.evaluate(Fu)[0];Hu*=ku,Fu>Vu.parameterPositions[1]&&(this.stopWarping(),0==Hu?this.paused=!0:this.timeScale=Hu)}}return this._effectiveTimeScale=Hu,Hu},_updateTime:function(Fu){var Hu=this.time+Fu,Vu=this._clip.duration,ku=this.loop,Wu=this._loopCount,ju=ku===2202;if(0===Fu)return-1===Wu?Hu:ju&&1==(1&Wu)?Vu-Hu:Hu;if(ku===2200){-1===Wu&&(this._loopCount=0,this._setEndings(!0,!0,!1));handle_stop:{if(Hu>=Vu)Hu=Vu;else if(0>Hu)Hu=0;else break handle_stop;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:'finished',action:this,direction:0>Fu?-1:1})}}else{if(-1===Wu&&(0<=Fu?(Wu=0,this._setEndings(!0,0===this.repetitions,ju)):this._setEndings(0===this.repetitions,!0,ju)),Hu>=Vu||0>Hu){var qu=Math.floor(Hu/Vu);Hu-=Vu*qu,Wu+=Math.abs(qu);var Xu=this.repetitions-Wu;if(0>=Xu)this.clampWhenFinished?this.paused=!0:this.enabled=!1,Hu=0<Fu?Vu:0,this._mixer.dispatchEvent({type:'finished',action:this,direction:0<Fu?1:-1});else{if(1==Xu){var Yu=0>Fu;this._setEndings(Yu,!Yu,ju)}else this._setEndings(!1,!1,ju);this._loopCount=Wu,this._mixer.dispatchEvent({type:'loop',action:this,loopDelta:qu})}}if(ju&&1==(1&Wu))return this.time=Hu,Vu-Hu}return this.time=Hu,Hu},_setEndings:function(Fu,Hu,Vu){var ku=this._interpolantSettings;Vu?(ku.endingStart=Ql,ku.endingEnd=Ql):(ku.endingStart=Fu?this.zeroSlopeAtStart?Ql:Jl:Kl,ku.endingEnd=Hu?this.zeroSlopeAtEnd?Ql:Jl:Kl)},_scheduleFading:function(Fu,Hu,Vu){var ku=this._mixer,Wu=ku.time,ju=this._weightInterpolant;null===ju&&(ju=ku._lendControlInterpolant(),this._weightInterpolant=ju);var qu=ju.parameterPositions,Xu=ju.sampleValues;return qu[0]=Wu,Xu[0]=Hu,qu[1]=Wu+Fu,Xu[1]=Vu,this}}),Fi.prototype=Object.assign(Object.create(M.prototype),{constructor:Fi,_bindAction:function(Fu,Hu){var Vu=Fu._localRoot||this._root,ku=Fu._clip.tracks,Wu=ku.length,ju=Fu._propertyBindings,qu=Fu._interpolants,Xu=Vu.uuid,Yu=this._bindingsByRootAndName,Zu=Yu[Xu];Zu===void 0&&(Zu={},Yu[Xu]=Zu);for(var Ju=0;Ju!==Wu;++Ju){var Qu=ku[Ju],Ku=Qu.name,$u=Zu[Ku];if(void 0!==$u)ju[Ju]=$u;else{if($u=ju[Ju],void 0!==$u){null===$u._cacheIndex&&(++$u.referenceCount,this._addInactiveBinding($u,Xu,Ku));continue}var em=Hu&&Hu._propertyBindings[Ju].binding.parsedPath;$u=new Ni(Ui.create(Vu,Ku,em),Qu.ValueTypeName,Qu.getValueSize()),++$u.referenceCount,this._addInactiveBinding($u,Xu,Ku),ju[Ju]=$u}qu[Ju].resultBuffer=$u.buffer}},_activateAction:function(Fu){if(!this._isActiveAction(Fu)){if(null===Fu._cacheIndex){var Hu=(Fu._localRoot||this._root).uuid,Vu=Fu._clip.uuid,ku=this._actionsByClip[Vu];this._bindAction(Fu,ku&&ku.knownActions[0]),this._addInactiveAction(Fu,Vu,Hu)}for(var Wu=Fu._propertyBindings,ju=0,qu=Wu.length,Xu;ju!==qu;++ju)Xu=Wu[ju],0==Xu.useCount++&&(this._lendBinding(Xu),Xu.saveOriginalState());this._lendAction(Fu)}},_deactivateAction:function(Fu){if(this._isActiveAction(Fu)){for(var Hu=Fu._propertyBindings,Vu=0,ku=Hu.length,Wu;Vu!==ku;++Vu)Wu=Hu[Vu],0==--Wu.useCount&&(Wu.restoreOriginalState(),this._takeBackBinding(Wu));this._takeBackAction(Fu)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var Fu=this;this.stats={actions:{get total(){return Fu._actions.length},get inUse(){return Fu._nActiveActions}},bindings:{get total(){return Fu._bindings.length},get inUse(){return Fu._nActiveBindings}},controlInterpolants:{get total(){return Fu._controlInterpolants.length},get inUse(){return Fu._nActiveControlInterpolants}}}},_isActiveAction:function(Fu){var Hu=Fu._cacheIndex;return null!==Hu&&Hu<this._nActiveActions},_addInactiveAction:function(Fu,Hu,Vu){var ku=this._actions,Wu=this._actionsByClip,ju=Wu[Hu];if(ju===void 0)ju={knownActions:[Fu],actionByRoot:{}},Fu._byClipCacheIndex=0,Wu[Hu]=ju;else{var qu=ju.knownActions;Fu._byClipCacheIndex=qu.length,qu.push(Fu)}Fu._cacheIndex=ku.length,ku.push(Fu),ju.actionByRoot[Vu]=Fu},_removeInactiveAction:function(Fu){var Hu=this._actions,Vu=Hu[Hu.length-1],ku=Fu._cacheIndex;Vu._cacheIndex=ku,Hu[ku]=Vu,Hu.pop(),Fu._cacheIndex=null;var Wu=Fu._clip.uuid,ju=this._actionsByClip,qu=ju[Wu],Xu=qu.knownActions,Yu=Xu[Xu.length-1],Zu=Fu._byClipCacheIndex;Yu._byClipCacheIndex=Zu,Xu[Zu]=Yu,Xu.pop(),Fu._byClipCacheIndex=null;var Ju=qu.actionByRoot,Qu=(Fu._localRoot||this._root).uuid;delete Ju[Qu],0===Xu.length&&delete ju[Wu],this._removeInactiveBindingsForAction(Fu)},_removeInactiveBindingsForAction:function(Fu){for(var Hu=Fu._propertyBindings,Vu=0,ku=Hu.length,Wu;Vu!==ku;++Vu)Wu=Hu[Vu],0==--Wu.referenceCount&&this._removeInactiveBinding(Wu)},_lendAction:function(Fu){var Hu=this._actions,Vu=Fu._cacheIndex,ku=this._nActiveActions++,Wu=Hu[ku];Fu._cacheIndex=ku,Hu[ku]=Fu,Wu._cacheIndex=Vu,Hu[Vu]=Wu},_takeBackAction:function(Fu){var Hu=this._actions,Vu=Fu._cacheIndex,ku=--this._nActiveActions,Wu=Hu[ku];Fu._cacheIndex=ku,Hu[ku]=Fu,Wu._cacheIndex=Vu,Hu[Vu]=Wu},_addInactiveBinding:function(Fu,Hu,Vu){var ku=this._bindingsByRootAndName,Wu=ku[Hu],ju=this._bindings;Wu===void 0&&(Wu={},ku[Hu]=Wu),Wu[Vu]=Fu,Fu._cacheIndex=ju.length,ju.push(Fu)},_removeInactiveBinding:function(Fu){var Hu=this._bindings,Vu=Fu.binding,ku=Vu.rootNode.uuid,Wu=Vu.path,ju=this._bindingsByRootAndName,qu=ju[ku],Xu=Hu[Hu.length-1],Yu=Fu._cacheIndex;Xu._cacheIndex=Yu,Hu[Yu]=Xu,Hu.pop(),delete qu[Wu];remove_empty_map:{for(var Zu in qu)break remove_empty_map;delete ju[ku]}},_lendBinding:function(Fu){var Hu=this._bindings,Vu=Fu._cacheIndex,ku=this._nActiveBindings++,Wu=Hu[ku];Fu._cacheIndex=ku,Hu[ku]=Fu,Wu._cacheIndex=Vu,Hu[Vu]=Wu},_takeBackBinding:function(Fu){var Hu=this._bindings,Vu=Fu._cacheIndex,ku=--this._nActiveBindings,Wu=Hu[ku];Fu._cacheIndex=ku,Hu[ku]=Fu,Wu._cacheIndex=Vu,Hu[Vu]=Wu},_lendControlInterpolant:function(){var Fu=this._controlInterpolants,Hu=this._nActiveControlInterpolants++,Vu=Fu[Hu];return void 0===Vu&&(Vu=new uo(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),Vu.__cacheIndex=Hu,Fu[Hu]=Vu),Vu},_takeBackControlInterpolant:function(Fu){var Hu=this._controlInterpolants,Vu=Fu.__cacheIndex,ku=--this._nActiveControlInterpolants,Wu=Hu[ku];Fu.__cacheIndex=ku,Hu[ku]=Fu,Wu.__cacheIndex=Vu,Hu[Vu]=Wu},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(Fu,Hu){var Vu=Hu||this._root,ku=Vu.uuid,Wu='string'==typeof Fu?So.findByName(Vu,Fu):Fu,ju=null===Wu?Fu:Wu.uuid,qu=this._actionsByClip[ju],Xu=null;if(void 0!==qu){var Yu=qu.actionByRoot[ku];if(void 0!==Yu)return Yu;Xu=qu.knownActions[0],null===Wu&&(Wu=Xu._clip)}if(null===Wu)return null;var Zu=new Oi(this,Wu,Hu);return this._bindAction(Zu,Xu),this._addInactiveAction(Zu,ju,ku),Zu},existingAction:function(Fu,Hu){var Vu=Hu||this._root,ku=Vu.uuid,Wu='string'==typeof Fu?So.findByName(Vu,Fu):Fu,ju=Wu?Wu.uuid:Fu,qu=this._actionsByClip[ju];return void 0===qu?null:qu.actionByRoot[ku]||null},stopAllAction:function(){var Fu=this._actions,Hu=this._nActiveActions,Vu=this._bindings,ku=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var Wu=0;Wu!==Hu;++Wu)Fu[Wu].reset();for(var Wu=0;Wu!==ku;++Wu)Vu[Wu].useCount=0;return this},update:function(Fu){Fu*=this.timeScale;for(var Hu=this._actions,Vu=this._nActiveActions,ku=this.time+=Fu,Wu=Math.sign(Fu),ju=this._accuIndex^=1,qu=0,Xu;qu!==Vu;++qu)Xu=Hu[qu],Xu._update(ku,Fu,Wu,ju);for(var Yu=this._bindings,Zu=this._nActiveBindings,qu=0;qu!==Zu;++qu)Yu[qu].apply(ju);return this},getRoot:function(){return this._root},uncacheClip:function(Fu){var Hu=this._actions,Vu=Fu.uuid,ku=this._actionsByClip,Wu=ku[Vu];if(Wu!==void 0){for(var ju=Wu.knownActions,qu=0,Xu=ju.length,Yu;qu!==Xu;++qu){Yu=ju[qu],this._deactivateAction(Yu);var Zu=Yu._cacheIndex,Ju=Hu[Hu.length-1];Yu._cacheIndex=null,Yu._byClipCacheIndex=null,Ju._cacheIndex=Zu,Hu[Zu]=Ju,Hu.pop(),this._removeInactiveBindingsForAction(Yu)}delete ku[Vu]}},uncacheRoot:function(Fu){var Hu=Fu.uuid,Vu=this._actionsByClip;for(var ku in Vu){var Wu=Vu[ku].actionByRoot,ju=Wu[Hu];ju!==void 0&&(this._deactivateAction(ju),this._removeInactiveAction(ju))}var qu=this._bindingsByRootAndName,Xu=qu[Hu];if(Xu!==void 0)for(var Yu in Xu){var Zu=Xu[Yu];Zu.restoreOriginalState(),this._removeInactiveBinding(Zu)}},uncacheAction:function(Fu,Hu){var Vu=this.existingAction(Fu,Hu);null!==Vu&&(this._deactivateAction(Vu),this._removeInactiveAction(Vu))}}),Hi.prototype.clone=function(){return new Hi(this.value.clone===void 0?this.value:this.value.clone())},Vi.prototype=Object.assign(Object.create(xe.prototype),{constructor:Vi,isInstancedBufferGeometry:!0,copy:function(Fu){return xe.prototype.copy.call(this,Fu),this.maxInstancedCount=Fu.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}}),ki.prototype=Object.assign(Object.create(fr.prototype),{constructor:ki,isInstancedInterleavedBuffer:!0,copy:function(Fu){return fr.prototype.copy.call(this,Fu),this.meshPerAttribute=Fu.meshPerAttribute,this}}),Wi.prototype=Object.assign(Object.create(re.prototype),{constructor:Wi,isInstancedBufferAttribute:!0,copy:function(Fu){return re.prototype.copy.call(this,Fu),this.meshPerAttribute=Fu.meshPerAttribute,this}}),Object.assign(function(Fu,Hu,Vu,ku){this.ray=new we(Fu,Hu),this.near=Vu||0,this.far=ku||Infinity,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn('THREE.Raycaster: params.PointCloud has been renamed to params.Points.'),this.Points}}})}.prototype,{linePrecision:1,set:function(Fu,Hu){this.ray.set(Fu,Hu)},setFromCamera:function(Fu,Hu){Hu&&Hu.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(Hu.matrixWorld),this.ray.direction.set(Fu.x,Fu.y,0.5).unproject(Hu).sub(this.ray.origin).normalize()):Hu&&Hu.isOrthographicCamera?(this.ray.origin.set(Fu.x,Fu.y,(Hu.near+Hu.far)/(Hu.near-Hu.far)).unproject(Hu),this.ray.direction.set(0,0,-1).transformDirection(Hu.matrixWorld)):console.error('THREE.Raycaster: Unsupported camera type.')},intersectObject:function(Fu,Hu,Vu){var ku=Vu||[];return Xi(Fu,this,ku,Hu),ku.sort(qi),ku},intersectObjects:function(Fu,Hu,Vu){var ku=Vu||[];if(!1===Array.isArray(Fu))return console.warn('THREE.Raycaster.intersectObjects: objects is not an Array.'),ku;for(var Wu=0,ju=Fu.length;Wu<ju;Wu++)Xi(Fu[Wu],this,ku,Hu);return ku.sort(qi),ku}}),Object.assign(function(Fu,Hu,Vu){return this.radius=void 0===Fu?1:Fu,this.phi=void 0===Hu?0:Hu,this.theta=void 0===Vu?0:Vu,this}.prototype,{set:function(Fu,Hu,Vu){return this.radius=Fu,this.phi=Hu,this.theta=Vu,this},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.radius=Fu.radius,this.phi=Fu.phi,this.theta=Fu.theta,this},makeSafe:function(){var Fu=1e-6;return this.phi=Math.max(Fu,Math.min(Math.PI-Fu,this.phi)),this},setFromVector3:function(Fu){return this.setFromCartesianCoords(Fu.x,Fu.y,Fu.z)},setFromCartesianCoords:function(Fu,Hu,Vu){return this.radius=Math.sqrt(Fu*Fu+Hu*Hu+Vu*Vu),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(Fu,Vu),this.phi=Math.acos(fp.clamp(Hu/this.radius,-1,1))),this}}),Object.assign(function(Fu,Hu,Vu){return this.radius=void 0===Fu?1:Fu,this.theta=void 0===Hu?0:Hu,this.y=void 0===Vu?0:Vu,this}.prototype,{set:function(Fu,Hu,Vu){return this.radius=Fu,this.theta=Hu,this.y=Vu,this},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.radius=Fu.radius,this.theta=Fu.theta,this.y=Fu.y,this},setFromVector3:function(Fu){return this.setFromCartesianCoords(Fu.x,Fu.y,Fu.z)},setFromCartesianCoords:function(Fu,Hu,Vu){return this.radius=Math.sqrt(Fu*Fu+Vu*Vu),this.theta=Math.atan2(Fu,Vu),this.y=Hu,this}}),Object.assign(Ji.prototype,{set:function(Fu,Hu){return this.min.copy(Fu),this.max.copy(Hu),this},setFromPoints:function(Fu){this.makeEmpty();for(var Hu=0,Vu=Fu.length;Hu<Vu;Hu++)this.expandByPoint(Fu[Hu]);return this},setFromCenterAndSize:function(){var Fu=new S;return function(Vu,ku){var Wu=Fu.copy(ku).multiplyScalar(0.5);return this.min.copy(Vu).sub(Wu),this.max.copy(Vu).add(Wu),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.min.copy(Fu.min),this.max.copy(Fu.max),this},makeEmpty:function(){return this.min.x=this.min.y=+Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(Fu){return void 0===Fu&&(console.warn('THREE.Box2: .getCenter() target is now required'),Fu=new S),this.isEmpty()?Fu.set(0,0):Fu.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(Fu){return void 0===Fu&&(console.warn('THREE.Box2: .getSize() target is now required'),Fu=new S),this.isEmpty()?Fu.set(0,0):Fu.subVectors(this.max,this.min)},expandByPoint:function(Fu){return this.min.min(Fu),this.max.max(Fu),this},expandByVector:function(Fu){return this.min.sub(Fu),this.max.add(Fu),this},expandByScalar:function(Fu){return this.min.addScalar(-Fu),this.max.addScalar(Fu),this},containsPoint:function(Fu){return Fu.x<this.min.x||Fu.x>this.max.x||Fu.y<this.min.y||Fu.y>this.max.y?!1:!0},containsBox:function(Fu){return this.min.x<=Fu.min.x&&Fu.max.x<=this.max.x&&this.min.y<=Fu.min.y&&Fu.max.y<=this.max.y},getParameter:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Box2: .getParameter() target is now required'),Hu=new S),Hu.set((Fu.x-this.min.x)/(this.max.x-this.min.x),(Fu.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(Fu){return Fu.max.x<this.min.x||Fu.min.x>this.max.x||Fu.max.y<this.min.y||Fu.min.y>this.max.y?!1:!0},clampPoint:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Box2: .clampPoint() target is now required'),Hu=new S),Hu.copy(Fu).clamp(this.min,this.max)},distanceToPoint:function(){var Fu=new S;return function(Vu){var ku=Fu.copy(Vu).clamp(this.min,this.max);return ku.sub(Vu).length()}}(),intersect:function(Fu){return this.min.max(Fu.min),this.max.min(Fu.max),this},union:function(Fu){return this.min.min(Fu.min),this.max.max(Fu.max),this},translate:function(Fu){return this.min.add(Fu),this.max.add(Fu),this},equals:function(Fu){return Fu.min.equals(this.min)&&Fu.max.equals(this.max)}}),Object.assign(Qi.prototype,{set:function(Fu,Hu){return this.start.copy(Fu),this.end.copy(Hu),this},clone:function(){return new this.constructor().copy(this)},copy:function(Fu){return this.start.copy(Fu.start),this.end.copy(Fu.end),this},getCenter:function(Fu){return void 0===Fu&&(console.warn('THREE.Line3: .getCenter() target is now required'),Fu=new A),Fu.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(Fu){return void 0===Fu&&(console.warn('THREE.Line3: .delta() target is now required'),Fu=new A),Fu.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(Fu,Hu){return void 0===Hu&&(console.warn('THREE.Line3: .at() target is now required'),Hu=new A),this.delta(Hu).multiplyScalar(Fu).add(this.start)},closestPointToPointParameter:function(){var Fu=new A,Hu=new A;return function(ku,Wu){Fu.subVectors(ku,this.start),Hu.subVectors(this.end,this.start);var ju=Hu.dot(Hu),qu=Hu.dot(Fu),Xu=qu/ju;return Wu&&(Xu=fp.clamp(Xu,0,1)),Xu}}(),closestPointToPoint:function(Fu,Hu,Vu){var ku=this.closestPointToPointParameter(Fu,Hu);return void 0===Vu&&(console.warn('THREE.Line3: .closestPointToPoint() target is now required'),Vu=new A),this.delta(Vu).multiplyScalar(ku).add(this.start)},applyMatrix4:function(Fu){return this.start.applyMatrix4(Fu),this.end.applyMatrix4(Fu),this},equals:function(Fu){return Fu.start.equals(this.start)&&Fu.end.equals(this.end)}}),Ki.prototype=Object.create(K.prototype),Ki.prototype.constructor=Ki,Ki.prototype.isImmediateRenderObject=!0,$i.prototype=Object.create(wr.prototype),$i.prototype.constructor=$i,$i.prototype.update=function(){var Fu=new A,Hu=new A,Vu=new C;return function(){var Wu=['a','b','c'];this.object.updateMatrixWorld(!0),Vu.getNormalMatrix(this.object.matrixWorld);var ju=this.object.matrixWorld,qu=this.geometry.attributes.position,Xu=this.object.geometry;if(Xu&&Xu.isGeometry)for(var Yu=Xu.vertices,Zu=Xu.faces,Ju=0,Qu=0,Ku=Zu.length,$u;Qu<Ku;Qu++){$u=Zu[Qu];for(var em=0,tm=$u.vertexNormals.length;em<tm;em++){var rm=Yu[$u[Wu[em]]],am=$u.vertexNormals[em];Fu.copy(rm).applyMatrix4(ju),Hu.copy(am).applyMatrix3(Vu).normalize().multiplyScalar(this.size).add(Fu),qu.setXYZ(Ju,Fu.x,Fu.y,Fu.z),++Ju,qu.setXYZ(Ju,Hu.x,Hu.y,Hu.z),++Ju}}else if(Xu&&Xu.isBufferGeometry)for(var om=Xu.attributes.position,im=Xu.attributes.normal,Ju=0,em=0,tm=om.count;em<tm;em++)Fu.set(om.getX(em),om.getY(em),om.getZ(em)).applyMatrix4(ju),Hu.set(im.getX(em),im.getY(em),im.getZ(em)),Hu.applyMatrix3(Vu).normalize().multiplyScalar(this.size).add(Fu),qu.setXYZ(Ju,Fu.x,Fu.y,Fu.z),++Ju,qu.setXYZ(Ju,Hu.x,Hu.y,Hu.z),++Ju;qu.needsUpdate=!0}}(),en.prototype=Object.create(K.prototype),en.prototype.constructor=en,en.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},en.prototype.update=function(){var Fu=new A,Hu=new A;return function(){this.light.updateMatrixWorld();var ku=this.light.distance?this.light.distance:1e3,Wu=ku*Math.tan(this.light.angle);this.cone.scale.set(Wu,Wu,ku),Fu.setFromMatrixPosition(this.light.matrixWorld),Hu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Hu.sub(Fu)),this.color===void 0?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),rn.prototype=Object.create(wr.prototype),rn.prototype.constructor=rn,rn.prototype.updateMatrixWorld=function(){var Fu=new A,Hu=new E,Vu=new E;return function(Wu){var ju=this.bones,qu=this.geometry,Xu=qu.getAttribute('position');Vu.getInverse(this.root.matrixWorld);for(var Yu=0,Zu=0,Ju;Yu<ju.length;Yu++)Ju=ju[Yu],Ju.parent&&Ju.parent.isBone&&(Hu.multiplyMatrices(Vu,Ju.matrixWorld),Fu.setFromMatrixPosition(Hu),Xu.setXYZ(Zu,Fu.x,Fu.y,Fu.z),Hu.multiplyMatrices(Vu,Ju.parent.matrixWorld),Fu.setFromMatrixPosition(Hu),Xu.setXYZ(Zu+1,Fu.x,Fu.y,Fu.z),Zu+=2);qu.getAttribute('position').needsUpdate=!0,K.prototype.updateMatrixWorld.call(this,Wu)}}(),on.prototype=Object.create(Pe.prototype),on.prototype.constructor=on,on.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},on.prototype.update=function(){this.color===void 0?this.material.color.copy(this.light.color):this.material.color.set(this.color)},nn.prototype=Object.create(K.prototype),nn.prototype.constructor=nn,nn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},nn.prototype.update=function(){var Fu=0.5*this.light.width,Hu=0.5*this.light.height,Vu=this.line.geometry.attributes.position,ku=Vu.array;ku[0]=Fu,ku[1]=-Hu,ku[2]=0,ku[3]=Fu,ku[4]=Hu,ku[5]=0,ku[6]=-Fu,ku[7]=Hu,ku[8]=0,ku[9]=-Fu,ku[10]=-Hu,ku[11]=0,ku[12]=Fu,ku[13]=-Hu,ku[14]=0,Vu.needsUpdate=!0,this.color===void 0?this.line.material.color.copy(this.light.color):this.line.material.color.set(this.color)},sn.prototype=Object.create(K.prototype),sn.prototype.constructor=sn,sn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},sn.prototype.update=function(){var Fu=new A,Hu=new W,Vu=new W;return function(){var Wu=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var ju=Wu.geometry.getAttribute('color');Hu.copy(this.light.color),Vu.copy(this.light.groundColor);for(var qu=0,Xu=ju.count,Yu;qu<Xu;qu++)Yu=qu<Xu/2?Hu:Vu,ju.setXYZ(qu,Yu.r,Yu.g,Yu.b);ju.needsUpdate=!0}Wu.lookAt(Fu.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),ln.prototype=Object.create(wr.prototype),ln.prototype.constructor=ln,pn.prototype=Object.create(wr.prototype),pn.prototype.constructor=pn,dn.prototype=Object.create(wr.prototype),dn.prototype.constructor=dn,dn.prototype.update=function(){var Fu=new A,Hu=new A,Vu=new C;return function(){this.object.updateMatrixWorld(!0),Vu.getNormalMatrix(this.object.matrixWorld);for(var Wu=this.object.matrixWorld,ju=this.geometry.attributes.position,qu=this.object.geometry,Xu=qu.vertices,Yu=qu.faces,Zu=0,Ju=0,Qu=Yu.length;Ju<Qu;Ju++){var Ku=Yu[Ju],$u=Ku.normal;Fu.copy(Xu[Ku.a]).add(Xu[Ku.b]).add(Xu[Ku.c]).divideScalar(3).applyMatrix4(Wu),Hu.copy($u).applyMatrix3(Vu).normalize().multiplyScalar(this.size).add(Fu),ju.setXYZ(Zu,Fu.x,Fu.y,Fu.z),++Zu,ju.setXYZ(Zu,Hu.x,Hu.y,Hu.z),++Zu}ju.needsUpdate=!0}}(),cn.prototype=Object.create(K.prototype),cn.prototype.constructor=cn,cn.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},cn.prototype.update=function(){var Fu=new A,Hu=new A,Vu=new A;return function(){Fu.setFromMatrixPosition(this.light.matrixWorld),Hu.setFromMatrixPosition(this.light.target.matrixWorld),Vu.subVectors(Hu,Fu),this.lightPlane.lookAt(Hu),this.color===void 0?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(Hu),this.targetLine.scale.z=Vu.length()}}(),un.prototype=Object.create(wr.prototype),un.prototype.constructor=un,un.prototype.update=function(){function Fu(ju,qu,Xu,Yu){ku.set(qu,Xu,Yu).unproject(Wu);var Zu=Vu[ju];if(Zu!==void 0)for(var Ju=Hu.getAttribute('position'),Qu=0,Ku=Zu.length;Qu<Ku;Qu++)Ju.setXYZ(Zu[Qu],ku.x,ku.y,ku.z)}var Hu,Vu,ku=new A,Wu=new ir;return function(){Hu=this.geometry,Vu=this.pointMap;var qu=1,Xu=1;Wu.projectionMatrix.copy(this.camera.projectionMatrix),Fu('c',0,0,-1),Fu('t',0,0,1),Fu('n1',-qu,-Xu,-1),Fu('n2',qu,-Xu,-1),Fu('n3',-qu,Xu,-1),Fu('n4',qu,Xu,-1),Fu('f1',-qu,-Xu,1),Fu('f2',qu,-Xu,1),Fu('f3',-qu,Xu,1),Fu('f4',qu,Xu,1),Fu('u1',0.7*qu,1.1*Xu,-1),Fu('u2',0.7*-qu,1.1*Xu,-1),Fu('u3',0,2*Xu,-1),Fu('cf1',-qu,0,1),Fu('cf2',qu,0,1),Fu('cf3',0,-Xu,1),Fu('cf4',0,Xu,1),Fu('cn1',-qu,0,-1),Fu('cn2',qu,0,-1),Fu('cn3',0,-Xu,-1),Fu('cn4',0,Xu,-1),Hu.getAttribute('position').needsUpdate=!0}}(),mn.prototype=Object.create(wr.prototype),mn.prototype.constructor=mn,mn.prototype.update=function(){var Fu=new O;return function(Vu){if(void 0!==Vu&&console.warn('THREE.BoxHelper: .update() has no longer arguments.'),void 0!==this.object&&Fu.setFromObject(this.object),!Fu.isEmpty()){var ku=Fu.min,Wu=Fu.max,ju=this.geometry.attributes.position,qu=ju.array;qu[0]=Wu.x,qu[1]=Wu.y,qu[2]=Wu.z,qu[3]=ku.x,qu[4]=Wu.y,qu[5]=Wu.z,qu[6]=ku.x,qu[7]=ku.y,qu[8]=Wu.z,qu[9]=Wu.x,qu[10]=ku.y,qu[11]=Wu.z,qu[12]=Wu.x,qu[13]=Wu.y,qu[14]=ku.z,qu[15]=ku.x,qu[16]=Wu.y,qu[17]=ku.z,qu[18]=ku.x,qu[19]=ku.y,qu[20]=ku.z,qu[21]=Wu.x,qu[22]=ku.y,qu[23]=ku.z,ju.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),mn.prototype.setFromObject=function(Fu){return this.object=Fu,this.update(),this},mn.prototype.copy=function(Fu){return wr.prototype.copy.call(this,Fu),this.object=Fu.object,this},mn.prototype.clone=function(){return new this.constructor().copy(this)},gn.prototype=Object.create(wr.prototype),gn.prototype.constructor=gn,gn.prototype.updateMatrixWorld=function(Fu){var Hu=this.box;Hu.isEmpty()||(Hu.getCenter(this.position),Hu.getSize(this.scale),this.scale.multiplyScalar(0.5),K.prototype.updateMatrixWorld.call(this,Fu))},fn.prototype=Object.create(Er.prototype),fn.prototype.constructor=fn,fn.prototype.updateMatrixWorld=function(Fu){var Hu=-this.plane.constant;1e-8>Math.abs(Hu)&&(Hu=1e-8),this.scale.set(0.5*this.size,0.5*this.size,Hu),this.children[0].material.side=0>Hu?zn:Dn,this.lookAt(this.plane.normal),K.prototype.updateMatrixWorld.call(this,Fu)};var Cu,Ru;hn.prototype=Object.create(K.prototype),hn.prototype.constructor=hn,hn.prototype.setDirection=function(){var Fu=new A,Hu;return function(ku){0.99999<ku.y?this.quaternion.set(0,0,0,1):-0.99999>ku.y?this.quaternion.set(1,0,0,0):(Fu.set(ku.z,0,-ku.x).normalize(),Hu=Math.acos(ku.y),this.quaternion.setFromAxisAngle(Fu,Hu))}}(),hn.prototype.setLength=function(Fu,Hu,Vu){Hu===void 0&&(Hu=0.2*Fu),Vu===void 0&&(Vu=0.2*Hu),this.line.scale.set(1,Math.max(0,Fu-Hu),1),this.line.updateMatrix(),this.cone.scale.set(Vu,Hu,Vu),this.cone.position.y=Fu,this.cone.updateMatrix()},hn.prototype.setColor=function(Fu){this.line.material.color.copy(Fu),this.cone.material.color.copy(Fu)},hn.prototype.copy=function(Fu){return K.prototype.copy.call(this,Fu,!1),this.line.copy(Fu.line),this.cone.copy(Fu.cone),this},hn.prototype.clone=function(){return new this.constructor().copy(this)},yn.prototype=Object.create(wr.prototype),yn.prototype.constructor=yn,zo.create=function(Fu,Hu){return console.log('THREE.Curve.create() has been deprecated'),Fu.prototype=Object.create(zo.prototype),Fu.prototype.constructor=Fu,Fu.prototype.getPoint=Hu,Fu},Object.assign(ri.prototype,{createPointsGeometry:function(Fu){console.warn('THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var Hu=this.getPoints(Fu);return this.createGeometry(Hu)},createSpacedPointsGeometry:function(Fu){console.warn('THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var Hu=this.getSpacedPoints(Fu);return this.createGeometry(Hu)},createGeometry:function(Fu){console.warn('THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');for(var Hu=new ee,Vu=0,ku=Fu.length,Wu;Vu<ku;Vu++)Wu=Fu[Vu],Hu.vertices.push(new A(Wu.x,Wu.y,Wu.z||0));return Hu}}),Object.assign(ai.prototype,{fromPoints:function(Fu){console.warn('THREE.Path: .fromPoints() has been renamed to .setFromPoints().'),this.setFromPoints(Fu)}}),xn.prototype=Object.create(Go.prototype),Object.assign(xn.prototype,{initFromArray:function(){console.error('THREE.Spline: .initFromArray() has been removed.')},getControlPointsArray:function(){console.error('THREE.Spline: .getControlPointsArray() has been removed.')},reparametrizeByArcLength:function(){console.error('THREE.Spline: .reparametrizeByArcLength() has been removed.')}}),ln.prototype.setColors=function(){console.error('THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.')},rn.prototype.update=function(){console.error('THREE.SkeletonHelper: update() no longer needs to be called.')},Object.assign(vi.prototype,{extractUrlBase:function(Fu){return console.warn('THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.'),Mu.extractUrlBase(Fu)}}),Object.assign(_i.prototype,{setTexturePath:function(Fu){return console.warn('THREE.JSONLoader: .setTexturePath() has been renamed to .setResourcePath().'),this.setResourcePath(Fu)}}),Object.assign(bi.prototype,{setTexturePath:function(Fu){return console.warn('THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().'),this.setResourcePath(Fu)}}),Object.assign(Ji.prototype,{center:function(Fu){return console.warn('THREE.Box2: .center() has been renamed to .getCenter().'),this.getCenter(Fu)},empty:function(){return console.warn('THREE.Box2: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(Fu){return console.warn('THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Fu)},size:function(Fu){return console.warn('THREE.Box2: .size() has been renamed to .getSize().'),this.getSize(Fu)}}),Object.assign(O.prototype,{center:function(Fu){return console.warn('THREE.Box3: .center() has been renamed to .getCenter().'),this.getCenter(Fu)},empty:function(){return console.warn('THREE.Box3: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(Fu){return console.warn('THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Fu)},isIntersectionSphere:function(Fu){return console.warn('THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(Fu)},size:function(Fu){return console.warn('THREE.Box3: .size() has been renamed to .getSize().'),this.getSize(Fu)}}),Qi.prototype.center=function(Fu){return console.warn('THREE.Line3: .center() has been renamed to .getCenter().'),this.getCenter(Fu)},Object.assign(fp,{random16:function(){return console.warn('THREE.Math: .random16() has been deprecated. Use Math.random() instead.'),Math.random()},nearestPowerOfTwo:function(Fu){return console.warn('THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().'),fp.floorPowerOfTwo(Fu)},nextPowerOfTwo:function(Fu){return console.warn('THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().'),fp.ceilPowerOfTwo(Fu)}}),Object.assign(C.prototype,{flattenToArrayOffset:function(Fu,Hu){return console.warn('THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(Fu,Hu)},multiplyVector3:function(Fu){return console.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.'),Fu.applyMatrix3(this)},multiplyVector3Array:function(){console.error('THREE.Matrix3: .multiplyVector3Array() has been removed.')},applyToBuffer:function(Fu){return console.warn('THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(Fu)},applyToVector3Array:function(){console.error('THREE.Matrix3: .applyToVector3Array() has been removed.')}}),Object.assign(E.prototype,{extractPosition:function(Fu){return console.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().'),this.copyPosition(Fu)},flattenToArrayOffset:function(Fu,Hu){return console.warn('THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(Fu,Hu)},getPosition:function(){var Fu;return function(){return void 0==Fu&&(Fu=new A),console.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.'),Fu.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(Fu){return console.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().'),this.makeRotationFromQuaternion(Fu)},multiplyToArray:function(){console.warn('THREE.Matrix4: .multiplyToArray() has been removed.')},multiplyVector3:function(Fu){return console.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Fu.applyMatrix4(this)},multiplyVector4:function(Fu){return console.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Fu.applyMatrix4(this)},multiplyVector3Array:function(){console.error('THREE.Matrix4: .multiplyVector3Array() has been removed.')},rotateAxis:function(Fu){console.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.'),Fu.transformDirection(this)},crossVector:function(Fu){return console.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Fu.applyMatrix4(this)},translate:function(){console.error('THREE.Matrix4: .translate() has been removed.')},rotateX:function(){console.error('THREE.Matrix4: .rotateX() has been removed.')},rotateY:function(){console.error('THREE.Matrix4: .rotateY() has been removed.')},rotateZ:function(){console.error('THREE.Matrix4: .rotateZ() has been removed.')},rotateByAxis:function(){console.error('THREE.Matrix4: .rotateByAxis() has been removed.')},applyToBuffer:function(Fu){return console.warn('THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(Fu)},applyToVector3Array:function(){console.error('THREE.Matrix4: .applyToVector3Array() has been removed.')},makeFrustum:function(Fu,Hu,Vu,ku,Wu,ju){return console.warn('THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.'),this.makePerspective(Fu,Hu,ku,Vu,Wu,ju)}}),H.prototype.isIntersectionLine=function(Fu){return console.warn('THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().'),this.intersectsLine(Fu)},L.prototype.multiplyVector3=function(Fu){return console.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.'),Fu.applyQuaternion(this)},Object.assign(we.prototype,{isIntersectionBox:function(Fu){return console.warn('THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Fu)},isIntersectionPlane:function(Fu){return console.warn('THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().'),this.intersectsPlane(Fu)},isIntersectionSphere:function(Fu){return console.warn('THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(Fu)}}),Object.assign(Le.prototype,{area:function(){return console.warn('THREE.Triangle: .area() has been renamed to .getArea().'),this.getArea()},barycoordFromPoint:function(Fu,Hu){return console.warn('THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().'),this.getBarycoord(Fu,Hu)},midpoint:function(Fu){return console.warn('THREE.Triangle: .midpoint() has been renamed to .getMidpoint().'),this.getMidpoint(Fu)},normal:function(Fu){return console.warn('THREE.Triangle: .normal() has been renamed to .getNormal().'),this.getNormal(Fu)},plane:function(Fu){return console.warn('THREE.Triangle: .plane() has been renamed to .getPlane().'),this.getPlane(Fu)}}),Object.assign(Le,{barycoordFromPoint:function(Fu,Hu,Vu,ku,Wu){return console.warn('THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().'),Le.getBarycoord(Fu,Hu,Vu,ku,Wu)},normal:function(Fu,Hu,Vu,ku){return console.warn('THREE.Triangle: .normal() has been renamed to .getNormal().'),Le.getNormal(Fu,Hu,Vu,ku)}}),Object.assign(oi.prototype,{extractAllPoints:function(Fu){return console.warn('THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.'),this.extractPoints(Fu)},extrude:function(Fu){return console.warn('THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.'),new Ca(this,Fu)},makeGeometry:function(Fu){return console.warn('THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.'),new Ha(this,Fu)}}),Object.assign(S.prototype,{fromAttribute:function(Fu,Hu,Vu){return console.warn('THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Fu,Hu,Vu)},distanceToManhattan:function(Fu){return console.warn('THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(Fu)},lengthManhattan:function(){return console.warn('THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(A.prototype,{setEulerFromRotationMatrix:function(){console.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.')},setEulerFromQuaternion:function(){console.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.')},getPositionFromMatrix:function(Fu){return console.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().'),this.setFromMatrixPosition(Fu)},getScaleFromMatrix:function(Fu){return console.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().'),this.setFromMatrixScale(Fu)},getColumnFromMatrix:function(Fu,Hu){return console.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().'),this.setFromMatrixColumn(Hu,Fu)},applyProjection:function(Fu){return console.warn('THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.'),this.applyMatrix4(Fu)},fromAttribute:function(Fu,Hu,Vu){return console.warn('THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Fu,Hu,Vu)},distanceToManhattan:function(Fu){return console.warn('THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(Fu)},lengthManhattan:function(){return console.warn('THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(I.prototype,{fromAttribute:function(Fu,Hu,Vu){return console.warn('THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Fu,Hu,Vu)},lengthManhattan:function(){return console.warn('THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(ee.prototype,{computeTangents:function(){console.error('THREE.Geometry: .computeTangents() has been removed.')},computeLineDistances:function(){console.error('THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.')}}),Object.assign(K.prototype,{getChildByName:function(Fu){return console.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().'),this.getObjectByName(Fu)},renderDepth:function(){console.warn('THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.')},translate:function(Fu,Hu){return console.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.'),this.translateOnAxis(Hu,Fu)},getWorldRotation:function(){console.error('THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.')}}),Object.defineProperties(K.prototype,{eulerOrder:{get:function(){return console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order},set:function(Fu){console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order=Fu}},useQuaternion:{get:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')},set:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')}}}),Object.defineProperties(_r.prototype,{objects:{get:function(){return console.warn('THREE.LOD: .objects has been renamed to .levels.'),this.levels}}}),Object.defineProperty(br.prototype,'useVertexTexture',{get:function(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')},set:function(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')}}),Object.defineProperty(zo.prototype,'__arcLengthDivisions',{get:function(){return console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions},set:function(Fu){console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions=Fu}}),nr.prototype.setLens=function(Fu,Hu){console.warn('THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.'),Hu!==void 0&&(this.filmGauge=Hu),this.setFocalLength(Fu)},Object.defineProperties(ii.prototype,{onlyShadow:{set:function(){console.warn('THREE.Light: .onlyShadow has been removed.')}},shadowCameraFov:{set:function(Fu){console.warn('THREE.Light: .shadowCameraFov is now .shadow.camera.fov.'),this.shadow.camera.fov=Fu}},shadowCameraLeft:{set:function(Fu){console.warn('THREE.Light: .shadowCameraLeft is now .shadow.camera.left.'),this.shadow.camera.left=Fu}},shadowCameraRight:{set:function(Fu){console.warn('THREE.Light: .shadowCameraRight is now .shadow.camera.right.'),this.shadow.camera.right=Fu}},shadowCameraTop:{set:function(Fu){console.warn('THREE.Light: .shadowCameraTop is now .shadow.camera.top.'),this.shadow.camera.top=Fu}},shadowCameraBottom:{set:function(Fu){console.warn('THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.'),this.shadow.camera.bottom=Fu}},shadowCameraNear:{set:function(Fu){console.warn('THREE.Light: .shadowCameraNear is now .shadow.camera.near.'),this.shadow.camera.near=Fu}},shadowCameraFar:{set:function(Fu){console.warn('THREE.Light: .shadowCameraFar is now .shadow.camera.far.'),this.shadow.camera.far=Fu}},shadowCameraVisible:{set:function(){console.warn('THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.')}},shadowBias:{set:function(Fu){console.warn('THREE.Light: .shadowBias is now .shadow.bias.'),this.shadow.bias=Fu}},shadowDarkness:{set:function(){console.warn('THREE.Light: .shadowDarkness has been removed.')}},shadowMapWidth:{set:function(Fu){console.warn('THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.'),this.shadow.mapSize.width=Fu}},shadowMapHeight:{set:function(Fu){console.warn('THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.'),this.shadow.mapSize.height=Fu}}}),Object.defineProperties(re.prototype,{length:{get:function(){return console.warn('THREE.BufferAttribute: .length has been deprecated. Use .count instead.'),this.array.length}},copyIndicesArray:function(){console.error('THREE.BufferAttribute: .copyIndicesArray() has been removed.')}}),Object.assign(xe.prototype,{addIndex:function(Fu){console.warn('THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().'),this.setIndex(Fu)},addDrawCall:function(Fu,Hu,Vu){Vu!==void 0&&console.warn('THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.'),console.warn('THREE.BufferGeometry: .addDrawCall() is now .addGroup().'),this.addGroup(Fu,Hu)},clearDrawCalls:function(){console.warn('THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().'),this.clearGroups()},computeTangents:function(){console.warn('THREE.BufferGeometry: .computeTangents() has been removed.')},computeOffsets:function(){console.warn('THREE.BufferGeometry: .computeOffsets() has been removed.')}}),Object.defineProperties(xe.prototype,{drawcalls:{get:function(){return console.error('THREE.BufferGeometry: .drawcalls has been renamed to .groups.'),this.groups}},offsets:{get:function(){return console.warn('THREE.BufferGeometry: .offsets has been renamed to .groups.'),this.groups}}}),Object.assign(Ra.prototype,{getArrays:function(){console.error('THREE.ExtrudeBufferGeometry: .getArrays() has been removed.')},addShapeList:function(){console.error('THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.')},addShape:function(){console.error('THREE.ExtrudeBufferGeometry: .addShape() has been removed.')}}),Object.defineProperties(Hi.prototype,{dynamic:{set:function(){console.warn('THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.')}},onUpdate:{value:function(){return console.warn('THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.'),this}}}),Object.defineProperties(Te.prototype,{wrapAround:{get:function(){console.warn('THREE.Material: .wrapAround has been removed.')},set:function(){console.warn('THREE.Material: .wrapAround has been removed.')}},overdraw:{get:function(){console.warn('THREE.Material: .overdraw has been removed.')},set:function(){console.warn('THREE.Material: .overdraw has been removed.')}},wrapRGB:{get:function(){return console.warn('THREE.Material: .wrapRGB has been removed.'),new W}},shading:{get:function(){console.error('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.')},set:function(Fu){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=Fu===Bn}}}),Object.defineProperties(ao.prototype,{metal:{get:function(){return console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.'),!1},set:function(){console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead')}}}),Object.defineProperties(Ee.prototype,{derivatives:{get:function(){return console.warn('THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives},set:function(Fu){console.warn('THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives=Fu}}}),Object.assign(cr.prototype,{clearTarget:function(Fu,Hu,Vu,ku){console.warn('THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.'),this.setRenderTarget(Fu),this.clear(Hu,Vu,ku)},animate:function(Fu){console.warn('THREE.WebGLRenderer: .animate() is now .setAnimationLoop().'),this.setAnimationLoop(Fu)},getCurrentRenderTarget:function(){return console.warn('THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().'),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn('THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().'),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn('THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.'),this.capabilities.precision},resetGLState:function(){return console.warn('THREE.WebGLRenderer: .resetGLState() is now .state.reset().'),this.state.reset()},supportsFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \'OES_texture_float\' ).'),this.extensions.get('OES_texture_float')},supportsHalfFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \'OES_texture_half_float\' ).'),this.extensions.get('OES_texture_half_float')},supportsStandardDerivatives:function(){return console.warn('THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \'OES_standard_derivatives\' ).'),this.extensions.get('OES_standard_derivatives')},supportsCompressedTextureS3TC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \'WEBGL_compressed_texture_s3tc\' ).'),this.extensions.get('WEBGL_compressed_texture_s3tc')},supportsCompressedTexturePVRTC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \'WEBGL_compressed_texture_pvrtc\' ).'),this.extensions.get('WEBGL_compressed_texture_pvrtc')},supportsBlendMinMax:function(){return console.warn('THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \'EXT_blend_minmax\' ).'),this.extensions.get('EXT_blend_minmax')},supportsVertexTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.'),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn('THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \'ANGLE_instanced_arrays\' ).'),this.extensions.get('ANGLE_instanced_arrays')},enableScissorTest:function(Fu){console.warn('THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().'),this.setScissorTest(Fu)},initMaterial:function(){console.warn('THREE.WebGLRenderer: .initMaterial() has been removed.')},addPrePlugin:function(){console.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.')},addPostPlugin:function(){console.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.')},updateShadowMap:function(){console.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.')},setFaceCulling:function(){console.warn('THREE.WebGLRenderer: .setFaceCulling() has been removed.')}}),Object.defineProperties(cr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(Fu){console.warn('THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.'),this.shadowMap.enabled=Fu}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(Fu){console.warn('THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.'),this.shadowMap.type=Fu}},shadowMapCullFace:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.')}}}),Object.defineProperties(er.prototype,{cullFace:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.')}},renderReverseSided:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.')}},renderSingleSided:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.')}}}),Object.defineProperties(D.prototype,{wrapS:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS=Fu}},wrapT:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT=Fu}},magFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter=Fu}},minFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter=Fu}},anisotropy:{get:function(){return console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy=Fu}},offset:{get:function(){return console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset=Fu}},repeat:{get:function(){return console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat=Fu}},format:{get:function(){return console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format=Fu}},type:{get:function(){return console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type=Fu}},generateMipmaps:{get:function(){return console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps},set:function(Fu){console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps=Fu}}}),Object.defineProperties(pr.prototype,{standing:{set:function(){console.warn('THREE.WebVRManager: .standing has been removed.')}},userHeight:{set:function(){console.warn('THREE.WebVRManager: .userHeight has been removed.')}}}),Ii.prototype.load=function(Fu){console.warn('THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.');var Hu=this,Vu=new Li;return Vu.load(Fu,function(ku){Hu.setBuffer(ku)}),this},zi.prototype.getData=function(){return console.warn('THREE.AudioAnalyser: .getData() is now .getFrequencyData().'),this.getFrequencyData()},Pi.prototype.updateCubeMap=function(Fu,Hu){return console.warn('THREE.CubeCamera: .updateCubeMap() is now .update().'),this.update(Fu,Hu)},hp.crossOrigin=void 0,hp.loadTexture=function(Fu,Hu,Vu,ku){console.warn('THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.');var Wu=new Do;Wu.setCrossOrigin(this.crossOrigin);var ju=Wu.load(Fu,Vu,void 0,ku);return Hu&&(ju.mapping=Hu),ju},hp.loadTextureCube=function(Fu,Hu,Vu,ku){console.warn('THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.');var Wu=new Io;Wu.setCrossOrigin(this.crossOrigin);var ju=Wu.load(Fu,Vu,void 0,ku);return Hu&&(ju.mapping=Hu),ju},hp.loadCompressedTexture=function(){console.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')},hp.loadCompressedTextureCube=function(){console.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')};var Iu,Du,zu,Nu,Bu,Uu;const Ou=0.02;$(document).ready(function(){vn()?(bn(),En()):alert('Your graphics card does not seem to support WebGL.\n This game will not work.')})})();