(function(){'use strict';function M(){}function S(Vu,ku){this.x=Vu||0,this.y=ku||0}function E(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')}function L(Vu,ku,Wu,ju){this._x=Vu||0,this._y=ku||0,this._z=Wu||0,this._w=ju===void 0?1:ju}function A(Vu,ku,Wu){this.x=Vu||0,this.y=ku||0,this.z=Wu||0}function C(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')}function R(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu){Object.defineProperty(this,'id',{value:xp++}),this.uuid=hp.generateUUID(),this.name='',this.image=Vu===void 0?R.DEFAULT_IMAGE:Vu,this.mipmaps=[],this.mapping=ku===void 0?R.DEFAULT_MAPPING:ku,this.wrapS=Wu===void 0?Bs:Wu,this.wrapT=ju===void 0?Bs:ju,this.magFilter=qu===void 0?Hs:qu,this.minFilter=Xu===void 0?ks:Xu,this.anisotropy=Ju===void 0?1:Ju,this.format=Yu===void 0?ll:Yu,this.type=Zu===void 0?Ws:Zu,this.offset=new S(0,0),this.repeat=new S(1,1),this.center=new S(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new C,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Qu===void 0?ap:Qu,this.version=0,this.onUpdate=null}function I(Vu,ku,Wu,ju){this.x=Vu||0,this.y=ku||0,this.z=Wu||0,this.w=ju===void 0?1:ju}function D(Vu,ku,Wu){this.width=Vu,this.height=ku,this.scissor=new I(0,0,Vu,ku),this.scissorTest=!1,this.viewport=new I(0,0,Vu,ku),Wu=Wu||{},Wu.minFilter===void 0&&(Wu.minFilter=Hs),this.texture=new R(void 0,void 0,Wu.wrapS,Wu.wrapT,Wu.magFilter,Wu.minFilter,Wu.format,Wu.type,Wu.anisotropy,Wu.encoding),this.texture.generateMipmaps=!(Wu.generateMipmaps!==void 0)||Wu.generateMipmaps,this.depthBuffer=!(Wu.depthBuffer!==void 0)||Wu.depthBuffer,this.stencilBuffer=!(Wu.stencilBuffer!==void 0)||Wu.stencilBuffer,this.depthTexture=Wu.depthTexture===void 0?null:Wu.depthTexture}function U(Vu,ku,Wu){D.call(this,Vu,ku,Wu),this.activeCubeFace=0,this.activeMipMapLevel=0}function G(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu,Ku,$u){R.call(this,null,Xu,Yu,Zu,Ju,Qu,ju,qu,Ku,$u),this.image={data:Vu,width:ku,height:Wu},this.magFilter=Ju===void 0?Gs:Ju,this.minFilter=Qu===void 0?Gs:Qu,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function O(Vu,ku){this.min=Vu===void 0?new A(+Infinity,+Infinity,+Infinity):Vu,this.max=ku===void 0?new A(-Infinity,-Infinity,-Infinity):ku}function F(Vu,ku){this.center=Vu===void 0?new A:Vu,this.radius=ku===void 0?0:ku}function H(Vu,ku){this.normal=Vu===void 0?new A(1,0,0):Vu,this.constant=ku===void 0?0:ku}function V(Vu,ku,Wu,ju,qu,Xu){this.planes=[Vu===void 0?new H:Vu,ku===void 0?new H:ku,Wu===void 0?new H:Wu,ju===void 0?new H:ju,qu===void 0?new H:qu,Xu===void 0?new H:Xu]}function W(Vu,ku,Wu){return void 0===ku&&void 0===Wu?this.set(Vu):this.setRGB(Vu,ku,Wu)}function X(){function Vu(qu,Xu){!1===Wu||(ju(qu,Xu),ku.requestAnimationFrame(Vu))}var ku=null,Wu=!1,ju=null;return{start:function(){!0==Wu||null==ju||(ku.requestAnimationFrame(Vu),Wu=!0)},stop:function(){Wu=!1},setAnimationLoop:function(qu){ju=qu},setContext:function(qu){ku=qu}}}function Y(Vu){function ku(Zu,Ju){var Qu=Zu.array,Ku=Zu.dynamic?35048:35044,$u=Vu.createBuffer();Vu.bindBuffer(Ju,$u),Vu.bufferData(Ju,Qu,Ku),Zu.onUploadCallback();var em=5126;return Qu instanceof Float32Array?em=5126:Qu instanceof Float64Array?console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.'):Qu instanceof Uint16Array?em=5123:Qu instanceof Int16Array?em=5122:Qu instanceof Uint32Array?em=5125:Qu instanceof Int32Array?em=5124:Qu instanceof Int8Array?em=5120:Qu instanceof Uint8Array&&(em=5121),{buffer:$u,type:em,bytesPerElement:Qu.BYTES_PER_ELEMENT,version:Zu.version}}function Wu(Zu,Ju,Qu){var Ku=Ju.array,$u=Ju.updateRange;Vu.bindBuffer(Qu,Zu),!1===Ju.dynamic?Vu.bufferData(Qu,Ku,35044):-1===$u.count?Vu.bufferSubData(Qu,0,Ku):0===$u.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):(Vu.bufferSubData(Qu,$u.offset*Ku.BYTES_PER_ELEMENT,Ku.subarray($u.offset,$u.offset+$u.count)),$u.count=-1)}var Yu=new WeakMap;return{get:function(Zu){return Zu.isInterleavedBufferAttribute&&(Zu=Zu.data),Yu.get(Zu)},remove:function(Zu){Zu.isInterleavedBufferAttribute&&(Zu=Zu.data);var Ju=Yu.get(Zu);Ju&&(Vu.deleteBuffer(Ju.buffer),Yu.delete(Zu))},update:function(Zu,Ju){Zu.isInterleavedBufferAttribute&&(Zu=Zu.data);var Qu=Yu.get(Zu);Qu===void 0?Yu.set(Zu,ku(Zu,Ju)):Qu.version<Zu.version&&(Wu(Qu.buffer,Zu,Ju),Qu.version=Zu.version)}}}function Z(Vu,ku,Wu,ju,qu,Xu){this.a=Vu,this.b=ku,this.c=Wu,this.normal=ju&&ju.isVector3?ju:new A,this.vertexNormals=Array.isArray(ju)?ju:[],this.color=qu&&qu.isColor?qu:new W,this.vertexColors=Array.isArray(qu)?qu:[],this.materialIndex=Xu===void 0?0:Xu}function J(Vu,ku,Wu,ju){this._x=Vu||0,this._y=ku||0,this._z=Wu||0,this._order=ju||J.DefaultOrder}function Q(){this.mask=1}function K(){Object.defineProperty(this,'id',{value:Vc++}),this.uuid=hp.generateUUID(),this.name='',this.type='Object3D',this.parent=null,this.children=[],this.up=K.DefaultUp.clone();var Wu=new A,ju=new J,qu=new L,Xu=new A(1,1,1);ju.onChange(function(){qu.setFromEuler(ju,!1)}),qu.onChange(function(){ju.setFromQuaternion(qu,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:Wu},rotation:{configurable:!0,enumerable:!0,value:ju},quaternion:{configurable:!0,enumerable:!0,value:qu},scale:{configurable:!0,enumerable:!0,value:Xu},modelViewMatrix:{value:new E},normalMatrix:{value:new C}}),this.matrix=new E,this.matrixWorld=new E,this.matrixAutoUpdate=K.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Q,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ee(){Object.defineProperty(this,'id',{value:kc+=2}),this.uuid=hp.generateUUID(),this.name='',this.type='Geometry',this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function re(Vu,ku,Wu){if(Array.isArray(Vu))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.name='',this.array=Vu,this.itemSize=ku,this.count=Vu===void 0?0:Vu.length/ku,this.normalized=!0===Wu,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function oe(Vu,ku,Wu){re.call(this,new Int8Array(Vu),ku,Wu)}function ie(Vu,ku,Wu){re.call(this,new Uint8Array(Vu),ku,Wu)}function ne(Vu,ku,Wu){re.call(this,new Uint8ClampedArray(Vu),ku,Wu)}function se(Vu,ku,Wu){re.call(this,new Int16Array(Vu),ku,Wu)}function le(Vu,ku,Wu){re.call(this,new Uint16Array(Vu),ku,Wu)}function pe(Vu,ku,Wu){re.call(this,new Int32Array(Vu),ku,Wu)}function ue(Vu,ku,Wu){re.call(this,new Uint32Array(Vu),ku,Wu)}function ge(Vu,ku,Wu){re.call(this,new Float32Array(Vu),ku,Wu)}function fe(Vu,ku,Wu){re.call(this,new Float64Array(Vu),ku,Wu)}function he(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function ye(Vu){if(0===Vu.length)return-Infinity;for(var ku=Vu[0],Wu=1,ju=Vu.length;Wu<ju;++Wu)Vu[Wu]>ku&&(ku=Vu[Wu]);return ku}function xe(){Object.defineProperty(this,'id',{value:Wc+=2}),this.uuid=hp.generateUUID(),this.name='',this.type='BufferGeometry',this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:Infinity},this.userData={}}function ve(Vu,ku,Wu,ju,qu,Xu){ee.call(this),this.type='BoxGeometry',this.parameters={width:Vu,height:ku,depth:Wu,widthSegments:ju,heightSegments:qu,depthSegments:Xu},this.fromBufferGeometry(new _e(Vu,ku,Wu,ju,qu,Xu)),this.mergeVertices()}function _e(Vu,ku,Wu,ju,qu,Xu){function Yu(rm,am,om,im,nm,sm,lm,pm,dm,cm,um){var xm=dm+1,_m=0,bm=0,Mm,Sm,Tm=new A;for(Sm=0;Sm<cm+1;Sm++){var Em=Sm*(lm/cm)-lm/2;for(Mm=0;Mm<xm;Mm++){var wm=Mm*(sm/dm)-sm/2;Tm[rm]=wm*im,Tm[am]=Em*nm,Tm[om]=pm/2,Qu.push(Tm.x,Tm.y,Tm.z),Tm[rm]=0,Tm[am]=0,Tm[om]=0<pm?1:-1,Ku.push(Tm.x,Tm.y,Tm.z),$u.push(Mm/dm),$u.push(1-Sm/cm),_m+=1}}for(Sm=0;Sm<cm;Sm++)for(Mm=0;Mm<dm;Mm++){var Lm=em+Mm+xm*Sm,Am=em+Mm+xm*(Sm+1),Pm=em+(Mm+1)+xm*(Sm+1),Cm=em+(Mm+1)+xm*Sm;Ju.push(Lm,Am,Cm),Ju.push(Am,Pm,Cm),bm+=6}Zu.addGroup(tm,bm,um),tm+=bm,em+=_m}xe.call(this),this.type='BoxBufferGeometry',this.parameters={width:Vu,height:ku,depth:Wu,widthSegments:ju,heightSegments:qu,depthSegments:Xu};var Zu=this;Vu=Vu||1,ku=ku||1,Wu=Wu||1,ju=Math.floor(ju)||1,qu=Math.floor(qu)||1,Xu=Math.floor(Xu)||1;var Ju=[],Qu=[],Ku=[],$u=[],em=0,tm=0;Yu('z','y','x',-1,-1,Wu,ku,Vu,Xu,qu,0),Yu('z','y','x',1,-1,Wu,ku,-Vu,Xu,qu,1),Yu('x','z','y',1,1,Vu,Wu,ku,ju,Xu,2),Yu('x','z','y',1,-1,Vu,Wu,-ku,ju,Xu,3),Yu('x','y','z',1,-1,Vu,ku,Wu,ju,qu,4),Yu('x','y','z',-1,-1,Vu,ku,-Wu,ju,qu,5),this.setIndex(Ju),this.addAttribute('position',new ge(Qu,3)),this.addAttribute('normal',new ge(Ku,3)),this.addAttribute('uv',new ge($u,2))}function Me(Vu,ku,Wu,ju){ee.call(this),this.type='PlaneGeometry',this.parameters={width:Vu,height:ku,widthSegments:Wu,heightSegments:ju},this.fromBufferGeometry(new Se(Vu,ku,Wu,ju)),this.mergeVertices()}function Se(Vu,ku,Wu,ju){xe.call(this),this.type='PlaneBufferGeometry',this.parameters={width:Vu,height:ku,widthSegments:Wu,heightSegments:ju},Vu=Vu||1,ku=ku||1;var qu=Vu/2,Xu=ku/2,Yu=Math.floor(Wu)||1,Zu=Math.floor(ju)||1,Ju=Yu+1,Ku=Vu/Yu,$u=ku/Zu,em,tm,rm=[],am=[],om=[],im=[];for(tm=0;tm<Zu+1;tm++){var nm=tm*$u-Xu;for(em=0;em<Ju;em++){var sm=em*Ku-qu;am.push(sm,-nm,0),om.push(0,0,1),im.push(em/Yu),im.push(1-tm/Zu)}}for(tm=0;tm<Zu;tm++)for(em=0;em<Yu;em++){var lm=em+Ju*tm,pm=em+Ju*(tm+1),dm=em+1+Ju*(tm+1),cm=em+1+Ju*tm;rm.push(lm,pm,cm),rm.push(pm,dm,cm)}this.setIndex(rm),this.addAttribute('position',new ge(am,3)),this.addAttribute('normal',new ge(om,3)),this.addAttribute('uv',new ge(im,2))}function Te(){Object.defineProperty(this,'id',{value:jc++}),this.uuid=hp.generateUUID(),this.name='',this.type='Material',this.fog=!0,this.lights=!0,this.blending=Vn,this.side=zn,this.flatShading=!1,this.vertexColors=Gn,this.opacity=1,this.transparent=!1,this.blendSrc=rs,this.blendDst=as,this.blendEquation=Xn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ms,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function Ee(Vu){Te.call(this),this.type='ShaderMaterial',this.defines={},this.uniforms={},this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}',this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}',this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,Vu!==void 0&&(Vu.attributes!==void 0&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(Vu))}function we(Vu,ku){this.origin=Vu===void 0?new A:Vu,this.direction=ku===void 0?new A:ku}function Le(Vu,ku,Wu){this.a=Vu===void 0?new A:Vu,this.b=ku===void 0?new A:ku,this.c=Wu===void 0?new A:Wu}function Ae(Vu){Te.call(this),this.type='MeshBasicMaterial',this.color=new W(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=xs,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(Vu)}function Pe(Vu,ku){K.call(this),this.type='Mesh',this.geometry=Vu===void 0?new xe:Vu,this.material=ku===void 0?new Ae({color:16777215*Math.random()}):ku,this.drawMode=ep,this.updateMorphTargets()}function Ce(Vu,ku,Wu,ju){function Xu(Ku,$u){ku.buffers.color.setClear(Ku.r,Ku.g,Ku.b,$u,ju)}var Yu=new W(0),Zu=0,Ju,Qu;return{getClearColor:function(){return Yu},setClearColor:function(Ku,$u){Yu.set(Ku),Zu=$u===void 0?1:$u,Xu(Yu,Zu)},getClearAlpha:function(){return Zu},setClearAlpha:function(Ku){Zu=Ku,Xu(Yu,Zu)},render:function(Ku,$u,em,tm){var rm=$u.background;null===rm?Xu(Yu,Zu):rm&&rm.isColor&&(Xu(rm,1),tm=!0),(Vu.autoClear||tm)&&Vu.clear(Vu.autoClearColor,Vu.autoClearDepth,Vu.autoClearStencil),rm&&(rm.isCubeTexture||rm.isWebGLRenderTargetCube)?(Qu===void 0&&(Qu=new Pe(new _e(1,1,1),new Ee({type:'BackgroundCubeMaterial',uniforms:Gc.clone(Hc.cube.uniforms),vertexShader:Hc.cube.vertexShader,fragmentShader:Hc.cube.fragmentShader,side:Nn,depthTest:!0,depthWrite:!1,fog:!1})),Qu.geometry.removeAttribute('normal'),Qu.geometry.removeAttribute('uv'),Qu.onBeforeRender=function(am,om,im){this.matrixWorld.copyPosition(im.matrixWorld)},Object.defineProperty(Qu.material,'envMap',{get:function(){return this.uniforms.tCube.value}}),Wu.update(Qu)),Qu.material.uniforms.tCube.value=rm.isWebGLRenderTargetCube?rm.texture:rm,Qu.material.uniforms.tFlip.value=rm.isWebGLRenderTargetCube?1:-1,Ku.push(Qu,Qu.geometry,Qu.material,0,null)):rm&&rm.isTexture&&(Ju===void 0&&(Ju=new Pe(new Se(2,2),new Ee({type:'BackgroundMaterial',uniforms:Gc.clone(Hc.background.uniforms),vertexShader:Hc.background.vertexShader,fragmentShader:Hc.background.fragmentShader,side:zn,depthTest:!0,depthWrite:!1,fog:!1})),Ju.geometry.removeAttribute('normal'),Object.defineProperty(Ju.material,'map',{get:function(){return this.uniforms.t2D.value}}),Wu.update(Ju)),Ju.material.uniforms.t2D.value=rm,!0===rm.matrixAutoUpdate&&rm.updateMatrix(),Ju.material.uniforms.uvTransform.value.copy(rm.matrix),Ku.push(Ju,Ju.geometry,Ju.material,0,null))}}}function Re(Vu,ku,Wu,ju){var Zu;this.setMode=function(Ju){Zu=Ju},this.render=function(Ju,Qu){Vu.drawArrays(Zu,Ju,Qu),Wu.update(Qu,Zu)},this.renderInstances=function(Ju,Qu,Ku){var $u;if(ju.isWebGL2)$u=Vu;else if($u=ku.get('ANGLE_instanced_arrays'),null===$u)return void console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');$u[ju.isWebGL2?'drawArraysInstanced':'drawArraysInstancedANGLE'](Zu,Qu,Ku,Ju.maxInstancedCount),Wu.update(Ku,Zu,Ju.maxInstancedCount)}}function Ie(Vu,ku,Wu){function qu(pm){if('highp'===pm){if(0<Vu.getShaderPrecisionFormat(35633,36338).precision&&0<Vu.getShaderPrecisionFormat(35632,36338).precision)return'highp';pm='mediump'}return'mediump'===pm&&0<Vu.getShaderPrecisionFormat(35633,36337).precision&&0<Vu.getShaderPrecisionFormat(35632,36337).precision?'mediump':'lowp'}var Xu,Yu='undefined'!=typeof WebGL2RenderingContext&&Vu instanceof WebGL2RenderingContext,Zu=Wu.precision===void 0?'highp':Wu.precision,Ju=qu(Zu);Ju!==Zu&&(console.warn('THREE.WebGLRenderer:',Zu,'not supported, using',Ju,'instead.'),Zu=Ju);var Qu=!0===Wu.logarithmicDepthBuffer,Ku=Vu.getParameter(34930),$u=Vu.getParameter(35660),em=Vu.getParameter(3379),tm=Vu.getParameter(34076),rm=Vu.getParameter(34921),am=Vu.getParameter(36347),om=Vu.getParameter(36348),im=Vu.getParameter(36349),nm=0<$u,sm=Yu||!!ku.get('OES_texture_float');return{isWebGL2:Yu,getMaxAnisotropy:function(){if(void 0!==Xu)return Xu;var pm=ku.get('EXT_texture_filter_anisotropic');return Xu=null===pm?0:Vu.getParameter(pm.MAX_TEXTURE_MAX_ANISOTROPY_EXT),Xu},getMaxPrecision:qu,precision:Zu,logarithmicDepthBuffer:Qu,maxTextures:Ku,maxVertexTextures:$u,maxTextureSize:em,maxCubemapSize:tm,maxAttributes:rm,maxVertexUniforms:am,maxVaryings:om,maxFragmentUniforms:im,vertexTextures:nm,floatFragmentTextures:sm,floatVertexTextures:nm&&sm}}function De(){function Vu(){Qu.value!==ju&&(Qu.value=ju,Qu.needsUpdate=0<qu),Wu.numPlanes=qu,Wu.numIntersection=0}function ku(Ku,$u,em,tm){var rm=null===Ku?0:Ku.length,am=null;if(0!==rm){if(am=Qu.value,!0!==tm||null==am){var om=em+4*rm,im=$u.matrixWorldInverse;Ju.getNormalMatrix(im),(null==am||am.length<om)&&(am=new Float32Array(om));for(var nm=0,sm=em;nm!==rm;++nm,sm+=4)Zu.copy(Ku[nm]).applyMatrix4(im,Ju),Zu.normal.toArray(am,sm),am[sm+3]=Zu.constant}Qu.value=am,Qu.needsUpdate=!0}return Wu.numPlanes=rm,am}var Wu=this,ju=null,qu=0,Xu=!1,Yu=!1,Zu=new H,Ju=new C,Qu={value:null,needsUpdate:!1};this.uniform=Qu,this.numPlanes=0,this.numIntersection=0,this.init=function(Ku,$u,em){var tm=0!==Ku.length||$u||0!=qu||Xu;return Xu=$u,ju=ku(Ku,em,0),qu=Ku.length,tm},this.beginShadows=function(){Yu=!0,ku(null)},this.endShadows=function(){Yu=!1,Vu()},this.setState=function(Ku,$u,em,tm,rm,am){if(!Xu||null===Ku||0===Ku.length||Yu&&!em)Yu?ku(null):Vu();else{var om=Yu?0:qu,im=4*om,nm=rm.clippingState||null;Qu.value=nm,nm=ku(Ku,tm,im,am);for(var sm=0;sm!==im;++sm)nm[sm]=ju[sm];rm.clippingState=nm,this.numIntersection=$u?this.numPlanes:0,this.numPlanes+=om}}}function ze(Vu){var ku={};return{get:function(Wu){if(void 0!==ku[Wu])return ku[Wu];var ju;return ju='WEBGL_depth_texture'===Wu?Vu.getExtension('WEBGL_depth_texture')||Vu.getExtension('MOZ_WEBGL_depth_texture')||Vu.getExtension('WEBKIT_WEBGL_depth_texture'):'EXT_texture_filter_anisotropic'===Wu?Vu.getExtension('EXT_texture_filter_anisotropic')||Vu.getExtension('MOZ_EXT_texture_filter_anisotropic')||Vu.getExtension('WEBKIT_EXT_texture_filter_anisotropic'):'WEBGL_compressed_texture_s3tc'===Wu?Vu.getExtension('WEBGL_compressed_texture_s3tc')||Vu.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||Vu.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc'):'WEBGL_compressed_texture_pvrtc'===Wu?Vu.getExtension('WEBGL_compressed_texture_pvrtc')||Vu.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'):Vu.getExtension(Wu),null===ju&&console.warn('THREE.WebGLRenderer: '+Wu+' extension not supported.'),ku[Wu]=ju,ju}}}function Ne(Vu,ku,Wu){function ju(Qu){var Ku=Qu.target,$u=Zu[Ku.id];for(var em in null!==$u.index&&ku.remove($u.index),$u.attributes)ku.remove($u.attributes[em]);Ku.removeEventListener('dispose',ju),delete Zu[Ku.id];var tm=Ju[$u.id];tm&&(ku.remove(tm),delete Ju[$u.id]),Wu.memory.geometries--}var Zu={},Ju={};return{get:function(Qu,Ku){var $u=Zu[Ku.id];return $u?$u:(Ku.addEventListener('dispose',ju),Ku.isBufferGeometry?$u=Ku:Ku.isGeometry&&(void 0===Ku._bufferGeometry&&(Ku._bufferGeometry=new xe().setFromObject(Qu)),$u=Ku._bufferGeometry),Zu[Ku.id]=$u,Wu.memory.geometries++,$u)},update:function(Qu){var Ku=Qu.index,$u=Qu.attributes;for(var em in null!==Ku&&ku.update(Ku,34963),$u)ku.update($u[em],34962);var tm=Qu.morphAttributes;for(var em in tm)for(var rm=tm[em],am=0,om=rm.length;am<om;am++)ku.update(rm[am],34962)},getWireframeAttribute:function(Qu){var Ku=Ju[Qu.id];if(Ku)return Ku;var $u=[],em=Qu.index,tm=Qu.attributes;if(null!==em)for(var rm=em.array,am=0,om=rm.length;am<om;am+=3){var im=rm[am+0],nm=rm[am+1],sm=rm[am+2];$u.push(im,nm,nm,sm,sm,im)}else for(var rm=tm.position.array,am=0,om=rm.length/3-1;am<om;am+=3){var im=am+0,nm=am+1,sm=am+2;$u.push(im,nm,nm,sm,sm,im)}return Ku=new(65535<ye($u)?ue:le)($u,1),ku.update(Ku,34963),Ju[Qu.id]=Ku,Ku}}}function Be(Vu,ku,Wu,ju){var Ju,Qu,Ku;this.setMode=function($u){Ju=$u},this.setIndex=function($u){Qu=$u.type,Ku=$u.bytesPerElement},this.render=function($u,em){Vu.drawElements(Ju,em,Qu,$u*Ku),Wu.update(em,Ju)},this.renderInstances=function($u,em,tm){var rm;if(ju.isWebGL2)rm=Vu;else{var rm=ku.get('ANGLE_instanced_arrays');if(null===rm)return void console.error('THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.')}rm[ju.isWebGL2?'drawElementsInstanced':'drawElementsInstancedANGLE'](Ju,tm,Qu,em*Ku,$u.maxInstancedCount),Wu.update(tm,Ju,$u.maxInstancedCount)}}function Ue(){var qu={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:qu,programs:null,autoReset:!0,reset:function(){qu.frame++,qu.calls=0,qu.triangles=0,qu.points=0,qu.lines=0},update:function(Xu,Yu,Zu){switch(Zu=Zu||1,qu.calls++,Yu){case 4:qu.triangles+=Zu*(Xu/3);break;case 5:case 6:qu.triangles+=Zu*(Xu-2);break;case 1:qu.lines+=Zu*(Xu/2);break;case 3:qu.lines+=Zu*(Xu-1);break;case 2:qu.lines+=Zu*Xu;break;case 0:qu.points+=Zu*Xu;break;default:console.error('THREE.WebGLInfo: Unknown draw mode:',Yu);}}}}function Ge(Vu,ku){return Math.abs(ku[1])-Math.abs(Vu[1])}function Oe(Vu){var Wu={},ju=new Float32Array(8);return{update:function(qu,Xu,Yu,Zu){var Ju=qu.morphTargetInfluences,Qu=Ju.length,Ku=Wu[Xu.id];if(Ku===void 0){Ku=[];for(var $u=0;$u<Qu;$u++)Ku[$u]=[$u,0];Wu[Xu.id]=Ku}for(var em=Yu.morphTargets&&Xu.morphAttributes.position,tm=Yu.morphNormals&&Xu.morphAttributes.normal,$u=0,rm;$u<Qu;$u++)rm=Ku[$u],0!==rm[1]&&(em&&Xu.removeAttribute('morphTarget'+$u),tm&&Xu.removeAttribute('morphNormal'+$u));for(var $u=0,rm;$u<Qu;$u++)rm=Ku[$u],rm[0]=$u,rm[1]=Ju[$u];Ku.sort(Ge);for(var $u=0,rm;8>$u;$u++){if(rm=Ku[$u],rm){var am=rm[0],om=rm[1];if(om){em&&Xu.addAttribute('morphTarget'+$u,em[am]),tm&&Xu.addAttribute('morphNormal'+$u,tm[am]),ju[$u]=om;continue}}ju[$u]=0}Zu.getUniforms().setValue(Vu,'morphTargetInfluences',ju)}}}function Fe(Vu,ku){var qu={};return{update:function(Xu){var Yu=ku.render.frame,Zu=Xu.geometry,Ju=Vu.get(Xu,Zu);return qu[Ju.id]!==Yu&&(Zu.isGeometry&&Ju.updateFromObject(Xu),Vu.update(Ju),qu[Ju.id]=Yu),Ju},dispose:function(){qu={}}}}function He(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu){Vu=Vu===void 0?[]:Vu,ku=ku===void 0?As:ku,R.call(this,Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu),this.flipY=!1}function Ve(Vu,ku,Wu,ju){R.call(this,null),this.image={data:Vu,width:ku,height:Wu,depth:ju},this.magFilter=Gs,this.minFilter=Gs,this.generateMipmaps=!1,this.flipY=!1}function ke(){this.seq=[],this.map={}}function We(Vu,ku,Wu){var ju=Vu[0];if(0>=ju||0<ju)return Vu;var qu=ku*Wu,Xu=Zc[qu];if(void 0===Xu&&(Xu=new Float32Array(qu),Zc[qu]=Xu),0!==ku){ju.toArray(Xu,0);for(var Yu=1,Zu=0;Yu!==ku;++Yu)Zu+=Wu,Vu[Yu].toArray(Xu,Zu)}return Xu}function je(Vu,ku){if(Vu.length!==ku.length)return!1;for(var Wu=0,ju=Vu.length;Wu<ju;Wu++)if(Vu[Wu]!==ku[Wu])return!1;return!0}function qe(Vu,ku){for(var Wu=0,ju=ku.length;Wu<ju;Wu++)Vu[Wu]=ku[Wu]}function Xe(Vu,ku){var Wu=Jc[ku];Wu===void 0&&(Wu=new Int32Array(ku),Jc[ku]=Wu);for(var ju=0;ju!==ku;++ju)Wu[ju]=Vu.allocTextureUnit();return Wu}function Ye(Vu,ku){var Wu=this.cache;Wu[0]===ku||(Vu.uniform1f(this.addr,ku),Wu[0]=ku)}function Ze(Vu,ku){var Wu=this.cache;Wu[0]===ku||(Vu.uniform1i(this.addr,ku),Wu[0]=ku)}function Je(Vu,ku){var Wu=this.cache;if(ku.x!==void 0)(Wu[0]!==ku.x||Wu[1]!==ku.y)&&(Vu.uniform2f(this.addr,ku.x,ku.y),Wu[0]=ku.x,Wu[1]=ku.y);else{if(je(Wu,ku))return;Vu.uniform2fv(this.addr,ku),qe(Wu,ku)}}function Qe(Vu,ku){var Wu=this.cache;if(ku.x!==void 0)(Wu[0]!==ku.x||Wu[1]!==ku.y||Wu[2]!==ku.z)&&(Vu.uniform3f(this.addr,ku.x,ku.y,ku.z),Wu[0]=ku.x,Wu[1]=ku.y,Wu[2]=ku.z);else if(ku.r!==void 0)(Wu[0]!==ku.r||Wu[1]!==ku.g||Wu[2]!==ku.b)&&(Vu.uniform3f(this.addr,ku.r,ku.g,ku.b),Wu[0]=ku.r,Wu[1]=ku.g,Wu[2]=ku.b);else{if(je(Wu,ku))return;Vu.uniform3fv(this.addr,ku),qe(Wu,ku)}}function Ke(Vu,ku){var Wu=this.cache;if(ku.x!==void 0)(Wu[0]!==ku.x||Wu[1]!==ku.y||Wu[2]!==ku.z||Wu[3]!==ku.w)&&(Vu.uniform4f(this.addr,ku.x,ku.y,ku.z,ku.w),Wu[0]=ku.x,Wu[1]=ku.y,Wu[2]=ku.z,Wu[3]=ku.w);else{if(je(Wu,ku))return;Vu.uniform4fv(this.addr,ku),qe(Wu,ku)}}function $e(Vu,ku){var Wu=this.cache,ju=ku.elements;if(ju===void 0){if(je(Wu,ku))return;Vu.uniformMatrix2fv(this.addr,!1,ku),qe(Wu,ku)}else{if(je(Wu,ju))return;$c.set(ju),Vu.uniformMatrix2fv(this.addr,!1,$c),qe(Wu,ju)}}function et(Vu,ku){var Wu=this.cache,ju=ku.elements;if(ju===void 0){if(je(Wu,ku))return;Vu.uniformMatrix3fv(this.addr,!1,ku),qe(Wu,ku)}else{if(je(Wu,ju))return;Kc.set(ju),Vu.uniformMatrix3fv(this.addr,!1,Kc),qe(Wu,ju)}}function tt(Vu,ku){var Wu=this.cache,ju=ku.elements;if(ju===void 0){if(je(Wu,ku))return;Vu.uniformMatrix4fv(this.addr,!1,ku),qe(Wu,ku)}else{if(je(Wu,ju))return;Qc.set(ju),Vu.uniformMatrix4fv(this.addr,!1,Qc),qe(Wu,ju)}}function rt(Vu,ku,Wu){var ju=this.cache,qu=Wu.allocTextureUnit();ju[0]!==qu&&(Vu.uniform1i(this.addr,qu),ju[0]=qu),Wu.setTexture2D(ku||qc,qu)}function at(Vu,ku,Wu){var ju=this.cache,qu=Wu.allocTextureUnit();ju[0]!==qu&&(Vu.uniform1i(this.addr,qu),ju[0]=qu),Wu.setTexture3D(ku||Xc,qu)}function ot(Vu,ku,Wu){var ju=this.cache,qu=Wu.allocTextureUnit();ju[0]!==qu&&(Vu.uniform1i(this.addr,qu),ju[0]=qu),Wu.setTextureCube(ku||Yc,qu)}function it(Vu,ku){var Wu=this.cache;je(Wu,ku)||(Vu.uniform2iv(this.addr,ku),qe(Wu,ku))}function nt(Vu,ku){var Wu=this.cache;je(Wu,ku)||(Vu.uniform3iv(this.addr,ku),qe(Wu,ku))}function st(Vu,ku){var Wu=this.cache;je(Wu,ku)||(Vu.uniform4iv(this.addr,ku),qe(Wu,ku))}function lt(Vu){return 5126===Vu?Ye:35664===Vu?Je:35665===Vu?Qe:35666===Vu?Ke:35674===Vu?$e:35675===Vu?et:35676===Vu?tt:35678===Vu||36198===Vu?rt:35679===Vu?at:35680===Vu?ot:5124===Vu||35670===Vu?Ze:35667===Vu||35671===Vu?it:35668===Vu||35672===Vu?nt:35669===Vu||35673===Vu?st:void 0}function dt(Vu,ku){var Wu=this.cache;je(Wu,ku)||(Vu.uniform1fv(this.addr,ku),qe(Wu,ku))}function ct(Vu,ku){var Wu=this.cache;je(Wu,ku)||(Vu.uniform1iv(this.addr,ku),qe(Wu,ku))}function ut(Vu,ku){var Wu=this.cache,ju=We(ku,this.size,2);je(Wu,ju)||(Vu.uniform2fv(this.addr,ju),this.updateCache(ju))}function mt(Vu,ku){var Wu=this.cache,ju=We(ku,this.size,3);je(Wu,ju)||(Vu.uniform3fv(this.addr,ju),this.updateCache(ju))}function gt(Vu,ku){var Wu=this.cache,ju=We(ku,this.size,4);je(Wu,ju)||(Vu.uniform4fv(this.addr,ju),this.updateCache(ju))}function ft(Vu,ku){var Wu=this.cache,ju=We(ku,this.size,4);je(Wu,ju)||(Vu.uniformMatrix2fv(this.addr,!1,ju),this.updateCache(ju))}function ht(Vu,ku){var Wu=this.cache,ju=We(ku,this.size,9);je(Wu,ju)||(Vu.uniformMatrix3fv(this.addr,!1,ju),this.updateCache(ju))}function yt(Vu,ku){var Wu=this.cache,ju=We(ku,this.size,16);je(Wu,ju)||(Vu.uniformMatrix4fv(this.addr,!1,ju),this.updateCache(ju))}function xt(Vu,ku,Wu){var ju=this.cache,qu=ku.length,Xu=Xe(Wu,qu);!1===je(ju,Xu)&&(Vu.uniform1iv(this.addr,Xu),qe(ju,Xu));for(var Yu=0;Yu!==qu;++Yu)Wu.setTexture2D(ku[Yu]||qc,Xu[Yu])}function vt(Vu,ku,Wu){var ju=this.cache,qu=ku.length,Xu=Xe(Wu,qu);!1===je(ju,Xu)&&(Vu.uniform1iv(this.addr,Xu),qe(ju,Xu));for(var Yu=0;Yu!==qu;++Yu)Wu.setTextureCube(ku[Yu]||Yc,Xu[Yu])}function _t(Vu){return 5126===Vu?dt:35664===Vu?ut:35665===Vu?mt:35666===Vu?gt:35674===Vu?ft:35675===Vu?ht:35676===Vu?yt:35678===Vu?xt:35680===Vu?vt:5124===Vu||35670===Vu?ct:35667===Vu||35671===Vu?it:35668===Vu||35672===Vu?nt:35669===Vu||35673===Vu?st:void 0}function bt(Vu,ku,Wu){this.id=Vu,this.addr=Wu,this.cache=[],this.setValue=lt(ku.type)}function Mt(Vu,ku,Wu){this.id=Vu,this.addr=Wu,this.cache=[],this.size=ku.size,this.setValue=_t(ku.type)}function St(Vu){this.id=Vu,ke.call(this)}function Tt(Vu,ku){Vu.seq.push(ku),Vu.map[ku.id]=ku}function Et(Vu,ku,Wu){var ju=Vu.name,qu=ju.length;for(eu.lastIndex=0;;){var Xu=eu.exec(ju),Yu=eu.lastIndex,Zu=Xu[1],Ju=']'===Xu[2],Qu=Xu[3];if(Ju&&(Zu|=0),void 0===Qu||'['===Qu&&Yu+2===qu){Tt(Wu,void 0===Qu?new bt(Zu,Vu,ku):new Mt(Zu,Vu,ku));break}else{var Ku=Wu.map,$u=Ku[Zu];void 0===$u&&($u=new St(Zu),Tt(Wu,$u)),Wu=$u}}}function wt(Vu,ku,Wu){ke.call(this),this.renderer=Wu;for(var ju=Vu.getProgramParameter(ku,35718),qu=0;qu<ju;++qu){var Xu=Vu.getActiveUniform(ku,qu),Yu=Vu.getUniformLocation(ku,Xu.name);Et(Xu,Yu,this)}}function Lt(Vu){for(var ku=Vu.split('\n'),Wu=0;Wu<ku.length;Wu++)ku[Wu]=Wu+1+': '+ku[Wu];return ku.join('\n')}function At(Vu,ku,Wu){var ju=Vu.createShader(ku);return Vu.shaderSource(ju,Wu),Vu.compileShader(ju),!1===Vu.getShaderParameter(ju,35713)&&console.error('THREE.WebGLShader: Shader couldn\'t compile.'),''!==Vu.getShaderInfoLog(ju)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',35633===ku?'vertex':'fragment',Vu.getShaderInfoLog(ju),Lt(Wu)),ju}function Pt(Vu){switch(Vu){case ap:return['Linear','( value )'];case 3001:return['sRGB','( value )'];case 3002:return['RGBE','( value )'];case 3004:return['RGBM','( value, 7.0 )'];case 3005:return['RGBM','( value, 16.0 )'];case 3006:return['RGBD','( value, 256.0 )'];case ip:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw new Error('unsupported encoding: '+Vu);}}function Ct(Vu,ku){var Wu=Pt(ku);return'vec4 '+Vu+'( vec4 value ) { return '+Wu[0]+'ToLinear'+Wu[1]+'; }'}function Rt(Vu,ku){var Wu=Pt(ku);return'vec4 '+Vu+'( vec4 value ) { return LinearTo'+Wu[0]+Wu[1]+'; }'}function It(Vu,ku){var Wu;switch(ku){case Ss:Wu='Linear';break;case 2:Wu='Reinhard';break;case 3:Wu='Uncharted2';break;case 4:Wu='OptimizedCineon';break;default:throw new Error('unsupported toneMapping: '+ku);}return'vec3 '+Vu+'( vec3 color ) { return '+Wu+'ToneMapping( color ); }'}function Dt(Vu,ku,Wu){Vu=Vu||{};var ju=[Vu.derivatives||ku.envMapCubeUV||ku.bumpMap||ku.normalMap&&!ku.objectSpaceNormalMap||ku.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(Vu.fragDepth||ku.logarithmicDepthBuffer)&&Wu.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',Vu.drawBuffers&&Wu.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(Vu.shaderTextureLOD||ku.envMap)&&Wu.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''];return ju.filter(Bt).join('\n')}function zt(Vu){var ku=[];for(var Wu in Vu){var ju=Vu[Wu];!1===ju||ku.push('#define '+Wu+' '+ju)}return ku.join('\n')}function Nt(Vu,ku){for(var Wu={},ju=Vu.getProgramParameter(ku,35721),qu=0;qu<ju;qu++){var Xu=Vu.getActiveAttrib(ku,qu),Yu=Xu.name;Wu[Yu]=Vu.getAttribLocation(ku,Yu)}return Wu}function Bt(Vu){return''!==Vu}function Ut(Vu,ku){return Vu.replace(/NUM_DIR_LIGHTS/g,ku.numDirLights).replace(/NUM_SPOT_LIGHTS/g,ku.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,ku.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,ku.numPointLights).replace(/NUM_HEMI_LIGHTS/g,ku.numHemiLights)}function Gt(Vu,ku){return Vu.replace(/NUM_CLIPPING_PLANES/g,ku.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,ku.numClippingPlanes-ku.numClipIntersection)}function Ot(Vu){var Wu=/^[ \t]*#include +<([\w\d./]+)>/gm;return Vu.replace(Wu,function(ju,qu){var Xu=Uc[qu];if(Xu===void 0)throw new Error('Can not resolve #include <'+qu+'>');return Ot(Xu)})}function Ft(Vu){var Wu=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return Vu.replace(Wu,function(ju,qu,Xu,Yu){for(var Zu='',Ju=parseInt(qu);Ju<parseInt(Xu);Ju++)Zu+=Yu.replace(/\[ i \]/g,'[ '+Ju+' ]');return Zu})}function Ht(Vu,ku,Wu,ju,qu,Xu,Yu){var Zu=Vu.context,Ju=ju.defines,Qu=qu.vertexShader,Ku=qu.fragmentShader,$u='SHADOWMAP_TYPE_BASIC';Xu.shadowMapType===In?$u='SHADOWMAP_TYPE_PCF':Xu.shadowMapType===2&&($u='SHADOWMAP_TYPE_PCF_SOFT');var em='ENVMAP_TYPE_CUBE',tm='ENVMAP_MODE_REFLECTION',rm='ENVMAP_BLENDING_MULTIPLY';if(Xu.envMap){switch(ju.envMap.mapping){case As:case Ps:em='ENVMAP_TYPE_CUBE';break;case Ds:case zs:em='ENVMAP_TYPE_CUBE_UV';break;case Cs:case Rs:em='ENVMAP_TYPE_EQUIREC';break;case Is:em='ENVMAP_TYPE_SPHERE';}switch(ju.envMap.mapping){case Ps:case Rs:tm='ENVMAP_MODE_REFRACTION';}switch(ju.combine){case xs:rm='ENVMAP_BLENDING_MULTIPLY';break;case 1:rm='ENVMAP_BLENDING_MIX';break;case 2:rm='ENVMAP_BLENDING_ADD';}}var am=0<Vu.gammaFactor?Vu.gammaFactor:1,om=Yu.isWebGL2?'':Dt(ju.extensions,Xu,ku),im=zt(Ju),nm=Zu.createProgram(),sm,lm;if(ju.isRawShaderMaterial?(sm=[im].filter(Bt).join('\n'),0<sm.length&&(sm+='\n'),lm=[om,im].filter(Bt).join('\n'),0<lm.length&&(lm+='\n')):(sm=['precision '+Xu.precision+' float;','precision '+Xu.precision+' int;','#define SHADER_NAME '+qu.name,im,Xu.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+am,'#define MAX_BONES '+Xu.maxBones,Xu.useFog&&Xu.fog?'#define USE_FOG':'',Xu.useFog&&Xu.fogExp?'#define FOG_EXP2':'',Xu.map?'#define USE_MAP':'',Xu.envMap?'#define USE_ENVMAP':'',Xu.envMap?'#define '+tm:'',Xu.lightMap?'#define USE_LIGHTMAP':'',Xu.aoMap?'#define USE_AOMAP':'',Xu.emissiveMap?'#define USE_EMISSIVEMAP':'',Xu.bumpMap?'#define USE_BUMPMAP':'',Xu.normalMap?'#define USE_NORMALMAP':'',Xu.normalMap&&Xu.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',Xu.displacementMap&&Xu.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',Xu.specularMap?'#define USE_SPECULARMAP':'',Xu.roughnessMap?'#define USE_ROUGHNESSMAP':'',Xu.metalnessMap?'#define USE_METALNESSMAP':'',Xu.alphaMap?'#define USE_ALPHAMAP':'',Xu.vertexColors?'#define USE_COLOR':'',Xu.flatShading?'#define FLAT_SHADED':'',Xu.skinning?'#define USE_SKINNING':'',Xu.useVertexTexture?'#define BONE_TEXTURE':'',Xu.morphTargets?'#define USE_MORPHTARGETS':'',Xu.morphNormals&&!1===Xu.flatShading?'#define USE_MORPHNORMALS':'',Xu.doubleSided?'#define DOUBLE_SIDED':'',Xu.flipSided?'#define FLIP_SIDED':'',Xu.shadowMapEnabled?'#define USE_SHADOWMAP':'',Xu.shadowMapEnabled?'#define '+$u:'',Xu.sizeAttenuation?'#define USE_SIZEATTENUATION':'',Xu.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',Xu.logarithmicDepthBuffer&&(Yu.isWebGL2||ku.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(Bt).join('\n'),lm=[om,'precision '+Xu.precision+' float;','precision '+Xu.precision+' int;','#define SHADER_NAME '+qu.name,im,Xu.alphaTest?'#define ALPHATEST '+Xu.alphaTest+(Xu.alphaTest%1?'':'.0'):'','#define GAMMA_FACTOR '+am,Xu.useFog&&Xu.fog?'#define USE_FOG':'',Xu.useFog&&Xu.fogExp?'#define FOG_EXP2':'',Xu.map?'#define USE_MAP':'',Xu.envMap?'#define USE_ENVMAP':'',Xu.envMap?'#define '+em:'',Xu.envMap?'#define '+tm:'',Xu.envMap?'#define '+rm:'',Xu.lightMap?'#define USE_LIGHTMAP':'',Xu.aoMap?'#define USE_AOMAP':'',Xu.emissiveMap?'#define USE_EMISSIVEMAP':'',Xu.bumpMap?'#define USE_BUMPMAP':'',Xu.normalMap?'#define USE_NORMALMAP':'',Xu.normalMap&&Xu.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',Xu.specularMap?'#define USE_SPECULARMAP':'',Xu.roughnessMap?'#define USE_ROUGHNESSMAP':'',Xu.metalnessMap?'#define USE_METALNESSMAP':'',Xu.alphaMap?'#define USE_ALPHAMAP':'',Xu.vertexColors?'#define USE_COLOR':'',Xu.gradientMap?'#define USE_GRADIENTMAP':'',Xu.flatShading?'#define FLAT_SHADED':'',Xu.doubleSided?'#define DOUBLE_SIDED':'',Xu.flipSided?'#define FLIP_SIDED':'',Xu.shadowMapEnabled?'#define USE_SHADOWMAP':'',Xu.shadowMapEnabled?'#define '+$u:'',Xu.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':'',Xu.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',Xu.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',Xu.logarithmicDepthBuffer&&(Yu.isWebGL2||ku.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'',Xu.envMap&&(Yu.isWebGL2||ku.get('EXT_shader_texture_lod'))?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',Xu.toneMapping===Ms?'':'#define TONE_MAPPING',Xu.toneMapping===Ms?'':Uc.tonemapping_pars_fragment,Xu.toneMapping===Ms?'':It('toneMapping',Xu.toneMapping),Xu.dithering?'#define DITHERING':'',Xu.outputEncoding||Xu.mapEncoding||Xu.matcapEncoding||Xu.envMapEncoding||Xu.emissiveMapEncoding?Uc.encodings_pars_fragment:'',Xu.mapEncoding?Ct('mapTexelToLinear',Xu.mapEncoding):'',Xu.matcapEncoding?Ct('matcapTexelToLinear',Xu.matcapEncoding):'',Xu.envMapEncoding?Ct('envMapTexelToLinear',Xu.envMapEncoding):'',Xu.emissiveMapEncoding?Ct('emissiveMapTexelToLinear',Xu.emissiveMapEncoding):'',Xu.outputEncoding?Rt('linearToOutputTexel',Xu.outputEncoding):'',Xu.depthPacking?'#define DEPTH_PACKING '+ju.depthPacking:'','\n'].filter(Bt).join('\n')),Qu=Ot(Qu),Qu=Ut(Qu,Xu),Qu=Gt(Qu,Xu),Ku=Ot(Ku),Ku=Ut(Ku,Xu),Ku=Gt(Ku,Xu),Qu=Ft(Qu),Ku=Ft(Ku),Yu.isWebGL2&&!ju.isRawShaderMaterial){var pm=!1,dm=/^\s*#version\s+300\s+es\s*\n/;ju.isShaderMaterial&&null!==Qu.match(dm)&&null!==Ku.match(dm)&&(pm=!0,Qu=Qu.replace(dm,''),Ku=Ku.replace(dm,'')),sm=['#version 300 es\n','#define attribute in','#define varying out','#define texture2D texture'].join('\n')+'\n'+sm,lm=['#version 300 es\n','#define varying in',pm?'':'out highp vec4 pc_fragColor;',pm?'':'#define gl_FragColor pc_fragColor','#define gl_FragDepthEXT gl_FragDepth','#define texture2D texture','#define textureCube texture','#define texture2DProj textureProj','#define texture2DLodEXT textureLod','#define texture2DProjLodEXT textureProjLod','#define textureCubeLodEXT textureLod','#define texture2DGradEXT textureGrad','#define texture2DProjGradEXT textureProjGrad','#define textureCubeGradEXT textureGrad'].join('\n')+'\n'+lm}var cm=sm+Qu,um=lm+Ku,mm=At(Zu,35633,cm),gm=At(Zu,35632,um);Zu.attachShader(nm,mm),Zu.attachShader(nm,gm),void 0===ju.index0AttributeName?!0===Xu.morphTargets&&Zu.bindAttribLocation(nm,0,'position'):Zu.bindAttribLocation(nm,0,ju.index0AttributeName),Zu.linkProgram(nm);var fm=Zu.getProgramInfoLog(nm).trim(),hm=Zu.getShaderInfoLog(mm).trim(),ym=Zu.getShaderInfoLog(gm).trim(),xm=!0,vm=!0;!1===Zu.getProgramParameter(nm,35714)?(xm=!1,console.error('THREE.WebGLProgram: shader error: ',Zu.getError(),'35715',Zu.getProgramParameter(nm,35715),'gl.getProgramInfoLog',fm,hm,ym)):''===fm?(''===hm||''===ym)&&(vm=!1):console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',fm),vm&&(this.diagnostics={runnable:xm,material:ju,programLog:fm,vertexShader:{log:hm,prefix:sm},fragmentShader:{log:ym,prefix:lm}}),Zu.deleteShader(mm),Zu.deleteShader(gm);var _m;this.getUniforms=function(){return void 0==_m&&(_m=new wt(Zu,nm,Vu)),_m};var bm;return this.getAttributes=function(){return void 0==bm&&(bm=Nt(Zu,nm)),bm},this.destroy=function(){Zu.deleteProgram(nm),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().'),this.getUniforms()}},attributes:{get:function(){return console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().'),this.getAttributes()}}}),this.name=qu.name,this.id=tu++,this.code=Wu,this.usedTimes=1,this.program=nm,this.vertexShader=mm,this.fragmentShader=gm,this}function Vt(Vu,ku,Wu){function ju(Ju){var Qu=Ju.skeleton,Ku=Qu.bones;if(Wu.floatVertexTextures)return 1024;var $u=Wu.maxVertexUniforms,em=Math.floor(($u-20)/4),tm=Math.min(em,Ku.length);return tm<Ku.length?(console.warn('THREE.WebGLRenderer: Skeleton has '+Ku.length+' bones. This GPU supports '+tm+'.'),0):tm}function qu(Ju,Qu){var Ku;return Ju?Ju.isTexture?Ku=Ju.encoding:Ju.isWebGLRenderTarget&&(console.warn('THREE.WebGLPrograms.getTextureEncodingFromMap: don\'t use render targets as textures. Use their .texture property instead.'),Ku=Ju.texture.encoding):Ku=ap,Ku===ap&&Qu&&(Ku=ip),Ku}var Xu=[],Yu={MeshDepthMaterial:'depth',MeshDistanceMaterial:'distanceRGBA',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',MeshToonMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',MeshMatcapMaterial:'matcap',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points',ShadowMaterial:'shadow',SpriteMaterial:'sprite'},Zu=['precision','supportsVertexTextures','map','mapEncoding','matcapEncoding','envMap','envMapMode','envMapEncoding','lightMap','aoMap','emissiveMap','emissiveMapEncoding','bumpMap','normalMap','objectSpaceNormalMap','displacementMap','specularMap','roughnessMap','metalnessMap','gradientMap','alphaMap','combine','vertexColors','fog','useFog','fogExp','flatShading','sizeAttenuation','logarithmicDepthBuffer','skinning','maxBones','useVertexTexture','morphTargets','morphNormals','maxMorphTargets','maxMorphNormals','premultipliedAlpha','numDirLights','numPointLights','numSpotLights','numHemiLights','numRectAreaLights','shadowMapEnabled','shadowMapType','toneMapping','physicallyCorrectLights','alphaTest','doubleSided','flipSided','numClippingPlanes','numClipIntersection','depthPacking','dithering'];this.getParameters=function(Ju,Qu,Ku,$u,em,tm,rm){var am=Yu[Ju.type],om=rm.isSkinnedMesh?ju(rm):0,im=Wu.precision;null!==Ju.precision&&(im=Wu.getMaxPrecision(Ju.precision),im!==Ju.precision&&console.warn('THREE.WebGLProgram.getParameters:',Ju.precision,'not supported, using',im,'instead.'));var nm=Vu.getRenderTarget(),sm={shaderID:am,precision:im,supportsVertexTextures:Wu.vertexTextures,outputEncoding:qu(nm?nm.texture:null,Vu.gammaOutput),map:!!Ju.map,mapEncoding:qu(Ju.map,Vu.gammaInput),matcap:!!Ju.matcap,matcapEncoding:qu(Ju.matcap,Vu.gammaInput),envMap:!!Ju.envMap,envMapMode:Ju.envMap&&Ju.envMap.mapping,envMapEncoding:qu(Ju.envMap,Vu.gammaInput),envMapCubeUV:!!Ju.envMap&&(Ju.envMap.mapping===Ds||Ju.envMap.mapping===zs),lightMap:!!Ju.lightMap,aoMap:!!Ju.aoMap,emissiveMap:!!Ju.emissiveMap,emissiveMapEncoding:qu(Ju.emissiveMap,Vu.gammaInput),bumpMap:!!Ju.bumpMap,normalMap:!!Ju.normalMap,objectSpaceNormalMap:Ju.normalMapType===1,displacementMap:!!Ju.displacementMap,roughnessMap:!!Ju.roughnessMap,metalnessMap:!!Ju.metalnessMap,specularMap:!!Ju.specularMap,alphaMap:!!Ju.alphaMap,gradientMap:!!Ju.gradientMap,combine:Ju.combine,vertexColors:Ju.vertexColors,fog:!!$u,useFog:Ju.fog,fogExp:$u&&$u.isFogExp2,flatShading:Ju.flatShading,sizeAttenuation:Ju.sizeAttenuation,logarithmicDepthBuffer:Wu.logarithmicDepthBuffer,skinning:Ju.skinning&&0<om,maxBones:om,useVertexTexture:Wu.floatVertexTextures,morphTargets:Ju.morphTargets,morphNormals:Ju.morphNormals,maxMorphTargets:Vu.maxMorphTargets,maxMorphNormals:Vu.maxMorphNormals,numDirLights:Qu.directional.length,numPointLights:Qu.point.length,numSpotLights:Qu.spot.length,numRectAreaLights:Qu.rectArea.length,numHemiLights:Qu.hemi.length,numClippingPlanes:em,numClipIntersection:tm,dithering:Ju.dithering,shadowMapEnabled:Vu.shadowMap.enabled&&rm.receiveShadow&&0<Ku.length,shadowMapType:Vu.shadowMap.type,toneMapping:Vu.toneMapping,physicallyCorrectLights:Vu.physicallyCorrectLights,premultipliedAlpha:Ju.premultipliedAlpha,alphaTest:Ju.alphaTest,doubleSided:Ju.side===Bn,flipSided:Ju.side===Nn,depthPacking:Ju.depthPacking!==void 0&&Ju.depthPacking};return sm},this.getProgramCode=function(Ju,Qu){var Ku=[];if(Qu.shaderID?Ku.push(Qu.shaderID):(Ku.push(Ju.fragmentShader),Ku.push(Ju.vertexShader)),void 0!==Ju.defines)for(var $u in Ju.defines)Ku.push($u),Ku.push(Ju.defines[$u]);for(var em=0;em<Zu.length;em++)Ku.push(Qu[Zu[em]]);return Ku.push(Ju.onBeforeCompile.toString()),Ku.push(Vu.gammaOutput),Ku.push(Vu.gammaFactor),Ku.join()},this.acquireProgram=function(Ju,Qu,Ku,$u){for(var tm=0,rm=Xu.length,em,am;tm<rm;tm++)if(am=Xu[tm],am.code===$u){em=am,++em.usedTimes;break}return void 0===em&&(em=new Ht(Vu,ku,$u,Ju,Qu,Ku,Wu),Xu.push(em)),em},this.releaseProgram=function(Ju){if(0==--Ju.usedTimes){var Qu=Xu.indexOf(Ju);Xu[Qu]=Xu[Xu.length-1],Xu.pop(),Ju.destroy()}},this.programs=Xu}function kt(){var qu=new WeakMap;return{get:function(Xu){var Yu=qu.get(Xu);return void 0===Yu&&(Yu={},qu.set(Xu,Yu)),Yu},remove:function(Xu){qu.delete(Xu)},update:function(Xu,Yu,Zu){qu.get(Xu)[Yu]=Zu},dispose:function(){qu=new WeakMap}}}function Wt(Vu,ku){return Vu.renderOrder===ku.renderOrder?Vu.program&&ku.program&&Vu.program!==ku.program?Vu.program.id-ku.program.id:Vu.material.id===ku.material.id?Vu.z===ku.z?Vu.id-ku.id:Vu.z-ku.z:Vu.material.id-ku.material.id:Vu.renderOrder-ku.renderOrder}function jt(Vu,ku){return Vu.renderOrder===ku.renderOrder?Vu.z===ku.z?Vu.id-ku.id:ku.z-Vu.z:Vu.renderOrder-ku.renderOrder}function qt(){var ju=[],qu=0,Xu=[],Yu=[];return{opaque:Xu,transparent:Yu,init:function(){qu=0,Xu.length=0,Yu.length=0},push:function(Zu,Ju,Qu,Ku,$u){var em=ju[qu];em===void 0?(em={id:Zu.id,object:Zu,geometry:Ju,material:Qu,program:Qu.program,renderOrder:Zu.renderOrder,z:Ku,group:$u},ju[qu]=em):(em.id=Zu.id,em.object=Zu,em.geometry=Ju,em.material=Qu,em.program=Qu.program,em.renderOrder=Zu.renderOrder,em.z=Ku,em.group=$u),(!0===Qu.transparent?Yu:Xu).push(em),qu++},sort:function(){1<Xu.length&&Xu.sort(Wt),1<Yu.length&&Yu.sort(jt)}}}function Xt(){var Wu={};return{get:function(ju,qu){var Xu=Wu[ju.id],Yu;return void 0===Xu?(Yu=new qt,Wu[ju.id]={},Wu[ju.id][qu.id]=Yu):(Yu=Xu[qu.id],void 0==Yu&&(Yu=new qt,Xu[qu.id]=Yu)),Yu},dispose:function(){Wu={}}}}function Yt(){var Vu={};return{get:function(ku){if(void 0!==Vu[ku.id])return Vu[ku.id];var Wu;switch(ku.type){case'DirectionalLight':Wu={direction:new A,color:new W,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new S};break;case'SpotLight':Wu={position:new A,direction:new A,color:new W,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new S};break;case'PointLight':Wu={position:new A,color:new W,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new S,shadowCameraNear:1,shadowCameraFar:1e3};break;case'HemisphereLight':Wu={direction:new A,skyColor:new W,groundColor:new W};break;case'RectAreaLight':Wu={color:new W,position:new A,halfWidth:new A,halfHeight:new A};}return Vu[ku.id]=Wu,Wu}}}function Zt(){var ku=new Yt,Wu={id:ru++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},ju=new A,qu=new E,Xu=new E;return{setup:function(Yu,Zu,Ju){for(var Qu=0,Ku=0,$u=0,em=0,tm=0,rm=0,am=0,om=0,im=Ju.matrixWorldInverse,nm=0,sm=Yu.length;nm<sm;nm++){var lm=Yu[nm],pm=lm.color,dm=lm.intensity,cm=lm.distance,um=lm.shadow&&lm.shadow.map?lm.shadow.map.texture:null;if(lm.isAmbientLight)Qu+=pm.r*dm,Ku+=pm.g*dm,$u+=pm.b*dm;else if(lm.isDirectionalLight){var mm=ku.get(lm);if(mm.color.copy(lm.color).multiplyScalar(lm.intensity),mm.direction.setFromMatrixPosition(lm.matrixWorld),ju.setFromMatrixPosition(lm.target.matrixWorld),mm.direction.sub(ju),mm.direction.transformDirection(im),mm.shadow=lm.castShadow,lm.castShadow){var gm=lm.shadow;mm.shadowBias=gm.bias,mm.shadowRadius=gm.radius,mm.shadowMapSize=gm.mapSize}Wu.directionalShadowMap[em]=um,Wu.directionalShadowMatrix[em]=lm.shadow.matrix,Wu.directional[em]=mm,em++}else if(lm.isSpotLight){var mm=ku.get(lm);if(mm.position.setFromMatrixPosition(lm.matrixWorld),mm.position.applyMatrix4(im),mm.color.copy(pm).multiplyScalar(dm),mm.distance=cm,mm.direction.setFromMatrixPosition(lm.matrixWorld),ju.setFromMatrixPosition(lm.target.matrixWorld),mm.direction.sub(ju),mm.direction.transformDirection(im),mm.coneCos=Math.cos(lm.angle),mm.penumbraCos=Math.cos(lm.angle*(1-lm.penumbra)),mm.decay=lm.decay,mm.shadow=lm.castShadow,lm.castShadow){var gm=lm.shadow;mm.shadowBias=gm.bias,mm.shadowRadius=gm.radius,mm.shadowMapSize=gm.mapSize}Wu.spotShadowMap[rm]=um,Wu.spotShadowMatrix[rm]=lm.shadow.matrix,Wu.spot[rm]=mm,rm++}else if(lm.isRectAreaLight){var mm=ku.get(lm);mm.color.copy(pm).multiplyScalar(dm),mm.position.setFromMatrixPosition(lm.matrixWorld),mm.position.applyMatrix4(im),Xu.identity(),qu.copy(lm.matrixWorld),qu.premultiply(im),Xu.extractRotation(qu),mm.halfWidth.set(0.5*lm.width,0,0),mm.halfHeight.set(0,0.5*lm.height,0),mm.halfWidth.applyMatrix4(Xu),mm.halfHeight.applyMatrix4(Xu),Wu.rectArea[am]=mm,am++}else if(lm.isPointLight){var mm=ku.get(lm);if(mm.position.setFromMatrixPosition(lm.matrixWorld),mm.position.applyMatrix4(im),mm.color.copy(lm.color).multiplyScalar(lm.intensity),mm.distance=lm.distance,mm.decay=lm.decay,mm.shadow=lm.castShadow,lm.castShadow){var gm=lm.shadow;mm.shadowBias=gm.bias,mm.shadowRadius=gm.radius,mm.shadowMapSize=gm.mapSize,mm.shadowCameraNear=gm.camera.near,mm.shadowCameraFar=gm.camera.far}Wu.pointShadowMap[tm]=um,Wu.pointShadowMatrix[tm]=lm.shadow.matrix,Wu.point[tm]=mm,tm++}else if(lm.isHemisphereLight){var mm=ku.get(lm);mm.direction.setFromMatrixPosition(lm.matrixWorld),mm.direction.transformDirection(im),mm.direction.normalize(),mm.skyColor.copy(lm.color).multiplyScalar(dm),mm.groundColor.copy(lm.groundColor).multiplyScalar(dm),Wu.hemi[om]=mm,om++}}Wu.ambient[0]=Qu,Wu.ambient[1]=Ku,Wu.ambient[2]=$u,Wu.directional.length=em,Wu.spot.length=rm,Wu.rectArea.length=am,Wu.point.length=tm,Wu.hemi.length=om,Wu.hash.stateID=Wu.id,Wu.hash.directionalLength=em,Wu.hash.pointLength=tm,Wu.hash.spotLength=rm,Wu.hash.rectAreaLength=am,Wu.hash.hemiLength=om,Wu.hash.shadowsLength=Zu.length},state:Wu}}function Jt(){var qu=new Zt,Xu=[],Yu=[];return{init:function(){Xu.length=0,Yu.length=0},state:{lightsArray:Xu,shadowsArray:Yu,lights:qu},setupLights:function(Ju){qu.setup(Xu,Yu,Ju)},pushLight:function(Ju){Xu.push(Ju)},pushShadow:function(Ju){Yu.push(Ju)}}}function Qt(){var Wu={};return{get:function(ju,qu){var Xu;return void 0===Wu[ju.id]?(Xu=new Jt,Wu[ju.id]={},Wu[ju.id][qu.id]=Xu):void 0===Wu[ju.id][qu.id]?(Xu=new Jt,Wu[ju.id][qu.id]=Xu):Xu=Wu[ju.id][qu.id],Xu},dispose:function(){Wu={}}}}function Kt(Vu){Te.call(this),this.type='MeshDepthMaterial',this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(Vu)}function $t(Vu){Te.call(this),this.type='MeshDistanceMaterial',this.referencePosition=new A,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(Vu)}function er(Vu,ku,Wu){function ju(fm,hm,ym,xm,vm,_m){var bm=fm.geometry,Mm=null,Sm=rm,Tm=fm.customDepthMaterial;if(ym&&(Sm=am,Tm=fm.customDistanceMaterial),!Tm){var Em=!1;hm.morphTargets&&(bm&&bm.isBufferGeometry?Em=bm.morphAttributes&&bm.morphAttributes.position&&0<bm.morphAttributes.position.length:bm&&bm.isGeometry&&(Em=bm.morphTargets&&0<bm.morphTargets.length)),fm.isSkinnedMesh&&!1===hm.skinning&&console.warn('THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:',fm);var wm=fm.isSkinnedMesh&&hm.skinning,Lm=0;Em&&(Lm|=$u),wm&&(Lm|=em),Mm=Sm[Lm]}else Mm=Tm;if(Vu.localClippingEnabled&&!0===hm.clipShadows&&0!==hm.clippingPlanes.length){var Am=Mm.uuid,Pm=hm.uuid,Cm=om[Am];void 0===Cm&&(Cm={},om[Am]=Cm);var Rm=Cm[Pm];void 0===Rm&&(Rm=Mm.clone(),Cm[Pm]=Rm),Mm=Rm}return Mm.visible=hm.visible,Mm.wireframe=hm.wireframe,Mm.side=null==hm.shadowSide?im[hm.side]:hm.shadowSide,Mm.clipShadows=hm.clipShadows,Mm.clippingPlanes=hm.clippingPlanes,Mm.clipIntersection=hm.clipIntersection,Mm.wireframeLinewidth=hm.wireframeLinewidth,Mm.linewidth=hm.linewidth,ym&&Mm.isMeshDistanceMaterial&&(Mm.referencePosition.copy(xm),Mm.nearDistance=vm,Mm.farDistance=_m),Mm}function qu(fm,hm,ym,xm){if(!1!==fm.visible){var vm=fm.layers.test(hm.layers);if(vm&&(fm.isMesh||fm.isLine||fm.isPoints)&&fm.castShadow&&(!fm.frustumCulled||Xu.intersectsObject(fm))){fm.modelViewMatrix.multiplyMatrices(ym.matrixWorldInverse,fm.matrixWorld);var _m=ku.update(fm),bm=fm.material;if(Array.isArray(bm))for(var Mm=_m.groups,Sm=0,Tm=Mm.length;Sm<Tm;Sm++){var Em=Mm[Sm],wm=bm[Em.materialIndex];if(wm&&wm.visible){var Lm=ju(fm,wm,xm,Ku,ym.near,ym.far);Vu.renderBufferDirect(ym,null,_m,Lm,fm,Em)}}else if(bm.visible){var Lm=ju(fm,bm,xm,Ku,ym.near,ym.far);Vu.renderBufferDirect(ym,null,_m,Lm,fm,null)}}for(var Am=fm.children,Pm=0,Cm=Am.length;Pm<Cm;Pm++)qu(Am[Pm],hm,ym,xm)}}for(var Xu=new V,Yu=new E,Zu=new S,Ju=new S(Wu,Wu),Qu=new A,Ku=new A,$u=1,em=2,rm=[,,,,],am=[,,,,],om={},im={0:Nn,1:zn,2:Bn},nm=[new A(1,0,0),new A(-1,0,0),new A(0,0,1),new A(0,0,-1),new A(0,1,0),new A(0,-1,0)],sm=[new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,0,1),new A(0,0,-1)],lm=[new I,new I,new I,new I,new I,new I],pm=0;pm!==($u|em)+1;++pm){var dm=0!=(pm&$u),cm=0!=(pm&em),um=new Kt({depthPacking:3201,morphTargets:dm,skinning:cm});rm[pm]=um;var mm=new $t({morphTargets:dm,skinning:cm});am[pm]=mm}var gm=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=In,this.render=function(fm,hm,ym){if(!1!==gm.enabled&&(!1!==gm.autoUpdate||!1!==gm.needsUpdate)&&0!==fm.length){var xm=Vu.context,vm=Vu.state;vm.disable(3042),vm.buffers.color.setClear(1,1,1,1),vm.buffers.depth.setTest(!0),vm.setScissorTest(!1);for(var bm=0,Mm=fm.length,_m;bm<Mm;bm++){var Sm=fm[bm],Tm=Sm.shadow,Em=Sm&&Sm.isPointLight;if(void 0===Tm){console.warn('THREE.WebGLShadowMap:',Sm,'has no shadow.');continue}var wm=Tm.camera;if(Zu.copy(Tm.mapSize),Zu.min(Ju),Em){var Lm=Zu.x,Am=Zu.y;lm[0].set(2*Lm,Am,Lm,Am),lm[1].set(0,Am,Lm,Am),lm[2].set(3*Lm,Am,Lm,Am),lm[3].set(Lm,Am,Lm,Am),lm[4].set(3*Lm,0,Lm,Am),lm[5].set(Lm,0,Lm,Am),Zu.x*=4,Zu.y*=2}if(null===Tm.map){Tm.map=new D(Zu.x,Zu.y,{minFilter:Gs,magFilter:Gs,format:ll}),Tm.map.texture.name=Sm.name+'.shadowMap',wm.updateProjectionMatrix()}Tm.isSpotLightShadow&&Tm.update(Sm);var Cm=Tm.map,Rm=Tm.matrix;Ku.setFromMatrixPosition(Sm.matrixWorld),wm.position.copy(Ku),Em?(_m=6,Rm.makeTranslation(-Ku.x,-Ku.y,-Ku.z)):(_m=1,Qu.setFromMatrixPosition(Sm.target.matrixWorld),wm.lookAt(Qu),wm.updateMatrixWorld(),Rm.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),Rm.multiply(wm.projectionMatrix),Rm.multiply(wm.matrixWorldInverse)),Vu.setRenderTarget(Cm),Vu.clear();for(var Im=0;Im<_m;Im++){if(Em){Qu.copy(wm.position),Qu.add(nm[Im]),wm.up.copy(sm[Im]),wm.lookAt(Qu),wm.updateMatrixWorld();var Dm=lm[Im];vm.viewport(Dm)}Yu.multiplyMatrices(wm.projectionMatrix,wm.matrixWorldInverse),Xu.setFromMatrix(Yu),qu(hm,ym,wm,Em)}}gm.needsUpdate=!1}}}function tr(Vu,ku,Wu,ju){function Zu($m,eg,tg){var rg=new Uint8Array(4),ag=Vu.createTexture();Vu.bindTexture($m,ag),Vu.texParameteri($m,10241,9728),Vu.texParameteri($m,10240,9728);for(var og=0;og<tg;og++)Vu.texImage2D(eg+og,0,6408,1,1,0,6408,5121,rg);return ag}function Ku($m,eg){if(Sm[$m]=1,0===Tm[$m]&&(Vu.enableVertexAttribArray($m),Tm[$m]=1),Em[$m]!==eg){var tg=ju.isWebGL2?Vu:ku.get('ANGLE_instanced_arrays');tg[ju.isWebGL2?'vertexAttribDivisor':'vertexAttribDivisorANGLE']($m,eg),Em[$m]=eg}}function em($m){!0!==wm[$m]&&(Vu.enable($m),wm[$m]=!0)}function tm($m){!1!==wm[$m]&&(Vu.disable($m),wm[$m]=!1)}function om($m,eg,tg,rg,ag,og,ig,ng){return $m===Hn?void(Pm&&(tm(3042),Pm=!1)):(Pm||(em(3042),Pm=!0),$m===qn?void(ag=ag||eg,og=og||tg,ig=ig||rg,(eg!==Rm||ag!==zm)&&(Vu.blendEquationSeparate(Wu.convert(eg),Wu.convert(ag)),Rm=eg,zm=ag),(tg!==Im||rg!==Dm||og!==Nm||ig!==Bm)&&(Vu.blendFuncSeparate(Wu.convert(tg),Wu.convert(rg),Wu.convert(og),Wu.convert(ig)),Im=tg,Dm=rg,Nm=og,Bm=ig),Cm=$m,Um=null):void(($m!==Cm||ng!==Um)&&((Rm!==Xn||zm!==Xn)&&(Vu.blendEquation(32774),Rm=Xn,zm=Xn),ng?$m===Vn?Vu.blendFuncSeparate(1,771,1,771):$m===kn?Vu.blendFunc(1,1):$m===Wn?Vu.blendFuncSeparate(0,0,769,771):$m===jn?Vu.blendFuncSeparate(0,768,0,770):console.error('THREE.WebGLState: Invalid blending: ',$m):$m===Vn?Vu.blendFuncSeparate(770,771,1,771):$m===kn?Vu.blendFunc(770,1):$m===Wn?Vu.blendFunc(0,769):$m===jn?Vu.blendFunc(0,768):console.error('THREE.WebGLState: Invalid blending: ',$m),Im=null,Dm=null,Nm=null,Bm=null,Cm=$m,Um=ng)))}function nm($m){Gm!==$m&&($m?Vu.frontFace(2304):Vu.frontFace(2305),Gm=$m)}function sm($m){$m===0?tm(2884):(em(2884),$m!==Om&&($m===Cn?Vu.cullFace(1029):$m===2?Vu.cullFace(1028):Vu.cullFace(1032))),Om=$m}function pm($m,eg,tg){$m?(em(32823),(Hm!==eg||Vm!==tg)&&(Vu.polygonOffset(eg,tg),Hm=eg,Vm=tg)):tm(32823)}function cm($m){void 0===$m&&($m=33984+km-1),Ym!==$m&&(Vu.activeTexture($m),Ym=$m)}var vm=new function(){var $m=!1,eg=new I,tg=null,rg=new I(0,0,0,0);return{setMask:function(ag){tg===ag||$m||(Vu.colorMask(ag,ag,ag,ag),tg=ag)},setLocked:function(ag){$m=ag},setClear:function(ag,og,ig,ng,sg){!0===sg&&(ag*=ng,og*=ng,ig*=ng),eg.set(ag,og,ig,ng),!1===rg.equals(eg)&&(Vu.clearColor(ag,og,ig,ng),rg.copy(eg))},reset:function(){$m=!1,tg=null,rg.set(-1,0,0,0)}}},_m=new function(){var $m=!1,eg=null,tg=null,rg=null;return{setTest:function(ag){ag?em(2929):tm(2929)},setMask:function(ag){eg===ag||$m||(Vu.depthMask(ag),eg=ag)},setFunc:function(ag){tg!==ag&&(ag?ag===0?Vu.depthFunc(512):ag===1?Vu.depthFunc(519):ag===2?Vu.depthFunc(513):ag===ms?Vu.depthFunc(515):ag===4?Vu.depthFunc(514):ag===5?Vu.depthFunc(518):ag===6?Vu.depthFunc(516):ag===7?Vu.depthFunc(517):Vu.depthFunc(515):Vu.depthFunc(515),tg=ag)},setLocked:function(ag){$m=ag},setClear:function(ag){rg!==ag&&(Vu.clearDepth(ag),rg=ag)},reset:function(){$m=!1,eg=null,tg=null,rg=null}}},bm=new function(){var $m=!1,eg=null,tg=null,rg=null,ag=null,og=null,ig=null,ng=null,sg=null;return{setTest:function(lg){lg?em(2960):tm(2960)},setMask:function(lg){eg===lg||$m||(Vu.stencilMask(lg),eg=lg)},setFunc:function(lg,pg,dg){(tg!==lg||rg!==pg||ag!==dg)&&(Vu.stencilFunc(lg,pg,dg),tg=lg,rg=pg,ag=dg)},setOp:function(lg,pg,dg){(og!==lg||ig!==pg||ng!==dg)&&(Vu.stencilOp(lg,pg,dg),og=lg,ig=pg,ng=dg)},setLocked:function(lg){$m=lg},setClear:function(lg){sg!==lg&&(Vu.clearStencil(lg),sg=lg)},reset:function(){$m=!1,eg=null,tg=null,rg=null,ag=null,og=null,ig=null,ng=null,sg=null}}},Mm=Vu.getParameter(34921),Sm=new Uint8Array(Mm),Tm=new Uint8Array(Mm),Em=new Uint8Array(Mm),wm={},Lm=null,Am=null,Pm=null,Cm=null,Rm=null,Im=null,Dm=null,zm=null,Nm=null,Bm=null,Um=!1,Gm=null,Om=null,Fm=null,Hm=null,Vm=null,km=Vu.getParameter(35661),Wm=!1,jm=0,Xm=Vu.getParameter(7938);-1===Xm.indexOf('WebGL')?-1!==Xm.indexOf('OpenGL ES')&&(jm=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Xm)[1]),Wm=2<=jm):(jm=parseFloat(/^WebGL\ ([0-9])/.exec(Xm)[1]),Wm=1<=jm);var Ym=null,Zm={},Jm=new I,Qm=new I,Km={};return Km[3553]=Zu(3553,3553,1),Km[34067]=Zu(34067,34069,6),vm.setClear(0,0,0,1),_m.setClear(1),bm.setClear(0),em(2929),_m.setFunc(ms),nm(!1),sm(Cn),em(2884),om(Hn),{buffers:{color:vm,depth:_m,stencil:bm},initAttributes:function(){for(var $m=0,eg=Sm.length;$m<eg;$m++)Sm[$m]=0},enableAttribute:function($m){Ku($m,0)},enableAttributeAndDivisor:Ku,disableUnusedAttributes:function(){for(var $m=0,eg=Tm.length;$m!==eg;++$m)Tm[$m]!==Sm[$m]&&(Vu.disableVertexAttribArray($m),Tm[$m]=0)},enable:em,disable:tm,getCompressedTextureFormats:function(){if(null===Lm&&(Lm=[],ku.get('WEBGL_compressed_texture_pvrtc')||ku.get('WEBGL_compressed_texture_s3tc')||ku.get('WEBGL_compressed_texture_etc1')||ku.get('WEBGL_compressed_texture_astc')))for(var $m=Vu.getParameter(34467),eg=0;eg<$m.length;eg++)Lm.push($m[eg]);return Lm},useProgram:function($m){return Am!==$m&&(Vu.useProgram($m),Am=$m,!0)},setBlending:om,setMaterial:function($m,eg){$m.side===Bn?tm(2884):em(2884);var tg=$m.side===Nn;eg&&(tg=!tg),nm(tg),$m.blending===Vn&&!1===$m.transparent?om(Hn):om($m.blending,$m.blendEquation,$m.blendSrc,$m.blendDst,$m.blendEquationAlpha,$m.blendSrcAlpha,$m.blendDstAlpha,$m.premultipliedAlpha),_m.setFunc($m.depthFunc),_m.setTest($m.depthTest),_m.setMask($m.depthWrite),vm.setMask($m.colorWrite),pm($m.polygonOffset,$m.polygonOffsetFactor,$m.polygonOffsetUnits)},setFlipSided:nm,setCullFace:sm,setLineWidth:function($m){$m!==Fm&&(Wm&&Vu.lineWidth($m),Fm=$m)},setPolygonOffset:pm,setScissorTest:function($m){$m?em(3089):tm(3089)},activeTexture:cm,bindTexture:function($m,eg){null===Ym&&cm();var tg=Zm[Ym];void 0===tg&&(tg={type:void 0,texture:void 0},Zm[Ym]=tg),(tg.type!==$m||tg.texture!==eg)&&(Vu.bindTexture($m,eg||Km[$m]),tg.type=$m,tg.texture=eg)},compressedTexImage2D:function(){try{Vu.compressedTexImage2D.apply(Vu,arguments)}catch($m){console.error('THREE.WebGLState:',$m)}},texImage2D:function(){try{Vu.texImage2D.apply(Vu,arguments)}catch($m){console.error('THREE.WebGLState:',$m)}},texImage3D:function(){try{Vu.texImage3D.apply(Vu,arguments)}catch($m){console.error('THREE.WebGLState:',$m)}},scissor:function($m){!1===Jm.equals($m)&&(Vu.scissor($m.x,$m.y,$m.z,$m.w),Jm.copy($m))},viewport:function($m){!1===Qm.equals($m)&&(Vu.viewport($m.x,$m.y,$m.z,$m.w),Qm.copy($m))},reset:function(){for(var $m=0;$m<Tm.length;$m++)1===Tm[$m]&&(Vu.disableVertexAttribArray($m),Tm[$m]=0);wm={},Lm=null,Ym=null,Zm={},Am=null,Cm=null,Gm=null,Om=null,vm.reset(),_m.reset(),bm.reset()}}}function rr(Vu,ku,Wu,ju,qu,Xu,Yu){function Zu(Mm,Sm){if(Mm.width>Sm||Mm.height>Sm){if('data'in Mm)return void console.warn('THREE.WebGLRenderer: image in DataTexture is too big ('+Mm.width+'x'+Mm.height+').');var Tm=Sm/Math.max(Mm.width,Mm.height),Em=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');Em.width=Math.floor(Mm.width*Tm),Em.height=Math.floor(Mm.height*Tm);var wm=Em.getContext('2d');return wm.drawImage(Mm,0,0,Mm.width,Mm.height,0,0,Em.width,Em.height),console.warn('THREE.WebGLRenderer: image is too big ('+Mm.width+'x'+Mm.height+'). Resized to '+Em.width+'x'+Em.height),Em}return Mm}function Ju(Mm){return hp.isPowerOfTwo(Mm.width)&&hp.isPowerOfTwo(Mm.height)}function Qu(Mm){if(Mm instanceof HTMLImageElement||Mm instanceof HTMLCanvasElement||Mm instanceof ImageBitmap){void 0===bm&&(bm=document.createElementNS('http://www.w3.org/1999/xhtml','canvas')),bm.width=hp.floorPowerOfTwo(Mm.width),bm.height=hp.floorPowerOfTwo(Mm.height);var Sm=bm.getContext('2d');return Sm.drawImage(Mm,0,0,bm.width,bm.height),console.warn('THREE.WebGLRenderer: image is not power of two ('+Mm.width+'x'+Mm.height+'). Resized to '+bm.width+'x'+bm.height),bm}return Mm}function Ku(Mm){return!qu.isWebGL2&&(Mm.wrapS!==Bs||Mm.wrapT!==Bs||Mm.minFilter!==Gs&&Mm.minFilter!==Hs)}function $u(Mm,Sm){return Mm.generateMipmaps&&Sm&&Mm.minFilter!==Gs&&Mm.minFilter!==Hs}function em(Mm,Sm,Tm,Em){Vu.generateMipmap(Mm);var wm=ju.get(Sm);wm.__maxMipLevel=Math.log(Math.max(Tm,Em))*Math.LOG2E}function tm(Mm,Sm){if(!qu.isWebGL2)return Mm;if(6403===Mm){if(5126===Sm)return 33326;if(5131===Sm)return 33325;if(5121===Sm)return 33321}if(6407===Mm){if(5126===Sm)return 34837;if(5131===Sm)return 34843;if(5121===Sm)return 32849}if(6408===Mm){if(5126===Sm)return 34836;if(5131===Sm)return 34842;if(5121===Sm)return 32856}return Mm}function rm(Mm){return Mm===Gs||Mm===Os||Mm===Fs?9728:9729}function am(Mm){var Sm=Mm.target;Sm.removeEventListener('dispose',am),im(Sm),Sm.isVideoTexture&&delete _m[Sm.id],Yu.memory.textures--}function om(Mm){var Sm=Mm.target;Sm.removeEventListener('dispose',om),nm(Sm),Yu.memory.textures--}function im(Mm){var Sm=ju.get(Mm);if(Mm.image&&Sm.__image__webglTextureCube)Vu.deleteTexture(Sm.__image__webglTextureCube);else{if(Sm.__webglInit===void 0)return;Vu.deleteTexture(Sm.__webglTexture)}ju.remove(Mm)}function nm(Mm){var Sm=ju.get(Mm),Tm=ju.get(Mm.texture);if(Mm){if(void 0!==Tm.__webglTexture&&Vu.deleteTexture(Tm.__webglTexture),Mm.depthTexture&&Mm.depthTexture.dispose(),Mm.isWebGLRenderTargetCube)for(var Em=0;6>Em;Em++)Vu.deleteFramebuffer(Sm.__webglFramebuffer[Em]),Sm.__webglDepthbuffer&&Vu.deleteRenderbuffer(Sm.__webglDepthbuffer[Em]);else Vu.deleteFramebuffer(Sm.__webglFramebuffer),Sm.__webglDepthbuffer&&Vu.deleteRenderbuffer(Sm.__webglDepthbuffer);ju.remove(Mm.texture),ju.remove(Mm)}}function sm(Mm,Sm){var Tm=ju.get(Mm);if(Mm.isVideoTexture&&vm(Mm),0<Mm.version&&Tm.__version!==Mm.version){var Em=Mm.image;if(void 0===Em)console.warn('THREE.WebGLRenderer: Texture marked for update but image is undefined');else if(!1===Em.complete)console.warn('THREE.WebGLRenderer: Texture marked for update but image is incomplete');else return void um(Tm,Mm,Sm)}Wu.activeTexture(33984+Sm),Wu.bindTexture(3553,Tm.__webglTexture)}function cm(Mm,Sm,Tm){var Em;if(Tm?(Vu.texParameteri(Mm,10242,Xu.convert(Sm.wrapS)),Vu.texParameteri(Mm,10243,Xu.convert(Sm.wrapT)),Vu.texParameteri(Mm,10240,Xu.convert(Sm.magFilter)),Vu.texParameteri(Mm,10241,Xu.convert(Sm.minFilter))):(Vu.texParameteri(Mm,10242,33071),Vu.texParameteri(Mm,10243,33071),(Sm.wrapS!==Bs||Sm.wrapT!==Bs)&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.'),Vu.texParameteri(Mm,10240,rm(Sm.magFilter)),Vu.texParameteri(Mm,10241,rm(Sm.minFilter)),Sm.minFilter!==Gs&&Sm.minFilter!==Hs&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.')),Em=ku.get('EXT_texture_filter_anisotropic'),Em){if(Sm.type===Js&&null===ku.get('OES_texture_float_linear'))return;if(Sm.type===Qs&&null===(qu.isWebGL2||ku.get('OES_texture_half_float_linear')))return;(1<Sm.anisotropy||ju.get(Sm).__currentAnisotropy)&&(Vu.texParameterf(Mm,Em.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Sm.anisotropy,qu.getMaxAnisotropy())),ju.get(Sm).__currentAnisotropy=Sm.anisotropy)}}function um(Mm,Sm,Tm){var Em;Em=Sm.isDataTexture3D?32879:3553,Mm.__webglInit===void 0&&(Mm.__webglInit=!0,Sm.addEventListener('dispose',am),Mm.__webglTexture=Vu.createTexture(),Yu.memory.textures++),Wu.activeTexture(33984+Tm),Wu.bindTexture(Em,Mm.__webglTexture),Vu.pixelStorei(37440,Sm.flipY),Vu.pixelStorei(37441,Sm.premultiplyAlpha),Vu.pixelStorei(3317,Sm.unpackAlignment);var wm=Zu(Sm.image,qu.maxTextureSize);Ku(Sm)&&!1===Ju(wm)&&(wm=Qu(wm));var Lm=Ju(wm),Am=Xu.convert(Sm.format),Pm=Xu.convert(Sm.type),Cm=tm(Am,Pm);cm(Em,Sm,Lm);var Im=Sm.mipmaps,Rm;if(Sm.isDepthTexture){if(Cm=6402,Sm.type===Js){if(!qu.isWebGL2)throw new Error('Float Depth Texture only supported in WebGL2.0');Cm=36012}else qu.isWebGL2&&(Cm=33189);Sm.format===ul&&6402===Cm&&Sm.type!==Xs&&Sm.type!==Zs&&(console.warn('THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.'),Sm.type=Xs,Pm=Xu.convert(Sm.type)),Sm.format===yl&&(Cm=34041,Sm.type!==rl&&(console.warn('THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.'),Sm.type=rl,Pm=Xu.convert(Sm.type))),Wu.texImage2D(3553,0,Cm,wm.width,wm.height,0,Am,Pm,null)}else if(Sm.isDataTexture){if(0<Im.length&&Lm){for(var Dm=0,zm=Im.length;Dm<zm;Dm++)Rm=Im[Dm],Wu.texImage2D(3553,Dm,Cm,Rm.width,Rm.height,0,Am,Pm,Rm.data);Sm.generateMipmaps=!1,Mm.__maxMipLevel=Im.length-1}else Wu.texImage2D(3553,0,Cm,wm.width,wm.height,0,Am,Pm,wm.data),Mm.__maxMipLevel=0;}else if(Sm.isCompressedTexture){for(var Dm=0,zm=Im.length;Dm<zm;Dm++)Rm=Im[Dm],Sm.format!==ll&&Sm.format!==nl?-1<Wu.getCompressedTextureFormats().indexOf(Am)?Wu.compressedTexImage2D(3553,Dm,Cm,Rm.width,Rm.height,0,Rm.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()'):Wu.texImage2D(3553,Dm,Cm,Rm.width,Rm.height,0,Am,Pm,Rm.data);Mm.__maxMipLevel=Im.length-1}else if(Sm.isDataTexture3D)Wu.texImage3D(32879,0,Cm,wm.width,wm.height,wm.depth,0,Am,Pm,wm.data),Mm.__maxMipLevel=0;else if(0<Im.length&&Lm){for(var Dm=0,zm=Im.length;Dm<zm;Dm++)Rm=Im[Dm],Wu.texImage2D(3553,Dm,Cm,Am,Pm,Rm);Sm.generateMipmaps=!1,Mm.__maxMipLevel=Im.length-1}else Wu.texImage2D(3553,0,Cm,Am,Pm,wm),Mm.__maxMipLevel=0;$u(Sm,Lm)&&em(3553,Sm,wm.width,wm.height),Mm.__version=Sm.version,Sm.onUpdate&&Sm.onUpdate(Sm)}function mm(Mm,Sm,Tm,Em){var wm=Xu.convert(Sm.texture.format),Lm=Xu.convert(Sm.texture.type),Am=tm(wm,Lm);Wu.texImage2D(Em,0,Am,Sm.width,Sm.height,0,wm,Lm,null),Vu.bindFramebuffer(36160,Mm),Vu.framebufferTexture2D(36160,Tm,Em,ju.get(Sm.texture).__webglTexture,0),Vu.bindFramebuffer(36160,null)}function gm(Mm,Sm){Vu.bindRenderbuffer(36161,Mm),Sm.depthBuffer&&!Sm.stencilBuffer?(Vu.renderbufferStorage(36161,33189,Sm.width,Sm.height),Vu.framebufferRenderbuffer(36160,36096,36161,Mm)):Sm.depthBuffer&&Sm.stencilBuffer?(Vu.renderbufferStorage(36161,34041,Sm.width,Sm.height),Vu.framebufferRenderbuffer(36160,33306,36161,Mm)):Vu.renderbufferStorage(36161,32854,Sm.width,Sm.height),Vu.bindRenderbuffer(36161,null)}function fm(Mm,Sm){var Tm=Sm&&Sm.isWebGLRenderTargetCube;if(Tm)throw new Error('Depth Texture with cube render targets is not supported');if(Vu.bindFramebuffer(36160,Mm),!(Sm.depthTexture&&Sm.depthTexture.isDepthTexture))throw new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');ju.get(Sm.depthTexture).__webglTexture&&Sm.depthTexture.image.width===Sm.width&&Sm.depthTexture.image.height===Sm.height||(Sm.depthTexture.image.width=Sm.width,Sm.depthTexture.image.height=Sm.height,Sm.depthTexture.needsUpdate=!0),sm(Sm.depthTexture,0);var Em=ju.get(Sm.depthTexture).__webglTexture;if(Sm.depthTexture.format===ul)Vu.framebufferTexture2D(36160,36096,3553,Em,0);else if(Sm.depthTexture.format===yl)Vu.framebufferTexture2D(36160,33306,3553,Em,0);else throw new Error('Unknown depthTexture format')}function hm(Mm){var Sm=ju.get(Mm),Tm=!0===Mm.isWebGLRenderTargetCube;if(Mm.depthTexture){if(Tm)throw new Error('target.depthTexture not supported in Cube render targets');fm(Sm.__webglFramebuffer,Mm)}else if(Tm){Sm.__webglDepthbuffer=[];for(var Em=0;6>Em;Em++)Vu.bindFramebuffer(36160,Sm.__webglFramebuffer[Em]),Sm.__webglDepthbuffer[Em]=Vu.createRenderbuffer(),gm(Sm.__webglDepthbuffer[Em],Mm)}else Vu.bindFramebuffer(36160,Sm.__webglFramebuffer),Sm.__webglDepthbuffer=Vu.createRenderbuffer(),gm(Sm.__webglDepthbuffer,Mm);Vu.bindFramebuffer(36160,null)}function vm(Mm){var Sm=Mm.id,Tm=Yu.render.frame;_m[Sm]!==Tm&&(_m[Sm]=Tm,Mm.update())}var _m={},bm;this.setTexture2D=sm,this.setTexture3D=function(Mm,Sm){var Tm=ju.get(Mm);return 0<Mm.version&&Tm.__version!==Mm.version?void um(Tm,Mm,Sm):void(Wu.activeTexture(33984+Sm),Wu.bindTexture(32879,Tm.__webglTexture))},this.setTextureCube=function(Mm,Sm){var Tm=ju.get(Mm);if(6===Mm.image.length)if(0<Mm.version&&Tm.__version!==Mm.version){Tm.__image__webglTextureCube||(Mm.addEventListener('dispose',am),Tm.__image__webglTextureCube=Vu.createTexture(),Yu.memory.textures++),Wu.activeTexture(33984+Sm),Wu.bindTexture(34067,Tm.__image__webglTextureCube),Vu.pixelStorei(37440,Mm.flipY);for(var Em=Mm&&Mm.isCompressedTexture,wm=Mm.image[0]&&Mm.image[0].isDataTexture,Lm=[],Am=0;6>Am;Am++)Lm[Am]=Em||wm?wm?Mm.image[Am].image:Mm.image[Am]:Zu(Mm.image[Am],qu.maxCubemapSize);var Pm=Lm[0],Cm=Ju(Pm),Rm=Xu.convert(Mm.format),Im=Xu.convert(Mm.type),Dm=tm(Rm,Im);cm(34067,Mm,Cm);for(var Am=0;6>Am;Am++)if(!Em)wm?Wu.texImage2D(34069+Am,0,Dm,Lm[Am].width,Lm[Am].height,0,Rm,Im,Lm[Am].data):Wu.texImage2D(34069+Am,0,Dm,Rm,Im,Lm[Am]);else for(var Nm=Lm[Am].mipmaps,Bm=0,Um=Nm.length,zm;Bm<Um;Bm++)zm=Nm[Bm],Mm.format!==ll&&Mm.format!==nl?-1<Wu.getCompressedTextureFormats().indexOf(Rm)?Wu.compressedTexImage2D(34069+Am,Bm,Dm,zm.width,zm.height,0,zm.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()'):Wu.texImage2D(34069+Am,Bm,Dm,zm.width,zm.height,0,Rm,Im,zm.data);Tm.__maxMipLevel=Em?Nm.length-1:0,$u(Mm,Cm)&&em(34067,Mm,Pm.width,Pm.height),Tm.__version=Mm.version,Mm.onUpdate&&Mm.onUpdate(Mm)}else Wu.activeTexture(33984+Sm),Wu.bindTexture(34067,Tm.__image__webglTextureCube)},this.setTextureCubeDynamic=function(Mm,Sm){Wu.activeTexture(33984+Sm),Wu.bindTexture(34067,ju.get(Mm).__webglTexture)},this.setupRenderTarget=function(Mm){var Sm=ju.get(Mm),Tm=ju.get(Mm.texture);Mm.addEventListener('dispose',om),Tm.__webglTexture=Vu.createTexture(),Yu.memory.textures++;var Em=!0===Mm.isWebGLRenderTargetCube,wm=Ju(Mm);if(Em){Sm.__webglFramebuffer=[];for(var Lm=0;6>Lm;Lm++)Sm.__webglFramebuffer[Lm]=Vu.createFramebuffer()}else Sm.__webglFramebuffer=Vu.createFramebuffer();if(Em){Wu.bindTexture(34067,Tm.__webglTexture),cm(34067,Mm.texture,wm);for(var Lm=0;6>Lm;Lm++)mm(Sm.__webglFramebuffer[Lm],Mm,36064,34069+Lm);$u(Mm.texture,wm)&&em(34067,Mm.texture,Mm.width,Mm.height),Wu.bindTexture(34067,null)}else Wu.bindTexture(3553,Tm.__webglTexture),cm(3553,Mm.texture,wm),mm(Sm.__webglFramebuffer,Mm,36064,3553),$u(Mm.texture,wm)&&em(3553,Mm.texture,Mm.width,Mm.height),Wu.bindTexture(3553,null);Mm.depthBuffer&&hm(Mm)},this.updateRenderTargetMipmap=function(Mm){var Sm=Mm.texture,Tm=Ju(Mm);if($u(Sm,Tm)){var Em=Mm.isWebGLRenderTargetCube?34067:3553,wm=ju.get(Sm).__webglTexture;Wu.bindTexture(Em,wm),em(Em,Sm,Mm.width,Mm.height),Wu.bindTexture(Em,null)}}}function ar(Vu,ku,Wu){return{convert:function(qu){var Xu;if(qu===Ns)return 10497;if(qu===Bs)return 33071;if(qu===Us)return 33648;if(qu===Gs)return 9728;if(qu===Os)return 9984;if(qu===Fs)return 9986;if(qu===Hs)return 9729;if(qu===Vs)return 9985;if(qu===ks)return 9987;if(qu===Ws)return 5121;if(qu===1017)return 32819;if(qu===1018)return 32820;if(qu===1019)return 33635;if(qu===1010)return 5120;if(qu===1011)return 5122;if(qu===Xs)return 5123;if(qu===1013)return 5124;if(qu===Zs)return 5125;if(qu===Js)return 5126;if(qu===Qs){if(Wu.isWebGL2)return 5131;if(Xu=ku.get('OES_texture_half_float'),null!==Xu)return Xu.HALF_FLOAT_OES}if(qu===1021)return 6406;if(qu===nl)return 6407;if(qu===ll)return 6408;if(qu===1024)return 6409;if(qu===1025)return 6410;if(qu===ul)return 6402;if(qu===yl)return 34041;if(qu===1028)return 6403;if(qu===Xn)return 32774;if(qu===101)return 32778;if(qu===102)return 32779;if(qu===200)return 0;if(qu===201)return 1;if(qu===202)return 768;if(qu===203)return 769;if(qu===rs)return 770;if(qu===as)return 771;if(qu===206)return 772;if(qu===207)return 773;if(qu===208)return 774;if(qu===209)return 775;if(qu===210)return 776;if((qu===_l||qu===bl||qu===Ml||qu===Sl)&&(Xu=ku.get('WEBGL_compressed_texture_s3tc'),null!==Xu)){if(qu===_l)return Xu.COMPRESSED_RGB_S3TC_DXT1_EXT;if(qu===bl)return Xu.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(qu===Ml)return Xu.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(qu===Sl)return Xu.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((qu===Tl||qu===El||qu===wl||qu===Ll)&&(Xu=ku.get('WEBGL_compressed_texture_pvrtc'),null!==Xu)){if(qu===Tl)return Xu.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(qu===El)return Xu.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(qu===wl)return Xu.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(qu===Ll)return Xu.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(qu===36196&&(Xu=ku.get('WEBGL_compressed_texture_etc1'),null!==Xu))return Xu.COMPRESSED_RGB_ETC1_WEBGL;if((qu===37808||qu===37809||qu===37810||qu===37811||qu===37812||qu===37813||qu===37814||qu===37815||qu===37816||qu===37817||qu===37818||qu===37819||qu===37820||qu===37821)&&(Xu=ku.get('WEBGL_compressed_texture_astc'),null!==Xu))return qu;if(qu===Jn||qu===Qn){if(Wu.isWebGL2){if(qu===Jn)return 32775;if(qu===Qn)return 32776}if(Xu=ku.get('EXT_blend_minmax'),null!==Xu){if(qu===Jn)return Xu.MIN_EXT;if(qu===Qn)return Xu.MAX_EXT}}if(qu===rl){if(Wu.isWebGL2)return 34042;if(Xu=ku.get('WEBGL_depth_texture'),null!==Xu)return Xu.UNSIGNED_INT_24_8_WEBGL}return 0}}}function or(){K.call(this),this.type='Group'}function ir(){K.call(this),this.type='Camera',this.matrixWorldInverse=new E,this.projectionMatrix=new E,this.projectionMatrixInverse=new E}function nr(Vu,ku,Wu,ju){ir.call(this),this.type='PerspectiveCamera',this.fov=Vu===void 0?50:Vu,this.zoom=1,this.near=Wu===void 0?0.1:Wu,this.far=ju===void 0?2e3:ju,this.focus=10,this.aspect=ku===void 0?1:ku,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function sr(Vu){nr.call(this),this.cameras=Vu||[]}function lr(Vu,ku,Wu){au.setFromMatrixPosition(ku.matrixWorld),ou.setFromMatrixPosition(Wu.matrixWorld);var ju=au.distanceTo(ou),qu=ku.projectionMatrix.elements,Xu=Wu.projectionMatrix.elements,Yu=qu[14]/(qu[10]-1),Zu=qu[14]/(qu[10]+1),Ju=(qu[9]+1)/qu[5],Qu=(qu[9]-1)/qu[5],Ku=(qu[8]-1)/qu[0],$u=(Xu[8]+1)/Xu[0],rm=ju/(-Ku+$u),am=rm*-Ku;ku.matrixWorld.decompose(Vu.position,Vu.quaternion,Vu.scale),Vu.translateX(am),Vu.translateZ(rm),Vu.matrixWorld.compose(Vu.position,Vu.quaternion,Vu.scale),Vu.matrixWorldInverse.getInverse(Vu.matrixWorld);var om=Yu+rm,im=Zu+rm;Vu.projectionMatrix.makePerspective(Yu*Ku-am,Yu*$u+(ju-am),Ju*Zu/im*om,Qu*Zu/im*om,om,im)}function pr(Vu){function ku(){return null!==Yu&&!0===Yu.isPresenting}function Wu(){if(ku()){var um=Yu.getEyeParameters('left'),mm=um.renderWidth*em,gm=um.renderHeight*em;pm=Vu.getPixelRatio(),lm=Vu.getSize(),Vu.setDrawingBufferSize(2*mm,gm,1),cm.start()}else Xu.enabled&&Vu.setDrawingBufferSize(lm.width,lm.height,pm),cm.stop()}function ju(um){for(var mm=navigator.getGamepads&&navigator.getGamepads(),gm=0,fm=0,hm=mm.length,ym;gm<hm;gm++)if(ym=mm[gm],ym&&('Daydream Controller'===ym.id||'Gear VR Controller'===ym.id||'Oculus Go Controller'===ym.id||'OpenVR Gamepad'===ym.id||ym.id.startsWith('Oculus Touch')||ym.id.startsWith('Spatial Controller'))){if(fm===um)return ym;fm++}}function qu(){for(var um=0;um<Qu.length;um++){var mm=Qu[um],gm=ju(um);if(gm!==void 0&&gm.pose!==void 0){if(null===gm.pose)return;var fm=gm.pose;!1===fm.hasPosition&&mm.position.set(0.2,-0.6,-0.05),null!==fm.position&&mm.position.fromArray(fm.position),null!==fm.orientation&&mm.quaternion.fromArray(fm.orientation),mm.matrix.compose(mm.position,mm.quaternion,mm.scale),mm.matrix.premultiply(Ku),mm.matrix.decompose(mm.position,mm.quaternion,mm.scale),mm.matrixWorldNeedsUpdate=!0,mm.visible=!0;var hm='Daydream Controller'===gm.id?0:1;dm[um]!==gm.buttons[hm].pressed&&(dm[um]=gm.buttons[hm].pressed,!0===dm[um]?mm.dispatchEvent({type:'selectstart'}):(mm.dispatchEvent({type:'selectend'}),mm.dispatchEvent({type:'select'})))}else mm.visible=!1}}var Xu=this,Yu=null,Zu=null,Ju=null,Qu=[],Ku=new E,$u=new E,em=1,tm='stage';'undefined'!=typeof window&&'VRFrameData'in window&&(Zu=new window.VRFrameData,window.addEventListener('vrdisplaypresentchange',Wu,!1));var rm=new E,am=new L,om=new A,im=new nr;im.bounds=new I(0,0,0.5,1),im.layers.enable(1);var nm=new nr;nm.bounds=new I(0.5,0,0.5,1),nm.layers.enable(2);var sm=new sr([im,nm]);sm.layers.enable(1),sm.layers.enable(2);var lm,pm,dm=[];this.enabled=!1,this.getController=function(um){var mm=Qu[um];return void 0===mm&&(mm=new or,mm.matrixAutoUpdate=!1,mm.visible=!1,Qu[um]=mm),mm},this.getDevice=function(){return Yu},this.setDevice=function(um){um!==void 0&&(Yu=um),cm.setContext(um)},this.setFramebufferScaleFactor=function(um){em=um},this.setFrameOfReferenceType=function(um){tm=um},this.setPoseTarget=function(um){um!==void 0&&(Ju=um)},this.getCamera=function(um){var mm='stage'===tm?1.6:0;if(null===Yu)return um.position.set(0,mm,0),um;if(Yu.depthNear=um.near,Yu.depthFar=um.far,Yu.getFrameData(Zu),'stage'===tm){var gm=Yu.stageParameters;gm?Ku.fromArray(gm.sittingToStandingTransform):Ku.makeTranslation(0,mm,0)}var fm=Zu.pose,hm=null===Ju?um:Ju;if(hm.matrix.copy(Ku),hm.matrix.decompose(hm.position,hm.quaternion,hm.scale),null!==fm.orientation&&(am.fromArray(fm.orientation),hm.quaternion.multiply(am)),null!==fm.position&&(am.setFromRotationMatrix(Ku),om.fromArray(fm.position),om.applyQuaternion(am),hm.position.add(om)),hm.updateMatrixWorld(),!1===Yu.isPresenting)return um;im.near=um.near,nm.near=um.near,im.far=um.far,nm.far=um.far,im.matrixWorldInverse.fromArray(Zu.leftViewMatrix),nm.matrixWorldInverse.fromArray(Zu.rightViewMatrix),$u.getInverse(Ku),'stage'===tm&&(im.matrixWorldInverse.multiply($u),nm.matrixWorldInverse.multiply($u));var ym=hm.parent;null!==ym&&(rm.getInverse(ym.matrixWorld),im.matrixWorldInverse.multiply(rm),nm.matrixWorldInverse.multiply(rm)),im.matrixWorld.getInverse(im.matrixWorldInverse),nm.matrixWorld.getInverse(nm.matrixWorldInverse),im.projectionMatrix.fromArray(Zu.leftProjectionMatrix),nm.projectionMatrix.fromArray(Zu.rightProjectionMatrix),lr(sm,im,nm);var xm=Yu.getLayers();if(xm.length){var vm=xm[0];null!==vm.leftBounds&&4===vm.leftBounds.length&&im.bounds.fromArray(vm.leftBounds),null!==vm.rightBounds&&4===vm.rightBounds.length&&nm.bounds.fromArray(vm.rightBounds)}return qu(),sm},this.getStandingMatrix=function(){return Ku},this.isPresenting=ku;var cm=new X;this.setAnimationLoop=function(um){cm.setAnimationLoop(um)},this.submitFrame=function(){ku()&&Yu.submitFrame()},this.dispose=function(){'undefined'!=typeof window&&window.removeEventListener('vrdisplaypresentchange',Wu)}}function dr(Vu){function ku(){return null!==Ju&&null!==Ku}function Wu(lm){var pm=tm[rm.indexOf(lm.inputSource)];pm&&pm.dispatchEvent({type:lm.type})}function ju(){Vu.setFramebuffer(null),sm.stop()}function qu(lm,pm){null===pm?lm.matrixWorld.copy(lm.matrix):lm.matrixWorld.multiplyMatrices(pm.matrixWorld,lm.matrix),lm.matrixWorldInverse.getInverse(lm.matrixWorld)}var Yu=Vu.context,Zu=null,Ju=null,Qu=1,Ku=null,$u='stage',em=null,tm=[],rm=[],am=new nr;am.layers.enable(1),am.viewport=new I;var om=new nr;om.layers.enable(2),om.viewport=new I;var im=new sr([am,om]);im.layers.enable(1),im.layers.enable(2),this.enabled=!1,this.getController=function(lm){var pm=tm[lm];return void 0===pm&&(pm=new or,pm.matrixAutoUpdate=!1,pm.visible=!1,tm[lm]=pm),pm},this.getDevice=function(){return Zu},this.setDevice=function(lm){lm!==void 0&&(Zu=lm),lm instanceof XRDevice&&Yu.setCompatibleXRDevice(lm)},this.setFramebufferScaleFactor=function(lm){Qu=lm},this.setFrameOfReferenceType=function(lm){$u=lm},this.setSession=function(lm){Ju=lm,null!=Ju&&(Ju.addEventListener('select',Wu),Ju.addEventListener('selectstart',Wu),Ju.addEventListener('selectend',Wu),Ju.addEventListener('end',ju),Ju.baseLayer=new XRWebGLLayer(Ju,Yu,{framebufferScaleFactor:Qu}),Ju.requestFrameOfReference($u).then(function(pm){Ku=pm,Vu.setFramebuffer(Ju.baseLayer.framebuffer),sm.setContext(Ju),sm.start()}),rm=Ju.getInputSources(),Ju.addEventListener('inputsourceschange',function(){rm=Ju.getInputSources(),console.log(rm);for(var pm=0,dm;pm<tm.length;pm++)dm=tm[pm],dm.userData.inputSource=rm[pm]}))},this.getCamera=function(lm){if(ku()){var pm=lm.parent,dm=im.cameras;qu(im,pm);for(var cm=0;cm<dm.length;cm++)qu(dm[cm],pm);lm.matrixWorld.copy(im.matrixWorld);for(var um=lm.children,cm=0,mm=um.length;cm<mm;cm++)um[cm].updateMatrixWorld(!0);return lr(im,am,om),im}return lm},this.isPresenting=ku;var nm=null,sm=new X;sm.setAnimationLoop(function(lm,pm){if(em=pm.getDevicePose(Ku),null!==em)for(var dm=Ju.baseLayer,cm=pm.views,um=0;um<cm.length;um++){var mm=cm[um],gm=dm.getViewport(mm),fm=em.getViewMatrix(mm),hm=im.cameras[um];hm.matrix.fromArray(fm).getInverse(hm.matrix),hm.projectionMatrix.fromArray(mm.projectionMatrix),hm.viewport.set(gm.x,gm.y,gm.width,gm.height),0===um&&im.matrix.copy(hm.matrix)}for(var um=0;um<tm.length;um++){var ym=tm[um],xm=rm[um];if(xm){var vm=pm.getInputPose(xm,Ku);if(null!==vm){'targetRay'in vm?ym.matrix.elements=vm.targetRay.transformMatrix:'pointerMatrix'in vm&&(ym.matrix.elements=vm.pointerMatrix),ym.matrix.decompose(ym.position,ym.rotation,ym.scale),ym.visible=!0;continue}}ym.visible=!1}nm&&nm(lm)}),this.setAnimationLoop=function(lm){nm=lm},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn('THREE.WebXRManager: getStandingMatrix() is no longer needed.'),new THREE.Matrix4},this.submitFrame=function(){}}function cr(Vu){function ku(){return null===Nm?Ym:1}function Wu(){ng=new ze(og),sg=new Ie(og,ng,Vu),sg.isWebGL2||(ng.get('WEBGL_depth_texture'),ng.get('OES_texture_float'),ng.get('OES_texture_half_float'),ng.get('OES_texture_half_float_linear'),ng.get('OES_standard_derivatives'),ng.get('OES_element_index_uint'),ng.get('ANGLE_instanced_arrays')),ng.get('OES_texture_float_linear'),Mg=new ar(og,ng,sg),lg=new tr(og,ng,Mg,sg),lg.scissor(Vm.copy(Jm).multiplyScalar(Ym)),lg.viewport(Hm.copy(Zm).multiplyScalar(Ym)),pg=new Ue(og),dg=new kt,cg=new rr(og,ng,lg,dg,sg,Mg,pg),ug=new Y(og),mg=new Ne(og,ug,pg),gg=new Fe(mg,pg),vg=new Oe(og),fg=new Vt(Im,ng,sg),hg=new Xt,yg=new Qt,xg=new Ce(Im,lg,gg,Lm),_g=new Re(og,ng,pg,sg),bg=new Be(og,ng,pg,sg),pg.programs=fg.programs,Im.context=og,Im.capabilities=sg,Im.extensions=ng,Im.properties=dg,Im.renderLists=hg,Im.state=lg,Im.info=pg}function ju(Lg){Lg.preventDefault(),console.log('THREE.WebGLRenderer: Context Lost.'),Dm=!0}function qu(){console.log('THREE.WebGLRenderer: Context Restored.'),Dm=!1,Wu()}function Xu(Lg){var Ag=Lg.target;Ag.removeEventListener('dispose',Xu),Yu(Ag)}function Yu(Lg){Zu(Lg),dg.remove(Lg)}function Zu(Lg){var Ag=dg.get(Lg).program;Lg.program=void 0,Ag!==void 0&&fg.releaseProgram(Ag)}function Ju(Lg,Ag){Lg.render(function(Pg){Im.renderBufferImmediate(Pg,Ag)})}function Qu(Lg,Ag,Pg){if(Pg&&Pg.isInstancedBufferGeometry&!sg.isWebGL2&&null===ng.get('ANGLE_instanced_arrays'))return void console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');lg.initAttributes();var Cg=Pg.attributes,Rg=Ag.getAttributes(),Ig=Lg.defaultAttributeValues;for(var Dg in Rg){var zg=Rg[Dg];if(0<=zg){var Ng=Cg[Dg];if(Ng!==void 0){var Bg=Ng.normalized,Ug=Ng.itemSize,Gg=ug.get(Ng);if(Gg===void 0)continue;var Og=Gg.buffer,Fg=Gg.type,Hg=Gg.bytesPerElement;if(Ng.isInterleavedBufferAttribute){var Vg=Ng.data,kg=Vg.stride,Wg=Ng.offset;Vg&&Vg.isInstancedInterleavedBuffer?(lg.enableAttributeAndDivisor(zg,Vg.meshPerAttribute),Pg.maxInstancedCount===void 0&&(Pg.maxInstancedCount=Vg.meshPerAttribute*Vg.count)):lg.enableAttribute(zg),og.bindBuffer(34962,Og),og.vertexAttribPointer(zg,Ug,Fg,Bg,kg*Hg,Wg*Hg)}else Ng.isInstancedBufferAttribute?(lg.enableAttributeAndDivisor(zg,Ng.meshPerAttribute),void 0===Pg.maxInstancedCount&&(Pg.maxInstancedCount=Ng.meshPerAttribute*Ng.count)):lg.enableAttribute(zg),og.bindBuffer(34962,Og),og.vertexAttribPointer(zg,Ug,Fg,Bg,0,0)}else if(Ig!==void 0){var jg=Ig[Dg];if(jg!==void 0)switch(jg.length){case 2:og.vertexAttrib2fv(zg,jg);break;case 3:og.vertexAttrib3fv(zg,jg);break;case 4:og.vertexAttrib4fv(zg,jg);break;default:og.vertexAttrib1fv(zg,jg);}}}}lg.disableUnusedAttributes()}function $u(Lg,Ag,Pg){if(!1!==Lg.visible){var Cg=Lg.layers.test(Ag.layers);if(Cg)if(Lg.isLight)Rm.pushLight(Lg),Lg.castShadow&&Rm.pushShadow(Lg);else if(Lg.isSprite){if(!Lg.frustumCulled||Km.intersectsSprite(Lg)){Pg&&ag.setFromMatrixPosition(Lg.matrixWorld).applyMatrix4(rg);var Rg=gg.update(Lg),Ig=Lg.material;Cm.push(Lg,Rg,Ig,ag.z,null)}}else if(Lg.isImmediateRenderObject)Pg&&ag.setFromMatrixPosition(Lg.matrixWorld).applyMatrix4(rg),Cm.push(Lg,null,Lg.material,ag.z,null);else if((Lg.isMesh||Lg.isLine||Lg.isPoints)&&(Lg.isSkinnedMesh&&Lg.skeleton.update(),!Lg.frustumCulled||Km.intersectsObject(Lg))){Pg&&ag.setFromMatrixPosition(Lg.matrixWorld).applyMatrix4(rg);var Rg=gg.update(Lg),Ig=Lg.material;if(Array.isArray(Ig))for(var Dg=Rg.groups,zg=0,Ng=Dg.length;zg<Ng;zg++){var Bg=Dg[zg],Ug=Ig[Bg.materialIndex];Ug&&Ug.visible&&Cm.push(Lg,Rg,Ug,ag.z,Bg)}else Ig.visible&&Cm.push(Lg,Rg,Ig,ag.z,null)}for(var Gg=Lg.children,zg=0,Ng=Gg.length;zg<Ng;zg++)$u(Gg[zg],Ag,Pg)}}function em(Lg,Ag,Pg,Cg){for(var Rg=0,Ig=Lg.length;Rg<Ig;Rg++){var Dg=Lg[Rg],zg=Dg.object,Ng=Dg.geometry,Bg=Cg===void 0?Dg.material:Cg,Ug=Dg.group;if(Pg.isArrayCamera){Fm=Pg;for(var Gg=Pg.cameras,Og=0,Fg=Gg.length,Hg;Og<Fg;Og++)if(Hg=Gg[Og],zg.layers.test(Hg.layers)){if('viewport'in Hg)lg.viewport(Hm.copy(Hg.viewport));else{var Vg=Hg.bounds,kg=Vg.x*jm,Wg=Vg.y*Xm,jg=Vg.z*jm,qg=Vg.w*Xm;lg.viewport(Hm.set(kg,Wg,jg,qg).multiplyScalar(Ym))}Rm.setupLights(Hg),tm(zg,Ag,Hg,Ng,Bg,Ug)}}else Fm=null,tm(zg,Ag,Pg,Ng,Bg,Ug)}}function tm(Lg,Ag,Pg,Cg,Rg,Ig){if(Lg.onBeforeRender(Im,Ag,Pg,Cg,Rg,Ig),Rm=yg.get(Ag,Fm||Pg),Lg.modelViewMatrix.multiplyMatrices(Pg.matrixWorldInverse,Lg.matrixWorld),Lg.normalMatrix.getNormalMatrix(Lg.modelViewMatrix),Lg.isImmediateRenderObject){lg.setMaterial(Rg);var Dg=am(Pg,Ag.fog,Rg,Lg);Gm.geometry=null,Gm.program=null,Gm.wireframe=!1,Ju(Lg,Dg)}else Im.renderBufferDirect(Pg,Ag.fog,Cg,Rg,Lg,Ig);Lg.onAfterRender(Im,Ag,Pg,Cg,Rg,Ig),Rm=yg.get(Ag,Fm||Pg)}function rm(Lg,Ag,Pg){var Cg=dg.get(Lg),Rg=Rm.state.lights,Ig=Rm.state.shadowsArray,Dg=Cg.lightsHash,zg=Rg.state.hash,Ng=fg.getParameters(Lg,Rg.state,Ig,Ag,$m.numPlanes,$m.numIntersection,Pg),Bg=fg.getProgramCode(Lg,Ng),Ug=Cg.program,Gg=!0;if(Ug===void 0)Lg.addEventListener('dispose',Xu);else if(Ug.code!==Bg)Zu(Lg);else if(Dg.stateID!==zg.stateID||Dg.directionalLength!==zg.directionalLength||Dg.pointLength!==zg.pointLength||Dg.spotLength!==zg.spotLength||Dg.rectAreaLength!==zg.rectAreaLength||Dg.hemiLength!==zg.hemiLength||Dg.shadowsLength!==zg.shadowsLength)Dg.stateID=zg.stateID,Dg.directionalLength=zg.directionalLength,Dg.pointLength=zg.pointLength,Dg.spotLength=zg.spotLength,Dg.rectAreaLength=zg.rectAreaLength,Dg.hemiLength=zg.hemiLength,Dg.shadowsLength=zg.shadowsLength,Gg=!1;else{if(Ng.shaderID!==void 0)return;Gg=!1}if(Gg){if(Ng.shaderID){var Og=Hc[Ng.shaderID];Cg.shader={name:Lg.type,uniforms:Gc.clone(Og.uniforms),vertexShader:Og.vertexShader,fragmentShader:Og.fragmentShader}}else Cg.shader={name:Lg.type,uniforms:Lg.uniforms,vertexShader:Lg.vertexShader,fragmentShader:Lg.fragmentShader};Lg.onBeforeCompile(Cg.shader,Im),Bg=fg.getProgramCode(Lg,Ng),Ug=fg.acquireProgram(Lg,Cg.shader,Ng,Bg),Cg.program=Ug,Lg.program=Ug}var Fg=Ug.getAttributes();if(Lg.morphTargets){Lg.numSupportedMorphTargets=0;for(var Hg=0;Hg<Im.maxMorphTargets;Hg++)0<=Fg['morphTarget'+Hg]&&Lg.numSupportedMorphTargets++}if(Lg.morphNormals){Lg.numSupportedMorphNormals=0;for(var Hg=0;Hg<Im.maxMorphNormals;Hg++)0<=Fg['morphNormal'+Hg]&&Lg.numSupportedMorphNormals++}var Vg=Cg.shader.uniforms;(Lg.isShaderMaterial||Lg.isRawShaderMaterial)&&!0!==Lg.clipping||(Cg.numClippingPlanes=$m.numPlanes,Cg.numIntersection=$m.numIntersection,Vg.clippingPlanes=$m.uniform),Cg.fog=Ag,Dg===void 0&&(Cg.lightsHash=Dg={}),Dg.stateID=zg.stateID,Dg.directionalLength=zg.directionalLength,Dg.pointLength=zg.pointLength,Dg.spotLength=zg.spotLength,Dg.rectAreaLength=zg.rectAreaLength,Dg.hemiLength=zg.hemiLength,Dg.shadowsLength=zg.shadowsLength,Lg.lights&&(Vg.ambientLightColor.value=Rg.state.ambient,Vg.directionalLights.value=Rg.state.directional,Vg.spotLights.value=Rg.state.spot,Vg.rectAreaLights.value=Rg.state.rectArea,Vg.pointLights.value=Rg.state.point,Vg.hemisphereLights.value=Rg.state.hemi,Vg.directionalShadowMap.value=Rg.state.directionalShadowMap,Vg.directionalShadowMatrix.value=Rg.state.directionalShadowMatrix,Vg.spotShadowMap.value=Rg.state.spotShadowMap,Vg.spotShadowMatrix.value=Rg.state.spotShadowMatrix,Vg.pointShadowMap.value=Rg.state.pointShadowMap,Vg.pointShadowMatrix.value=Rg.state.pointShadowMatrix);var kg=Cg.program.getUniforms(),Wg=wt.seqWithValue(kg.seq,Vg);Cg.uniformsList=Wg}function am(Lg,Ag,Pg,Cg){Wm=0;var Rg=dg.get(Pg),Ig=Rm.state.lights,Dg=Rg.lightsHash,zg=Ig.state.hash;if(eg&&(tg||Lg!==Om)){var Ng=Lg===Om&&Pg.id===Um;$m.setState(Pg.clippingPlanes,Pg.clipIntersection,Pg.clipShadows,Lg,Rg,Ng)}!1===Pg.needsUpdate&&(void 0===Rg.program?Pg.needsUpdate=!0:Pg.fog&&Rg.fog!==Ag?Pg.needsUpdate=!0:Pg.lights&&(Dg.stateID!==zg.stateID||Dg.directionalLength!==zg.directionalLength||Dg.pointLength!==zg.pointLength||Dg.spotLength!==zg.spotLength||Dg.rectAreaLength!==zg.rectAreaLength||Dg.hemiLength!==zg.hemiLength||Dg.shadowsLength!==zg.shadowsLength)?Pg.needsUpdate=!0:void 0!==Rg.numClippingPlanes&&(Rg.numClippingPlanes!==$m.numPlanes||Rg.numIntersection!==$m.numIntersection)&&(Pg.needsUpdate=!0)),Pg.needsUpdate&&(rm(Pg,Ag,Cg),Pg.needsUpdate=!1);var Bg=!1,Ug=!1,Gg=!1,Og=Rg.program,Fg=Og.getUniforms(),Hg=Rg.shader.uniforms;if(lg.useProgram(Og.program)&&(Bg=!0,Ug=!0,Gg=!0),Pg.id!==Um&&(Um=Pg.id,Ug=!0),Bg||Om!==Lg){if(Fg.setValue(og,'projectionMatrix',Lg.projectionMatrix),sg.logarithmicDepthBuffer&&Fg.setValue(og,'logDepthBufFC',2/(Math.log(Lg.far+1)/Math.LN2)),Om!==Lg&&(Om=Lg,Ug=!0,Gg=!0),Pg.isShaderMaterial||Pg.isMeshPhongMaterial||Pg.isMeshStandardMaterial||Pg.envMap){var Vg=Fg.map.cameraPosition;void 0!==Vg&&Vg.setValue(og,ag.setFromMatrixPosition(Lg.matrixWorld))}(Pg.isMeshPhongMaterial||Pg.isMeshLambertMaterial||Pg.isMeshBasicMaterial||Pg.isMeshStandardMaterial||Pg.isShaderMaterial||Pg.skinning)&&Fg.setValue(og,'viewMatrix',Lg.matrixWorldInverse)}if(Pg.skinning){Fg.setOptional(og,Cg,'bindMatrix'),Fg.setOptional(og,Cg,'bindMatrixInverse');var kg=Cg.skeleton;if(kg){var Wg=kg.bones;if(sg.floatVertexTextures){if(void 0===kg.boneTexture){var jg=Math.sqrt(4*Wg.length);jg=hp.ceilPowerOfTwo(jg),jg=Math.max(jg,4);var qg=new Float32Array(4*(jg*jg));qg.set(kg.boneMatrices);var Xg=new G(qg,jg,jg,ll,Js);Xg.needsUpdate=!0,kg.boneMatrices=qg,kg.boneTexture=Xg,kg.boneTextureSize=jg}Fg.setValue(og,'boneTexture',kg.boneTexture),Fg.setValue(og,'boneTextureSize',kg.boneTextureSize)}else Fg.setOptional(og,kg,'boneMatrices')}}return Ug&&(Fg.setValue(og,'toneMappingExposure',Im.toneMappingExposure),Fg.setValue(og,'toneMappingWhitePoint',Im.toneMappingWhitePoint),Pg.lights&&vm(Hg,Gg),Ag&&Pg.fog&&pm(Hg,Ag),Pg.isMeshBasicMaterial?om(Hg,Pg):Pg.isMeshLambertMaterial?(om(Hg,Pg),dm(Hg,Pg)):Pg.isMeshPhongMaterial?(om(Hg,Pg),Pg.isMeshToonMaterial?um(Hg,Pg):cm(Hg,Pg)):Pg.isMeshStandardMaterial?(om(Hg,Pg),Pg.isMeshPhysicalMaterial?gm(Hg,Pg):mm(Hg,Pg)):Pg.isMeshMatcapMaterial?(om(Hg,Pg),fm(Hg,Pg)):Pg.isMeshDepthMaterial?(om(Hg,Pg),hm(Hg,Pg)):Pg.isMeshDistanceMaterial?(om(Hg,Pg),ym(Hg,Pg)):Pg.isMeshNormalMaterial?(om(Hg,Pg),xm(Hg,Pg)):Pg.isLineBasicMaterial?(im(Hg,Pg),Pg.isLineDashedMaterial&&nm(Hg,Pg)):Pg.isPointsMaterial?sm(Hg,Pg):Pg.isSpriteMaterial?lm(Hg,Pg):Pg.isShadowMaterial&&(Hg.color.value=Pg.color,Hg.opacity.value=Pg.opacity),void 0!==Hg.ltc_1&&(Hg.ltc_1.value=Fc.LTC_1),void 0!==Hg.ltc_2&&(Hg.ltc_2.value=Fc.LTC_2),wt.upload(og,Rg.uniformsList,Hg,Im)),Pg.isShaderMaterial&&!0===Pg.uniformsNeedUpdate&&(wt.upload(og,Rg.uniformsList,Hg,Im),Pg.uniformsNeedUpdate=!1),Pg.isSpriteMaterial&&Fg.setValue(og,'center',Cg.center),Fg.setValue(og,'modelViewMatrix',Cg.modelViewMatrix),Fg.setValue(og,'normalMatrix',Cg.normalMatrix),Fg.setValue(og,'modelMatrix',Cg.matrixWorld),Og}function om(Lg,Ag){Lg.opacity.value=Ag.opacity,Ag.color&&(Lg.diffuse.value=Ag.color),Ag.emissive&&Lg.emissive.value.copy(Ag.emissive).multiplyScalar(Ag.emissiveIntensity),Ag.map&&(Lg.map.value=Ag.map),Ag.alphaMap&&(Lg.alphaMap.value=Ag.alphaMap),Ag.specularMap&&(Lg.specularMap.value=Ag.specularMap),Ag.envMap&&(Lg.envMap.value=Ag.envMap,Lg.flipEnvMap.value=Ag.envMap&&Ag.envMap.isCubeTexture?-1:1,Lg.reflectivity.value=Ag.reflectivity,Lg.refractionRatio.value=Ag.refractionRatio,Lg.maxMipLevel.value=dg.get(Ag.envMap).__maxMipLevel),Ag.lightMap&&(Lg.lightMap.value=Ag.lightMap,Lg.lightMapIntensity.value=Ag.lightMapIntensity),Ag.aoMap&&(Lg.aoMap.value=Ag.aoMap,Lg.aoMapIntensity.value=Ag.aoMapIntensity);var Pg;Ag.map?Pg=Ag.map:Ag.specularMap?Pg=Ag.specularMap:Ag.displacementMap?Pg=Ag.displacementMap:Ag.normalMap?Pg=Ag.normalMap:Ag.bumpMap?Pg=Ag.bumpMap:Ag.roughnessMap?Pg=Ag.roughnessMap:Ag.metalnessMap?Pg=Ag.metalnessMap:Ag.alphaMap?Pg=Ag.alphaMap:Ag.emissiveMap&&(Pg=Ag.emissiveMap),Pg!=void 0&&(Pg.isWebGLRenderTarget&&(Pg=Pg.texture),!0===Pg.matrixAutoUpdate&&Pg.updateMatrix(),Lg.uvTransform.value.copy(Pg.matrix))}function im(Lg,Ag){Lg.diffuse.value=Ag.color,Lg.opacity.value=Ag.opacity}function nm(Lg,Ag){Lg.dashSize.value=Ag.dashSize,Lg.totalSize.value=Ag.dashSize+Ag.gapSize,Lg.scale.value=Ag.scale}function sm(Lg,Ag){Lg.diffuse.value=Ag.color,Lg.opacity.value=Ag.opacity,Lg.size.value=Ag.size*Ym,Lg.scale.value=0.5*Xm,Lg.map.value=Ag.map,null!==Ag.map&&(!0===Ag.map.matrixAutoUpdate&&Ag.map.updateMatrix(),Lg.uvTransform.value.copy(Ag.map.matrix))}function lm(Lg,Ag){Lg.diffuse.value=Ag.color,Lg.opacity.value=Ag.opacity,Lg.rotation.value=Ag.rotation,Lg.map.value=Ag.map,null!==Ag.map&&(!0===Ag.map.matrixAutoUpdate&&Ag.map.updateMatrix(),Lg.uvTransform.value.copy(Ag.map.matrix))}function pm(Lg,Ag){Lg.fogColor.value=Ag.color,Ag.isFog?(Lg.fogNear.value=Ag.near,Lg.fogFar.value=Ag.far):Ag.isFogExp2&&(Lg.fogDensity.value=Ag.density)}function dm(Lg,Ag){Ag.emissiveMap&&(Lg.emissiveMap.value=Ag.emissiveMap)}function cm(Lg,Ag){Lg.specular.value=Ag.specular,Lg.shininess.value=Math.max(Ag.shininess,1e-4),Ag.emissiveMap&&(Lg.emissiveMap.value=Ag.emissiveMap),Ag.bumpMap&&(Lg.bumpMap.value=Ag.bumpMap,Lg.bumpScale.value=Ag.bumpScale,Ag.side===Nn&&(Lg.bumpScale.value*=-1)),Ag.normalMap&&(Lg.normalMap.value=Ag.normalMap,Lg.normalScale.value.copy(Ag.normalScale),Ag.side===Nn&&Lg.normalScale.value.negate()),Ag.displacementMap&&(Lg.displacementMap.value=Ag.displacementMap,Lg.displacementScale.value=Ag.displacementScale,Lg.displacementBias.value=Ag.displacementBias)}function um(Lg,Ag){cm(Lg,Ag),Ag.gradientMap&&(Lg.gradientMap.value=Ag.gradientMap)}function mm(Lg,Ag){Lg.roughness.value=Ag.roughness,Lg.metalness.value=Ag.metalness,Ag.roughnessMap&&(Lg.roughnessMap.value=Ag.roughnessMap),Ag.metalnessMap&&(Lg.metalnessMap.value=Ag.metalnessMap),Ag.emissiveMap&&(Lg.emissiveMap.value=Ag.emissiveMap),Ag.bumpMap&&(Lg.bumpMap.value=Ag.bumpMap,Lg.bumpScale.value=Ag.bumpScale,Ag.side===Nn&&(Lg.bumpScale.value*=-1)),Ag.normalMap&&(Lg.normalMap.value=Ag.normalMap,Lg.normalScale.value.copy(Ag.normalScale),Ag.side===Nn&&Lg.normalScale.value.negate()),Ag.displacementMap&&(Lg.displacementMap.value=Ag.displacementMap,Lg.displacementScale.value=Ag.displacementScale,Lg.displacementBias.value=Ag.displacementBias),Ag.envMap&&(Lg.envMapIntensity.value=Ag.envMapIntensity)}function gm(Lg,Ag){mm(Lg,Ag),Lg.reflectivity.value=Ag.reflectivity,Lg.clearCoat.value=Ag.clearCoat,Lg.clearCoatRoughness.value=Ag.clearCoatRoughness}function fm(Lg,Ag){Ag.matcap&&(Lg.matcap.value=Ag.matcap),Ag.bumpMap&&(Lg.bumpMap.value=Ag.bumpMap,Lg.bumpScale.value=Ag.bumpScale,Ag.side===Nn&&(Lg.bumpScale.value*=-1)),Ag.normalMap&&(Lg.normalMap.value=Ag.normalMap,Lg.normalScale.value.copy(Ag.normalScale),Ag.side===Nn&&Lg.normalScale.value.negate()),Ag.displacementMap&&(Lg.displacementMap.value=Ag.displacementMap,Lg.displacementScale.value=Ag.displacementScale,Lg.displacementBias.value=Ag.displacementBias)}function hm(Lg,Ag){Ag.displacementMap&&(Lg.displacementMap.value=Ag.displacementMap,Lg.displacementScale.value=Ag.displacementScale,Lg.displacementBias.value=Ag.displacementBias)}function ym(Lg,Ag){Ag.displacementMap&&(Lg.displacementMap.value=Ag.displacementMap,Lg.displacementScale.value=Ag.displacementScale,Lg.displacementBias.value=Ag.displacementBias),Lg.referencePosition.value.copy(Ag.referencePosition),Lg.nearDistance.value=Ag.nearDistance,Lg.farDistance.value=Ag.farDistance}function xm(Lg,Ag){Ag.bumpMap&&(Lg.bumpMap.value=Ag.bumpMap,Lg.bumpScale.value=Ag.bumpScale,Ag.side===Nn&&(Lg.bumpScale.value*=-1)),Ag.normalMap&&(Lg.normalMap.value=Ag.normalMap,Lg.normalScale.value.copy(Ag.normalScale),Ag.side===Nn&&Lg.normalScale.value.negate()),Ag.displacementMap&&(Lg.displacementMap.value=Ag.displacementMap,Lg.displacementScale.value=Ag.displacementScale,Lg.displacementBias.value=Ag.displacementBias)}function vm(Lg,Ag){Lg.ambientLightColor.needsUpdate=Ag,Lg.directionalLights.needsUpdate=Ag,Lg.pointLights.needsUpdate=Ag,Lg.spotLights.needsUpdate=Ag,Lg.rectAreaLights.needsUpdate=Ag,Lg.hemisphereLights.needsUpdate=Ag}console.log('THREE.WebGLRenderer','99dev'),Vu=Vu||{};var bm=Vu.canvas===void 0?document.createElementNS('http://www.w3.org/1999/xhtml','canvas'):Vu.canvas,Mm=Vu.context===void 0?null:Vu.context,Sm=Vu.alpha!==void 0&&Vu.alpha,Tm=!(Vu.depth!==void 0)||Vu.depth,Em=!(Vu.stencil!==void 0)||Vu.stencil,wm=Vu.antialias!==void 0&&Vu.antialias,Lm=!(Vu.premultipliedAlpha!==void 0)||Vu.premultipliedAlpha,Am=Vu.preserveDrawingBuffer!==void 0&&Vu.preserveDrawingBuffer,Pm=Vu.powerPreference===void 0?'default':Vu.powerPreference,Cm=null,Rm=null;this.domElement=bm,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ss,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Im=this,Dm=!1,zm=null,Nm=null,Bm=null,Um=-1,Gm={geometry:null,program:null,wireframe:!1},Om=null,Fm=null,Hm=new I,Vm=new I,km=null,Wm=0,jm=bm.width,Xm=bm.height,Ym=1,Zm=new I(0,0,jm,Xm),Jm=new I(0,0,jm,Xm),Qm=!1,Km=new V,$m=new De,eg=!1,tg=!1,rg=new E,ag=new A,og;try{var ig={alpha:Sm,depth:Tm,stencil:Em,antialias:wm,premultipliedAlpha:Lm,preserveDrawingBuffer:Am,powerPreference:Pm};if(bm.addEventListener('webglcontextlost',ju,!1),bm.addEventListener('webglcontextrestored',qu,!1),og=Mm||bm.getContext('webgl',ig)||bm.getContext('experimental-webgl',ig),null===og)if(null!==bm.getContext('webgl'))throw new Error('Error creating WebGL context with your selected attributes.');else throw new Error('Error creating WebGL context.');void 0===og.getShaderPrecisionFormat&&(og.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Lg){console.error('THREE.WebGLRenderer: '+Lg.message)}var ng,sg,lg,pg,dg,cg,ug,mg,gg,fg,hg,yg,xg,vg,_g,bg,Mg;Wu();var Sg=null;'undefined'!=typeof navigator&&(Sg='xr'in navigator?new dr(Im):new pr(Im)),this.vr=Sg;var Tg=new er(Im,gg,sg.maxTextureSize);this.shadowMap=Tg,this.getContext=function(){return og},this.getContextAttributes=function(){return og.getContextAttributes()},this.forceContextLoss=function(){var Lg=ng.get('WEBGL_lose_context');Lg&&Lg.loseContext()},this.forceContextRestore=function(){var Lg=ng.get('WEBGL_lose_context');Lg&&Lg.restoreContext()},this.getPixelRatio=function(){return Ym},this.setPixelRatio=function(Lg){void 0===Lg||(Ym=Lg,this.setSize(jm,Xm,!1))},this.getSize=function(){return{width:jm,height:Xm}},this.setSize=function(Lg,Ag,Pg){return Sg.isPresenting()?void console.warn('THREE.WebGLRenderer: Can\'t change size while VR device is presenting.'):void(jm=Lg,Xm=Ag,bm.width=Lg*Ym,bm.height=Ag*Ym,!1!==Pg&&(bm.style.width=Lg+'px',bm.style.height=Ag+'px'),this.setViewport(0,0,Lg,Ag))},this.getDrawingBufferSize=function(){return{width:jm*Ym,height:Xm*Ym}},this.setDrawingBufferSize=function(Lg,Ag,Pg){jm=Lg,Xm=Ag,Ym=Pg,bm.width=Lg*Pg,bm.height=Ag*Pg,this.setViewport(0,0,Lg,Ag)},this.getCurrentViewport=function(){return Hm},this.setViewport=function(Lg,Ag,Pg,Cg){Zm.set(Lg,Xm-Ag-Cg,Pg,Cg),lg.viewport(Hm.copy(Zm).multiplyScalar(Ym))},this.setScissor=function(Lg,Ag,Pg,Cg){Jm.set(Lg,Xm-Ag-Cg,Pg,Cg),lg.scissor(Vm.copy(Jm).multiplyScalar(Ym))},this.setScissorTest=function(Lg){lg.setScissorTest(Qm=Lg)},this.getClearColor=function(){return xg.getClearColor()},this.setClearColor=function(){xg.setClearColor.apply(xg,arguments)},this.getClearAlpha=function(){return xg.getClearAlpha()},this.setClearAlpha=function(){xg.setClearAlpha.apply(xg,arguments)},this.clear=function(Lg,Ag,Pg){var Cg=0;(Lg===void 0||Lg)&&(Cg|=16384),(Ag===void 0||Ag)&&(Cg|=256),(Pg===void 0||Pg)&&(Cg|=1024),og.clear(Cg)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){bm.removeEventListener('webglcontextlost',ju,!1),bm.removeEventListener('webglcontextrestored',qu,!1),hg.dispose(),yg.dispose(),dg.dispose(),gg.dispose(),Sg.dispose(),wg.stop()},this.renderBufferImmediate=function(Lg,Ag){lg.initAttributes();var Pg=dg.get(Lg);Lg.hasPositions&&!Pg.position&&(Pg.position=og.createBuffer()),Lg.hasNormals&&!Pg.normal&&(Pg.normal=og.createBuffer()),Lg.hasUvs&&!Pg.uv&&(Pg.uv=og.createBuffer()),Lg.hasColors&&!Pg.color&&(Pg.color=og.createBuffer());var Cg=Ag.getAttributes();Lg.hasPositions&&(og.bindBuffer(34962,Pg.position),og.bufferData(34962,Lg.positionArray,35048),lg.enableAttribute(Cg.position),og.vertexAttribPointer(Cg.position,3,5126,!1,0,0)),Lg.hasNormals&&(og.bindBuffer(34962,Pg.normal),og.bufferData(34962,Lg.normalArray,35048),lg.enableAttribute(Cg.normal),og.vertexAttribPointer(Cg.normal,3,5126,!1,0,0)),Lg.hasUvs&&(og.bindBuffer(34962,Pg.uv),og.bufferData(34962,Lg.uvArray,35048),lg.enableAttribute(Cg.uv),og.vertexAttribPointer(Cg.uv,2,5126,!1,0,0)),Lg.hasColors&&(og.bindBuffer(34962,Pg.color),og.bufferData(34962,Lg.colorArray,35048),lg.enableAttribute(Cg.color),og.vertexAttribPointer(Cg.color,3,5126,!1,0,0)),lg.disableUnusedAttributes(),og.drawArrays(4,0,Lg.count),Lg.count=0},this.renderBufferDirect=function(Lg,Ag,Pg,Cg,Rg,Ig){var Dg=Rg.isMesh&&0>Rg.normalMatrix.determinant();lg.setMaterial(Cg,Dg);var zg=am(Lg,Ag,Cg,Rg),Ng=!1;(Gm.geometry!==Pg.id||Gm.program!==zg.id||Gm.wireframe!==(!0===Cg.wireframe))&&(Gm.geometry=Pg.id,Gm.program=zg.id,Gm.wireframe=!0===Cg.wireframe,Ng=!0),Rg.morphTargetInfluences&&(vg.update(Rg,Pg,Cg,zg),Ng=!0);var Bg=Pg.index,Ug=Pg.attributes.position,Gg=1;!0===Cg.wireframe&&(Bg=mg.getWireframeAttribute(Pg),Gg=2);var Og,Fg=_g;null!==Bg&&(Og=ug.get(Bg),Fg=bg,Fg.setIndex(Og)),Ng&&(Qu(Cg,zg,Pg),null!==Bg&&og.bindBuffer(34963,Og.buffer));var Hg=Infinity;null===Bg?Ug!==void 0&&(Hg=Ug.count):Hg=Bg.count;var Vg=Pg.drawRange.start*Gg,kg=Pg.drawRange.count*Gg,Wg=null===Ig?0:Ig.start*Gg,jg=null===Ig?Infinity:Ig.count*Gg,qg=Math.max(Vg,Wg),Xg=Math.min(Hg,Vg+kg,Wg+jg)-1,Yg=Math.max(0,Xg-qg+1);if(0!==Yg){if(Rg.isMesh){if(!0===Cg.wireframe)lg.setLineWidth(Cg.wireframeLinewidth*ku()),Fg.setMode(1);else switch(Rg.drawMode){case ep:Fg.setMode(4);break;case 1:Fg.setMode(5);break;case 2:Fg.setMode(6);}}else if(Rg.isLine){var Zg=Cg.linewidth;void 0===Zg&&(Zg=1),lg.setLineWidth(Zg*ku()),Rg.isLineSegments?Fg.setMode(1):Rg.isLineLoop?Fg.setMode(2):Fg.setMode(3)}else Rg.isPoints?Fg.setMode(0):Rg.isSprite&&Fg.setMode(4);Pg&&Pg.isInstancedBufferGeometry?0<Pg.maxInstancedCount&&Fg.renderInstances(Pg,qg,Yg):Fg.render(qg,Yg)}},this.compile=function(Lg,Ag){Rm=yg.get(Lg,Ag),Rm.init(),Lg.traverse(function(Pg){Pg.isLight&&(Rm.pushLight(Pg),Pg.castShadow&&Rm.pushShadow(Pg))}),Rm.setupLights(Ag),Lg.traverse(function(Pg){if(Pg.material)if(Array.isArray(Pg.material))for(var Cg=0;Cg<Pg.material.length;Cg++)rm(Pg.material[Cg],Lg.fog,Pg);else rm(Pg.material,Lg.fog,Pg)})};var Eg=null,wg=new X;wg.setAnimationLoop(function(Lg){Sg.isPresenting()||Eg&&Eg(Lg)}),'undefined'!=typeof window&&wg.setContext(window),this.setAnimationLoop=function(Lg){Eg=Lg,Sg.setAnimationLoop(Lg),wg.start()},this.render=function(Lg,Ag,Pg,Cg){if(!(Ag&&Ag.isCamera))return void console.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');if(!Dm){Gm.geometry=null,Gm.program=null,Gm.wireframe=!1,Um=-1,Om=null,!0===Lg.autoUpdate&&Lg.updateMatrixWorld(),null===Ag.parent&&Ag.updateMatrixWorld(),Sg.enabled&&(Ag=Sg.getCamera(Ag)),Rm=yg.get(Lg,Ag),Rm.init(),Lg.onBeforeRender(Im,Lg,Ag,Pg),rg.multiplyMatrices(Ag.projectionMatrix,Ag.matrixWorldInverse),Km.setFromMatrix(rg),tg=this.localClippingEnabled,eg=$m.init(this.clippingPlanes,tg,Ag),Cm=hg.get(Lg,Ag),Cm.init(),$u(Lg,Ag,Im.sortObjects),!0===Im.sortObjects&&Cm.sort(),eg&&$m.beginShadows();var Rg=Rm.state.shadowsArray;Tg.render(Rg,Lg,Ag),Rm.setupLights(Ag),eg&&$m.endShadows(),this.info.autoReset&&this.info.reset(),void 0===Pg&&(Pg=null),this.setRenderTarget(Pg),xg.render(Cm,Lg,Ag,Cg);var Ig=Cm.opaque,Dg=Cm.transparent;if(Lg.overrideMaterial){var zg=Lg.overrideMaterial;Ig.length&&em(Ig,Lg,Ag,zg),Dg.length&&em(Dg,Lg,Ag,zg)}else Ig.length&&em(Ig,Lg,Ag),Dg.length&&em(Dg,Lg,Ag);Pg&&cg.updateRenderTargetMipmap(Pg),lg.buffers.depth.setTest(!0),lg.buffers.depth.setMask(!0),lg.buffers.color.setMask(!0),lg.setPolygonOffset(!1),Lg.onAfterRender(Im,Lg,Ag),Sg.enabled&&Sg.submitFrame(),Cm=null,Rm=null}},this.allocTextureUnit=function(){var Lg=Wm;return Lg>=sg.maxTextures&&console.warn('THREE.WebGLRenderer: Trying to use '+Lg+' texture units while this GPU supports only '+sg.maxTextures),Wm+=1,Lg},this.setTexture2D=function(){var Lg=!1;return function(Pg,Cg){Pg&&Pg.isWebGLRenderTarget&&(!Lg&&(console.warn('THREE.WebGLRenderer.setTexture2D: don\'t use render targets as textures. Use their .texture property instead.'),Lg=!0),Pg=Pg.texture),cg.setTexture2D(Pg,Cg)}}(),this.setTexture3D=function(){return function(Ag,Pg){cg.setTexture3D(Ag,Pg)}}(),this.setTexture=function(){var Lg=!1;return function(Pg,Cg){Lg||(console.warn('THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.'),Lg=!0),cg.setTexture2D(Pg,Cg)}}(),this.setTextureCube=function(){var Lg=!1;return function(Pg,Cg){Pg&&Pg.isWebGLRenderTargetCube&&(!Lg&&(console.warn('THREE.WebGLRenderer.setTextureCube: don\'t use cube render targets as textures. Use their .texture property instead.'),Lg=!0),Pg=Pg.texture),Pg&&Pg.isCubeTexture||Array.isArray(Pg.image)&&6===Pg.image.length?cg.setTextureCube(Pg,Cg):cg.setTextureCubeDynamic(Pg,Cg)}}(),this.setFramebuffer=function(Lg){zm=Lg},this.getRenderTarget=function(){return Nm},this.setRenderTarget=function(Lg){Nm=Lg,Lg&&void 0===dg.get(Lg).__webglFramebuffer&&cg.setupRenderTarget(Lg);var Ag=zm,Pg=!1;if(Lg){var Cg=dg.get(Lg).__webglFramebuffer;Lg.isWebGLRenderTargetCube?(Ag=Cg[Lg.activeCubeFace],Pg=!0):Ag=Cg,Hm.copy(Lg.viewport),Vm.copy(Lg.scissor),km=Lg.scissorTest}else Hm.copy(Zm).multiplyScalar(Ym),Vm.copy(Jm).multiplyScalar(Ym),km=Qm;if(Bm!==Ag&&(og.bindFramebuffer(36160,Ag),Bm=Ag),lg.viewport(Hm),lg.scissor(Vm),lg.setScissorTest(km),Pg){var Rg=dg.get(Lg.texture);og.framebufferTexture2D(36160,36064,34069+Lg.activeCubeFace,Rg.__webglTexture,Lg.activeMipMapLevel)}},this.readRenderTargetPixels=function(Lg,Ag,Pg,Cg,Rg,Ig){if(!(Lg&&Lg.isWebGLRenderTarget))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');var Dg=dg.get(Lg).__webglFramebuffer;if(Dg){var zg=!1;Dg!==Bm&&(og.bindFramebuffer(36160,Dg),zg=!0);try{var Ng=Lg.texture,Bg=Ng.format,Ug=Ng.type;if(Bg!==ll&&Mg.convert(Bg)!==og.getParameter(35739))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.');if(Ug!==Ws&&Mg.convert(Ug)!==og.getParameter(35738)&&!(Ug===Js&&(sg.isWebGL2||ng.get('OES_texture_float')||ng.get('WEBGL_color_buffer_float')))&&!(Ug===Qs&&(sg.isWebGL2?ng.get('EXT_color_buffer_float'):ng.get('EXT_color_buffer_half_float'))))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.');36053===og.checkFramebufferStatus(36160)?0<=Ag&&Ag<=Lg.width-Cg&&0<=Pg&&Pg<=Lg.height-Rg&&og.readPixels(Ag,Pg,Cg,Rg,Mg.convert(Bg),Mg.convert(Ug),Ig):console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.')}finally{zg&&og.bindFramebuffer(36160,Bm)}}},this.copyFramebufferToTexture=function(Lg,Ag,Pg){var Cg=Ag.image.width,Rg=Ag.image.height,Ig=Mg.convert(Ag.format);this.setTexture2D(Ag,0),og.copyTexImage2D(3553,Pg||0,Ig,Lg.x,Lg.y,Cg,Rg,0)},this.copyTextureToTexture=function(Lg,Ag,Pg,Cg){var Rg=Ag.image.width,Ig=Ag.image.height,Dg=Mg.convert(Pg.format),zg=Mg.convert(Pg.type);this.setTexture2D(Pg,0),Ag.isDataTexture?og.texSubImage2D(3553,Cg||0,Lg.x,Lg.y,Rg,Ig,Dg,zg,Ag.image.data):og.texSubImage2D(3553,Cg||0,Lg.x,Lg.y,Dg,zg,Ag.image)}}function ur(Vu,ku){this.name='',this.color=new W(Vu),this.density=ku===void 0?2.5e-4:ku}function mr(Vu,ku,Wu){this.name='',this.color=new W(Vu),this.near=ku===void 0?1:ku,this.far=Wu===void 0?1e3:Wu}function gr(){K.call(this),this.type='Scene',this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function fr(Vu,ku){this.array=Vu,this.stride=ku,this.count=Vu===void 0?0:Vu.length/ku,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function hr(Vu,ku,Wu,ju){this.data=Vu,this.itemSize=ku,this.offset=Wu,this.normalized=!0===ju}function yr(Vu){Te.call(this),this.type='SpriteMaterial',this.color=new W(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(Vu)}function xr(Vu){if(K.call(this),this.type='Sprite',void 0===iu){iu=new xe;var ku=new Float32Array([-0.5,-0.5,0,0,0,0.5,-0.5,0,1,0,0.5,0.5,0,1,1,-0.5,0.5,0,0,1]),Wu=new fr(ku,5);iu.setIndex([0,1,2,0,2,3]),iu.addAttribute('position',new hr(Wu,3,0,!1)),iu.addAttribute('uv',new hr(Wu,2,3,!1))}this.geometry=iu,this.material=void 0===Vu?new yr:Vu,this.center=new S(0.5,0.5)}function _r(){K.call(this),this.type='LOD',Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function br(Vu,ku){if(Vu=Vu||[],this.bones=Vu.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===ku)this.calculateInverses();else if(this.bones.length===ku.length)this.boneInverses=ku.slice(0);else{console.warn('THREE.Skeleton boneInverses is the wrong length.'),this.boneInverses=[];for(var Wu=0,ju=this.bones.length;Wu<ju;Wu++)this.boneInverses.push(new E)}}function Mr(){K.call(this),this.type='Bone'}function Sr(Vu,ku){Pe.call(this,Vu,ku),this.type='SkinnedMesh',this.bindMode='attached',this.bindMatrix=new E,this.bindMatrixInverse=new E;var Wu=this.initBones(),ju=new br(Wu);this.bind(ju,this.matrixWorld),this.normalizeSkinWeights()}function Tr(Vu){Te.call(this),this.type='LineBasicMaterial',this.color=new W(16777215),this.linewidth=1,this.linecap='round',this.linejoin='round',this.lights=!1,this.setValues(Vu)}function Er(Vu,ku,Wu){1===Wu&&console.error('THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.'),K.call(this),this.type='Line',this.geometry=Vu===void 0?new xe:Vu,this.material=ku===void 0?new Tr({color:16777215*Math.random()}):ku}function wr(Vu,ku){Er.call(this,Vu,ku),this.type='LineSegments'}function Lr(Vu,ku){Er.call(this,Vu,ku),this.type='LineLoop'}function Ar(Vu){Te.call(this),this.type='PointsMaterial',this.color=new W(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(Vu)}function Pr(Vu,ku){K.call(this),this.type='Points',this.geometry=Vu===void 0?new xe:Vu,this.material=ku===void 0?new Ar({color:16777215*Math.random()}):ku}function Cr(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju){R.call(this,Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju),this.format=Yu===void 0?nl:Yu,this.minFilter=Xu===void 0?Hs:Xu,this.magFilter=qu===void 0?Hs:qu,this.generateMipmaps=!1}function Rr(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu,Ku,$u){R.call(this,null,Xu,Yu,Zu,Ju,Qu,ju,qu,Ku,$u),this.image={width:ku,height:Wu},this.mipmaps=Vu,this.flipY=!1,this.generateMipmaps=!1}function Ir(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju){R.call(this,Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju),this.needsUpdate=!0}function Dr(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu){if(Qu=void 0===Qu?ul:Qu,Qu!==ul&&Qu!==yl)throw new Error('DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat');void 0===Wu&&Qu===ul&&(Wu=Xs),void 0===Wu&&Qu===yl&&(Wu=rl),R.call(this,null,ju,qu,Xu,Yu,Zu,Qu,Wu,Ju),this.image={width:Vu,height:ku},this.magFilter=void 0===Yu?Gs:Yu,this.minFilter=void 0===Zu?Gs:Zu,this.flipY=!1,this.generateMipmaps=!1}function zr(Vu){xe.call(this),this.type='WireframeGeometry';var ku=[],Wu,ju,qu,Xu,Yu,Zu=[0,0],Ju={},Qu,Ku,$u,em,tm=['a','b','c'],rm;if(Vu&&Vu.isGeometry){var am=Vu.faces;for(Wu=0,qu=am.length;Wu<qu;Wu++){var om=am[Wu];for(ju=0;3>ju;ju++)Ku=om[tm[ju]],$u=om[tm[(ju+1)%3]],Zu[0]=Math.min(Ku,$u),Zu[1]=Math.max(Ku,$u),em=Zu[0]+','+Zu[1],void 0===Ju[em]&&(Ju[em]={index1:Zu[0],index2:Zu[1]})}for(em in Ju)Qu=Ju[em],rm=Vu.vertices[Qu.index1],ku.push(rm.x,rm.y,rm.z),rm=Vu.vertices[Qu.index2],ku.push(rm.x,rm.y,rm.z)}else if(Vu&&Vu.isBufferGeometry){var im,nm,sm,lm,pm,dm,cm,um;if(rm=new A,null!==Vu.index){for(im=Vu.attributes.position,nm=Vu.index,sm=Vu.groups,0===sm.length&&(sm=[{start:0,count:nm.count,materialIndex:0}]),(Xu=0,Yu=sm.length);Xu<Yu;++Xu)for(lm=sm[Xu],pm=lm.start,dm=lm.count,(Wu=pm,qu=pm+dm);Wu<qu;Wu+=3)for(ju=0;3>ju;ju++)Ku=nm.getX(Wu+ju),$u=nm.getX(Wu+(ju+1)%3),Zu[0]=Math.min(Ku,$u),Zu[1]=Math.max(Ku,$u),em=Zu[0]+','+Zu[1],void 0===Ju[em]&&(Ju[em]={index1:Zu[0],index2:Zu[1]});for(em in Ju)Qu=Ju[em],rm.fromBufferAttribute(im,Qu.index1),ku.push(rm.x,rm.y,rm.z),rm.fromBufferAttribute(im,Qu.index2),ku.push(rm.x,rm.y,rm.z)}else for(im=Vu.attributes.position,Wu=0,qu=im.count/3;Wu<qu;Wu++)for(ju=0;3>ju;ju++)cm=3*Wu+ju,rm.fromBufferAttribute(im,cm),ku.push(rm.x,rm.y,rm.z),um=3*Wu+(ju+1)%3,rm.fromBufferAttribute(im,um),ku.push(rm.x,rm.y,rm.z)}this.addAttribute('position',new ge(ku,3))}function Nr(Vu,ku,Wu){ee.call(this),this.type='ParametricGeometry',this.parameters={func:Vu,slices:ku,stacks:Wu},this.fromBufferGeometry(new Br(Vu,ku,Wu)),this.mergeVertices()}function Br(Vu,ku,Wu){xe.call(this),this.type='ParametricBufferGeometry',this.parameters={func:Vu,slices:ku,stacks:Wu};var ju=[],qu=[],Xu=[],Yu=[],Zu=1e-5,Ju=new A,Qu=new A,Ku=new A,$u=new A,em=new A,tm,rm;3>Vu.length&&console.error('THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.');var am=ku+1;for(tm=0;tm<=Wu;tm++){var om=tm/Wu;for(rm=0;rm<=ku;rm++){var im=rm/ku;Vu(im,om,Qu),qu.push(Qu.x,Qu.y,Qu.z),0<=im-Zu?(Vu(im-Zu,om,Ku),$u.subVectors(Qu,Ku)):(Vu(im+Zu,om,Ku),$u.subVectors(Ku,Qu)),0<=om-Zu?(Vu(im,om-Zu,Ku),em.subVectors(Qu,Ku)):(Vu(im,om+Zu,Ku),em.subVectors(Ku,Qu)),Ju.crossVectors($u,em).normalize(),Xu.push(Ju.x,Ju.y,Ju.z),Yu.push(im,om)}}for(tm=0;tm<Wu;tm++)for(rm=0;rm<ku;rm++){var nm=tm*am+rm,sm=tm*am+rm+1,lm=(tm+1)*am+rm+1,pm=(tm+1)*am+rm;ju.push(nm,sm,pm),ju.push(sm,lm,pm)}this.setIndex(ju),this.addAttribute('position',new ge(qu,3)),this.addAttribute('normal',new ge(Xu,3)),this.addAttribute('uv',new ge(Yu,2))}function Ur(Vu,ku,Wu,ju){ee.call(this),this.type='PolyhedronGeometry',this.parameters={vertices:Vu,indices:ku,radius:Wu,detail:ju},this.fromBufferGeometry(new Gr(Vu,ku,Wu,ju)),this.mergeVertices()}function Gr(Vu,ku,Wu,ju){function Xu(im,nm,sm,lm){var pm=Math.pow(2,lm),dm=[],cm,um;for(cm=0;cm<=pm;cm++){dm[cm]=[];var mm=im.clone().lerp(sm,cm/pm),gm=nm.clone().lerp(sm,cm/pm),fm=pm-cm;for(um=0;um<=fm;um++)dm[cm][um]=0===um&&cm===pm?mm:mm.clone().lerp(gm,um/fm)}for(cm=0;cm<pm;cm++)for(um=0;um<2*(pm-cm)-1;um++){var hm=Math.floor(um/2);0==um%2?(Qu(dm[cm][hm+1]),Qu(dm[cm+1][hm]),Qu(dm[cm][hm])):(Qu(dm[cm][hm+1]),Qu(dm[cm+1][hm+1]),Qu(dm[cm+1][hm]))}}function Ju(){for(var im=0;im<om.length;im+=6){var nm=om[im+0],sm=om[im+2],lm=om[im+4],pm=Math.max(nm,sm,lm),dm=Math.min(nm,sm,lm);0.9<pm&&0.1>dm&&(0.2>nm&&(om[im+0]+=1),0.2>sm&&(om[im+2]+=1),0.2>lm&&(om[im+4]+=1))}}function Qu(im){am.push(im.x,im.y,im.z)}function Ku(im,nm){var sm=3*im;nm.x=Vu[sm+0],nm.y=Vu[sm+1],nm.z=Vu[sm+2]}function $u(){for(var im=new A,nm=new A,sm=new A,lm=new A,pm=new S,dm=new S,cm=new S,um=0,mm=0;um<am.length;um+=9,mm+=6){im.set(am[um+0],am[um+1],am[um+2]),nm.set(am[um+3],am[um+4],am[um+5]),sm.set(am[um+6],am[um+7],am[um+8]),pm.set(om[mm+0],om[mm+1]),dm.set(om[mm+2],om[mm+3]),cm.set(om[mm+4],om[mm+5]),lm.copy(im).add(nm).add(sm).divideScalar(3);var gm=tm(lm);em(pm,mm+0,im,gm),em(dm,mm+2,nm,gm),em(cm,mm+4,sm,gm)}}function em(im,nm,sm,lm){0>lm&&1===im.x&&(om[nm]=im.x-1),0===sm.x&&0===sm.z&&(om[nm]=lm/2/Math.PI+0.5)}function tm(im){return Math.atan2(im.z,-im.x)}function rm(im){return Math.atan2(-im.y,Math.sqrt(im.x*im.x+im.z*im.z))}xe.call(this),this.type='PolyhedronBufferGeometry',this.parameters={vertices:Vu,indices:ku,radius:Wu,detail:ju},Wu=Wu||1,ju=ju||0;var am=[],om=[];(function(im){for(var nm=new A,sm=new A,lm=new A,pm=0;pm<ku.length;pm+=3)Ku(ku[pm+0],nm),Ku(ku[pm+1],sm),Ku(ku[pm+2],lm),Xu(nm,sm,lm,im)})(ju),function(im){for(var nm=new A,sm=0;sm<am.length;sm+=3)nm.x=am[sm+0],nm.y=am[sm+1],nm.z=am[sm+2],nm.normalize().multiplyScalar(im),am[sm+0]=nm.x,am[sm+1]=nm.y,am[sm+2]=nm.z}(Wu),function(){for(var im=new A,nm=0;nm<am.length;nm+=3){im.x=am[nm+0],im.y=am[nm+1],im.z=am[nm+2];var sm=tm(im)/2/Math.PI+0.5,lm=rm(im)/Math.PI+0.5;om.push(sm,1-lm)}$u(),Ju()}(),this.addAttribute('position',new ge(am,3)),this.addAttribute('normal',new ge(am.slice(),3)),this.addAttribute('uv',new ge(om,2)),0===ju?this.computeVertexNormals():this.normalizeNormals()}function Or(Vu,ku){ee.call(this),this.type='TetrahedronGeometry',this.parameters={radius:Vu,detail:ku},this.fromBufferGeometry(new Fr(Vu,ku)),this.mergeVertices()}function Fr(Vu,ku){Gr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],Vu,ku),this.type='TetrahedronBufferGeometry',this.parameters={radius:Vu,detail:ku}}function Hr(Vu,ku){ee.call(this),this.type='OctahedronGeometry',this.parameters={radius:Vu,detail:ku},this.fromBufferGeometry(new Vr(Vu,ku)),this.mergeVertices()}function Vr(Vu,ku){Gr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],Vu,ku),this.type='OctahedronBufferGeometry',this.parameters={radius:Vu,detail:ku}}function kr(Vu,ku){ee.call(this),this.type='IcosahedronGeometry',this.parameters={radius:Vu,detail:ku},this.fromBufferGeometry(new Wr(Vu,ku)),this.mergeVertices()}function Wr(Vu,ku){var Wu=(1+Math.sqrt(5))/2;Gr.call(this,[-1,Wu,0,1,Wu,0,-1,-Wu,0,1,-Wu,0,0,-1,Wu,0,1,Wu,0,-1,-Wu,0,1,-Wu,Wu,0,-1,Wu,0,1,-Wu,0,-1,-Wu,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],Vu,ku),this.type='IcosahedronBufferGeometry',this.parameters={radius:Vu,detail:ku}}function jr(Vu,ku){ee.call(this),this.type='DodecahedronGeometry',this.parameters={radius:Vu,detail:ku},this.fromBufferGeometry(new qr(Vu,ku)),this.mergeVertices()}function qr(Vu,ku){var Wu=(1+Math.sqrt(5))/2,ju=1/Wu;Gr.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-ju,-Wu,0,-ju,Wu,0,ju,-Wu,0,ju,Wu,-ju,-Wu,0,-ju,Wu,0,ju,-Wu,0,ju,Wu,0,-Wu,0,-ju,Wu,0,-ju,-Wu,0,ju,Wu,0,ju],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],Vu,ku),this.type='DodecahedronBufferGeometry',this.parameters={radius:Vu,detail:ku}}function Xr(Vu,ku,Wu,ju,qu,Xu){ee.call(this),this.type='TubeGeometry',this.parameters={path:Vu,tubularSegments:ku,radius:Wu,radialSegments:ju,closed:qu},Xu!==void 0&&console.warn('THREE.TubeGeometry: taper has been removed.');var Yu=new Yr(Vu,ku,Wu,ju,qu);this.tangents=Yu.tangents,this.normals=Yu.normals,this.binormals=Yu.binormals,this.fromBufferGeometry(Yu),this.mergeVertices()}function Yr(Vu,ku,Wu,ju,qu){function Yu(lm){tm=Vu.getPointAt(lm/ku,tm);var pm=Qu.normals[lm],dm=Qu.binormals[lm];for(am=0;am<=ju;am++){var cm=2*(am/ju*Math.PI),um=Math.sin(cm),mm=-Math.cos(cm);$u.x=mm*pm.x+um*dm.x,$u.y=mm*pm.y+um*dm.y,$u.z=mm*pm.z+um*dm.z,$u.normalize(),im.push($u.x,$u.y,$u.z),Ku.x=tm.x+Wu*$u.x,Ku.y=tm.y+Wu*$u.y,Ku.z=tm.z+Wu*$u.z,om.push(Ku.x,Ku.y,Ku.z)}}function Zu(){for(am=1;am<=ku;am++)for(rm=1;rm<=ju;rm++){var lm=(ju+1)*(am-1)+(rm-1),pm=(ju+1)*am+(rm-1),dm=(ju+1)*am+rm,cm=(ju+1)*(am-1)+rm;sm.push(lm,pm,cm),sm.push(pm,dm,cm)}}function Ju(){for(rm=0;rm<=ku;rm++)for(am=0;am<=ju;am++)em.x=rm/ku,em.y=am/ju,nm.push(em.x,em.y)}xe.call(this),this.type='TubeBufferGeometry',this.parameters={path:Vu,tubularSegments:ku,radius:Wu,radialSegments:ju,closed:qu},ku=ku||64,Wu=Wu||1,ju=ju||8,qu=qu||!1;var Qu=Vu.computeFrenetFrames(ku,qu);this.tangents=Qu.tangents,this.normals=Qu.normals,this.binormals=Qu.binormals;var Ku=new A,$u=new A,em=new S,tm=new A,rm,am,om=[],im=[],nm=[],sm=[];(function(){for(rm=0;rm<ku;rm++)Yu(rm);Yu(!1===qu?ku:0),Ju(),Zu()})(),this.setIndex(sm),this.addAttribute('position',new ge(om,3)),this.addAttribute('normal',new ge(im,3)),this.addAttribute('uv',new ge(nm,2))}function Zr(Vu,ku,Wu,ju,qu,Xu,Yu){ee.call(this),this.type='TorusKnotGeometry',this.parameters={radius:Vu,tube:ku,tubularSegments:Wu,radialSegments:ju,p:qu,q:Xu},Yu!==void 0&&console.warn('THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.'),this.fromBufferGeometry(new Jr(Vu,ku,Wu,ju,qu,Xu)),this.mergeVertices()}function Jr(Vu,ku,Wu,ju,qu,Xu){function Yu(hm,ym,xm,vm,_m){var bm=Math.cos(hm),Mm=Math.sin(hm),Sm=xm/ym*hm,Tm=Math.cos(Sm);_m.x=0.5*(vm*(2+Tm))*bm,_m.y=0.5*(vm*(2+Tm)*Mm),_m.z=0.5*(vm*Math.sin(Sm))}xe.call(this),this.type='TorusKnotBufferGeometry',this.parameters={radius:Vu,tube:ku,tubularSegments:Wu,radialSegments:ju,p:qu,q:Xu},Vu=Vu||1,ku=ku||0.4,Wu=Math.floor(Wu)||64,ju=Math.floor(ju)||8,qu=qu||2,Xu=Xu||3;var Zu=[],Ju=[],Qu=[],Ku=[],$u,em,tm=new A,rm=new A,am=new A,om=new A,im=new A,nm=new A,sm=new A;for($u=0;$u<=Wu;++$u){var lm=2*($u/Wu*qu*Math.PI);for(Yu(lm,qu,Xu,Vu,am),Yu(lm+0.01,qu,Xu,Vu,om),nm.subVectors(om,am),sm.addVectors(om,am),im.crossVectors(nm,sm),sm.crossVectors(im,nm),im.normalize(),sm.normalize(),em=0;em<=ju;++em){var pm=2*(em/ju*Math.PI),dm=-ku*Math.cos(pm),cm=ku*Math.sin(pm);tm.x=am.x+(dm*sm.x+cm*im.x),tm.y=am.y+(dm*sm.y+cm*im.y),tm.z=am.z+(dm*sm.z+cm*im.z),Ju.push(tm.x,tm.y,tm.z),rm.subVectors(tm,am).normalize(),Qu.push(rm.x,rm.y,rm.z),Ku.push($u/Wu),Ku.push(em/ju)}}for(em=1;em<=Wu;em++)for($u=1;$u<=ju;$u++){var um=(ju+1)*(em-1)+($u-1),mm=(ju+1)*em+($u-1),gm=(ju+1)*em+$u,fm=(ju+1)*(em-1)+$u;Zu.push(um,mm,fm),Zu.push(mm,gm,fm)}this.setIndex(Zu),this.addAttribute('position',new ge(Ju,3)),this.addAttribute('normal',new ge(Qu,3)),this.addAttribute('uv',new ge(Ku,2))}function Qr(Vu,ku,Wu,ju,qu){ee.call(this),this.type='TorusGeometry',this.parameters={radius:Vu,tube:ku,radialSegments:Wu,tubularSegments:ju,arc:qu},this.fromBufferGeometry(new Kr(Vu,ku,Wu,ju,qu)),this.mergeVertices()}function Kr(Vu,ku,Wu,ju,qu){xe.call(this),this.type='TorusBufferGeometry',this.parameters={radius:Vu,tube:ku,radialSegments:Wu,tubularSegments:ju,arc:qu},Vu=Vu||1,ku=ku||0.4,Wu=Math.floor(Wu)||8,ju=Math.floor(ju)||6,qu=qu||2*Math.PI;var Xu=[],Yu=[],Zu=[],Ju=[],Qu=new A,Ku=new A,$u=new A,em,tm;for(em=0;em<=Wu;em++)for(tm=0;tm<=ju;tm++){var rm=tm/ju*qu,am=2*(em/Wu*Math.PI);Ku.x=(Vu+ku*Math.cos(am))*Math.cos(rm),Ku.y=(Vu+ku*Math.cos(am))*Math.sin(rm),Ku.z=ku*Math.sin(am),Yu.push(Ku.x,Ku.y,Ku.z),Qu.x=Vu*Math.cos(rm),Qu.y=Vu*Math.sin(rm),$u.subVectors(Ku,Qu).normalize(),Zu.push($u.x,$u.y,$u.z),Ju.push(tm/ju),Ju.push(em/Wu)}for(em=1;em<=Wu;em++)for(tm=1;tm<=ju;tm++){var om=(ju+1)*em+tm-1,im=(ju+1)*(em-1)+tm-1,nm=(ju+1)*(em-1)+tm,sm=(ju+1)*em+tm;Xu.push(om,im,sm),Xu.push(im,nm,sm)}this.setIndex(Xu),this.addAttribute('position',new ge(Yu,3)),this.addAttribute('normal',new ge(Zu,3)),this.addAttribute('uv',new ge(Ju,2))}function $r(Vu,ku,Wu,ju,qu){var Xu,Yu;if(qu===0<La(Vu,ku,Wu,ju))for(Xu=ku;Xu<Wu;Xu+=ju)Yu=Ta(Xu,Vu[Xu],Vu[Xu+1],Yu);else for(Xu=Wu-ju;Xu>=ku;Xu-=ju)Yu=Ta(Xu,Vu[Xu],Vu[Xu+1],Yu);return Yu&&ya(Yu,Yu.next)&&(Ea(Yu),Yu=Yu.next),Yu}function ea(Vu,ku){if(!Vu)return Vu;ku||(ku=Vu);var Wu=Vu,ju;do if(ju=!1,!Wu.steiner&&(ya(Wu,Wu.next)||0===ha(Wu.prev,Wu,Wu.next))){if(Ea(Wu),Wu=ku=Wu.prev,Wu===Wu.next)break;ju=!0}else Wu=Wu.next;while(ju||Wu!==ku);return ku}function ta(Vu,ku,Wu,ju,qu,Xu,Yu){if(Vu){!Yu&&Xu&&da(Vu,ju,qu,Xu);for(var Zu=Vu,Ju,Qu;Vu.prev!==Vu.next;){if(Ju=Vu.prev,Qu=Vu.next,Xu?aa(Vu,ju,qu,Xu):ra(Vu)){ku.push(Ju.i/Wu),ku.push(Vu.i/Wu),ku.push(Qu.i/Wu),Ea(Vu),Vu=Qu.next,Zu=Qu.next;continue}if(Vu=Qu,Vu===Zu){Yu?1===Yu?(Vu=oa(Vu,ku,Wu),ta(Vu,ku,Wu,ju,qu,Xu,2)):2==Yu&&ia(Vu,ku,Wu,ju,qu,Xu):ta(ea(Vu),ku,Wu,ju,qu,Xu,1);break}}}}function ra(Vu){var ku=Vu.prev,Wu=Vu,ju=Vu.next;if(0<=ha(ku,Wu,ju))return!1;for(var qu=Vu.next.next;qu!==Vu.prev;){if(ga(ku.x,ku.y,Wu.x,Wu.y,ju.x,ju.y,qu.x,qu.y)&&0<=ha(qu.prev,qu,qu.next))return!1;qu=qu.next}return!0}function aa(Vu,ku,Wu,ju){var qu=Vu.prev,Xu=Vu,Yu=Vu.next;if(0<=ha(qu,Xu,Yu))return!1;for(var Zu=qu.x<Xu.x?qu.x<Yu.x?qu.x:Yu.x:Xu.x<Yu.x?Xu.x:Yu.x,Ju=qu.y<Xu.y?qu.y<Yu.y?qu.y:Yu.y:Xu.y<Yu.y?Xu.y:Yu.y,Qu=qu.x>Xu.x?qu.x>Yu.x?qu.x:Yu.x:Xu.x>Yu.x?Xu.x:Yu.x,Ku=qu.y>Xu.y?qu.y>Yu.y?qu.y:Yu.y:Xu.y>Yu.y?Xu.y:Yu.y,$u=ua(Zu,Ju,ku,Wu,ju),em=ua(Qu,Ku,ku,Wu,ju),tm=Vu.nextZ;tm&&tm.z<=em;){if(tm!==Vu.prev&&tm!==Vu.next&&ga(qu.x,qu.y,Xu.x,Xu.y,Yu.x,Yu.y,tm.x,tm.y)&&0<=ha(tm.prev,tm,tm.next))return!1;tm=tm.nextZ}for(tm=Vu.prevZ;tm&&tm.z>=$u;){if(tm!==Vu.prev&&tm!==Vu.next&&ga(qu.x,qu.y,Xu.x,Xu.y,Yu.x,Yu.y,tm.x,tm.y)&&0<=ha(tm.prev,tm,tm.next))return!1;tm=tm.prevZ}return!0}function oa(Vu,ku,Wu){var ju=Vu;do{var qu=ju.prev,Xu=ju.next.next;!ya(qu,Xu)&&xa(qu,ju,ju.next,Xu)&&ba(qu,Xu)&&ba(Xu,qu)&&(ku.push(qu.i/Wu),ku.push(ju.i/Wu),ku.push(Xu.i/Wu),Ea(ju),Ea(ju.next),ju=Vu=Xu),ju=ju.next}while(ju!==Vu);return ju}function ia(Vu,ku,Wu,ju,qu,Xu){var Yu=Vu;do{for(var Zu=Yu.next.next;Zu!==Yu.prev;){if(Yu.i!==Zu.i&&fa(Yu,Zu)){var Ju=Sa(Yu,Zu);return Yu=ea(Yu,Yu.next),Ju=ea(Ju,Ju.next),ta(Yu,ku,Wu,ju,qu,Xu),void ta(Ju,ku,Wu,ju,qu,Xu)}Zu=Zu.next}Yu=Yu.next}while(Yu!==Vu)}function na(Vu,ku,Wu,ju){var qu=[],Xu,Yu,Zu,Ju,Qu;for(Xu=0,Yu=ku.length;Xu<Yu;Xu++)Zu=ku[Xu]*ju,Ju=Xu<Yu-1?ku[Xu+1]*ju:Vu.length,Qu=$r(Vu,Zu,Ju,ju,!1),Qu===Qu.next&&(Qu.steiner=!0),qu.push(ma(Qu));for(qu.sort(sa),Xu=0;Xu<qu.length;Xu++)la(qu[Xu],Wu),Wu=ea(Wu,Wu.next);return Wu}function sa(Vu,ku){return Vu.x-ku.x}function la(Vu,ku){if(ku=pa(Vu,ku),ku){var Wu=Sa(ku,Vu);ea(Wu,Wu.next)}}function pa(Vu,ku){var Wu=ku,ju=Vu.x,qu=Vu.y,Xu=-Infinity,Yu;do{if(qu<=Wu.y&&qu>=Wu.next.y&&Wu.next.y!==Wu.y){var Zu=Wu.x+(qu-Wu.y)*(Wu.next.x-Wu.x)/(Wu.next.y-Wu.y);if(Zu<=ju&&Zu>Xu){if(Xu=Zu,Zu===ju){if(qu===Wu.y)return Wu;if(qu===Wu.next.y)return Wu.next}Yu=Wu.x<Wu.next.x?Wu:Wu.next}}Wu=Wu.next}while(Wu!==ku);if(!Yu)return null;if(ju===Xu)return Yu.prev;var Ju=Yu,Qu=Yu.x,Ku=Yu.y,$u=Infinity,em;for(Wu=Yu.next;Wu!==Ju;)ju>=Wu.x&&Wu.x>=Qu&&ju!==Wu.x&&ga(qu<Ku?ju:Xu,qu,Qu,Ku,qu<Ku?Xu:ju,qu,Wu.x,Wu.y)&&(em=Math.abs(qu-Wu.y)/(ju-Wu.x),(em<$u||em===$u&&Wu.x>Yu.x)&&ba(Wu,Vu)&&(Yu=Wu,$u=em)),Wu=Wu.next;return Yu}function da(Vu,ku,Wu,ju){var qu=Vu;do null===qu.z&&(qu.z=ua(qu.x,qu.y,ku,Wu,ju)),qu.prevZ=qu.prev,qu.nextZ=qu.next,qu=qu.next;while(qu!==Vu);qu.prevZ.nextZ=null,qu.prevZ=null,ca(qu)}function ca(Vu){var Qu=1,ku,Wu,ju,qu,Xu,Yu,Zu,Ju;do{for(Wu=Vu,Vu=null,Xu=null,Yu=0;Wu;){for(Yu++,ju=Wu,Zu=0,ku=0;ku<Qu&&(Zu++,ju=ju.nextZ,!!ju);ku++);for(Ju=Qu;0<Zu||0<Ju&&ju;)0!==Zu&&(0===Ju||!ju||Wu.z<=ju.z)?(qu=Wu,Wu=Wu.nextZ,Zu--):(qu=ju,ju=ju.nextZ,Ju--),Xu?Xu.nextZ=qu:Vu=qu,qu.prevZ=Xu,Xu=qu;Wu=ju}Xu.nextZ=null,Qu*=2}while(1<Yu);return Vu}function ua(Vu,ku,Wu,ju,qu){return Vu=32767*(Vu-Wu)*qu,ku=32767*(ku-ju)*qu,Vu=16711935&(Vu|Vu<<8),Vu=252645135&(Vu|Vu<<4),Vu=858993459&(Vu|Vu<<2),Vu=1431655765&(Vu|Vu<<1),ku=16711935&(ku|ku<<8),ku=252645135&(ku|ku<<4),ku=858993459&(ku|ku<<2),ku=1431655765&(ku|ku<<1),Vu|ku<<1}function ma(Vu){var ku=Vu,Wu=Vu;do ku.x<Wu.x&&(Wu=ku),ku=ku.next;while(ku!==Vu);return Wu}function ga(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){return 0<=(qu-Yu)*(ku-Zu)-(Vu-Yu)*(Xu-Zu)&&0<=(Vu-Yu)*(ju-Zu)-(Wu-Yu)*(ku-Zu)&&0<=(Wu-Yu)*(Xu-Zu)-(qu-Yu)*(ju-Zu)}function fa(Vu,ku){return Vu.next.i!==ku.i&&Vu.prev.i!==ku.i&&!_a(Vu,ku)&&ba(Vu,ku)&&ba(ku,Vu)&&Ma(Vu,ku)}function ha(Vu,ku,Wu){return(ku.y-Vu.y)*(Wu.x-ku.x)-(ku.x-Vu.x)*(Wu.y-ku.y)}function ya(Vu,ku){return Vu.x===ku.x&&Vu.y===ku.y}function xa(Vu,ku,Wu,ju){return ya(Vu,ku)&&ya(Wu,ju)||ya(Vu,ju)&&ya(Wu,ku)||0<ha(Vu,ku,Wu)!=0<ha(Vu,ku,ju)&&0<ha(Wu,ju,Vu)!=0<ha(Wu,ju,ku)}function _a(Vu,ku){var Wu=Vu;do{if(Wu.i!==Vu.i&&Wu.next.i!==Vu.i&&Wu.i!==ku.i&&Wu.next.i!==ku.i&&xa(Wu,Wu.next,Vu,ku))return!0;Wu=Wu.next}while(Wu!==Vu);return!1}function ba(Vu,ku){return 0>ha(Vu.prev,Vu,Vu.next)?0<=ha(Vu,ku,Vu.next)&&0<=ha(Vu,Vu.prev,ku):0>ha(Vu,ku,Vu.prev)||0>ha(Vu,Vu.next,ku)}function Ma(Vu,ku){var Wu=Vu,ju=!1,qu=(Vu.x+ku.x)/2,Xu=(Vu.y+ku.y)/2;do Wu.y>Xu!=Wu.next.y>Xu&&Wu.next.y!==Wu.y&&qu<(Wu.next.x-Wu.x)*(Xu-Wu.y)/(Wu.next.y-Wu.y)+Wu.x&&(ju=!ju),Wu=Wu.next;while(Wu!==Vu);return ju}function Sa(Vu,ku){var Wu=new wa(Vu.i,Vu.x,Vu.y),ju=new wa(ku.i,ku.x,ku.y),qu=Vu.next,Xu=ku.prev;return Vu.next=ku,ku.prev=Vu,Wu.next=qu,qu.prev=Wu,ju.next=Wu,Wu.prev=ju,Xu.next=ju,ju.prev=Xu,ju}function Ta(Vu,ku,Wu,ju){var qu=new wa(Vu,ku,Wu);return ju?(qu.next=ju.next,qu.prev=ju,ju.next.prev=qu,ju.next=qu):(qu.prev=qu,qu.next=qu),qu}function Ea(Vu){Vu.next.prev=Vu.prev,Vu.prev.next=Vu.next,Vu.prevZ&&(Vu.prevZ.nextZ=Vu.nextZ),Vu.nextZ&&(Vu.nextZ.prevZ=Vu.prevZ)}function wa(Vu,ku,Wu){this.i=Vu,this.x=ku,this.y=Wu,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function La(Vu,ku,Wu,ju){for(var qu=0,Xu=ku,Yu=Wu-ju;Xu<Wu;Xu+=ju)qu+=(Vu[Yu]-Vu[Xu])*(Vu[Xu+1]+Vu[Yu+1]),Yu=Xu;return qu}function Aa(Vu){var ku=Vu.length;2<ku&&Vu[ku-1].equals(Vu[0])&&Vu.pop()}function Pa(Vu,ku){for(var Wu=0;Wu<ku.length;Wu++)Vu.push(ku[Wu].x),Vu.push(ku[Wu].y)}function Ca(Vu,ku){ee.call(this),this.type='ExtrudeGeometry',this.parameters={shapes:Vu,options:ku},this.fromBufferGeometry(new Ra(Vu,ku)),this.mergeVertices()}function Ra(Vu,ku){function Wu(Qu){function Ku(Qm,Km,$m){return Km||console.error('THREE.ExtrudeGeometry: vec does not exist'),Km.clone().multiplyScalar($m).add(Qm)}function $u(Qm,Km,$m){var eg,tg,rg,ag=Qm.x-Km.x,og=Qm.y-Km.y,ig=$m.x-Qm.x,ng=$m.y-Qm.y,sg=ag*ag+og*og;if(Math.abs(ag*ng-og*ig)>Number.EPSILON){var pg=Math.sqrt(sg),dg=Math.sqrt(ig*ig+ng*ng),cg=Km.x-og/pg,ug=Km.y+ag/pg,mg=$m.x-ng/dg,gg=$m.y+ig/dg,fg=((mg-cg)*ng-(gg-ug)*ig)/(ag*ng-og*ig);eg=cg+ag*fg-Qm.x,tg=ug+og*fg-Qm.y;var hg=eg*eg+tg*tg;if(2>=hg)return new S(eg,tg);rg=Math.sqrt(hg/2)}else{var yg=!1;ag>Number.EPSILON?ig>Number.EPSILON&&(yg=!0):ag<-Number.EPSILON?ig<-Number.EPSILON&&(yg=!0):Math.sign(og)===Math.sign(ng)&&(yg=!0),yg?(eg=-og,tg=ag,rg=Math.sqrt(sg)):(eg=ag,tg=og,rg=Math.sqrt(sg/2))}return new S(eg/rg,tg/rg)}function rm(Qm,Km){var $m,eg;for(Vm=Qm.length;0<=--Vm;){$m=Vm,eg=Vm-1,0>eg&&(eg=Qm.length-1);var tg=0,rg=dm+2*fm;for(tg=0;tg<rg;tg++){var ag=Gm*tg,og=Gm*(tg+1),ig=Km+$m+ag,ng=Km+eg+ag,sg=Km+eg+og,lg=Km+$m+og;im(ig,ng,sg,lg)}}}function am(Qm,Km,$m){lm.push(Qm),lm.push(Km),lm.push($m)}function om(Qm,Km,$m){nm(Qm),nm(Km),nm($m);var eg=qu.length/3,tg=ym.generateTopUV(ju,qu,eg-3,eg-2,eg-1);sm(tg[0]),sm(tg[1]),sm(tg[2])}function im(Qm,Km,$m,eg){nm(Qm),nm(Km),nm(eg),nm(Km),nm($m),nm(eg);var tg=qu.length/3,rg=ym.generateSideWallUV(ju,qu,tg-6,tg-3,tg-2,tg-1);sm(rg[0]),sm(rg[1]),sm(rg[3]),sm(rg[1]),sm(rg[2]),sm(rg[3])}function nm(Qm){qu.push(lm[3*Qm+0]),qu.push(lm[3*Qm+1]),qu.push(lm[3*Qm+2])}function sm(Qm){Xu.push(Qm.x),Xu.push(Qm.y)}var lm=[],pm=ku.curveSegments===void 0?12:ku.curveSegments,dm=ku.steps===void 0?1:ku.steps,cm=ku.depth===void 0?100:ku.depth,um=!(ku.bevelEnabled!==void 0)||ku.bevelEnabled,mm=ku.bevelThickness===void 0?6:ku.bevelThickness,gm=ku.bevelSize===void 0?mm-2:ku.bevelSize,fm=ku.bevelSegments===void 0?3:ku.bevelSegments,hm=ku.extrudePath,ym=ku.UVGenerator===void 0?du:ku.UVGenerator;ku.amount!==void 0&&(console.warn('THREE.ExtrudeBufferGeometry: amount has been renamed to depth.'),cm=ku.amount);var vm=!1,xm,_m,bm,Mm,Sm;hm&&(xm=hm.getSpacedPoints(dm),vm=!0,um=!1,_m=hm.computeFrenetFrames(dm,!1),bm=new A,Mm=new A,Sm=new A),um||(fm=0,mm=0,gm=0);var Tm,Em,wm,Lm=Qu.extractPoints(pm),Am=Lm.shape,Pm=Lm.holes,Cm=!lu.isClockWise(Am);if(Cm)for(Am=Am.reverse(),Em=0,wm=Pm.length;Em<wm;Em++)Tm=Pm[Em],lu.isClockWise(Tm)&&(Pm[Em]=Tm.reverse());var Rm=lu.triangulateShape(Am,Pm),Im=Am;for(Em=0,wm=Pm.length;Em<wm;Em++)Tm=Pm[Em],Am=Am.concat(Tm);for(var Gm=Am.length,Fm=Rm.length,Hm=[],Vm=0,km=Im.length,Wm=km-1,jm=Vm+1,Dm,zm,Nm,Bm,Um,Om;Vm<km;Vm++,Wm++,jm++)Wm===km&&(Wm=0),jm===km&&(jm=0),Hm[Vm]=$u(Im[Vm],Im[Wm],Im[jm]);var Xm=[],Zm=Hm.concat(),Ym;for(Em=0,wm=Pm.length;Em<wm;Em++){for(Tm=Pm[Em],Ym=[],(Vm=0,km=Tm.length,Wm=km-1,jm=Vm+1);Vm<km;Vm++,Wm++,jm++)Wm===km&&(Wm=0),jm===km&&(jm=0),Ym[Vm]=$u(Tm[Vm],Tm[Wm],Tm[jm]);Xm.push(Ym),Zm=Zm.concat(Ym)}for(Dm=0;Dm<fm;Dm++){for(Nm=Dm/fm,Bm=mm*Math.cos(Nm*Math.PI/2),zm=gm*Math.sin(Nm*Math.PI/2),(Vm=0,km=Im.length);Vm<km;Vm++)Um=Ku(Im[Vm],Hm[Vm],zm),am(Um.x,Um.y,-Bm);for(Em=0,wm=Pm.length;Em<wm;Em++)for(Tm=Pm[Em],Ym=Xm[Em],(Vm=0,km=Tm.length);Vm<km;Vm++)Um=Ku(Tm[Vm],Ym[Vm],zm),am(Um.x,Um.y,-Bm)}for(zm=gm,Vm=0;Vm<Gm;Vm++)Um=um?Ku(Am[Vm],Zm[Vm],zm):Am[Vm],vm?(Mm.copy(_m.normals[0]).multiplyScalar(Um.x),bm.copy(_m.binormals[0]).multiplyScalar(Um.y),Sm.copy(xm[0]).add(Mm).add(bm),am(Sm.x,Sm.y,Sm.z)):am(Um.x,Um.y,0);var Jm;for(Jm=1;Jm<=dm;Jm++)for(Vm=0;Vm<Gm;Vm++)Um=um?Ku(Am[Vm],Zm[Vm],zm):Am[Vm],vm?(Mm.copy(_m.normals[Jm]).multiplyScalar(Um.x),bm.copy(_m.binormals[Jm]).multiplyScalar(Um.y),Sm.copy(xm[Jm]).add(Mm).add(bm),am(Sm.x,Sm.y,Sm.z)):am(Um.x,Um.y,cm/dm*Jm);for(Dm=fm-1;0<=Dm;Dm--){for(Nm=Dm/fm,Bm=mm*Math.cos(Nm*Math.PI/2),zm=gm*Math.sin(Nm*Math.PI/2),(Vm=0,km=Im.length);Vm<km;Vm++)Um=Ku(Im[Vm],Hm[Vm],zm),am(Um.x,Um.y,cm+Bm);for(Em=0,wm=Pm.length;Em<wm;Em++)for(Tm=Pm[Em],Ym=Xm[Em],(Vm=0,km=Tm.length);Vm<km;Vm++)Um=Ku(Tm[Vm],Ym[Vm],zm),vm?am(Um.x,Um.y+xm[dm-1].y,xm[dm-1].x+Bm):am(Um.x,Um.y,cm+Bm)}(function(){var Qm=qu.length/3;if(um){var Km=0,$m=Gm*Km;for(Vm=0;Vm<Fm;Vm++)Om=Rm[Vm],om(Om[2]+$m,Om[1]+$m,Om[0]+$m);for(Km=dm+2*fm,$m=Gm*Km,Vm=0;Vm<Fm;Vm++)Om=Rm[Vm],om(Om[0]+$m,Om[1]+$m,Om[2]+$m)}else{for(Vm=0;Vm<Fm;Vm++)Om=Rm[Vm],om(Om[2],Om[1],Om[0]);for(Vm=0;Vm<Fm;Vm++)Om=Rm[Vm],om(Om[0]+Gm*dm,Om[1]+Gm*dm,Om[2]+Gm*dm)}ju.addGroup(Qm,qu.length/3-Qm,0)})(),function(){var Qm=qu.length/3,Km=0;for(rm(Im,Km),Km+=Im.length,(Em=0,wm=Pm.length);Em<wm;Em++)Tm=Pm[Em],rm(Tm,Km),Km+=Tm.length;ju.addGroup(Qm,qu.length/3-Qm,1)}()}xe.call(this),this.type='ExtrudeBufferGeometry',this.parameters={shapes:Vu,options:ku},Vu=Array.isArray(Vu)?Vu:[Vu];for(var ju=this,qu=[],Xu=[],Yu=0,Zu=Vu.length,Ju;Yu<Zu;Yu++)Ju=Vu[Yu],Wu(Ju);this.addAttribute('position',new ge(qu,3)),this.addAttribute('uv',new ge(Xu,2)),this.computeVertexNormals()}function Ia(Vu,ku,Wu){if(Wu.shapes=[],Array.isArray(Vu))for(var ju=0,qu=Vu.length,Xu;ju<qu;ju++)Xu=Vu[ju],Wu.shapes.push(Xu.uuid);else Wu.shapes.push(Vu.uuid);return void 0!==ku.extrudePath&&(Wu.options.extrudePath=ku.extrudePath.toJSON()),Wu}function Da(Vu,ku){ee.call(this),this.type='TextGeometry',this.parameters={text:Vu,parameters:ku},this.fromBufferGeometry(new za(Vu,ku)),this.mergeVertices()}function za(Vu,ku){ku=ku||{};var Wu=ku.font;if(!(Wu&&Wu.isFont))return console.error('THREE.TextGeometry: font parameter is not an instance of THREE.Font.'),new ee;var ju=Wu.generateShapes(Vu,ku.size);ku.depth=ku.height===void 0?50:ku.height,ku.bevelThickness===void 0&&(ku.bevelThickness=10),ku.bevelSize===void 0&&(ku.bevelSize=8),ku.bevelEnabled===void 0&&(ku.bevelEnabled=!1),Ra.call(this,ju,ku),this.type='TextBufferGeometry'}function Na(Vu,ku,Wu,ju,qu,Xu,Yu){ee.call(this),this.type='SphereGeometry',this.parameters={radius:Vu,widthSegments:ku,heightSegments:Wu,phiStart:ju,phiLength:qu,thetaStart:Xu,thetaLength:Yu},this.fromBufferGeometry(new Ba(Vu,ku,Wu,ju,qu,Xu,Yu)),this.mergeVertices()}function Ba(Vu,ku,Wu,ju,qu,Xu,Yu){xe.call(this),this.type='SphereBufferGeometry',this.parameters={radius:Vu,widthSegments:ku,heightSegments:Wu,phiStart:ju,phiLength:qu,thetaStart:Xu,thetaLength:Yu},Vu=Vu||1,ku=Math.max(3,Math.floor(ku)||8),Wu=Math.max(2,Math.floor(Wu)||6),ju=ju===void 0?0:ju,qu=qu===void 0?2*Math.PI:qu,Xu=Xu===void 0?0:Xu,Yu=Yu===void 0?Math.PI:Yu;var Zu=Xu+Yu,Ju,Qu,Ku=0,$u=[],em=new A,tm=new A,rm=[],am=[],om=[],im=[];for(Qu=0;Qu<=Wu;Qu++){var nm=[],sm=Qu/Wu;for(Ju=0;Ju<=ku;Ju++){var lm=Ju/ku;em.x=-Vu*Math.cos(ju+lm*qu)*Math.sin(Xu+sm*Yu),em.y=Vu*Math.cos(Xu+sm*Yu),em.z=Vu*Math.sin(ju+lm*qu)*Math.sin(Xu+sm*Yu),am.push(em.x,em.y,em.z),tm.set(em.x,em.y,em.z).normalize(),om.push(tm.x,tm.y,tm.z),im.push(lm,1-sm),nm.push(Ku++)}$u.push(nm)}for(Qu=0;Qu<Wu;Qu++)for(Ju=0;Ju<ku;Ju++){var pm=$u[Qu][Ju+1],dm=$u[Qu][Ju],cm=$u[Qu+1][Ju],um=$u[Qu+1][Ju+1];(0!==Qu||0<Xu)&&rm.push(pm,dm,um),(Qu!==Wu-1||Zu<Math.PI)&&rm.push(dm,cm,um)}this.setIndex(rm),this.addAttribute('position',new ge(am,3)),this.addAttribute('normal',new ge(om,3)),this.addAttribute('uv',new ge(im,2))}function Ua(Vu,ku,Wu,ju,qu,Xu){ee.call(this),this.type='RingGeometry',this.parameters={innerRadius:Vu,outerRadius:ku,thetaSegments:Wu,phiSegments:ju,thetaStart:qu,thetaLength:Xu},this.fromBufferGeometry(new Ga(Vu,ku,Wu,ju,qu,Xu)),this.mergeVertices()}function Ga(Vu,ku,Wu,ju,qu,Xu){xe.call(this),this.type='RingBufferGeometry',this.parameters={innerRadius:Vu,outerRadius:ku,thetaSegments:Wu,phiSegments:ju,thetaStart:qu,thetaLength:Xu},Vu=Vu||0.5,ku=ku||1,qu=qu===void 0?0:qu,Xu=Xu===void 0?2*Math.PI:Xu,Wu=Wu===void 0?8:Math.max(3,Wu),ju=ju===void 0?1:Math.max(1,ju);var Yu=[],Zu=[],Ju=[],Qu=[],Ku,$u=Vu,em=(ku-Vu)/ju,tm=new A,rm=new S,am,om;for(am=0;am<=ju;am++){for(om=0;om<=Wu;om++)Ku=qu+om/Wu*Xu,tm.x=$u*Math.cos(Ku),tm.y=$u*Math.sin(Ku),Zu.push(tm.x,tm.y,tm.z),Ju.push(0,0,1),rm.x=(tm.x/ku+1)/2,rm.y=(tm.y/ku+1)/2,Qu.push(rm.x,rm.y);$u+=em}for(am=0;am<ju;am++){var im=am*(Wu+1);for(om=0;om<Wu;om++){Ku=om+im;var nm=Ku,sm=Ku+Wu+1,lm=Ku+Wu+2,pm=Ku+1;Yu.push(nm,sm,pm),Yu.push(sm,lm,pm)}}this.setIndex(Yu),this.addAttribute('position',new ge(Zu,3)),this.addAttribute('normal',new ge(Ju,3)),this.addAttribute('uv',new ge(Qu,2))}function Oa(Vu,ku,Wu,ju){ee.call(this),this.type='LatheGeometry',this.parameters={points:Vu,segments:ku,phiStart:Wu,phiLength:ju},this.fromBufferGeometry(new Fa(Vu,ku,Wu,ju)),this.mergeVertices()}function Fa(Vu,ku,Wu,ju){xe.call(this),this.type='LatheBufferGeometry',this.parameters={points:Vu,segments:ku,phiStart:Wu,phiLength:ju},ku=Math.floor(ku)||12,Wu=Wu||0,ju=ju||2*Math.PI,ju=hp.clamp(ju,0,2*Math.PI);var qu=[],Xu=[],Yu=[],Ju=1/ku,Qu=new A,Ku=new S,Zu,$u,em;for($u=0;$u<=ku;$u++){var tm=Wu+$u*Ju*ju,rm=Math.sin(tm),am=Math.cos(tm);for(em=0;em<=Vu.length-1;em++)Qu.x=Vu[em].x*rm,Qu.y=Vu[em].y,Qu.z=Vu[em].x*am,Xu.push(Qu.x,Qu.y,Qu.z),Ku.x=$u/ku,Ku.y=em/(Vu.length-1),Yu.push(Ku.x,Ku.y)}for($u=0;$u<ku;$u++)for(em=0;em<Vu.length-1;em++){Zu=em+$u*Vu.length;var om=Zu,im=Zu+Vu.length,nm=Zu+Vu.length+1,sm=Zu+1;qu.push(om,im,sm),qu.push(im,nm,sm)}if(this.setIndex(qu),this.addAttribute('position',new ge(Xu,3)),this.addAttribute('uv',new ge(Yu,2)),this.computeVertexNormals(),ju===2*Math.PI){var lm=this.attributes.normal.array,pm=new A,dm=new A,cm=new A;for(Zu=3*(ku*Vu.length),$u=0,em=0;$u<Vu.length;$u++,em+=3)pm.x=lm[em+0],pm.y=lm[em+1],pm.z=lm[em+2],dm.x=lm[Zu+em+0],dm.y=lm[Zu+em+1],dm.z=lm[Zu+em+2],cm.addVectors(pm,dm).normalize(),lm[em+0]=lm[Zu+em+0]=cm.x,lm[em+1]=lm[Zu+em+1]=cm.y,lm[em+2]=lm[Zu+em+2]=cm.z}}function Ha(Vu,ku){ee.call(this),this.type='ShapeGeometry','object'==typeof ku&&(console.warn('THREE.ShapeGeometry: Options parameter has been removed.'),ku=ku.curveSegments),this.parameters={shapes:Vu,curveSegments:ku},this.fromBufferGeometry(new Va(Vu,ku)),this.mergeVertices()}function Va(Vu,ku){function Wu(Ku){var $u,em,tm,rm=qu.length/3,am=Ku.extractPoints(ku),om=am.shape,im=am.holes;if(!1===lu.isClockWise(om))for(om=om.reverse(),$u=0,em=im.length;$u<em;$u++)tm=im[$u],!0===lu.isClockWise(tm)&&(im[$u]=tm.reverse());var nm=lu.triangulateShape(om,im);for($u=0,em=im.length;$u<em;$u++)tm=im[$u],om=om.concat(tm);for($u=0,em=om.length;$u<em;$u++){var sm=om[$u];qu.push(sm.x,sm.y,0),Xu.push(0,0,1),Yu.push(sm.x,sm.y)}for($u=0,em=nm.length;$u<em;$u++){var lm=nm[$u],pm=lm[0]+rm,dm=lm[1]+rm,cm=lm[2]+rm;ju.push(pm,dm,cm),Ju+=3}}xe.call(this),this.type='ShapeBufferGeometry',this.parameters={shapes:Vu,curveSegments:ku},ku=ku||12;var ju=[],qu=[],Xu=[],Yu=[],Zu=0,Ju=0;if(!1===Array.isArray(Vu))Wu(Vu);else for(var Qu=0;Qu<Vu.length;Qu++)Wu(Vu[Qu]),this.addGroup(Zu,Ju,Qu),Zu+=Ju,Ju=0;this.setIndex(ju),this.addAttribute('position',new ge(qu,3)),this.addAttribute('normal',new ge(Xu,3)),this.addAttribute('uv',new ge(Yu,2))}function ka(Vu,ku){if(ku.shapes=[],Array.isArray(Vu))for(var Wu=0,ju=Vu.length,qu;Wu<ju;Wu++)qu=Vu[Wu],ku.shapes.push(qu.uuid);else ku.shapes.push(Vu.uuid);return ku}function Wa(Vu,ku){xe.call(this),this.type='EdgesGeometry',this.parameters={thresholdAngle:ku},ku=ku===void 0?1:ku;var Wu=[],ju=Math.cos(hp.DEG2RAD*ku),qu=[0,0],Xu={},Yu,Zu,Ju,Qu=['a','b','c'],Ku;Vu.isBufferGeometry?(Ku=new ee,Ku.fromBufferGeometry(Vu)):Ku=Vu.clone(),Ku.mergeVertices(),Ku.computeFaceNormals();for(var $u=Ku.vertices,em=Ku.faces,tm=0,rm=em.length,am;tm<rm;tm++){am=em[tm];for(var om=0;3>om;om++)Yu=am[Qu[om]],Zu=am[Qu[(om+1)%3]],qu[0]=Math.min(Yu,Zu),qu[1]=Math.max(Yu,Zu),Ju=qu[0]+','+qu[1],void 0===Xu[Ju]?Xu[Ju]={index1:qu[0],index2:qu[1],face1:tm,face2:void 0}:Xu[Ju].face2=tm}for(Ju in Xu){var im=Xu[Ju];if(im.face2===void 0||em[im.face1].normal.dot(em[im.face2].normal)<=ju){var nm=$u[im.index1];Wu.push(nm.x,nm.y,nm.z),nm=$u[im.index2],Wu.push(nm.x,nm.y,nm.z)}}this.addAttribute('position',new ge(Wu,3))}function ja(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){ee.call(this),this.type='CylinderGeometry',this.parameters={radiusTop:Vu,radiusBottom:ku,height:Wu,radialSegments:ju,heightSegments:qu,openEnded:Xu,thetaStart:Yu,thetaLength:Zu},this.fromBufferGeometry(new Xa(Vu,ku,Wu,ju,qu,Xu,Yu,Zu)),this.mergeVertices()}function Xa(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){function Qu(sm){var lm,pm,dm,cm=new S,um=new A,mm=0,gm=!0===sm?Vu:ku,fm=!0===sm?1:-1;for(pm=am,lm=1;lm<=ju;lm++)em.push(0,im*fm,0),tm.push(0,fm,0),rm.push(0.5,0.5),am++;for(dm=am,lm=0;lm<=ju;lm++){var hm=lm/ju,ym=hm*Zu+Yu,xm=Math.cos(ym),vm=Math.sin(ym);um.x=gm*vm,um.y=im*fm,um.z=gm*xm,em.push(um.x,um.y,um.z),tm.push(0,fm,0),cm.x=0.5*xm+0.5,cm.y=0.5*vm*fm+0.5,rm.push(cm.x,cm.y),am++}for(lm=0;lm<ju;lm++){var _m=pm+lm,bm=dm+lm;!0===sm?$u.push(bm,bm+1,_m):$u.push(bm+1,bm,_m),mm+=3}Ku.addGroup(nm,mm,!0===sm?1:2),nm+=mm}xe.call(this),this.type='CylinderBufferGeometry',this.parameters={radiusTop:Vu,radiusBottom:ku,height:Wu,radialSegments:ju,heightSegments:qu,openEnded:Xu,thetaStart:Yu,thetaLength:Zu};var Ku=this;Vu=Vu===void 0?1:Vu,ku=ku===void 0?1:ku,Wu=Wu||1,ju=Math.floor(ju)||8,qu=Math.floor(qu)||1,Xu=Xu!==void 0&&Xu,Yu=Yu===void 0?0:Yu,Zu=Zu===void 0?2*Math.PI:Zu;var $u=[],em=[],tm=[],rm=[],am=0,om=[],im=Wu/2,nm=0;(function(){var sm,lm,pm=new A,dm=new A,cm=0,um=(ku-Vu)/Wu;for(lm=0;lm<=qu;lm++){var mm=[],gm=lm/qu,fm=gm*(ku-Vu)+Vu;for(sm=0;sm<=ju;sm++){var hm=sm/ju,ym=hm*Zu+Yu,xm=Math.sin(ym),vm=Math.cos(ym);dm.x=fm*xm,dm.y=-gm*Wu+im,dm.z=fm*vm,em.push(dm.x,dm.y,dm.z),pm.set(xm,um,vm).normalize(),tm.push(pm.x,pm.y,pm.z),rm.push(hm,1-gm),mm.push(am++)}om.push(mm)}for(sm=0;sm<ju;sm++)for(lm=0;lm<qu;lm++){var _m=om[lm][sm],bm=om[lm+1][sm],Mm=om[lm+1][sm+1],Sm=om[lm][sm+1];$u.push(_m,bm,Sm),$u.push(bm,Mm,Sm),cm+=6}Ku.addGroup(nm,cm,0),nm+=cm})(),!1===Xu&&(0<Vu&&Qu(!0),0<ku&&Qu(!1)),this.setIndex($u),this.addAttribute('position',new ge(em,3)),this.addAttribute('normal',new ge(tm,3)),this.addAttribute('uv',new ge(rm,2))}function Ya(Vu,ku,Wu,ju,qu,Xu,Yu){ja.call(this,0,Vu,ku,Wu,ju,qu,Xu,Yu),this.type='ConeGeometry',this.parameters={radius:Vu,height:ku,radialSegments:Wu,heightSegments:ju,openEnded:qu,thetaStart:Xu,thetaLength:Yu}}function Za(Vu,ku,Wu,ju,qu,Xu,Yu){Xa.call(this,0,Vu,ku,Wu,ju,qu,Xu,Yu),this.type='ConeBufferGeometry',this.parameters={radius:Vu,height:ku,radialSegments:Wu,heightSegments:ju,openEnded:qu,thetaStart:Xu,thetaLength:Yu}}function Ja(Vu,ku,Wu,ju){ee.call(this),this.type='CircleGeometry',this.parameters={radius:Vu,segments:ku,thetaStart:Wu,thetaLength:ju},this.fromBufferGeometry(new Qa(Vu,ku,Wu,ju)),this.mergeVertices()}function Qa(Vu,ku,Wu,ju){xe.call(this),this.type='CircleBufferGeometry',this.parameters={radius:Vu,segments:ku,thetaStart:Wu,thetaLength:ju},Vu=Vu||1,ku=ku===void 0?8:Math.max(3,ku),Wu=Wu===void 0?0:Wu,ju=ju===void 0?2*Math.PI:ju;var qu=[],Xu=[],Yu=[],Zu=[],Ju,Qu,Ku=new A,$u=new S;for(Xu.push(0,0,0),Yu.push(0,0,1),Zu.push(0.5,0.5),(Qu=0,Ju=3);Qu<=ku;Qu++,Ju+=3){var em=Wu+Qu/ku*ju;Ku.x=Vu*Math.cos(em),Ku.y=Vu*Math.sin(em),Xu.push(Ku.x,Ku.y,Ku.z),Yu.push(0,0,1),$u.x=(Xu[Ju]/Vu+1)/2,$u.y=(Xu[Ju+1]/Vu+1)/2,Zu.push($u.x,$u.y)}for(Ju=1;Ju<=ku;Ju++)qu.push(Ju,Ju+1,0);this.setIndex(qu),this.addAttribute('position',new ge(Xu,3)),this.addAttribute('normal',new ge(Yu,3)),this.addAttribute('uv',new ge(Zu,2))}function Ka(Vu){Te.call(this),this.type='ShadowMaterial',this.color=new W(0),this.transparent=!0,this.setValues(Vu)}function $a(Vu){Ee.call(this,Vu),this.type='RawShaderMaterial'}function eo(Vu){Te.call(this),this.defines={STANDARD:''},this.type='MeshStandardMaterial',this.color=new W(16777215),this.roughness=0.5,this.metalness=0.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Vu)}function ro(Vu){eo.call(this),this.defines={PHYSICAL:''},this.type='MeshPhysicalMaterial',this.reflectivity=0.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(Vu)}function ao(Vu){Te.call(this),this.type='MeshPhongMaterial',this.color=new W(16777215),this.specular=new W(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=xs,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Vu)}function oo(Vu){ao.call(this),this.defines={TOON:''},this.type='MeshToonMaterial',this.gradientMap=null,this.setValues(Vu)}function io(Vu){Te.call(this),this.type='MeshNormalMaterial',this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Vu)}function no(Vu){Te.call(this),this.type='MeshLambertMaterial',this.color=new W(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new W(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=xs,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Vu)}function so(Vu){if(Te.call(this),this.defines={MATCAP:''},this.type='MeshMatcapMaterial',this.color=new W(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gp,this.normalScale=new S(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(Vu),null===this.matcap){var ku=document.createElement('canvas');ku.width=1,ku.height=1;var Wu=ku.getContext('2d');Wu.fillStyle='#fff',Wu.fillRect(0,0,1,1),this.matcap=new THREE.CanvasTexture(ku)}}function lo(Vu){Tr.call(this),this.type='LineDashedMaterial',this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(Vu)}function po(Vu,ku,Wu,ju){this.parameterPositions=Vu,this._cachedIndex=0,this.resultBuffer=ju===void 0?new ku.constructor(Wu):ju,this.sampleValues=ku,this.valueSize=Wu}function co(Vu,ku,Wu,ju){po.call(this,Vu,ku,Wu,ju),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function uo(Vu,ku,Wu,ju){po.call(this,Vu,ku,Wu,ju)}function mo(Vu,ku,Wu,ju){po.call(this,Vu,ku,Wu,ju)}function go(Vu,ku,Wu,ju){if(Vu===void 0)throw new Error('THREE.KeyframeTrack: track name is undefined');if(void 0===ku||0===ku.length)throw new Error('THREE.KeyframeTrack: no keyframes in track named '+Vu);this.name=Vu,this.times=gu.convertArray(ku,this.TimeBufferType),this.values=gu.convertArray(Wu,this.ValueBufferType),this.setInterpolation(ju||this.DefaultInterpolation)}function fo(Vu,ku,Wu){go.call(this,Vu,ku,Wu)}function yo(Vu,ku,Wu,ju){go.call(this,Vu,ku,Wu,ju)}function xo(Vu,ku,Wu,ju){go.call(this,Vu,ku,Wu,ju)}function vo(Vu,ku,Wu,ju){po.call(this,Vu,ku,Wu,ju)}function _o(Vu,ku,Wu,ju){go.call(this,Vu,ku,Wu,ju)}function bo(Vu,ku,Wu,ju){go.call(this,Vu,ku,Wu,ju)}function Mo(Vu,ku,Wu,ju){go.call(this,Vu,ku,Wu,ju)}function So(Vu,ku,Wu){this.name=Vu,this.tracks=Wu,this.duration=ku===void 0?-1:ku,this.uuid=hp.generateUUID(),0>this.duration&&this.resetDuration()}function To(Vu){switch(Vu.toLowerCase()){case'scalar':case'double':case'float':case'number':case'integer':return xo;case'vector':case'vector2':case'vector3':case'vector4':return Mo;case'color':return yo;case'quaternion':return _o;case'bool':case'boolean':return fo;case'string':return bo;}throw new Error('THREE.KeyframeTrack: Unsupported typeName: '+Vu)}function Eo(Vu){if(Vu.type===void 0)throw new Error('THREE.KeyframeTrack: track type undefined, can not parse');var ku=To(Vu.type);if(Vu.times===void 0){var Wu=[],ju=[];gu.flattenJSON(Vu.keys,Wu,ju,'value'),Vu.times=Wu,Vu.values=ju}return void 0===ku.parse?new ku(Vu.name,Vu.times,Vu.values,Vu.interpolation):ku.parse(Vu)}function wo(Vu,ku,Wu){var ju=this,qu=!1,Xu=0,Yu=0,Zu;this.onStart=void 0,this.onLoad=Vu,this.onProgress=ku,this.onError=Wu,this.itemStart=function(Ju){Yu++,!1==qu&&ju.onStart!==void 0&&ju.onStart(Ju,Xu,Yu),qu=!0},this.itemEnd=function(Ju){Xu++,ju.onProgress!==void 0&&ju.onProgress(Ju,Xu,Yu),Xu==Yu&&(qu=!1,ju.onLoad!==void 0&&ju.onLoad())},this.itemError=function(Ju){ju.onError!==void 0&&ju.onError(Ju)},this.resolveURL=function(Ju){return Zu?Zu(Ju):Ju},this.setURLModifier=function(Ju){return Zu=Ju,this}}function Lo(Vu){this.manager=Vu===void 0?hu:Vu}function Ro(Vu){this.manager=Vu===void 0?hu:Vu}function Io(Vu){this.manager=Vu===void 0?hu:Vu}function Do(Vu){this.manager=Vu===void 0?hu:Vu}function zo(){this.type='Curve',this.arcLengthDivisions=200}function No(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){zo.call(this),this.type='EllipseCurve',this.aX=Vu||0,this.aY=ku||0,this.xRadius=Wu||1,this.yRadius=ju||1,this.aStartAngle=qu||0,this.aEndAngle=Xu||2*Math.PI,this.aClockwise=Yu||!1,this.aRotation=Zu||0}function Bo(Vu,ku,Wu,ju,qu,Xu){No.call(this,Vu,ku,Wu,Wu,ju,qu,Xu),this.type='ArcCurve'}function Uo(){function Vu(Xu,Yu,Zu,Ju){ku=Xu,Wu=Zu,ju=-3*Xu+3*Yu-2*Zu-Ju,qu=2*Xu-2*Yu+Zu+Ju}var ku=0,Wu=0,ju=0,qu=0;return{initCatmullRom:function(Xu,Yu,Zu,Ju,Qu){Vu(Yu,Zu,Qu*(Zu-Xu),Qu*(Ju-Yu))},initNonuniformCatmullRom:function(Xu,Yu,Zu,Ju,Qu,Ku,$u){var em=(Yu-Xu)/Qu-(Zu-Xu)/(Qu+Ku)+(Zu-Yu)/Ku,tm=(Zu-Yu)/Ku-(Ju-Yu)/(Ku+$u)+(Ju-Zu)/$u;em*=Ku,tm*=Ku,Vu(Yu,Zu,em,tm)},calc:function(Xu){var Yu=Xu*Xu;return ku+Wu*Xu+ju*Yu+qu*(Yu*Xu)}}}function Go(Vu,ku,Wu,ju){zo.call(this),this.type='CatmullRomCurve3',this.points=Vu||[],this.closed=ku||!1,this.curveType=Wu||'centripetal',this.tension=ju||0.5}function Oo(Vu,ku,Wu,ju,qu){var Xu=0.5*(ju-ku),Yu=0.5*(qu-Wu),Zu=Vu*Vu;return(2*Wu-2*ju+Xu+Yu)*(Vu*Zu)+(-3*Wu+3*ju-2*Xu-Yu)*Zu+Xu*Vu+Wu}function Fo(Vu,ku){var Wu=1-Vu;return Wu*Wu*ku}function Ho(Vu,ku){return 2*(1-Vu)*Vu*ku}function Vo(Vu,ku){return Vu*Vu*ku}function ko(Vu,ku,Wu,ju){return Fo(Vu,ku)+Ho(Vu,Wu)+Vo(Vu,ju)}function Wo(Vu,ku){var Wu=1-Vu;return Wu*Wu*Wu*ku}function jo(Vu,ku){var Wu=1-Vu;return 3*Wu*Wu*Vu*ku}function qo(Vu,ku){return 3*(1-Vu)*Vu*Vu*ku}function Xo(Vu,ku){return Vu*Vu*Vu*ku}function Yo(Vu,ku,Wu,ju,qu){return Wo(Vu,ku)+jo(Vu,Wu)+qo(Vu,ju)+Xo(Vu,qu)}function Zo(Vu,ku,Wu,ju){zo.call(this),this.type='CubicBezierCurve',this.v0=Vu||new S,this.v1=ku||new S,this.v2=Wu||new S,this.v3=ju||new S}function Jo(Vu,ku,Wu,ju){zo.call(this),this.type='CubicBezierCurve3',this.v0=Vu||new A,this.v1=ku||new A,this.v2=Wu||new A,this.v3=ju||new A}function Qo(Vu,ku){zo.call(this),this.type='LineCurve',this.v1=Vu||new S,this.v2=ku||new S}function Ko(Vu,ku){zo.call(this),this.type='LineCurve3',this.v1=Vu||new A,this.v2=ku||new A}function $o(Vu,ku,Wu){zo.call(this),this.type='QuadraticBezierCurve',this.v0=Vu||new S,this.v1=ku||new S,this.v2=Wu||new S}function ei(Vu,ku,Wu){zo.call(this),this.type='QuadraticBezierCurve3',this.v0=Vu||new A,this.v1=ku||new A,this.v2=Wu||new A}function ti(Vu){zo.call(this),this.type='SplineCurve',this.points=Vu||[]}function ri(){zo.call(this),this.type='CurvePath',this.curves=[],this.autoClose=!1}function ai(Vu){ri.call(this),this.type='Path',this.currentPoint=new S,Vu&&this.setFromPoints(Vu)}function oi(Vu){ai.call(this,Vu),this.uuid=hp.generateUUID(),this.type='Shape',this.holes=[]}function ii(Vu,ku){K.call(this),this.type='Light',this.color=new W(Vu),this.intensity=ku===void 0?1:ku,this.receiveShadow=void 0}function ni(Vu,ku,Wu){ii.call(this,Vu,Wu),this.type='HemisphereLight',this.castShadow=void 0,this.position.copy(K.DefaultUp),this.updateMatrix(),this.groundColor=new W(ku)}function si(Vu){this.camera=Vu,this.bias=0,this.radius=1,this.mapSize=new S(512,512),this.map=null,this.matrix=new E}function li(){si.call(this,new nr(50,1,0.5,500))}function pi(Vu,ku,Wu,ju,qu,Xu){ii.call(this,Vu,ku),this.type='SpotLight',this.position.copy(K.DefaultUp),this.updateMatrix(),this.target=new K,Object.defineProperty(this,'power',{get:function(){return this.intensity*Math.PI},set:function(Yu){this.intensity=Yu/Math.PI}}),this.distance=Wu===void 0?0:Wu,this.angle=ju===void 0?Math.PI/3:ju,this.penumbra=qu===void 0?0:qu,this.decay=Xu===void 0?1:Xu,this.shadow=new li}function di(Vu,ku,Wu,ju){ii.call(this,Vu,ku),this.type='PointLight',Object.defineProperty(this,'power',{get:function(){return 4*this.intensity*Math.PI},set:function(qu){this.intensity=qu/(4*Math.PI)}}),this.distance=Wu===void 0?0:Wu,this.decay=ju===void 0?1:ju,this.shadow=new si(new nr(90,1,0.5,500))}function ci(Vu,ku,Wu,ju,qu,Xu){ir.call(this),this.type='OrthographicCamera',this.zoom=1,this.view=null,this.left=Vu===void 0?-1:Vu,this.right=ku===void 0?1:ku,this.top=Wu===void 0?1:Wu,this.bottom=ju===void 0?-1:ju,this.near=qu===void 0?0.1:qu,this.far=Xu===void 0?2e3:Xu,this.updateProjectionMatrix()}function ui(){si.call(this,new ci(-5,5,5,-5,0.5,500))}function mi(Vu,ku){ii.call(this,Vu,ku),this.type='DirectionalLight',this.position.copy(K.DefaultUp),this.updateMatrix(),this.target=new K,this.shadow=new ui}function gi(Vu,ku){ii.call(this,Vu,ku),this.type='AmbientLight',this.castShadow=void 0}function hi(Vu,ku,Wu,ju){ii.call(this,Vu,ku),this.type='RectAreaLight',this.width=Wu===void 0?10:Wu,this.height=ju===void 0?10:ju}function yi(Vu){this.manager=Vu===void 0?hu:Vu,this.textures={}}function xi(Vu){this.manager=Vu===void 0?hu:Vu}function vi(){}function _i(Vu){'boolean'==typeof Vu&&(console.warn('THREE.JSONLoader: showStatus parameter has been removed from constructor.'),Vu=void 0),this.manager=Vu===void 0?hu:Vu,this.withCredentials=!1}function bi(Vu){this.manager=Vu===void 0?hu:Vu,this.resourcePath=''}function Mi(){this.type='ShapePath',this.color=new W,this.subPaths=[],this.currentPath=null}function Si(Vu){this.type='Font',this.data=Vu}function Ti(Vu,ku,Wu){for(var ju=Array.from?Array.from(Vu):(Vu+'').split(''),qu=ku/Wu.resolution,Xu=(Wu.boundingBox.yMax-Wu.boundingBox.yMin+Wu.underlineThickness)*qu,Yu=[],Zu=0,Ju=0,Qu=0,Ku;Qu<ju.length;Qu++)if(Ku=ju[Qu],'\n'===Ku)Zu=0,Ju-=Xu;else{var $u=Ei(Ku,qu,Zu,Ju,Wu);Zu+=$u.offsetX,Yu.push($u.path)}return Yu}function Ei(Vu,ku,Wu,ju,qu){var Xu=qu.glyphs[Vu]||qu.glyphs['?'];if(Xu){var Yu=new Mi,Zu,Ju,Qu,Ku,$u,em,tm,rm;if(Xu.o)for(var am=Xu._cachedOutline||(Xu._cachedOutline=Xu.o.split(' ')),om=0,im=am.length,nm;om<im;)nm=am[om++],'m'===nm?(Zu=am[om++]*ku+Wu,Ju=am[om++]*ku+ju,Yu.moveTo(Zu,Ju)):'l'===nm?(Zu=am[om++]*ku+Wu,Ju=am[om++]*ku+ju,Yu.lineTo(Zu,Ju)):'q'===nm?(Qu=am[om++]*ku+Wu,Ku=am[om++]*ku+ju,$u=am[om++]*ku+Wu,em=am[om++]*ku+ju,Yu.quadraticCurveTo($u,em,Qu,Ku)):'b'===nm?(Qu=am[om++]*ku+Wu,Ku=am[om++]*ku+ju,$u=am[om++]*ku+Wu,em=am[om++]*ku+ju,tm=am[om++]*ku+Wu,rm=am[om++]*ku+ju,Yu.bezierCurveTo($u,em,tm,rm,Qu,Ku)):void 0;return{offsetX:Xu.ha*ku,path:Yu}}}function Li(Vu){this.manager=Vu===void 0?hu:Vu}function Pi(Vu,ku,Wu,ju){K.call(this),this.type='CubeCamera';var qu=90,Xu=1,Yu=new nr(qu,Xu,Vu,ku);Yu.up.set(0,-1,0),Yu.lookAt(new A(1,0,0)),this.add(Yu);var Zu=new nr(qu,Xu,Vu,ku);Zu.up.set(0,-1,0),Zu.lookAt(new A(-1,0,0)),this.add(Zu);var Ju=new nr(qu,Xu,Vu,ku);Ju.up.set(0,0,1),Ju.lookAt(new A(0,1,0)),this.add(Ju);var Qu=new nr(qu,Xu,Vu,ku);Qu.up.set(0,0,-1),Qu.lookAt(new A(0,-1,0)),this.add(Qu);var Ku=new nr(qu,Xu,Vu,ku);Ku.up.set(0,-1,0),Ku.lookAt(new A(0,0,1)),this.add(Ku);var $u=new nr(qu,Xu,Vu,ku);$u.up.set(0,-1,0),$u.lookAt(new A(0,0,-1)),this.add($u),ju=ju||{format:nl,magFilter:Hs,minFilter:Hs},this.renderTarget=new U(Wu,Wu,ju),this.renderTarget.texture.name='CubeCamera',this.update=function(em,tm){null===this.parent&&this.updateMatrixWorld();var rm=this.renderTarget,am=rm.texture.generateMipmaps;rm.texture.generateMipmaps=!1,rm.activeCubeFace=0,em.render(tm,Yu,rm),rm.activeCubeFace=1,em.render(tm,Zu,rm),rm.activeCubeFace=2,em.render(tm,Ju,rm),rm.activeCubeFace=3,em.render(tm,Qu,rm),rm.activeCubeFace=4,em.render(tm,Ku,rm),rm.texture.generateMipmaps=am,rm.activeCubeFace=5,em.render(tm,$u,rm),em.setRenderTarget(null)},this.clear=function(em,tm,rm,am){for(var om=this.renderTarget,im=0;6>im;im++)om.activeCubeFace=im,em.setRenderTarget(om),em.clear(tm,rm,am);em.setRenderTarget(null)}}function Ci(Vu){this.autoStart=!(Vu!==void 0)||Vu,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ri(){K.call(this),this.type='AudioListener',this.context=Pu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Ii(Vu){K.call(this),this.type='Audio',this.listener=Vu,this.context=Vu.context,this.gain=this.context.createGain(),this.gain.connect(Vu.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType='empty',this.filters=[]}function Di(Vu){Ii.call(this,Vu),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function zi(Vu,ku){this.analyser=Vu.context.createAnalyser(),this.analyser.fftSize=ku===void 0?2048:ku,this.data=new Uint8Array(this.analyser.frequencyBinCount),Vu.getOutput().connect(this.analyser)}function Ni(Vu,ku,Wu){this.binding=Vu,this.valueSize=Wu;var ju=Float64Array,qu;'quaternion'===ku?qu=this._slerp:'string'===ku||'bool'===ku?(ju=Array,qu=this._select):qu=this._lerp;this.buffer=new ju(4*Wu),this._mixBufferRegion=qu,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Bi(Vu,ku,Wu){var ju=Wu||Ui.parseTrackName(ku);this._targetGroup=Vu,this._bindings=Vu.subscribe_(ku,ju)}function Ui(Vu,ku,Wu){this.path=ku,this.parsedPath=Wu||Ui.parseTrackName(ku),this.node=Ui.findNode(Vu,this.parsedPath.nodeName)||Vu,this.rootNode=Vu}function Oi(Vu,ku,Wu){this._mixer=Vu,this._clip=ku,this._localRoot=Wu||null;for(var ju=ku.tracks,qu=ju.length,Xu=Array(qu),Yu={endingStart:Ql,endingEnd:Ql},Zu=0,Ju;Zu!==qu;++Zu)Ju=ju[Zu].createInterpolant(null),Xu[Zu]=Ju,Ju.settings=Yu;this._interpolantSettings=Yu,this._interpolants=Xu,this._propertyBindings=Array(qu),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Fi(Vu){this._root=Vu,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Hi(Vu){'string'==typeof Vu&&(console.warn('THREE.Uniform: Type parameter is no longer needed.'),Vu=arguments[1]),this.value=Vu}function Vi(){xe.call(this),this.type='InstancedBufferGeometry',this.maxInstancedCount=void 0}function ki(Vu,ku,Wu){fr.call(this,Vu,ku),this.meshPerAttribute=Wu||1}function Wi(Vu,ku,Wu,ju){'number'==typeof Wu&&(ju=Wu,Wu=!1,console.error('THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.')),re.call(this,Vu,ku,Wu),this.meshPerAttribute=ju||1}function qi(Vu,ku){return Vu.distance-ku.distance}function Xi(Vu,ku,Wu,ju){if(!1!==Vu.visible&&(Vu.raycast(ku,Wu),!0===ju))for(var qu=Vu.children,Xu=0,Yu=qu.length;Xu<Yu;Xu++)Xi(qu[Xu],ku,Wu,!0)}function Ji(Vu,ku){this.min=Vu===void 0?new S(+Infinity,+Infinity):Vu,this.max=ku===void 0?new S(-Infinity,-Infinity):ku}function Qi(Vu,ku){this.start=Vu===void 0?new A:Vu,this.end=ku===void 0?new A:ku}function Ki(Vu){K.call(this),this.material=Vu,this.render=function(){}}function $i(Vu,ku,Wu,ju){this.object=Vu,this.size=ku===void 0?1:ku;var qu=Wu===void 0?16711680:Wu,Xu=ju===void 0?1:ju,Yu=0,Zu=this.object.geometry;Zu&&Zu.isGeometry?Yu=3*Zu.faces.length:Zu&&Zu.isBufferGeometry&&(Yu=Zu.attributes.normal.count);var Ju=new xe,Qu=new ge(3*(2*Yu),3);Ju.addAttribute('position',Qu),wr.call(this,Ju,new Tr({color:qu,linewidth:Xu})),this.matrixAutoUpdate=!1,this.update()}function en(Vu,ku){K.call(this),this.light=Vu,this.light.updateMatrixWorld(),this.matrix=Vu.matrixWorld,this.matrixAutoUpdate=!1,this.color=ku;for(var Wu=new xe,ju=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],qu=0,Xu=1,Yu=32;qu<Yu;qu++,Xu++){var Zu=2*(qu/Yu*Math.PI),Ju=2*(Xu/Yu*Math.PI);ju.push(Math.cos(Zu),Math.sin(Zu),1,Math.cos(Ju),Math.sin(Ju),1)}Wu.addAttribute('position',new ge(ju,3));var Qu=new Tr({fog:!1});this.cone=new wr(Wu,Qu),this.add(this.cone),this.update()}function tn(Vu){var ku=[];Vu&&Vu.isBone&&ku.push(Vu);for(var Wu=0;Wu<Vu.children.length;Wu++)ku.push.apply(ku,tn(Vu.children[Wu]));return ku}function rn(Vu){for(var ku=tn(Vu),Wu=new xe,ju=[],qu=[],Xu=new W(0,0,1),Yu=new W(0,1,0),Zu=0,Ju;Zu<ku.length;Zu++)Ju=ku[Zu],Ju.parent&&Ju.parent.isBone&&(ju.push(0,0,0),ju.push(0,0,0),qu.push(Xu.r,Xu.g,Xu.b),qu.push(Yu.r,Yu.g,Yu.b));Wu.addAttribute('position',new ge(ju,3)),Wu.addAttribute('color',new ge(qu,3));var Qu=new Tr({vertexColors:Fn,depthTest:!1,depthWrite:!1,transparent:!0});wr.call(this,Wu,Qu),this.root=Vu,this.bones=ku,this.matrix=Vu.matrixWorld,this.matrixAutoUpdate=!1}function on(Vu,ku,Wu){this.light=Vu,this.light.updateMatrixWorld(),this.color=Wu;var ju=new Ba(ku,4,2),qu=new Ae({wireframe:!0,fog:!1});Pe.call(this,ju,qu),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function nn(Vu,ku){K.call(this),this.light=Vu,this.light.updateMatrixWorld(),this.matrix=Vu.matrixWorld,this.matrixAutoUpdate=!1,this.color=ku;var Wu=new Tr({fog:!1}),ju=new xe;ju.addAttribute('position',new re(new Float32Array(15),3)),this.line=new Er(ju,Wu),this.add(this.line),this.update()}function sn(Vu,ku,Wu){K.call(this),this.light=Vu,this.light.updateMatrixWorld(),this.matrix=Vu.matrixWorld,this.matrixAutoUpdate=!1,this.color=Wu;var ju=new Vr(ku);ju.rotateY(0.5*Math.PI),this.material=new Ae({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=Fn);var qu=ju.getAttribute('position'),Xu=new Float32Array(3*qu.count);ju.addAttribute('color',new re(Xu,3)),this.add(new Pe(ju,this.material)),this.update()}function ln(Vu,ku,Wu,ju){Vu=Vu||10,ku=ku||10,Wu=new W(Wu===void 0?4473924:Wu),ju=new W(ju===void 0?8947848:ju);for(var qu=ku/2,Xu=Vu/ku,Yu=Vu/2,Zu=[],Ju=[],Qu=0,Ku=0,$u=-Yu;Qu<=ku;Qu++,$u+=Xu){Zu.push(-Yu,0,$u,Yu,0,$u),Zu.push($u,0,-Yu,$u,0,Yu);var em=Qu===qu?Wu:ju;em.toArray(Ju,Ku),Ku+=3,em.toArray(Ju,Ku),Ku+=3,em.toArray(Ju,Ku),Ku+=3,em.toArray(Ju,Ku),Ku+=3}var tm=new xe;tm.addAttribute('position',new ge(Zu,3)),tm.addAttribute('color',new ge(Ju,3));var rm=new Tr({vertexColors:Fn});wr.call(this,tm,rm)}function pn(Vu,ku,Wu,ju,qu,Xu){Vu=Vu||10,ku=ku||16,Wu=Wu||8,ju=ju||64,qu=new W(qu===void 0?4473924:qu),Xu=new W(Xu===void 0?8947848:Xu);var Yu=[],Zu=[],Ju,Qu,Ku,$u,em,tm,rm;for($u=0;$u<=ku;$u++)Ku=$u/ku*(2*Math.PI),Ju=Math.sin(Ku)*Vu,Qu=Math.cos(Ku)*Vu,Yu.push(0,0,0),Yu.push(Ju,0,Qu),rm=1&$u?qu:Xu,Zu.push(rm.r,rm.g,rm.b),Zu.push(rm.r,rm.g,rm.b);for($u=0;$u<=Wu;$u++)for(rm=1&$u?qu:Xu,tm=Vu-Vu/Wu*$u,em=0;em<ju;em++)Ku=em/ju*(2*Math.PI),Ju=Math.sin(Ku)*tm,Qu=Math.cos(Ku)*tm,Yu.push(Ju,0,Qu),Zu.push(rm.r,rm.g,rm.b),Ku=(em+1)/ju*(2*Math.PI),Ju=Math.sin(Ku)*tm,Qu=Math.cos(Ku)*tm,Yu.push(Ju,0,Qu),Zu.push(rm.r,rm.g,rm.b);var am=new xe;am.addAttribute('position',new ge(Yu,3)),am.addAttribute('color',new ge(Zu,3));var om=new Tr({vertexColors:Fn});wr.call(this,am,om)}function dn(Vu,ku,Wu,ju){this.object=Vu,this.size=ku===void 0?1:ku;var qu=Wu===void 0?16776960:Wu,Xu=ju===void 0?1:ju,Yu=0,Zu=this.object.geometry;Zu&&Zu.isGeometry?Yu=Zu.faces.length:console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');var Ju=new xe,Qu=new ge(3*(2*Yu),3);Ju.addAttribute('position',Qu),wr.call(this,Ju,new Tr({color:qu,linewidth:Xu})),this.matrixAutoUpdate=!1,this.update()}function cn(Vu,ku,Wu){K.call(this),this.light=Vu,this.light.updateMatrixWorld(),this.matrix=Vu.matrixWorld,this.matrixAutoUpdate=!1,this.color=Wu,ku===void 0&&(ku=1);var ju=new xe;ju.addAttribute('position',new ge([-ku,ku,0,ku,ku,0,ku,-ku,0,-ku,-ku,0,-ku,ku,0],3));var qu=new Tr({fog:!1});this.lightPlane=new Er(ju,qu),this.add(this.lightPlane),ju=new xe,ju.addAttribute('position',new ge([0,0,0,0,0,1],3)),this.targetLine=new Er(ju,qu),this.add(this.targetLine),this.update()}function un(Vu){function ku(tm,rm,am){Wu(tm,am),Wu(rm,am)}function Wu(tm,rm){Xu.push(0,0,0),Yu.push(rm.r,rm.g,rm.b),Zu[tm]===void 0&&(Zu[tm]=[]),Zu[tm].push(Xu.length/3-1)}var ju=new xe,qu=new Tr({color:16777215,vertexColors:On}),Xu=[],Yu=[],Zu={},Ju=new W(16755200),Qu=new W(16711680),Ku=new W(43775),$u=new W(16777215),em=new W(3355443);ku('n1','n2',Ju),ku('n2','n4',Ju),ku('n4','n3',Ju),ku('n3','n1',Ju),ku('f1','f2',Ju),ku('f2','f4',Ju),ku('f4','f3',Ju),ku('f3','f1',Ju),ku('n1','f1',Ju),ku('n2','f2',Ju),ku('n3','f3',Ju),ku('n4','f4',Ju),ku('p','n1',Qu),ku('p','n2',Qu),ku('p','n3',Qu),ku('p','n4',Qu),ku('u1','u2',Ku),ku('u2','u3',Ku),ku('u3','u1',Ku),ku('c','t',$u),ku('p','c',em),ku('cn1','cn2',em),ku('cn3','cn4',em),ku('cf1','cf2',em),ku('cf3','cf4',em),ju.addAttribute('position',new ge(Xu,3)),ju.addAttribute('color',new ge(Yu,3)),wr.call(this,ju,qu),this.camera=Vu,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=Vu.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Zu,this.update()}function mn(Vu,ku){this.object=Vu,ku===void 0&&(ku=16776960);var Wu=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ju=new Float32Array(24),qu=new xe;qu.setIndex(new re(Wu,1)),qu.addAttribute('position',new re(ju,3)),wr.call(this,qu,new Tr({color:ku})),this.matrixAutoUpdate=!1,this.update()}function gn(Vu,ku){this.type='Box3Helper',this.box=Vu;var Wu=ku===void 0?16776960:ku,ju=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Xu=new xe;Xu.setIndex(new re(ju,1)),Xu.addAttribute('position',new ge([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),wr.call(this,Xu,new Tr({color:Wu})),this.geometry.computeBoundingSphere()}function fn(Vu,ku,Wu){this.type='PlaneHelper',this.plane=Vu,this.size=ku===void 0?1:ku;var ju=Wu===void 0?16776960:Wu,Xu=new xe;Xu.addAttribute('position',new ge([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),Xu.computeBoundingSphere(),Er.call(this,Xu,new Tr({color:ju}));var Zu=new xe;Zu.addAttribute('position',new ge([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),Zu.computeBoundingSphere(),this.add(new Pe(Zu,new Ae({color:ju,opacity:0.2,transparent:!0,depthWrite:!1})))}function hn(Vu,ku,Wu,ju,qu,Xu){K.call(this),Vu===void 0&&(Vu=new THREE.Vector3(0,0,1)),ku===void 0&&(ku=new THREE.Vector3(0,0,0)),Wu===void 0&&(Wu=1),ju===void 0&&(ju=16776960),qu===void 0&&(qu=0.2*Wu),Xu===void 0&&(Xu=0.2*qu),Ru===void 0&&(Ru=new xe,Ru.addAttribute('position',new ge([0,0,0,0,1,0],3)),Iu=new Xa(0,0.5,1,5,1),Iu.translate(0,-0.5,0)),this.position.copy(ku),this.line=new Er(Ru,new Tr({color:ju})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Pe(Iu,new Ae({color:ju})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(Vu),this.setLength(Wu,qu,Xu)}function yn(Vu){Vu=Vu||1;var ku=[0,0,0,Vu,0,0,0,0,0,0,Vu,0,0,0,0,0,0,Vu],ju=new xe;ju.addAttribute('position',new ge(ku,3)),ju.addAttribute('color',new ge([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3));var qu=new Tr({vertexColors:Fn});wr.call(this,ju,qu)}function xn(Vu){console.warn('THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.'),Go.call(this,Vu),this.type='catmullrom'}function vn(){try{var Vu=document.createElement('canvas');return!!(window.WebGLRenderingContext&&(Vu.getContext('webgl')||Vu.getContext('experimental-webgl')))}catch(ku){return!1}}function bn(){zu=window.innerWidth,Nu=window.innerHeight,Uu=new gr,Bu=new nr(45,zu/Nu,0.1,30),Bu.position.set(0,3.5,5),Bu.lookAt(Uu.position),Mn(),Sn(),Tn()}function Mn(){let Vu=new _e(2,2,2),ku=new io;Gu=new Pe(Vu,ku),Gu.position.x=-4,Gu.position.y=-3,Gu.position.z=-3,Uu.add(Gu)}function Sn(){let Vu=new _e(2,2,2),ku=new io;Ou=new Pe(Vu,ku),Ou.position.x=3.5,Ou.position.y=-0.5,Ou.position.z=-3,Uu.add(Ou)}function Tn(){Du=new cr({antialias:!0}),Du.setClearColor(16764057,1),Du.setSize(zu,Nu),document.body.prepend(Du.domElement),window.addEventListener('resize',Ln,!1)}function En(){Gu.rotation.x+=1.1*Hu,Gu.rotation.y-=Hu,Gu.rotation.z+=0.9*Hu,Ou.rotation.x-=Hu,Ou.rotation.y+=0.8*Hu,Ou.rotation.z-=1.1*Hu}function wn(){requestAnimationFrame(wn),En(),Du.render(Uu,Bu)}function Ln(){Nu=window.innerHeight,zu=window.innerWidth,Du.setSize(zu,Nu),Bu.aspect=zu/Nu,Bu.updateProjectionMatrix()}Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(Vu){return'number'==typeof Vu&&isFinite(Vu)&&Math.floor(Vu)===Vu}),Math.sign===void 0&&(Math.sign=function(Vu){return 0>Vu?-1:0<Vu?1:+Vu}),!1=='name'in Function.prototype&&Object.defineProperty(Function.prototype,'name',{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&function(){Object.assign=function(Vu){if(Vu===void 0||null===Vu)throw new TypeError('Cannot convert undefined or null to object');for(var ku=Object(Vu),Wu=1,ju;Wu<arguments.length;Wu++)if(ju=arguments[Wu],void 0!==ju&&null!==ju)for(var qu in ju)Object.prototype.hasOwnProperty.call(ju,qu)&&(ku[qu]=ju[qu]);return ku}}(),Object.assign(M.prototype,{addEventListener:function(Vu,ku){this._listeners===void 0&&(this._listeners={});var Wu=this._listeners;Wu[Vu]===void 0&&(Wu[Vu]=[]),-1===Wu[Vu].indexOf(ku)&&Wu[Vu].push(ku)},hasEventListener:function(Vu,ku){if(this._listeners===void 0)return!1;var Wu=this._listeners;return Wu[Vu]!==void 0&&-1!==Wu[Vu].indexOf(ku)},removeEventListener:function(Vu,ku){if(void 0!==this._listeners){var Wu=this._listeners,ju=Wu[Vu];if(void 0!==ju){var qu=ju.indexOf(ku);-1!==qu&&ju.splice(qu,1)}}},dispatchEvent:function(Vu){if(void 0!==this._listeners){var ku=this._listeners,Wu=ku[Vu.type];if(void 0!==Wu){Vu.target=this;for(var ju=Wu.slice(0),qu=0,Xu=ju.length;qu<Xu;qu++)ju[qu].call(this,Vu)}}}});var Cn=1,In=1,zn=0,Nn=1,Bn=2,Un=1,Gn=0,On=1,Fn=2,Hn=0,Vn=1,kn=2,Wn=3,jn=4,qn=5,Xn=100,Jn=103,Qn=104,rs=204,as=205,ms=3,xs=0,Ms=0,Ss=1,Ls=300,As=301,Ps=302,Cs=303,Rs=304,Is=305,Ds=306,zs=307,Ns=1e3,Bs=1001,Us=1002,Gs=1003,Os=1004,Fs=1005,Hs=1006,Vs=1007,ks=1008,Ws=1009,Xs=1012,Zs=1014,Js=1015,Qs=1016,rl=1020,nl=1022,ll=1023,ul=1026,yl=1027,_l=33776,bl=33777,Ml=33778,Sl=33779,Tl=35840,El=35841,wl=35842,Ll=35843,Yl=2300,Zl=2301,Jl=2302,Ql=2400,Kl=2401,$l=2402,ep=0,ap=3e3,ip=3007,gp=0,hp={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var Vu=[],ku=0;256>ku;ku++)Vu[ku]=(16>ku?'0':'')+ku.toString(16);return function(){var ju=0|4294967295*Math.random(),qu=0|4294967295*Math.random(),Xu=0|4294967295*Math.random(),Yu=0|4294967295*Math.random(),Zu=Vu[255&ju]+Vu[255&ju>>8]+Vu[255&ju>>16]+Vu[255&ju>>24]+'-'+Vu[255&qu]+Vu[255&qu>>8]+'-'+Vu[64|15&qu>>16]+Vu[255&qu>>24]+'-'+Vu[128|63&Xu]+Vu[255&Xu>>8]+'-'+Vu[255&Xu>>16]+Vu[255&Xu>>24]+Vu[255&Yu]+Vu[255&Yu>>8]+Vu[255&Yu>>16]+Vu[255&Yu>>24];return Zu.toUpperCase()}}(),clamp:function(Vu,ku,Wu){return Math.max(ku,Math.min(Wu,Vu))},euclideanModulo:function(Vu,ku){return(Vu%ku+ku)%ku},mapLinear:function(Vu,ku,Wu,ju,qu){return ju+(Vu-ku)*(qu-ju)/(Wu-ku)},lerp:function(Vu,ku,Wu){return(1-Wu)*Vu+Wu*ku},smoothstep:function(Vu,ku,Wu){return Vu<=ku?0:Vu>=Wu?1:(Vu=(Vu-ku)/(Wu-ku),Vu*Vu*(3-2*Vu))},smootherstep:function(Vu,ku,Wu){return Vu<=ku?0:Vu>=Wu?1:(Vu=(Vu-ku)/(Wu-ku),Vu*Vu*Vu*(Vu*(6*Vu-15)+10))},randInt:function(Vu,ku){return Vu+Math.floor(Math.random()*(ku-Vu+1))},randFloat:function(Vu,ku){return Vu+Math.random()*(ku-Vu)},randFloatSpread:function(Vu){return Vu*(0.5-Math.random())},degToRad:function(Vu){return Vu*hp.DEG2RAD},radToDeg:function(Vu){return Vu*hp.RAD2DEG},isPowerOfTwo:function(Vu){return 0==(Vu&Vu-1)&&0!==Vu},ceilPowerOfTwo:function(Vu){return Math.pow(2,Math.ceil(Math.log(Vu)/Math.LN2))},floorPowerOfTwo:function(Vu){return Math.pow(2,Math.floor(Math.log(Vu)/Math.LN2))}};Object.defineProperties(S.prototype,{width:{get:function(){return this.x},set:function(Vu){this.x=Vu}},height:{get:function(){return this.y},set:function(Vu){this.y=Vu}}}),Object.assign(S.prototype,{isVector2:!0,set:function(Vu,ku){return this.x=Vu,this.y=ku,this},setScalar:function(Vu){return this.x=Vu,this.y=Vu,this},setX:function(Vu){return this.x=Vu,this},setY:function(Vu){return this.y=Vu,this},setComponent:function(Vu,ku){switch(Vu){case 0:this.x=ku;break;case 1:this.y=ku;break;default:throw new Error('index is out of range: '+Vu);}return this},getComponent:function(Vu){switch(Vu){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+Vu);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(Vu){return this.x=Vu.x,this.y=Vu.y,this},add:function(Vu,ku){return void 0===ku?(this.x+=Vu.x,this.y+=Vu.y,this):(console.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Vu,ku))},addScalar:function(Vu){return this.x+=Vu,this.y+=Vu,this},addVectors:function(Vu,ku){return this.x=Vu.x+ku.x,this.y=Vu.y+ku.y,this},addScaledVector:function(Vu,ku){return this.x+=Vu.x*ku,this.y+=Vu.y*ku,this},sub:function(Vu,ku){return void 0===ku?(this.x-=Vu.x,this.y-=Vu.y,this):(console.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Vu,ku))},subScalar:function(Vu){return this.x-=Vu,this.y-=Vu,this},subVectors:function(Vu,ku){return this.x=Vu.x-ku.x,this.y=Vu.y-ku.y,this},multiply:function(Vu){return this.x*=Vu.x,this.y*=Vu.y,this},multiplyScalar:function(Vu){return this.x*=Vu,this.y*=Vu,this},divide:function(Vu){return this.x/=Vu.x,this.y/=Vu.y,this},divideScalar:function(Vu){return this.multiplyScalar(1/Vu)},applyMatrix3:function(Vu){var ku=this.x,Wu=this.y,ju=Vu.elements;return this.x=ju[0]*ku+ju[3]*Wu+ju[6],this.y=ju[1]*ku+ju[4]*Wu+ju[7],this},min:function(Vu){return this.x=Math.min(this.x,Vu.x),this.y=Math.min(this.y,Vu.y),this},max:function(Vu){return this.x=Math.max(this.x,Vu.x),this.y=Math.max(this.y,Vu.y),this},clamp:function(Vu,ku){return this.x=Math.max(Vu.x,Math.min(ku.x,this.x)),this.y=Math.max(Vu.y,Math.min(ku.y,this.y)),this},clampScalar:function(){var Vu=new S,ku=new S;return function(ju,qu){return Vu.set(ju,ju),ku.set(qu,qu),this.clamp(Vu,ku)}}(),clampLength:function(Vu,ku){var Wu=this.length();return this.divideScalar(Wu||1).multiplyScalar(Math.max(Vu,Math.min(ku,Wu)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(Vu){return this.x*Vu.x+this.y*Vu.y},cross:function(Vu){return this.x*Vu.y-this.y*Vu.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var Vu=Math.atan2(this.y,this.x);return 0>Vu&&(Vu+=2*Math.PI),Vu},distanceTo:function(Vu){return Math.sqrt(this.distanceToSquared(Vu))},distanceToSquared:function(Vu){var ku=this.x-Vu.x,Wu=this.y-Vu.y;return ku*ku+Wu*Wu},manhattanDistanceTo:function(Vu){return Math.abs(this.x-Vu.x)+Math.abs(this.y-Vu.y)},setLength:function(Vu){return this.normalize().multiplyScalar(Vu)},lerp:function(Vu,ku){return this.x+=(Vu.x-this.x)*ku,this.y+=(Vu.y-this.y)*ku,this},lerpVectors:function(Vu,ku,Wu){return this.subVectors(ku,Vu).multiplyScalar(Wu).add(Vu)},equals:function(Vu){return Vu.x===this.x&&Vu.y===this.y},fromArray:function(Vu,ku){return void 0===ku&&(ku=0),this.x=Vu[ku],this.y=Vu[ku+1],this},toArray:function(Vu,ku){return void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0),Vu[ku]=this.x,Vu[ku+1]=this.y,Vu},fromBufferAttribute:function(Vu,ku,Wu){return void 0!==Wu&&console.warn('THREE.Vector2: offset has been removed from .fromBufferAttribute().'),this.x=Vu.getX(ku),this.y=Vu.getY(ku),this},rotateAround:function(Vu,ku){var Wu=Math.cos(ku),ju=Math.sin(ku),qu=this.x-Vu.x,Xu=this.y-Vu.y;return this.x=qu*Wu-Xu*ju+Vu.x,this.y=qu*ju+Xu*Wu+Vu.y,this}}),Object.assign(E.prototype,{isMatrix4:!0,set:function(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju,Qu,Ku,$u,em,tm,rm,am){var om=this.elements;return om[0]=Vu,om[4]=ku,om[8]=Wu,om[12]=ju,om[1]=qu,om[5]=Xu,om[9]=Yu,om[13]=Zu,om[2]=Ju,om[6]=Qu,om[10]=Ku,om[14]=$u,om[3]=em,om[7]=tm,om[11]=rm,om[15]=am,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new E().fromArray(this.elements)},copy:function(Vu){var ku=this.elements,Wu=Vu.elements;return ku[0]=Wu[0],ku[1]=Wu[1],ku[2]=Wu[2],ku[3]=Wu[3],ku[4]=Wu[4],ku[5]=Wu[5],ku[6]=Wu[6],ku[7]=Wu[7],ku[8]=Wu[8],ku[9]=Wu[9],ku[10]=Wu[10],ku[11]=Wu[11],ku[12]=Wu[12],ku[13]=Wu[13],ku[14]=Wu[14],ku[15]=Wu[15],this},copyPosition:function(Vu){var ku=this.elements,Wu=Vu.elements;return ku[12]=Wu[12],ku[13]=Wu[13],ku[14]=Wu[14],this},extractBasis:function(Vu,ku,Wu){return Vu.setFromMatrixColumn(this,0),ku.setFromMatrixColumn(this,1),Wu.setFromMatrixColumn(this,2),this},makeBasis:function(Vu,ku,Wu){return this.set(Vu.x,ku.x,Wu.x,0,Vu.y,ku.y,Wu.y,0,Vu.z,ku.z,Wu.z,0,0,0,0,1),this},extractRotation:function(){var Vu=new A;return function(Wu){var ju=this.elements,qu=Wu.elements,Xu=1/Vu.setFromMatrixColumn(Wu,0).length(),Yu=1/Vu.setFromMatrixColumn(Wu,1).length(),Zu=1/Vu.setFromMatrixColumn(Wu,2).length();return ju[0]=qu[0]*Xu,ju[1]=qu[1]*Xu,ju[2]=qu[2]*Xu,ju[3]=0,ju[4]=qu[4]*Yu,ju[5]=qu[5]*Yu,ju[6]=qu[6]*Yu,ju[7]=0,ju[8]=qu[8]*Zu,ju[9]=qu[9]*Zu,ju[10]=qu[10]*Zu,ju[11]=0,ju[12]=0,ju[13]=0,ju[14]=0,ju[15]=1,this}}(),makeRotationFromEuler:function(Vu){Vu&&Vu.isEuler||console.error('THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');var ku=this.elements,Wu=Vu.x,ju=Vu.y,qu=Vu.z,Xu=Math.cos(Wu),Yu=Math.sin(Wu),Zu=Math.cos(ju),Ju=Math.sin(ju),Qu=Math.cos(qu),Ku=Math.sin(qu);if('XYZ'===Vu.order){var $u=Xu*Qu,em=Xu*Ku,tm=Yu*Qu,rm=Yu*Ku;ku[0]=Zu*Qu,ku[4]=-Zu*Ku,ku[8]=Ju,ku[1]=em+tm*Ju,ku[5]=$u-rm*Ju,ku[9]=-Yu*Zu,ku[2]=rm-$u*Ju,ku[6]=tm+em*Ju,ku[10]=Xu*Zu}else if('YXZ'===Vu.order){var am=Zu*Qu,om=Zu*Ku,im=Ju*Qu,nm=Ju*Ku;ku[0]=am+nm*Yu,ku[4]=im*Yu-om,ku[8]=Xu*Ju,ku[1]=Xu*Ku,ku[5]=Xu*Qu,ku[9]=-Yu,ku[2]=om*Yu-im,ku[6]=nm+am*Yu,ku[10]=Xu*Zu}else if('ZXY'===Vu.order){var am=Zu*Qu,om=Zu*Ku,im=Ju*Qu,nm=Ju*Ku;ku[0]=am-nm*Yu,ku[4]=-Xu*Ku,ku[8]=im+om*Yu,ku[1]=om+im*Yu,ku[5]=Xu*Qu,ku[9]=nm-am*Yu,ku[2]=-Xu*Ju,ku[6]=Yu,ku[10]=Xu*Zu}else if('ZYX'===Vu.order){var $u=Xu*Qu,em=Xu*Ku,tm=Yu*Qu,rm=Yu*Ku;ku[0]=Zu*Qu,ku[4]=tm*Ju-em,ku[8]=$u*Ju+rm,ku[1]=Zu*Ku,ku[5]=rm*Ju+$u,ku[9]=em*Ju-tm,ku[2]=-Ju,ku[6]=Yu*Zu,ku[10]=Xu*Zu}else if('YZX'===Vu.order){var sm=Xu*Zu,lm=Xu*Ju,pm=Yu*Zu,dm=Yu*Ju;ku[0]=Zu*Qu,ku[4]=dm-sm*Ku,ku[8]=pm*Ku+lm,ku[1]=Ku,ku[5]=Xu*Qu,ku[9]=-Yu*Qu,ku[2]=-Ju*Qu,ku[6]=lm*Ku+pm,ku[10]=sm-dm*Ku}else if('XZY'===Vu.order){var sm=Xu*Zu,lm=Xu*Ju,pm=Yu*Zu,dm=Yu*Ju;ku[0]=Zu*Qu,ku[4]=-Ku,ku[8]=Ju*Qu,ku[1]=sm*Ku+dm,ku[5]=Xu*Qu,ku[9]=lm*Ku-pm,ku[2]=pm*Ku-lm,ku[6]=Yu*Qu,ku[10]=dm*Ku+sm}return ku[3]=0,ku[7]=0,ku[11]=0,ku[12]=0,ku[13]=0,ku[14]=0,ku[15]=1,this},makeRotationFromQuaternion:function(){var Vu=new A(0,0,0),ku=new A(1,1,1);return function(ju){return this.compose(Vu,ju,ku)}}(),lookAt:function(){var Vu=new A,ku=new A,Wu=new A;return function(qu,Xu,Yu){var Zu=this.elements;return Wu.subVectors(qu,Xu),0===Wu.lengthSq()&&(Wu.z=1),Wu.normalize(),Vu.crossVectors(Yu,Wu),0===Vu.lengthSq()&&(1===Math.abs(Yu.z)?Wu.x+=1e-4:Wu.z+=1e-4,Wu.normalize(),Vu.crossVectors(Yu,Wu)),Vu.normalize(),ku.crossVectors(Wu,Vu),Zu[0]=Vu.x,Zu[4]=ku.x,Zu[8]=Wu.x,Zu[1]=Vu.y,Zu[5]=ku.y,Zu[9]=Wu.y,Zu[2]=Vu.z,Zu[6]=ku.z,Zu[10]=Wu.z,this}}(),multiply:function(Vu,ku){return void 0===ku?this.multiplyMatrices(this,Vu):(console.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.'),this.multiplyMatrices(Vu,ku))},premultiply:function(Vu){return this.multiplyMatrices(Vu,this)},multiplyMatrices:function(Vu,ku){var Wu=Vu.elements,ju=ku.elements,qu=this.elements,Xu=Wu[0],Yu=Wu[4],Zu=Wu[8],Ju=Wu[12],Qu=Wu[1],Ku=Wu[5],$u=Wu[9],em=Wu[13],tm=Wu[2],rm=Wu[6],am=Wu[10],om=Wu[14],im=Wu[3],nm=Wu[7],sm=Wu[11],lm=Wu[15],pm=ju[0],dm=ju[4],cm=ju[8],um=ju[12],mm=ju[1],gm=ju[5],fm=ju[9],hm=ju[13],ym=ju[2],xm=ju[6],vm=ju[10],_m=ju[14],bm=ju[3],Mm=ju[7],Sm=ju[11],Tm=ju[15];return qu[0]=Xu*pm+Yu*mm+Zu*ym+Ju*bm,qu[4]=Xu*dm+Yu*gm+Zu*xm+Ju*Mm,qu[8]=Xu*cm+Yu*fm+Zu*vm+Ju*Sm,qu[12]=Xu*um+Yu*hm+Zu*_m+Ju*Tm,qu[1]=Qu*pm+Ku*mm+$u*ym+em*bm,qu[5]=Qu*dm+Ku*gm+$u*xm+em*Mm,qu[9]=Qu*cm+Ku*fm+$u*vm+em*Sm,qu[13]=Qu*um+Ku*hm+$u*_m+em*Tm,qu[2]=tm*pm+rm*mm+am*ym+om*bm,qu[6]=tm*dm+rm*gm+am*xm+om*Mm,qu[10]=tm*cm+rm*fm+am*vm+om*Sm,qu[14]=tm*um+rm*hm+am*_m+om*Tm,qu[3]=im*pm+nm*mm+sm*ym+lm*bm,qu[7]=im*dm+nm*gm+sm*xm+lm*Mm,qu[11]=im*cm+nm*fm+sm*vm+lm*Sm,qu[15]=im*um+nm*hm+sm*_m+lm*Tm,this},multiplyScalar:function(Vu){var ku=this.elements;return ku[0]*=Vu,ku[4]*=Vu,ku[8]*=Vu,ku[12]*=Vu,ku[1]*=Vu,ku[5]*=Vu,ku[9]*=Vu,ku[13]*=Vu,ku[2]*=Vu,ku[6]*=Vu,ku[10]*=Vu,ku[14]*=Vu,ku[3]*=Vu,ku[7]*=Vu,ku[11]*=Vu,ku[15]*=Vu,this},applyToBufferAttribute:function(){var Vu=new A;return function(Wu){for(var ju=0,qu=Wu.count;ju<qu;ju++)Vu.x=Wu.getX(ju),Vu.y=Wu.getY(ju),Vu.z=Wu.getZ(ju),Vu.applyMatrix4(this),Wu.setXYZ(ju,Vu.x,Vu.y,Vu.z);return Wu}}(),determinant:function(){var Vu=this.elements,ku=Vu[0],Wu=Vu[4],ju=Vu[8],qu=Vu[12],Xu=Vu[1],Yu=Vu[5],Zu=Vu[9],Ju=Vu[13],Qu=Vu[2],Ku=Vu[6],$u=Vu[10],em=Vu[14],tm=Vu[3],rm=Vu[7],am=Vu[11],om=Vu[15];return tm*(+qu*Zu*Ku-ju*Ju*Ku-qu*Yu*$u+Wu*Ju*$u+ju*Yu*em-Wu*Zu*em)+rm*(+ku*Zu*em-ku*Ju*$u+qu*Xu*$u-ju*Xu*em+ju*Ju*Qu-qu*Zu*Qu)+am*(+ku*Ju*Ku-ku*Yu*em-qu*Xu*Ku+Wu*Xu*em+qu*Yu*Qu-Wu*Ju*Qu)+om*(-ju*Yu*Qu-ku*Zu*Ku+ku*Yu*$u+ju*Xu*Ku-Wu*Xu*$u+Wu*Zu*Qu)},transpose:function(){var Vu=this.elements,ku;return ku=Vu[1],Vu[1]=Vu[4],Vu[4]=ku,ku=Vu[2],Vu[2]=Vu[8],Vu[8]=ku,ku=Vu[6],Vu[6]=Vu[9],Vu[9]=ku,ku=Vu[3],Vu[3]=Vu[12],Vu[12]=ku,ku=Vu[7],Vu[7]=Vu[13],Vu[13]=ku,ku=Vu[11],Vu[11]=Vu[14],Vu[14]=ku,this},setPosition:function(Vu){var ku=this.elements;return ku[12]=Vu.x,ku[13]=Vu.y,ku[14]=Vu.z,this},getInverse:function(Vu,ku){var Wu=this.elements,ju=Vu.elements,qu=ju[0],Xu=ju[1],Yu=ju[2],Zu=ju[3],Ju=ju[4],Qu=ju[5],Ku=ju[6],$u=ju[7],em=ju[8],tm=ju[9],rm=ju[10],am=ju[11],om=ju[12],im=ju[13],nm=ju[14],sm=ju[15],lm=tm*nm*$u-im*rm*$u+im*Ku*am-Qu*nm*am-tm*Ku*sm+Qu*rm*sm,pm=om*rm*$u-em*nm*$u-om*Ku*am+Ju*nm*am+em*Ku*sm-Ju*rm*sm,dm=em*im*$u-om*tm*$u+om*Qu*am-Ju*im*am-em*Qu*sm+Ju*tm*sm,cm=om*tm*Ku-em*im*Ku-om*Qu*rm+Ju*im*rm+em*Qu*nm-Ju*tm*nm,um=qu*lm+Xu*pm+Yu*dm+Zu*cm;if(0==um){var mm='THREE.Matrix4: .getInverse() can\'t invert matrix, determinant is 0';if(!0===ku)throw new Error(mm);else console.warn(mm);return this.identity()}var gm=1/um;return Wu[0]=lm*gm,Wu[1]=(im*rm*Zu-tm*nm*Zu-im*Yu*am+Xu*nm*am+tm*Yu*sm-Xu*rm*sm)*gm,Wu[2]=(Qu*nm*Zu-im*Ku*Zu+im*Yu*$u-Xu*nm*$u-Qu*Yu*sm+Xu*Ku*sm)*gm,Wu[3]=(tm*Ku*Zu-Qu*rm*Zu-tm*Yu*$u+Xu*rm*$u+Qu*Yu*am-Xu*Ku*am)*gm,Wu[4]=pm*gm,Wu[5]=(em*nm*Zu-om*rm*Zu+om*Yu*am-qu*nm*am-em*Yu*sm+qu*rm*sm)*gm,Wu[6]=(om*Ku*Zu-Ju*nm*Zu-om*Yu*$u+qu*nm*$u+Ju*Yu*sm-qu*Ku*sm)*gm,Wu[7]=(Ju*rm*Zu-em*Ku*Zu+em*Yu*$u-qu*rm*$u-Ju*Yu*am+qu*Ku*am)*gm,Wu[8]=dm*gm,Wu[9]=(om*tm*Zu-em*im*Zu-om*Xu*am+qu*im*am+em*Xu*sm-qu*tm*sm)*gm,Wu[10]=(Ju*im*Zu-om*Qu*Zu+om*Xu*$u-qu*im*$u-Ju*Xu*sm+qu*Qu*sm)*gm,Wu[11]=(em*Qu*Zu-Ju*tm*Zu-em*Xu*$u+qu*tm*$u+Ju*Xu*am-qu*Qu*am)*gm,Wu[12]=cm*gm,Wu[13]=(em*im*Yu-om*tm*Yu+om*Xu*rm-qu*im*rm-em*Xu*nm+qu*tm*nm)*gm,Wu[14]=(om*Qu*Yu-Ju*im*Yu-om*Xu*Ku+qu*im*Ku+Ju*Xu*nm-qu*Qu*nm)*gm,Wu[15]=(Ju*tm*Yu-em*Qu*Yu+em*Xu*Ku-qu*tm*Ku-Ju*Xu*rm+qu*Qu*rm)*gm,this},scale:function(Vu){var ku=this.elements,Wu=Vu.x,ju=Vu.y,qu=Vu.z;return ku[0]*=Wu,ku[4]*=ju,ku[8]*=qu,ku[1]*=Wu,ku[5]*=ju,ku[9]*=qu,ku[2]*=Wu,ku[6]*=ju,ku[10]*=qu,ku[3]*=Wu,ku[7]*=ju,ku[11]*=qu,this},getMaxScaleOnAxis:function(){var Vu=this.elements,ku=Vu[0]*Vu[0]+Vu[1]*Vu[1]+Vu[2]*Vu[2],Wu=Vu[4]*Vu[4]+Vu[5]*Vu[5]+Vu[6]*Vu[6],ju=Vu[8]*Vu[8]+Vu[9]*Vu[9]+Vu[10]*Vu[10];return Math.sqrt(Math.max(ku,Wu,ju))},makeTranslation:function(Vu,ku,Wu){return this.set(1,0,0,Vu,0,1,0,ku,0,0,1,Wu,0,0,0,1),this},makeRotationX:function(Vu){var ku=Math.cos(Vu),Wu=Math.sin(Vu);return this.set(1,0,0,0,0,ku,-Wu,0,0,Wu,ku,0,0,0,0,1),this},makeRotationY:function(Vu){var ku=Math.cos(Vu),Wu=Math.sin(Vu);return this.set(ku,0,Wu,0,0,1,0,0,-Wu,0,ku,0,0,0,0,1),this},makeRotationZ:function(Vu){var ku=Math.cos(Vu),Wu=Math.sin(Vu);return this.set(ku,-Wu,0,0,Wu,ku,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(Vu,ku){var Wu=Math.cos(ku),ju=Math.sin(ku),qu=1-Wu,Xu=Vu.x,Yu=Vu.y,Zu=Vu.z,Ju=qu*Xu,Qu=qu*Yu;return this.set(Ju*Xu+Wu,Ju*Yu-ju*Zu,Ju*Zu+ju*Yu,0,Ju*Yu+ju*Zu,Qu*Yu+Wu,Qu*Zu-ju*Xu,0,Ju*Zu-ju*Yu,Qu*Zu+ju*Xu,qu*Zu*Zu+Wu,0,0,0,0,1),this},makeScale:function(Vu,ku,Wu){return this.set(Vu,0,0,0,0,ku,0,0,0,0,Wu,0,0,0,0,1),this},makeShear:function(Vu,ku,Wu){return this.set(1,ku,Wu,0,Vu,1,Wu,0,Vu,ku,1,0,0,0,0,1),this},compose:function(Vu,ku,Wu){var ju=this.elements,qu=ku._x,Xu=ku._y,Yu=ku._z,Zu=ku._w,Ju=qu+qu,Qu=Xu+Xu,Ku=Yu+Yu,$u=qu*Ju,em=qu*Qu,tm=qu*Ku,rm=Xu*Qu,am=Xu*Ku,om=Yu*Ku,im=Zu*Ju,nm=Zu*Qu,sm=Zu*Ku,lm=Wu.x,pm=Wu.y,dm=Wu.z;return ju[0]=(1-(rm+om))*lm,ju[1]=(em+sm)*lm,ju[2]=(tm-nm)*lm,ju[3]=0,ju[4]=(em-sm)*pm,ju[5]=(1-($u+om))*pm,ju[6]=(am+im)*pm,ju[7]=0,ju[8]=(tm+nm)*dm,ju[9]=(am-im)*dm,ju[10]=(1-($u+rm))*dm,ju[11]=0,ju[12]=Vu.x,ju[13]=Vu.y,ju[14]=Vu.z,ju[15]=1,this},decompose:function(){var Vu=new A,ku=new E;return function(ju,qu,Xu){var Yu=this.elements,Zu=Vu.set(Yu[0],Yu[1],Yu[2]).length(),Ju=Vu.set(Yu[4],Yu[5],Yu[6]).length(),Qu=Vu.set(Yu[8],Yu[9],Yu[10]).length(),Ku=this.determinant();0>Ku&&(Zu=-Zu),ju.x=Yu[12],ju.y=Yu[13],ju.z=Yu[14],ku.copy(this);var $u=1/Zu,em=1/Ju,tm=1/Qu;return ku.elements[0]*=$u,ku.elements[1]*=$u,ku.elements[2]*=$u,ku.elements[4]*=em,ku.elements[5]*=em,ku.elements[6]*=em,ku.elements[8]*=tm,ku.elements[9]*=tm,ku.elements[10]*=tm,qu.setFromRotationMatrix(ku),Xu.x=Zu,Xu.y=Ju,Xu.z=Qu,this}}(),makePerspective:function(Vu,ku,Wu,ju,qu,Xu){void 0===Xu&&console.warn('THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.');var Yu=this.elements;return Yu[0]=2*qu/(ku-Vu),Yu[4]=0,Yu[8]=(ku+Vu)/(ku-Vu),Yu[12]=0,Yu[1]=0,Yu[5]=2*qu/(Wu-ju),Yu[9]=(Wu+ju)/(Wu-ju),Yu[13]=0,Yu[2]=0,Yu[6]=0,Yu[10]=-(Xu+qu)/(Xu-qu),Yu[14]=-2*Xu*qu/(Xu-qu),Yu[3]=0,Yu[7]=0,Yu[11]=-1,Yu[15]=0,this},makeOrthographic:function(Vu,ku,Wu,ju,qu,Xu){var Yu=this.elements,Zu=1/(ku-Vu),Ju=1/(Wu-ju),Qu=1/(Xu-qu);return Yu[0]=2*Zu,Yu[4]=0,Yu[8]=0,Yu[12]=-((ku+Vu)*Zu),Yu[1]=0,Yu[5]=2*Ju,Yu[9]=0,Yu[13]=-((Wu+ju)*Ju),Yu[2]=0,Yu[6]=0,Yu[10]=-2*Qu,Yu[14]=-((Xu+qu)*Qu),Yu[3]=0,Yu[7]=0,Yu[11]=0,Yu[15]=1,this},equals:function(Vu){for(var ku=this.elements,Wu=Vu.elements,ju=0;16>ju;ju++)if(ku[ju]!==Wu[ju])return!1;return!0},fromArray:function(Vu,ku){ku===void 0&&(ku=0);for(var Wu=0;16>Wu;Wu++)this.elements[Wu]=Vu[Wu+ku];return this},toArray:function(Vu,ku){void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0);var Wu=this.elements;return Vu[ku]=Wu[0],Vu[ku+1]=Wu[1],Vu[ku+2]=Wu[2],Vu[ku+3]=Wu[3],Vu[ku+4]=Wu[4],Vu[ku+5]=Wu[5],Vu[ku+6]=Wu[6],Vu[ku+7]=Wu[7],Vu[ku+8]=Wu[8],Vu[ku+9]=Wu[9],Vu[ku+10]=Wu[10],Vu[ku+11]=Wu[11],Vu[ku+12]=Wu[12],Vu[ku+13]=Wu[13],Vu[ku+14]=Wu[14],Vu[ku+15]=Wu[15],Vu}}),Object.assign(L,{slerp:function(Vu,ku,Wu,ju){return Wu.copy(Vu).slerp(ku,ju)},slerpFlat:function(Vu,ku,Wu,ju,qu,Xu,Yu){var Zu=Wu[ju+0],Ju=Wu[ju+1],Qu=Wu[ju+2],Ku=Wu[ju+3],$u=qu[Xu+0],em=qu[Xu+1],tm=qu[Xu+2],rm=qu[Xu+3];if(Ku!==rm||Zu!==$u||Ju!==em||Qu!==tm){var am=1-Yu,om=Zu*$u+Ju*em+Qu*tm+Ku*rm,im=0<=om?1:-1,nm=1-om*om;if(nm>Number.EPSILON){var sm=Math.sqrt(nm),lm=Math.atan2(sm,om*im);am=Math.sin(am*lm)/sm,Yu=Math.sin(Yu*lm)/sm}var pm=Yu*im;if(Zu=Zu*am+$u*pm,Ju=Ju*am+em*pm,Qu=Qu*am+tm*pm,Ku=Ku*am+rm*pm,am==1-Yu){var dm=1/Math.sqrt(Zu*Zu+Ju*Ju+Qu*Qu+Ku*Ku);Zu*=dm,Ju*=dm,Qu*=dm,Ku*=dm}}Vu[ku]=Zu,Vu[ku+1]=Ju,Vu[ku+2]=Qu,Vu[ku+3]=Ku}}),Object.defineProperties(L.prototype,{x:{get:function(){return this._x},set:function(Vu){this._x=Vu,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Vu){this._y=Vu,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Vu){this._z=Vu,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(Vu){this._w=Vu,this.onChangeCallback()}}}),Object.assign(L.prototype,{isQuaternion:!0,set:function(Vu,ku,Wu,ju){return this._x=Vu,this._y=ku,this._z=Wu,this._w=ju,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(Vu){return this._x=Vu.x,this._y=Vu.y,this._z=Vu.z,this._w=Vu.w,this.onChangeCallback(),this},setFromEuler:function(Vu,ku){if(!(Vu&&Vu.isEuler))throw new Error('THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');var Wu=Vu._x,ju=Vu._y,qu=Vu._z,Xu=Vu.order,Yu=Math.cos,Zu=Math.sin,Ju=Yu(Wu/2),Qu=Yu(ju/2),Ku=Yu(qu/2),$u=Zu(Wu/2),em=Zu(ju/2),tm=Zu(qu/2);return'XYZ'===Xu?(this._x=$u*Qu*Ku+Ju*em*tm,this._y=Ju*em*Ku-$u*Qu*tm,this._z=Ju*Qu*tm+$u*em*Ku,this._w=Ju*Qu*Ku-$u*em*tm):'YXZ'===Xu?(this._x=$u*Qu*Ku+Ju*em*tm,this._y=Ju*em*Ku-$u*Qu*tm,this._z=Ju*Qu*tm-$u*em*Ku,this._w=Ju*Qu*Ku+$u*em*tm):'ZXY'===Xu?(this._x=$u*Qu*Ku-Ju*em*tm,this._y=Ju*em*Ku+$u*Qu*tm,this._z=Ju*Qu*tm+$u*em*Ku,this._w=Ju*Qu*Ku-$u*em*tm):'ZYX'===Xu?(this._x=$u*Qu*Ku-Ju*em*tm,this._y=Ju*em*Ku+$u*Qu*tm,this._z=Ju*Qu*tm-$u*em*Ku,this._w=Ju*Qu*Ku+$u*em*tm):'YZX'===Xu?(this._x=$u*Qu*Ku+Ju*em*tm,this._y=Ju*em*Ku+$u*Qu*tm,this._z=Ju*Qu*tm-$u*em*Ku,this._w=Ju*Qu*Ku-$u*em*tm):'XZY'===Xu&&(this._x=$u*Qu*Ku-Ju*em*tm,this._y=Ju*em*Ku-$u*Qu*tm,this._z=Ju*Qu*tm+$u*em*Ku,this._w=Ju*Qu*Ku+$u*em*tm),!1!==ku&&this.onChangeCallback(),this},setFromAxisAngle:function(Vu,ku){var Wu=ku/2,ju=Math.sin(Wu);return this._x=Vu.x*ju,this._y=Vu.y*ju,this._z=Vu.z*ju,this._w=Math.cos(Wu),this.onChangeCallback(),this},setFromRotationMatrix:function(Vu){var ku=Vu.elements,Wu=ku[0],ju=ku[4],qu=ku[8],Xu=ku[1],Yu=ku[5],Zu=ku[9],Ju=ku[2],Qu=ku[6],Ku=ku[10],$u=Wu+Yu+Ku,em;return 0<$u?(em=0.5/Math.sqrt($u+1),this._w=0.25/em,this._x=(Qu-Zu)*em,this._y=(qu-Ju)*em,this._z=(Xu-ju)*em):Wu>Yu&&Wu>Ku?(em=2*Math.sqrt(1+Wu-Yu-Ku),this._w=(Qu-Zu)/em,this._x=0.25*em,this._y=(ju+Xu)/em,this._z=(qu+Ju)/em):Yu>Ku?(em=2*Math.sqrt(1+Yu-Wu-Ku),this._w=(qu-Ju)/em,this._x=(ju+Xu)/em,this._y=0.25*em,this._z=(Zu+Qu)/em):(em=2*Math.sqrt(1+Ku-Wu-Yu),this._w=(Xu-ju)/em,this._x=(qu+Ju)/em,this._y=(Zu+Qu)/em,this._z=0.25*em),this.onChangeCallback(),this},setFromUnitVectors:function(){var Vu=new A,ku;return function(qu,Xu){return void 0===Vu&&(Vu=new A),ku=qu.dot(Xu)+1,ku<1e-6?(ku=0,Math.abs(qu.x)>Math.abs(qu.z)?Vu.set(-qu.y,qu.x,0):Vu.set(0,-qu.z,qu.y)):Vu.crossVectors(qu,Xu),this._x=Vu.x,this._y=Vu.y,this._z=Vu.z,this._w=ku,this.normalize()}}(),angleTo:function(Vu){return 2*Math.acos(Math.abs(hp.clamp(this.dot(Vu),-1,1)))},rotateTowards:function(Vu,ku){var Wu=this.angleTo(Vu);if(0===Wu)return this;var ju=Math.min(1,ku/Wu);return this.slerp(Vu,ju),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(Vu){return this._x*Vu._x+this._y*Vu._y+this._z*Vu._z+this._w*Vu._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var Vu=this.length();return 0===Vu?(this._x=0,this._y=0,this._z=0,this._w=1):(Vu=1/Vu,this._x*=Vu,this._y*=Vu,this._z*=Vu,this._w*=Vu),this.onChangeCallback(),this},multiply:function(Vu,ku){return void 0===ku?this.multiplyQuaternions(this,Vu):(console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.'),this.multiplyQuaternions(Vu,ku))},premultiply:function(Vu){return this.multiplyQuaternions(Vu,this)},multiplyQuaternions:function(Vu,ku){var Wu=Vu._x,ju=Vu._y,qu=Vu._z,Xu=Vu._w,Yu=ku._x,Zu=ku._y,Ju=ku._z,Qu=ku._w;return this._x=Wu*Qu+Xu*Yu+ju*Ju-qu*Zu,this._y=ju*Qu+Xu*Zu+qu*Yu-Wu*Ju,this._z=qu*Qu+Xu*Ju+Wu*Zu-ju*Yu,this._w=Xu*Qu-Wu*Yu-ju*Zu-qu*Ju,this.onChangeCallback(),this},slerp:function(Vu,ku){if(0===ku)return this;if(1===ku)return this.copy(Vu);var Wu=this._x,ju=this._y,qu=this._z,Xu=this._w,Yu=Xu*Vu._w+Wu*Vu._x+ju*Vu._y+qu*Vu._z;if(0>Yu?(this._w=-Vu._w,this._x=-Vu._x,this._y=-Vu._y,this._z=-Vu._z,Yu=-Yu):this.copy(Vu),1<=Yu)return this._w=Xu,this._x=Wu,this._y=ju,this._z=qu,this;var Zu=1-Yu*Yu;if(Zu<=Number.EPSILON){var Ju=1-ku;return this._w=Ju*Xu+ku*this._w,this._x=Ju*Wu+ku*this._x,this._y=Ju*ju+ku*this._y,this._z=Ju*qu+ku*this._z,this.normalize()}var Qu=Math.sqrt(Zu),Ku=Math.atan2(Qu,Yu),$u=Math.sin((1-ku)*Ku)/Qu,em=Math.sin(ku*Ku)/Qu;return this._w=Xu*$u+this._w*em,this._x=Wu*$u+this._x*em,this._y=ju*$u+this._y*em,this._z=qu*$u+this._z*em,this.onChangeCallback(),this},equals:function(Vu){return Vu._x===this._x&&Vu._y===this._y&&Vu._z===this._z&&Vu._w===this._w},fromArray:function(Vu,ku){return void 0===ku&&(ku=0),this._x=Vu[ku],this._y=Vu[ku+1],this._z=Vu[ku+2],this._w=Vu[ku+3],this.onChangeCallback(),this},toArray:function(Vu,ku){return void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0),Vu[ku]=this._x,Vu[ku+1]=this._y,Vu[ku+2]=this._z,Vu[ku+3]=this._w,Vu},onChange:function(Vu){return this.onChangeCallback=Vu,this},onChangeCallback:function(){}}),Object.assign(A.prototype,{isVector3:!0,set:function(Vu,ku,Wu){return this.x=Vu,this.y=ku,this.z=Wu,this},setScalar:function(Vu){return this.x=Vu,this.y=Vu,this.z=Vu,this},setX:function(Vu){return this.x=Vu,this},setY:function(Vu){return this.y=Vu,this},setZ:function(Vu){return this.z=Vu,this},setComponent:function(Vu,ku){switch(Vu){case 0:this.x=ku;break;case 1:this.y=ku;break;case 2:this.z=ku;break;default:throw new Error('index is out of range: '+Vu);}return this},getComponent:function(Vu){switch(Vu){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+Vu);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(Vu){return this.x=Vu.x,this.y=Vu.y,this.z=Vu.z,this},add:function(Vu,ku){return void 0===ku?(this.x+=Vu.x,this.y+=Vu.y,this.z+=Vu.z,this):(console.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Vu,ku))},addScalar:function(Vu){return this.x+=Vu,this.y+=Vu,this.z+=Vu,this},addVectors:function(Vu,ku){return this.x=Vu.x+ku.x,this.y=Vu.y+ku.y,this.z=Vu.z+ku.z,this},addScaledVector:function(Vu,ku){return this.x+=Vu.x*ku,this.y+=Vu.y*ku,this.z+=Vu.z*ku,this},sub:function(Vu,ku){return void 0===ku?(this.x-=Vu.x,this.y-=Vu.y,this.z-=Vu.z,this):(console.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Vu,ku))},subScalar:function(Vu){return this.x-=Vu,this.y-=Vu,this.z-=Vu,this},subVectors:function(Vu,ku){return this.x=Vu.x-ku.x,this.y=Vu.y-ku.y,this.z=Vu.z-ku.z,this},multiply:function(Vu,ku){return void 0===ku?(this.x*=Vu.x,this.y*=Vu.y,this.z*=Vu.z,this):(console.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.'),this.multiplyVectors(Vu,ku))},multiplyScalar:function(Vu){return this.x*=Vu,this.y*=Vu,this.z*=Vu,this},multiplyVectors:function(Vu,ku){return this.x=Vu.x*ku.x,this.y=Vu.y*ku.y,this.z=Vu.z*ku.z,this},applyEuler:function(){var Vu=new L;return function(Wu){return Wu&&Wu.isEuler||console.error('THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.'),this.applyQuaternion(Vu.setFromEuler(Wu))}}(),applyAxisAngle:function(){var Vu=new L;return function(Wu,ju){return this.applyQuaternion(Vu.setFromAxisAngle(Wu,ju))}}(),applyMatrix3:function(Vu){var ku=this.x,Wu=this.y,ju=this.z,qu=Vu.elements;return this.x=qu[0]*ku+qu[3]*Wu+qu[6]*ju,this.y=qu[1]*ku+qu[4]*Wu+qu[7]*ju,this.z=qu[2]*ku+qu[5]*Wu+qu[8]*ju,this},applyMatrix4:function(Vu){var ku=this.x,Wu=this.y,ju=this.z,qu=Vu.elements,Xu=1/(qu[3]*ku+qu[7]*Wu+qu[11]*ju+qu[15]);return this.x=(qu[0]*ku+qu[4]*Wu+qu[8]*ju+qu[12])*Xu,this.y=(qu[1]*ku+qu[5]*Wu+qu[9]*ju+qu[13])*Xu,this.z=(qu[2]*ku+qu[6]*Wu+qu[10]*ju+qu[14])*Xu,this},applyQuaternion:function(Vu){var ku=this.x,Wu=this.y,ju=this.z,qu=Vu.x,Xu=Vu.y,Yu=Vu.z,Zu=Vu.w,Ju=Zu*ku+Xu*ju-Yu*Wu,Qu=Zu*Wu+Yu*ku-qu*ju,Ku=Zu*ju+qu*Wu-Xu*ku,$u=-qu*ku-Xu*Wu-Yu*ju;return this.x=Ju*Zu+$u*-qu+Qu*-Yu-Ku*-Xu,this.y=Qu*Zu+$u*-Xu+Ku*-qu-Ju*-Yu,this.z=Ku*Zu+$u*-Yu+Ju*-Xu-Qu*-qu,this},project:function(Vu){return this.applyMatrix4(Vu.matrixWorldInverse).applyMatrix4(Vu.projectionMatrix)},unproject:function(){var Vu=new E;return function(Wu){return this.applyMatrix4(Vu.getInverse(Wu.projectionMatrix)).applyMatrix4(Wu.matrixWorld)}}(),transformDirection:function(Vu){var ku=this.x,Wu=this.y,ju=this.z,qu=Vu.elements;return this.x=qu[0]*ku+qu[4]*Wu+qu[8]*ju,this.y=qu[1]*ku+qu[5]*Wu+qu[9]*ju,this.z=qu[2]*ku+qu[6]*Wu+qu[10]*ju,this.normalize()},divide:function(Vu){return this.x/=Vu.x,this.y/=Vu.y,this.z/=Vu.z,this},divideScalar:function(Vu){return this.multiplyScalar(1/Vu)},min:function(Vu){return this.x=Math.min(this.x,Vu.x),this.y=Math.min(this.y,Vu.y),this.z=Math.min(this.z,Vu.z),this},max:function(Vu){return this.x=Math.max(this.x,Vu.x),this.y=Math.max(this.y,Vu.y),this.z=Math.max(this.z,Vu.z),this},clamp:function(Vu,ku){return this.x=Math.max(Vu.x,Math.min(ku.x,this.x)),this.y=Math.max(Vu.y,Math.min(ku.y,this.y)),this.z=Math.max(Vu.z,Math.min(ku.z,this.z)),this},clampScalar:function(){var Vu=new A,ku=new A;return function(ju,qu){return Vu.set(ju,ju,ju),ku.set(qu,qu,qu),this.clamp(Vu,ku)}}(),clampLength:function(Vu,ku){var Wu=this.length();return this.divideScalar(Wu||1).multiplyScalar(Math.max(Vu,Math.min(ku,Wu)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(Vu){return this.x*Vu.x+this.y*Vu.y+this.z*Vu.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(Vu){return this.normalize().multiplyScalar(Vu)},lerp:function(Vu,ku){return this.x+=(Vu.x-this.x)*ku,this.y+=(Vu.y-this.y)*ku,this.z+=(Vu.z-this.z)*ku,this},lerpVectors:function(Vu,ku,Wu){return this.subVectors(ku,Vu).multiplyScalar(Wu).add(Vu)},cross:function(Vu,ku){return void 0===ku?this.crossVectors(this,Vu):(console.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.'),this.crossVectors(Vu,ku))},crossVectors:function(Vu,ku){var Wu=Vu.x,ju=Vu.y,qu=Vu.z,Xu=ku.x,Yu=ku.y,Zu=ku.z;return this.x=ju*Zu-qu*Yu,this.y=qu*Xu-Wu*Zu,this.z=Wu*Yu-ju*Xu,this},projectOnVector:function(Vu){var ku=Vu.dot(this)/Vu.lengthSq();return this.copy(Vu).multiplyScalar(ku)},projectOnPlane:function(){var Vu=new A;return function(Wu){return Vu.copy(this).projectOnVector(Wu),this.sub(Vu)}}(),reflect:function(){var Vu=new A;return function(Wu){return this.sub(Vu.copy(Wu).multiplyScalar(2*this.dot(Wu)))}}(),angleTo:function(Vu){var ku=this.dot(Vu)/Math.sqrt(this.lengthSq()*Vu.lengthSq());return Math.acos(hp.clamp(ku,-1,1))},distanceTo:function(Vu){return Math.sqrt(this.distanceToSquared(Vu))},distanceToSquared:function(Vu){var ku=this.x-Vu.x,Wu=this.y-Vu.y,ju=this.z-Vu.z;return ku*ku+Wu*Wu+ju*ju},manhattanDistanceTo:function(Vu){return Math.abs(this.x-Vu.x)+Math.abs(this.y-Vu.y)+Math.abs(this.z-Vu.z)},setFromSpherical:function(Vu){return this.setFromSphericalCoords(Vu.radius,Vu.phi,Vu.theta)},setFromSphericalCoords:function(Vu,ku,Wu){var ju=Math.sin(ku)*Vu;return this.x=ju*Math.sin(Wu),this.y=Math.cos(ku)*Vu,this.z=ju*Math.cos(Wu),this},setFromCylindrical:function(Vu){return this.setFromCylindricalCoords(Vu.radius,Vu.theta,Vu.y)},setFromCylindricalCoords:function(Vu,ku,Wu){return this.x=Vu*Math.sin(ku),this.y=Wu,this.z=Vu*Math.cos(ku),this},setFromMatrixPosition:function(Vu){var ku=Vu.elements;return this.x=ku[12],this.y=ku[13],this.z=ku[14],this},setFromMatrixScale:function(Vu){var ku=this.setFromMatrixColumn(Vu,0).length(),Wu=this.setFromMatrixColumn(Vu,1).length(),ju=this.setFromMatrixColumn(Vu,2).length();return this.x=ku,this.y=Wu,this.z=ju,this},setFromMatrixColumn:function(Vu,ku){return this.fromArray(Vu.elements,4*ku)},equals:function(Vu){return Vu.x===this.x&&Vu.y===this.y&&Vu.z===this.z},fromArray:function(Vu,ku){return void 0===ku&&(ku=0),this.x=Vu[ku],this.y=Vu[ku+1],this.z=Vu[ku+2],this},toArray:function(Vu,ku){return void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0),Vu[ku]=this.x,Vu[ku+1]=this.y,Vu[ku+2]=this.z,Vu},fromBufferAttribute:function(Vu,ku,Wu){return void 0!==Wu&&console.warn('THREE.Vector3: offset has been removed from .fromBufferAttribute().'),this.x=Vu.getX(ku),this.y=Vu.getY(ku),this.z=Vu.getZ(ku),this}}),Object.assign(C.prototype,{isMatrix3:!0,set:function(Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju){var Qu=this.elements;return Qu[0]=Vu,Qu[1]=ju,Qu[2]=Yu,Qu[3]=ku,Qu[4]=qu,Qu[5]=Zu,Qu[6]=Wu,Qu[7]=Xu,Qu[8]=Ju,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(Vu){var ku=this.elements,Wu=Vu.elements;return ku[0]=Wu[0],ku[1]=Wu[1],ku[2]=Wu[2],ku[3]=Wu[3],ku[4]=Wu[4],ku[5]=Wu[5],ku[6]=Wu[6],ku[7]=Wu[7],ku[8]=Wu[8],this},setFromMatrix4:function(Vu){var ku=Vu.elements;return this.set(ku[0],ku[4],ku[8],ku[1],ku[5],ku[9],ku[2],ku[6],ku[10]),this},applyToBufferAttribute:function(){var Vu=new A;return function(Wu){for(var ju=0,qu=Wu.count;ju<qu;ju++)Vu.x=Wu.getX(ju),Vu.y=Wu.getY(ju),Vu.z=Wu.getZ(ju),Vu.applyMatrix3(this),Wu.setXYZ(ju,Vu.x,Vu.y,Vu.z);return Wu}}(),multiply:function(Vu){return this.multiplyMatrices(this,Vu)},premultiply:function(Vu){return this.multiplyMatrices(Vu,this)},multiplyMatrices:function(Vu,ku){var Wu=Vu.elements,ju=ku.elements,qu=this.elements,Xu=Wu[0],Yu=Wu[3],Zu=Wu[6],Ju=Wu[1],Qu=Wu[4],Ku=Wu[7],$u=Wu[2],em=Wu[5],tm=Wu[8],rm=ju[0],am=ju[3],om=ju[6],im=ju[1],nm=ju[4],sm=ju[7],lm=ju[2],pm=ju[5],dm=ju[8];return qu[0]=Xu*rm+Yu*im+Zu*lm,qu[3]=Xu*am+Yu*nm+Zu*pm,qu[6]=Xu*om+Yu*sm+Zu*dm,qu[1]=Ju*rm+Qu*im+Ku*lm,qu[4]=Ju*am+Qu*nm+Ku*pm,qu[7]=Ju*om+Qu*sm+Ku*dm,qu[2]=$u*rm+em*im+tm*lm,qu[5]=$u*am+em*nm+tm*pm,qu[8]=$u*om+em*sm+tm*dm,this},multiplyScalar:function(Vu){var ku=this.elements;return ku[0]*=Vu,ku[3]*=Vu,ku[6]*=Vu,ku[1]*=Vu,ku[4]*=Vu,ku[7]*=Vu,ku[2]*=Vu,ku[5]*=Vu,ku[8]*=Vu,this},determinant:function(){var Vu=this.elements,ku=Vu[0],Wu=Vu[1],ju=Vu[2],qu=Vu[3],Xu=Vu[4],Yu=Vu[5],Zu=Vu[6],Ju=Vu[7],Qu=Vu[8];return ku*Xu*Qu-ku*Yu*Ju-Wu*qu*Qu+Wu*Yu*Zu+ju*qu*Ju-ju*Xu*Zu},getInverse:function(Vu,ku){Vu&&Vu.isMatrix4&&console.error('THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.');var Wu=Vu.elements,ju=this.elements,qu=Wu[0],Xu=Wu[1],Yu=Wu[2],Zu=Wu[3],Ju=Wu[4],Qu=Wu[5],Ku=Wu[6],$u=Wu[7],em=Wu[8],tm=em*Ju-Qu*$u,rm=Qu*Ku-em*Zu,am=$u*Zu-Ju*Ku,om=qu*tm+Xu*rm+Yu*am;if(0==om){var im='THREE.Matrix3: .getInverse() can\'t invert matrix, determinant is 0';if(!0===ku)throw new Error(im);else console.warn(im);return this.identity()}var nm=1/om;return ju[0]=tm*nm,ju[1]=(Yu*$u-em*Xu)*nm,ju[2]=(Qu*Xu-Yu*Ju)*nm,ju[3]=rm*nm,ju[4]=(em*qu-Yu*Ku)*nm,ju[5]=(Yu*Zu-Qu*qu)*nm,ju[6]=am*nm,ju[7]=(Xu*Ku-$u*qu)*nm,ju[8]=(Ju*qu-Xu*Zu)*nm,this},transpose:function(){var ku=this.elements,Vu;return Vu=ku[1],ku[1]=ku[3],ku[3]=Vu,Vu=ku[2],ku[2]=ku[6],ku[6]=Vu,Vu=ku[5],ku[5]=ku[7],ku[7]=Vu,this},getNormalMatrix:function(Vu){return this.setFromMatrix4(Vu).getInverse(this).transpose()},transposeIntoArray:function(Vu){var ku=this.elements;return Vu[0]=ku[0],Vu[1]=ku[3],Vu[2]=ku[6],Vu[3]=ku[1],Vu[4]=ku[4],Vu[5]=ku[7],Vu[6]=ku[2],Vu[7]=ku[5],Vu[8]=ku[8],this},setUvTransform:function(Vu,ku,Wu,ju,qu,Xu,Yu){var Zu=Math.cos(qu),Ju=Math.sin(qu);this.set(Wu*Zu,Wu*Ju,-Wu*(Zu*Xu+Ju*Yu)+Xu+Vu,-ju*Ju,ju*Zu,-ju*(-Ju*Xu+Zu*Yu)+Yu+ku,0,0,1)},scale:function(Vu,ku){var Wu=this.elements;return Wu[0]*=Vu,Wu[3]*=Vu,Wu[6]*=Vu,Wu[1]*=ku,Wu[4]*=ku,Wu[7]*=ku,this},rotate:function(Vu){var ku=Math.cos(Vu),Wu=Math.sin(Vu),ju=this.elements,qu=ju[0],Xu=ju[3],Yu=ju[6],Zu=ju[1],Ju=ju[4],Qu=ju[7];return ju[0]=ku*qu+Wu*Zu,ju[3]=ku*Xu+Wu*Ju,ju[6]=ku*Yu+Wu*Qu,ju[1]=-Wu*qu+ku*Zu,ju[4]=-Wu*Xu+ku*Ju,ju[7]=-Wu*Yu+ku*Qu,this},translate:function(Vu,ku){var Wu=this.elements;return Wu[0]+=Vu*Wu[2],Wu[3]+=Vu*Wu[5],Wu[6]+=Vu*Wu[8],Wu[1]+=ku*Wu[2],Wu[4]+=ku*Wu[5],Wu[7]+=ku*Wu[8],this},equals:function(Vu){for(var ku=this.elements,Wu=Vu.elements,ju=0;9>ju;ju++)if(ku[ju]!==Wu[ju])return!1;return!0},fromArray:function(Vu,ku){ku===void 0&&(ku=0);for(var Wu=0;9>Wu;Wu++)this.elements[Wu]=Vu[Wu+ku];return this},toArray:function(Vu,ku){void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0);var Wu=this.elements;return Vu[ku]=Wu[0],Vu[ku+1]=Wu[1],Vu[ku+2]=Wu[2],Vu[ku+3]=Wu[3],Vu[ku+4]=Wu[4],Vu[ku+5]=Wu[5],Vu[ku+6]=Wu[6],Vu[ku+7]=Wu[7],Vu[ku+8]=Wu[8],Vu}});var yp={getDataURL:function(Vu){var ku;if('undefined'==typeof HTMLCanvasElement)return Vu.src;if(Vu instanceof HTMLCanvasElement)ku=Vu;else{ku=document.createElementNS('http://www.w3.org/1999/xhtml','canvas'),ku.width=Vu.width,ku.height=Vu.height;var Wu=ku.getContext('2d');Vu instanceof ImageData?Wu.putImageData(Vu,0,0):Wu.drawImage(Vu,0,0,Vu.width,Vu.height)}return 2048<ku.width||2048<ku.height?ku.toDataURL('image/jpeg',0.6):ku.toDataURL('image/png')}},xp=0;R.DEFAULT_IMAGE=void 0,R.DEFAULT_MAPPING=Ls,R.prototype=Object.assign(Object.create(M.prototype),{constructor:R,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.name=Vu.name,this.image=Vu.image,this.mipmaps=Vu.mipmaps.slice(0),this.mapping=Vu.mapping,this.wrapS=Vu.wrapS,this.wrapT=Vu.wrapT,this.magFilter=Vu.magFilter,this.minFilter=Vu.minFilter,this.anisotropy=Vu.anisotropy,this.format=Vu.format,this.type=Vu.type,this.offset.copy(Vu.offset),this.repeat.copy(Vu.repeat),this.center.copy(Vu.center),this.rotation=Vu.rotation,this.matrixAutoUpdate=Vu.matrixAutoUpdate,this.matrix.copy(Vu.matrix),this.generateMipmaps=Vu.generateMipmaps,this.premultiplyAlpha=Vu.premultiplyAlpha,this.flipY=Vu.flipY,this.unpackAlignment=Vu.unpackAlignment,this.encoding=Vu.encoding,this},toJSON:function(Vu){var ku=void 0===Vu||'string'==typeof Vu;if(!ku&&void 0!==Vu.textures[this.uuid])return Vu.textures[this.uuid];var Wu={metadata:{version:4.5,type:'Texture',generator:'Texture.toJSON'},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var ju=this.image;if(void 0===ju.uuid&&(ju.uuid=hp.generateUUID()),!ku&&void 0===Vu.images[ju.uuid]){var qu;if(Array.isArray(ju)){qu=[];for(var Xu=0,Yu=ju.length;Xu<Yu;Xu++)qu.push(yp.getDataURL(ju[Xu]))}else qu=yp.getDataURL(ju);Vu.images[ju.uuid]={uuid:ju.uuid,url:qu}}Wu.image=ju.uuid}return ku||(Vu.textures[this.uuid]=Wu),Wu},dispose:function(){this.dispatchEvent({type:'dispose'})},transformUv:function(Vu){if(this.mapping!==Ls)return Vu;if(Vu.applyMatrix3(this.matrix),0>Vu.x||1<Vu.x)switch(this.wrapS){case Ns:Vu.x-=Math.floor(Vu.x);break;case Bs:Vu.x=0>Vu.x?0:1;break;case Us:1===Math.abs(Math.floor(Vu.x)%2)?Vu.x=Math.ceil(Vu.x)-Vu.x:Vu.x-=Math.floor(Vu.x);}if(0>Vu.y||1<Vu.y)switch(this.wrapT){case Ns:Vu.y-=Math.floor(Vu.y);break;case Bs:Vu.y=0>Vu.y?0:1;break;case Us:1===Math.abs(Math.floor(Vu.y)%2)?Vu.y=Math.ceil(Vu.y)-Vu.y:Vu.y-=Math.floor(Vu.y);}return this.flipY&&(Vu.y=1-Vu.y),Vu}}),Object.defineProperty(R.prototype,'needsUpdate',{set:function(Vu){!0===Vu&&this.version++}}),Object.assign(I.prototype,{isVector4:!0,set:function(Vu,ku,Wu,ju){return this.x=Vu,this.y=ku,this.z=Wu,this.w=ju,this},setScalar:function(Vu){return this.x=Vu,this.y=Vu,this.z=Vu,this.w=Vu,this},setX:function(Vu){return this.x=Vu,this},setY:function(Vu){return this.y=Vu,this},setZ:function(Vu){return this.z=Vu,this},setW:function(Vu){return this.w=Vu,this},setComponent:function(Vu,ku){switch(Vu){case 0:this.x=ku;break;case 1:this.y=ku;break;case 2:this.z=ku;break;case 3:this.w=ku;break;default:throw new Error('index is out of range: '+Vu);}return this},getComponent:function(Vu){switch(Vu){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+Vu);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(Vu){return this.x=Vu.x,this.y=Vu.y,this.z=Vu.z,this.w=void 0===Vu.w?1:Vu.w,this},add:function(Vu,ku){return void 0===ku?(this.x+=Vu.x,this.y+=Vu.y,this.z+=Vu.z,this.w+=Vu.w,this):(console.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Vu,ku))},addScalar:function(Vu){return this.x+=Vu,this.y+=Vu,this.z+=Vu,this.w+=Vu,this},addVectors:function(Vu,ku){return this.x=Vu.x+ku.x,this.y=Vu.y+ku.y,this.z=Vu.z+ku.z,this.w=Vu.w+ku.w,this},addScaledVector:function(Vu,ku){return this.x+=Vu.x*ku,this.y+=Vu.y*ku,this.z+=Vu.z*ku,this.w+=Vu.w*ku,this},sub:function(Vu,ku){return void 0===ku?(this.x-=Vu.x,this.y-=Vu.y,this.z-=Vu.z,this.w-=Vu.w,this):(console.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Vu,ku))},subScalar:function(Vu){return this.x-=Vu,this.y-=Vu,this.z-=Vu,this.w-=Vu,this},subVectors:function(Vu,ku){return this.x=Vu.x-ku.x,this.y=Vu.y-ku.y,this.z=Vu.z-ku.z,this.w=Vu.w-ku.w,this},multiplyScalar:function(Vu){return this.x*=Vu,this.y*=Vu,this.z*=Vu,this.w*=Vu,this},applyMatrix4:function(Vu){var ku=this.x,Wu=this.y,ju=this.z,qu=this.w,Xu=Vu.elements;return this.x=Xu[0]*ku+Xu[4]*Wu+Xu[8]*ju+Xu[12]*qu,this.y=Xu[1]*ku+Xu[5]*Wu+Xu[9]*ju+Xu[13]*qu,this.z=Xu[2]*ku+Xu[6]*Wu+Xu[10]*ju+Xu[14]*qu,this.w=Xu[3]*ku+Xu[7]*Wu+Xu[11]*ju+Xu[15]*qu,this},divideScalar:function(Vu){return this.multiplyScalar(1/Vu)},setAxisAngleFromQuaternion:function(Vu){this.w=2*Math.acos(Vu.w);var ku=Math.sqrt(1-Vu.w*Vu.w);return 1e-4>ku?(this.x=1,this.y=0,this.z=0):(this.x=Vu.x/ku,this.y=Vu.y/ku,this.z=Vu.z/ku),this},setAxisAngleFromRotationMatrix:function(Vu){var Xu=0.01,Yu=0.1,Zu=Vu.elements,Ju=Zu[0],Qu=Zu[4],Ku=Zu[8],$u=Zu[1],em=Zu[5],tm=Zu[9],rm=Zu[2],am=Zu[6],om=Zu[10],ku,Wu,ju,qu;if(Math.abs(Qu-$u)<Xu&&Math.abs(Ku-rm)<Xu&&Math.abs(tm-am)<Xu){if(Math.abs(Qu+$u)<Yu&&Math.abs(Ku+rm)<Yu&&Math.abs(tm+am)<Yu&&Math.abs(Ju+em+om-3)<Yu)return this.set(1,0,0,0),this;ku=Math.PI;var im=(Ju+1)/2,nm=(em+1)/2,sm=(om+1)/2,lm=(Qu+$u)/4,pm=(Ku+rm)/4,dm=(tm+am)/4;return im>nm&&im>sm?im<Xu?(Wu=0,ju=0.707106781,qu=0.707106781):(Wu=Math.sqrt(im),ju=lm/Wu,qu=pm/Wu):nm>sm?nm<Xu?(Wu=0.707106781,ju=0,qu=0.707106781):(ju=Math.sqrt(nm),Wu=lm/ju,qu=dm/ju):sm<Xu?(Wu=0.707106781,ju=0.707106781,qu=0):(qu=Math.sqrt(sm),Wu=pm/qu,ju=dm/qu),this.set(Wu,ju,qu,ku),this}var cm=Math.sqrt((am-tm)*(am-tm)+(Ku-rm)*(Ku-rm)+($u-Qu)*($u-Qu));return 1e-3>Math.abs(cm)&&(cm=1),this.x=(am-tm)/cm,this.y=(Ku-rm)/cm,this.z=($u-Qu)/cm,this.w=Math.acos((Ju+em+om-1)/2),this},min:function(Vu){return this.x=Math.min(this.x,Vu.x),this.y=Math.min(this.y,Vu.y),this.z=Math.min(this.z,Vu.z),this.w=Math.min(this.w,Vu.w),this},max:function(Vu){return this.x=Math.max(this.x,Vu.x),this.y=Math.max(this.y,Vu.y),this.z=Math.max(this.z,Vu.z),this.w=Math.max(this.w,Vu.w),this},clamp:function(Vu,ku){return this.x=Math.max(Vu.x,Math.min(ku.x,this.x)),this.y=Math.max(Vu.y,Math.min(ku.y,this.y)),this.z=Math.max(Vu.z,Math.min(ku.z,this.z)),this.w=Math.max(Vu.w,Math.min(ku.w,this.w)),this},clampScalar:function(){var Vu,ku;return function(ju,qu){return void 0==Vu&&(Vu=new I,ku=new I),Vu.set(ju,ju,ju,ju),ku.set(qu,qu,qu,qu),this.clamp(Vu,ku)}}(),clampLength:function(Vu,ku){var Wu=this.length();return this.divideScalar(Wu||1).multiplyScalar(Math.max(Vu,Math.min(ku,Wu)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(Vu){return this.x*Vu.x+this.y*Vu.y+this.z*Vu.z+this.w*Vu.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(Vu){return this.normalize().multiplyScalar(Vu)},lerp:function(Vu,ku){return this.x+=(Vu.x-this.x)*ku,this.y+=(Vu.y-this.y)*ku,this.z+=(Vu.z-this.z)*ku,this.w+=(Vu.w-this.w)*ku,this},lerpVectors:function(Vu,ku,Wu){return this.subVectors(ku,Vu).multiplyScalar(Wu).add(Vu)},equals:function(Vu){return Vu.x===this.x&&Vu.y===this.y&&Vu.z===this.z&&Vu.w===this.w},fromArray:function(Vu,ku){return void 0===ku&&(ku=0),this.x=Vu[ku],this.y=Vu[ku+1],this.z=Vu[ku+2],this.w=Vu[ku+3],this},toArray:function(Vu,ku){return void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0),Vu[ku]=this.x,Vu[ku+1]=this.y,Vu[ku+2]=this.z,Vu[ku+3]=this.w,Vu},fromBufferAttribute:function(Vu,ku,Wu){return void 0!==Wu&&console.warn('THREE.Vector4: offset has been removed from .fromBufferAttribute().'),this.x=Vu.getX(ku),this.y=Vu.getY(ku),this.z=Vu.getZ(ku),this.w=Vu.getW(ku),this}}),D.prototype=Object.assign(Object.create(M.prototype),{constructor:D,isWebGLRenderTarget:!0,setSize:function(Vu,ku){(this.width!==Vu||this.height!==ku)&&(this.width=Vu,this.height=ku,this.dispose()),this.viewport.set(0,0,Vu,ku),this.scissor.set(0,0,Vu,ku)},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.width=Vu.width,this.height=Vu.height,this.viewport.copy(Vu.viewport),this.texture=Vu.texture.clone(),this.depthBuffer=Vu.depthBuffer,this.stencilBuffer=Vu.stencilBuffer,this.depthTexture=Vu.depthTexture,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),U.prototype=Object.create(D.prototype),U.prototype.constructor=U,U.prototype.isWebGLRenderTargetCube=!0,G.prototype=Object.create(R.prototype),G.prototype.constructor=G,G.prototype.isDataTexture=!0,Object.assign(O.prototype,{isBox3:!0,set:function(Vu,ku){return this.min.copy(Vu),this.max.copy(ku),this},setFromArray:function(Vu){for(var ku=+Infinity,Wu=+Infinity,ju=+Infinity,qu=-Infinity,Xu=-Infinity,Yu=-Infinity,Zu=0,Ju=Vu.length;Zu<Ju;Zu+=3){var Qu=Vu[Zu],Ku=Vu[Zu+1],$u=Vu[Zu+2];Qu<ku&&(ku=Qu),Ku<Wu&&(Wu=Ku),$u<ju&&(ju=$u),Qu>qu&&(qu=Qu),Ku>Xu&&(Xu=Ku),$u>Yu&&(Yu=$u)}return this.min.set(ku,Wu,ju),this.max.set(qu,Xu,Yu),this},setFromBufferAttribute:function(Vu){for(var ku=+Infinity,Wu=+Infinity,ju=+Infinity,qu=-Infinity,Xu=-Infinity,Yu=-Infinity,Zu=0,Ju=Vu.count;Zu<Ju;Zu++){var Qu=Vu.getX(Zu),Ku=Vu.getY(Zu),$u=Vu.getZ(Zu);Qu<ku&&(ku=Qu),Ku<Wu&&(Wu=Ku),$u<ju&&(ju=$u),Qu>qu&&(qu=Qu),Ku>Xu&&(Xu=Ku),$u>Yu&&(Yu=$u)}return this.min.set(ku,Wu,ju),this.max.set(qu,Xu,Yu),this},setFromPoints:function(Vu){this.makeEmpty();for(var ku=0,Wu=Vu.length;ku<Wu;ku++)this.expandByPoint(Vu[ku]);return this},setFromCenterAndSize:function(){var Vu=new A;return function(Wu,ju){var qu=Vu.copy(ju).multiplyScalar(0.5);return this.min.copy(Wu).sub(qu),this.max.copy(Wu).add(qu),this}}(),setFromObject:function(Vu){return this.makeEmpty(),this.expandByObject(Vu)},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.min.copy(Vu.min),this.max.copy(Vu.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(Vu){return void 0===Vu&&(console.warn('THREE.Box3: .getCenter() target is now required'),Vu=new A),this.isEmpty()?Vu.set(0,0,0):Vu.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(Vu){return void 0===Vu&&(console.warn('THREE.Box3: .getSize() target is now required'),Vu=new A),this.isEmpty()?Vu.set(0,0,0):Vu.subVectors(this.max,this.min)},expandByPoint:function(Vu){return this.min.min(Vu),this.max.max(Vu),this},expandByVector:function(Vu){return this.min.sub(Vu),this.max.add(Vu),this},expandByScalar:function(Vu){return this.min.addScalar(-Vu),this.max.addScalar(Vu),this},expandByObject:function(){function Vu(Xu){var Yu=Xu.geometry;if(Yu!==void 0)if(Yu.isGeometry){var Zu=Yu.vertices;for(Wu=0,ju=Zu.length;Wu<ju;Wu++)qu.copy(Zu[Wu]),qu.applyMatrix4(Xu.matrixWorld),ku.expandByPoint(qu)}else if(Yu.isBufferGeometry){var Ju=Yu.attributes.position;if(void 0!==Ju)for(Wu=0,ju=Ju.count;Wu<ju;Wu++)qu.fromBufferAttribute(Ju,Wu).applyMatrix4(Xu.matrixWorld),ku.expandByPoint(qu)}}var ku,Wu,ju,qu=new A;return function(Yu){return ku=this,Yu.updateMatrixWorld(!0),Yu.traverse(Vu),this}}(),containsPoint:function(Vu){return Vu.x<this.min.x||Vu.x>this.max.x||Vu.y<this.min.y||Vu.y>this.max.y||Vu.z<this.min.z||Vu.z>this.max.z?!1:!0},containsBox:function(Vu){return this.min.x<=Vu.min.x&&Vu.max.x<=this.max.x&&this.min.y<=Vu.min.y&&Vu.max.y<=this.max.y&&this.min.z<=Vu.min.z&&Vu.max.z<=this.max.z},getParameter:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Box3: .getParameter() target is now required'),ku=new A),ku.set((Vu.x-this.min.x)/(this.max.x-this.min.x),(Vu.y-this.min.y)/(this.max.y-this.min.y),(Vu.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(Vu){return Vu.max.x<this.min.x||Vu.min.x>this.max.x||Vu.max.y<this.min.y||Vu.min.y>this.max.y||Vu.max.z<this.min.z||Vu.min.z>this.max.z?!1:!0},intersectsSphere:function(){var Vu=new A;return function(Wu){return this.clampPoint(Wu.center,Vu),Vu.distanceToSquared(Wu.center)<=Wu.radius*Wu.radius}}(),intersectsPlane:function(Vu){var ku,Wu;return 0<Vu.normal.x?(ku=Vu.normal.x*this.min.x,Wu=Vu.normal.x*this.max.x):(ku=Vu.normal.x*this.max.x,Wu=Vu.normal.x*this.min.x),0<Vu.normal.y?(ku+=Vu.normal.y*this.min.y,Wu+=Vu.normal.y*this.max.y):(ku+=Vu.normal.y*this.max.y,Wu+=Vu.normal.y*this.min.y),0<Vu.normal.z?(ku+=Vu.normal.z*this.min.z,Wu+=Vu.normal.z*this.max.z):(ku+=Vu.normal.z*this.max.z,Wu+=Vu.normal.z*this.min.z),ku<=-Vu.constant&&Wu>=-Vu.constant},intersectsTriangle:function(){function Vu($u){var em,tm;for(em=0,tm=$u.length-3;em<=tm;em+=3){Zu.fromArray($u,em);var rm=Qu.x*Math.abs(Zu.x)+Qu.y*Math.abs(Zu.y)+Qu.z*Math.abs(Zu.z),am=ku.dot(Zu),om=Wu.dot(Zu),im=ju.dot(Zu);if(Math.max(-Math.max(am,om,im),Math.min(am,om,im))>rm)return!1}return!0}var ku=new A,Wu=new A,ju=new A,qu=new A,Xu=new A,Yu=new A,Zu=new A,Ju=new A,Qu=new A,Ku=new A;return function(em){if(this.isEmpty())return!1;this.getCenter(Ju),Qu.subVectors(this.max,Ju),ku.subVectors(em.a,Ju),Wu.subVectors(em.b,Ju),ju.subVectors(em.c,Ju),qu.subVectors(Wu,ku),Xu.subVectors(ju,Wu),Yu.subVectors(ku,ju);var tm=[0,-qu.z,qu.y,0,-Xu.z,Xu.y,0,-Yu.z,Yu.y,qu.z,0,-qu.x,Xu.z,0,-Xu.x,Yu.z,0,-Yu.x,-qu.y,qu.x,0,-Xu.y,Xu.x,0,-Yu.y,Yu.x,0];return!!Vu(tm)&&(tm=[1,0,0,0,1,0,0,0,1],!!Vu(tm))&&(Ku.crossVectors(qu,Xu),tm=[Ku.x,Ku.y,Ku.z],Vu(tm))}}(),clampPoint:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Box3: .clampPoint() target is now required'),ku=new A),ku.copy(Vu).clamp(this.min,this.max)},distanceToPoint:function(){var Vu=new A;return function(Wu){var ju=Vu.copy(Wu).clamp(this.min,this.max);return ju.sub(Wu).length()}}(),getBoundingSphere:function(){var Vu=new A;return function(Wu){return void 0===Wu&&(console.warn('THREE.Box3: .getBoundingSphere() target is now required'),Wu=new F),this.getCenter(Wu.center),Wu.radius=0.5*this.getSize(Vu).length(),Wu}}(),intersect:function(Vu){return this.min.max(Vu.min),this.max.min(Vu.max),this.isEmpty()&&this.makeEmpty(),this},union:function(Vu){return this.min.min(Vu.min),this.max.max(Vu.max),this},applyMatrix4:function(){var Vu=[new A,new A,new A,new A,new A,new A,new A,new A];return function(Wu){return this.isEmpty()?this:(Vu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(Wu),Vu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(Wu),Vu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(Wu),Vu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(Wu),Vu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(Wu),Vu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(Wu),Vu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(Wu),Vu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(Wu),this.setFromPoints(Vu),this)}}(),translate:function(Vu){return this.min.add(Vu),this.max.add(Vu),this},equals:function(Vu){return Vu.min.equals(this.min)&&Vu.max.equals(this.max)}}),Object.assign(F.prototype,{set:function(Vu,ku){return this.center.copy(Vu),this.radius=ku,this},setFromPoints:function(){var Vu=new O;return function(Wu,ju){var qu=this.center;void 0===ju?Vu.setFromPoints(Wu).getCenter(qu):qu.copy(ju);for(var Xu=0,Yu=0,Zu=Wu.length;Yu<Zu;Yu++)Xu=Math.max(Xu,qu.distanceToSquared(Wu[Yu]));return this.radius=Math.sqrt(Xu),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.center.copy(Vu.center),this.radius=Vu.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(Vu){return Vu.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(Vu){return Vu.distanceTo(this.center)-this.radius},intersectsSphere:function(Vu){var ku=this.radius+Vu.radius;return Vu.center.distanceToSquared(this.center)<=ku*ku},intersectsBox:function(Vu){return Vu.intersectsSphere(this)},intersectsPlane:function(Vu){return Math.abs(Vu.distanceToPoint(this.center))<=this.radius},clampPoint:function(Vu,ku){var Wu=this.center.distanceToSquared(Vu);return void 0===ku&&(console.warn('THREE.Sphere: .clampPoint() target is now required'),ku=new A),ku.copy(Vu),Wu>this.radius*this.radius&&(ku.sub(this.center).normalize(),ku.multiplyScalar(this.radius).add(this.center)),ku},getBoundingBox:function(Vu){return void 0===Vu&&(console.warn('THREE.Sphere: .getBoundingBox() target is now required'),Vu=new O),Vu.set(this.center,this.center),Vu.expandByScalar(this.radius),Vu},applyMatrix4:function(Vu){return this.center.applyMatrix4(Vu),this.radius*=Vu.getMaxScaleOnAxis(),this},translate:function(Vu){return this.center.add(Vu),this},equals:function(Vu){return Vu.center.equals(this.center)&&Vu.radius===this.radius}}),Object.assign(H.prototype,{set:function(Vu,ku){return this.normal.copy(Vu),this.constant=ku,this},setComponents:function(Vu,ku,Wu,ju){return this.normal.set(Vu,ku,Wu),this.constant=ju,this},setFromNormalAndCoplanarPoint:function(Vu,ku){return this.normal.copy(Vu),this.constant=-ku.dot(this.normal),this},setFromCoplanarPoints:function(){var Vu=new A,ku=new A;return function(ju,qu,Xu){var Yu=Vu.subVectors(Xu,qu).cross(ku.subVectors(ju,qu)).normalize();return this.setFromNormalAndCoplanarPoint(Yu,ju),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.normal.copy(Vu.normal),this.constant=Vu.constant,this},normalize:function(){var Vu=1/this.normal.length();return this.normal.multiplyScalar(Vu),this.constant*=Vu,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(Vu){return this.normal.dot(Vu)+this.constant},distanceToSphere:function(Vu){return this.distanceToPoint(Vu.center)-Vu.radius},projectPoint:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Plane: .projectPoint() target is now required'),ku=new A),ku.copy(this.normal).multiplyScalar(-this.distanceToPoint(Vu)).add(Vu)},intersectLine:function(){var Vu=new A;return function(Wu,ju){ju===void 0&&(console.warn('THREE.Plane: .intersectLine() target is now required'),ju=new A);var qu=Wu.delta(Vu),Xu=this.normal.dot(qu);if(0===Xu)return 0===this.distanceToPoint(Wu.start)?ju.copy(Wu.start):void 0;var Yu=-(Wu.start.dot(this.normal)+this.constant)/Xu;return 0>Yu||1<Yu?void 0:ju.copy(qu).multiplyScalar(Yu).add(Wu.start)}}(),intersectsLine:function(Vu){var ku=this.distanceToPoint(Vu.start),Wu=this.distanceToPoint(Vu.end);return 0>ku&&0<Wu||0>Wu&&0<ku},intersectsBox:function(Vu){return Vu.intersectsPlane(this)},intersectsSphere:function(Vu){return Vu.intersectsPlane(this)},coplanarPoint:function(Vu){return void 0===Vu&&(console.warn('THREE.Plane: .coplanarPoint() target is now required'),Vu=new A),Vu.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var Vu=new A,ku=new C;return function(ju,qu){var Xu=qu||ku.getNormalMatrix(ju),Yu=this.coplanarPoint(Vu).applyMatrix4(ju),Zu=this.normal.applyMatrix3(Xu).normalize();return this.constant=-Yu.dot(Zu),this}}(),translate:function(Vu){return this.constant-=Vu.dot(this.normal),this},equals:function(Vu){return Vu.normal.equals(this.normal)&&Vu.constant===this.constant}}),Object.assign(V.prototype,{set:function(Vu,ku,Wu,ju,qu,Xu){var Yu=this.planes;return Yu[0].copy(Vu),Yu[1].copy(ku),Yu[2].copy(Wu),Yu[3].copy(ju),Yu[4].copy(qu),Yu[5].copy(Xu),this},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){for(var ku=this.planes,Wu=0;6>Wu;Wu++)ku[Wu].copy(Vu.planes[Wu]);return this},setFromMatrix:function(Vu){var ku=this.planes,Wu=Vu.elements,ju=Wu[0],qu=Wu[1],Xu=Wu[2],Yu=Wu[3],Zu=Wu[4],Ju=Wu[5],Qu=Wu[6],Ku=Wu[7],$u=Wu[8],em=Wu[9],tm=Wu[10],rm=Wu[11],am=Wu[12],om=Wu[13],im=Wu[14],nm=Wu[15];return ku[0].setComponents(Yu-ju,Ku-Zu,rm-$u,nm-am).normalize(),ku[1].setComponents(Yu+ju,Ku+Zu,rm+$u,nm+am).normalize(),ku[2].setComponents(Yu+qu,Ku+Ju,rm+em,nm+om).normalize(),ku[3].setComponents(Yu-qu,Ku-Ju,rm-em,nm-om).normalize(),ku[4].setComponents(Yu-Xu,Ku-Qu,rm-tm,nm-im).normalize(),ku[5].setComponents(Yu+Xu,Ku+Qu,rm+tm,nm+im).normalize(),this},intersectsObject:function(){var Vu=new F;return function(Wu){var ju=Wu.geometry;return null===ju.boundingSphere&&ju.computeBoundingSphere(),Vu.copy(ju.boundingSphere).applyMatrix4(Wu.matrixWorld),this.intersectsSphere(Vu)}}(),intersectsSprite:function(){var Vu=new F;return function(Wu){return Vu.center.set(0,0,0),Vu.radius=0.7071067811865476,Vu.applyMatrix4(Wu.matrixWorld),this.intersectsSphere(Vu)}}(),intersectsSphere:function(Vu){for(var ku=this.planes,Wu=Vu.center,ju=-Vu.radius,qu=0,Xu;6>qu;qu++)if(Xu=ku[qu].distanceToPoint(Wu),Xu<ju)return!1;return!0},intersectsBox:function(){var Vu=new A;return function(Wu){for(var ju=this.planes,qu=0,Xu;6>qu;qu++)if(Xu=ju[qu],Vu.x=0<Xu.normal.x?Wu.max.x:Wu.min.x,Vu.y=0<Xu.normal.y?Wu.max.y:Wu.min.y,Vu.z=0<Xu.normal.z?Wu.max.z:Wu.min.z,0>Xu.distanceToPoint(Vu))return!1;return!0}}(),containsPoint:function(Vu){for(var ku=this.planes,Wu=0;6>Wu;Wu++)if(0>ku[Wu].distanceToPoint(Vu))return!1;return!0}});var Uc={alphamap_fragment:'#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n',alphamap_pars_fragment:'#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n',alphatest_fragment:'#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n',aomap_fragment:'#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n',aomap_pars_fragment:'#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif',begin_vertex:'\nvec3 transformed = vec3( position );\n',beginnormal_vertex:'\nvec3 objectNormal = vec3( normal );\n',bsdfs:'float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',bumpmap_pars_fragment:'#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n',clipping_planes_fragment:'#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n',clipping_planes_pars_fragment:'#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n',clipping_planes_pars_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n',clipping_planes_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n',color_fragment:'#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif',color_pars_fragment:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n',color_pars_vertex:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif',color_vertex:'#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif',common:'#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n',cube_uv_reflection_fragment:'#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n',defaultnormal_vertex:'vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n',displacementmap_pars_vertex:'#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n',displacementmap_vertex:'#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n',emissivemap_fragment:'#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n',emissivemap_pars_fragment:'#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n',encodings_fragment:'  gl_FragColor = linearToOutputTexel( gl_FragColor );\n',encodings_pars_fragment:'\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n',envmap_fragment:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n',envmap_pars_fragment:'#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n',envmap_pars_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n',envmap_physical_pars_fragment:'#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n',envmap_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n',fog_vertex:'#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif\n',fog_pars_vertex:'#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif\n',fog_fragment:'#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n',fog_pars_fragment:'#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n',gradientmap_pars_fragment:'#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n',lightmap_fragment:'#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n',lightmap_pars_fragment:'#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif',lights_lambert_vertex:'vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n',lights_pars_begin:'uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n',lights_phong_fragment:'BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n',lights_phong_pars_fragment:'varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n',lights_physical_fragment:'PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n',lights_physical_pars_fragment:'struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n',lights_fragment_begin:'\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n',lights_fragment_maps:'#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n',lights_fragment_end:'#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n',logdepthbuf_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif',logdepthbuf_pars_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif\n',logdepthbuf_pars_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif\n',logdepthbuf_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n',map_fragment:'#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n',map_pars_fragment:'#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n',map_particle_fragment:'#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n',map_particle_pars_fragment:'#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n',metalnessmap_fragment:'float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n',metalnessmap_pars_fragment:'#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif',morphnormal_vertex:'#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n',morphtarget_pars_vertex:'#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif',morphtarget_vertex:'#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n',normal_fragment_begin:'#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n',normal_fragment_maps:'#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n',normalmap_pars_fragment:'#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n',packing:'vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n',premultiplied_alpha_fragment:'#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n',project_vertex:'vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n',dithering_fragment:'#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n',dithering_pars_fragment:'#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n',roughnessmap_fragment:'float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n',roughnessmap_pars_fragment:'#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif',shadowmap_pars_fragment:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n',shadowmap_pars_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n',shadowmap_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n',shadowmask_pars_fragment:'float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n',skinbase_vertex:'#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif',skinning_pars_vertex:'#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n',skinning_vertex:'#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n',skinnormal_vertex:'#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n',specularmap_fragment:'float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif',specularmap_pars_fragment:'#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif',tonemapping_fragment:'#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n',tonemapping_pars_fragment:'#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n',uv_pars_fragment:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif',uv_pars_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n',uv_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif',uv2_pars_fragment:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif',uv2_pars_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif',uv2_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif',worldpos_vertex:'#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n',background_frag:'uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}\n',background_vert:'varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}\n',cube_frag:'uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = envMapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}\n',cube_vert:'varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n',depth_frag:'#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n',depth_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',distanceRGBA_frag:'#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n',distanceRGBA_vert:'#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n',equirect_frag:'uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n',equirect_vert:'varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n',linedashed_frag:'uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',linedashed_vert:'uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n',meshbasic_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshbasic_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n',meshlambert_frag:'uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshlambert_vert:'#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshmatcap_frag:'#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\tvec4 matcapColor = texture2D( matcap, uv );\n\tmatcapColor = matcapTexelToLinear( matcapColor );\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshmatcap_vert:'#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}\n',meshphong_frag:'#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphong_vert:'#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshphysical_frag:'#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphysical_vert:'#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',normal_frag:'#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n',normal_vert:'#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n',points_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',points_vert:'uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n',shadow_frag:'uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n',shadow_vert:'#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',sprite_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',sprite_vert:'uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n'},Gc={merge:function(Vu){for(var ku={},Wu=0,ju;Wu<Vu.length;Wu++)for(var qu in ju=this.clone(Vu[Wu]),ju)ku[qu]=ju[qu];return ku},clone:function(Vu){var ku={};for(var Wu in Vu)for(var ju in ku[Wu]={},Vu[Wu]){var qu=Vu[Wu][ju];ku[Wu][ju]=qu&&(qu.isColor||qu.isMatrix3||qu.isMatrix4||qu.isVector2||qu.isVector3||qu.isVector4||qu.isTexture)?qu.clone():Array.isArray(qu)?qu.slice():qu}return ku}},Oc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(W.prototype,{isColor:!0,r:1,g:1,b:1,set:function(Vu){return Vu&&Vu.isColor?this.copy(Vu):'number'==typeof Vu?this.setHex(Vu):'string'==typeof Vu&&this.setStyle(Vu),this},setScalar:function(Vu){return this.r=Vu,this.g=Vu,this.b=Vu,this},setHex:function(Vu){return Vu=Math.floor(Vu),this.r=(255&Vu>>16)/255,this.g=(255&Vu>>8)/255,this.b=(255&Vu)/255,this},setRGB:function(Vu,ku,Wu){return this.r=Vu,this.g=ku,this.b=Wu,this},setHSL:function(){function Vu(ku,Wu,ju){return 0>ju&&(ju+=1),1<ju&&(ju-=1),ju<1/6?ku+6*(Wu-ku)*ju:ju<1/2?Wu:ju<2/3?ku+6*(Wu-ku)*(2/3-ju):ku}return function(Wu,ju,qu){if(Wu=hp.euclideanModulo(Wu,1),ju=hp.clamp(ju,0,1),qu=hp.clamp(qu,0,1),0===ju)this.r=this.g=this.b=qu;else{var Xu=0.5>=qu?qu*(1+ju):qu+ju-qu*ju,Yu=2*qu-Xu;this.r=Vu(Yu,Xu,Wu+1/3),this.g=Vu(Yu,Xu,Wu),this.b=Vu(Yu,Xu,Wu-1/3)}return this}}(),setStyle:function(Vu){function ku($u){void 0===$u||1>parseFloat($u)&&console.warn('THREE.Color: Alpha component of '+Vu+' will be ignored.')}var Wu;if(Wu=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(Vu)){var ju,qu=Wu[1],Xu=Wu[2];switch(qu){case'rgb':case'rgba':if(ju=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Xu))return this.r=Math.min(255,parseInt(ju[1],10))/255,this.g=Math.min(255,parseInt(ju[2],10))/255,this.b=Math.min(255,parseInt(ju[3],10))/255,ku(ju[5]),this;if(ju=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Xu))return this.r=Math.min(100,parseInt(ju[1],10))/100,this.g=Math.min(100,parseInt(ju[2],10))/100,this.b=Math.min(100,parseInt(ju[3],10))/100,ku(ju[5]),this;break;case'hsl':case'hsla':if(ju=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Xu)){var Yu=parseFloat(ju[1])/360,Zu=parseInt(ju[2],10)/100,Ju=parseInt(ju[3],10)/100;return ku(ju[5]),this.setHSL(Yu,Zu,Ju)}}}else if(Wu=/^\#([A-Fa-f0-9]+)$/.exec(Vu)){var Qu=Wu[1],Ku=Qu.length;if(3===Ku)return this.r=parseInt(Qu.charAt(0)+Qu.charAt(0),16)/255,this.g=parseInt(Qu.charAt(1)+Qu.charAt(1),16)/255,this.b=parseInt(Qu.charAt(2)+Qu.charAt(2),16)/255,this;if(6===Ku)return this.r=parseInt(Qu.charAt(0)+Qu.charAt(1),16)/255,this.g=parseInt(Qu.charAt(2)+Qu.charAt(3),16)/255,this.b=parseInt(Qu.charAt(4)+Qu.charAt(5),16)/255,this}if(Vu&&0<Vu.length){var Qu=Oc[Vu];void 0===Qu?console.warn('THREE.Color: Unknown color '+Vu):this.setHex(Qu)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(Vu){return this.r=Vu.r,this.g=Vu.g,this.b=Vu.b,this},copyGammaToLinear:function(Vu,ku){return void 0===ku&&(ku=2),this.r=Math.pow(Vu.r,ku),this.g=Math.pow(Vu.g,ku),this.b=Math.pow(Vu.b,ku),this},copyLinearToGamma:function(Vu,ku){void 0===ku&&(ku=2);var Wu=0<ku?1/ku:1;return this.r=Math.pow(Vu.r,Wu),this.g=Math.pow(Vu.g,Wu),this.b=Math.pow(Vu.b,Wu),this},convertGammaToLinear:function(Vu){return this.copyGammaToLinear(this,Vu),this},convertLinearToGamma:function(Vu){return this.copyLinearToGamma(this,Vu),this},copySRGBToLinear:function(){function Vu(ku){return 0.04045>ku?0.0773993808*ku:Math.pow(0.9478672986*ku+0.0521327014,2.4)}return function(Wu){return this.r=Vu(Wu.r),this.g=Vu(Wu.g),this.b=Vu(Wu.b),this}}(),copyLinearToSRGB:function(){function Vu(ku){return 0.0031308>ku?12.92*ku:1.055*Math.pow(ku,0.41666)-0.055}return function(Wu){return this.r=Vu(Wu.r),this.g=Vu(Wu.g),this.b=Vu(Wu.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function(Vu){void 0===Vu&&(console.warn('THREE.Color: .getHSL() target is now required'),Vu={h:0,s:0,l:0});var ku=this.r,Wu=this.g,ju=this.b,qu=Math.max(ku,Wu,ju),Xu=Math.min(ku,Wu,ju),Ju=(Xu+qu)/2,Yu,Zu;if(Xu===qu)Yu=0,Zu=0;else{var Qu=qu-Xu;Zu=0.5>=Ju?Qu/(qu+Xu):Qu/(2-qu-Xu),qu===ku?Yu=(Wu-ju)/Qu+(Wu<ju?6:0):qu===Wu?Yu=(ju-ku)/Qu+2:qu===ju?Yu=(ku-Wu)/Qu+4:void 0,Yu/=6}return Vu.h=Yu,Vu.s=Zu,Vu.l=Ju,Vu},getStyle:function(){return'rgb('+(0|255*this.r)+','+(0|255*this.g)+','+(0|255*this.b)+')'},offsetHSL:function(){var Vu={};return function(ku,Wu,ju){return this.getHSL(Vu),Vu.h+=ku,Vu.s+=Wu,Vu.l+=ju,this.setHSL(Vu.h,Vu.s,Vu.l),this}}(),add:function(Vu){return this.r+=Vu.r,this.g+=Vu.g,this.b+=Vu.b,this},addColors:function(Vu,ku){return this.r=Vu.r+ku.r,this.g=Vu.g+ku.g,this.b=Vu.b+ku.b,this},addScalar:function(Vu){return this.r+=Vu,this.g+=Vu,this.b+=Vu,this},sub:function(Vu){return this.r=Math.max(0,this.r-Vu.r),this.g=Math.max(0,this.g-Vu.g),this.b=Math.max(0,this.b-Vu.b),this},multiply:function(Vu){return this.r*=Vu.r,this.g*=Vu.g,this.b*=Vu.b,this},multiplyScalar:function(Vu){return this.r*=Vu,this.g*=Vu,this.b*=Vu,this},lerp:function(Vu,ku){return this.r+=(Vu.r-this.r)*ku,this.g+=(Vu.g-this.g)*ku,this.b+=(Vu.b-this.b)*ku,this},lerpHSL:function(){var Vu={h:0,s:0,l:0},ku={h:0,s:0,l:0};return function(ju,qu){this.getHSL(Vu),ju.getHSL(ku);var Xu=hp.lerp(Vu.h,ku.h,qu),Yu=hp.lerp(Vu.s,ku.s,qu),Zu=hp.lerp(Vu.l,ku.l,qu);return this.setHSL(Xu,Yu,Zu),this}}(),equals:function(Vu){return Vu.r===this.r&&Vu.g===this.g&&Vu.b===this.b},fromArray:function(Vu,ku){return void 0===ku&&(ku=0),this.r=Vu[ku],this.g=Vu[ku+1],this.b=Vu[ku+2],this},toArray:function(Vu,ku){return void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0),Vu[ku]=this.r,Vu[ku+1]=this.g,Vu[ku+2]=this.b,Vu},toJSON:function(){return this.getHex()}});var Fc={common:{diffuse:{value:new W(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new C},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:0.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new S(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5e-4},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new W(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new W(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new C}},sprite:{diffuse:{value:new W(15658734)},opacity:{value:1},center:{value:new S(0.5,0.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new C}}},Hc={basic:{uniforms:Gc.merge([Fc.common,Fc.specularmap,Fc.envmap,Fc.aomap,Fc.lightmap,Fc.fog]),vertexShader:Uc.meshbasic_vert,fragmentShader:Uc.meshbasic_frag},lambert:{uniforms:Gc.merge([Fc.common,Fc.specularmap,Fc.envmap,Fc.aomap,Fc.lightmap,Fc.emissivemap,Fc.fog,Fc.lights,{emissive:{value:new W(0)}}]),vertexShader:Uc.meshlambert_vert,fragmentShader:Uc.meshlambert_frag},phong:{uniforms:Gc.merge([Fc.common,Fc.specularmap,Fc.envmap,Fc.aomap,Fc.lightmap,Fc.emissivemap,Fc.bumpmap,Fc.normalmap,Fc.displacementmap,Fc.gradientmap,Fc.fog,Fc.lights,{emissive:{value:new W(0)},specular:{value:new W(1118481)},shininess:{value:30}}]),vertexShader:Uc.meshphong_vert,fragmentShader:Uc.meshphong_frag},standard:{uniforms:Gc.merge([Fc.common,Fc.envmap,Fc.aomap,Fc.lightmap,Fc.emissivemap,Fc.bumpmap,Fc.normalmap,Fc.displacementmap,Fc.roughnessmap,Fc.metalnessmap,Fc.fog,Fc.lights,{emissive:{value:new W(0)},roughness:{value:0.5},metalness:{value:0.5},envMapIntensity:{value:1}}]),vertexShader:Uc.meshphysical_vert,fragmentShader:Uc.meshphysical_frag},matcap:{uniforms:Gc.merge([Fc.common,Fc.bumpmap,Fc.normalmap,Fc.displacementmap,Fc.fog,{matcap:{value:null}}]),vertexShader:Uc.meshmatcap_vert,fragmentShader:Uc.meshmatcap_frag},points:{uniforms:Gc.merge([Fc.points,Fc.fog]),vertexShader:Uc.points_vert,fragmentShader:Uc.points_frag},dashed:{uniforms:Gc.merge([Fc.common,Fc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Uc.linedashed_vert,fragmentShader:Uc.linedashed_frag},depth:{uniforms:Gc.merge([Fc.common,Fc.displacementmap]),vertexShader:Uc.depth_vert,fragmentShader:Uc.depth_frag},normal:{uniforms:Gc.merge([Fc.common,Fc.bumpmap,Fc.normalmap,Fc.displacementmap,{opacity:{value:1}}]),vertexShader:Uc.normal_vert,fragmentShader:Uc.normal_frag},sprite:{uniforms:Gc.merge([Fc.sprite,Fc.fog]),vertexShader:Uc.sprite_vert,fragmentShader:Uc.sprite_frag},background:{uniforms:{uvTransform:{value:new C},t2D:{value:null}},vertexShader:Uc.background_vert,fragmentShader:Uc.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Uc.cube_vert,fragmentShader:Uc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Uc.equirect_vert,fragmentShader:Uc.equirect_frag},distanceRGBA:{uniforms:Gc.merge([Fc.common,Fc.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Uc.distanceRGBA_vert,fragmentShader:Uc.distanceRGBA_frag},shadow:{uniforms:Gc.merge([Fc.lights,Fc.fog,{color:{value:new W(0)},opacity:{value:1}}]),vertexShader:Uc.shadow_vert,fragmentShader:Uc.shadow_frag}};Hc.physical={uniforms:Gc.merge([Hc.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Uc.meshphysical_vert,fragmentShader:Uc.meshphysical_frag},Object.assign(Z.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(Vu){this.a=Vu.a,this.b=Vu.b,this.c=Vu.c,this.normal.copy(Vu.normal),this.color.copy(Vu.color),this.materialIndex=Vu.materialIndex;for(var ku=0,Wu=Vu.vertexNormals.length;ku<Wu;ku++)this.vertexNormals[ku]=Vu.vertexNormals[ku].clone();for(var ku=0,Wu=Vu.vertexColors.length;ku<Wu;ku++)this.vertexColors[ku]=Vu.vertexColors[ku].clone();return this}}),J.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],J.DefaultOrder='XYZ',Object.defineProperties(J.prototype,{x:{get:function(){return this._x},set:function(Vu){this._x=Vu,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Vu){this._y=Vu,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Vu){this._z=Vu,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(Vu){this._order=Vu,this.onChangeCallback()}}}),Object.assign(J.prototype,{isEuler:!0,set:function(Vu,ku,Wu,ju){return this._x=Vu,this._y=ku,this._z=Wu,this._order=ju||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(Vu){return this._x=Vu._x,this._y=Vu._y,this._z=Vu._z,this._order=Vu._order,this.onChangeCallback(),this},setFromRotationMatrix:function(Vu,ku,Wu){var ju=hp.clamp,qu=Vu.elements,Xu=qu[0],Yu=qu[4],Zu=qu[8],Ju=qu[1],Qu=qu[5],Ku=qu[9],$u=qu[2],em=qu[6],tm=qu[10];return ku=ku||this._order,'XYZ'===ku?(this._y=Math.asin(ju(Zu,-1,1)),0.99999>Math.abs(Zu)?(this._x=Math.atan2(-Ku,tm),this._z=Math.atan2(-Yu,Xu)):(this._x=Math.atan2(em,Qu),this._z=0)):'YXZ'===ku?(this._x=Math.asin(-ju(Ku,-1,1)),0.99999>Math.abs(Ku)?(this._y=Math.atan2(Zu,tm),this._z=Math.atan2(Ju,Qu)):(this._y=Math.atan2(-$u,Xu),this._z=0)):'ZXY'===ku?(this._x=Math.asin(ju(em,-1,1)),0.99999>Math.abs(em)?(this._y=Math.atan2(-$u,tm),this._z=Math.atan2(-Yu,Qu)):(this._y=0,this._z=Math.atan2(Ju,Xu))):'ZYX'===ku?(this._y=Math.asin(-ju($u,-1,1)),0.99999>Math.abs($u)?(this._x=Math.atan2(em,tm),this._z=Math.atan2(Ju,Xu)):(this._x=0,this._z=Math.atan2(-Yu,Qu))):'YZX'===ku?(this._z=Math.asin(ju(Ju,-1,1)),0.99999>Math.abs(Ju)?(this._x=Math.atan2(-Ku,Qu),this._y=Math.atan2(-$u,Xu)):(this._x=0,this._y=Math.atan2(Zu,tm))):'XZY'===ku?(this._z=Math.asin(-ju(Yu,-1,1)),0.99999>Math.abs(Yu)?(this._x=Math.atan2(em,Qu),this._y=Math.atan2(Zu,Xu)):(this._x=Math.atan2(-Ku,tm),this._y=0)):console.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: '+ku),this._order=ku,!1!==Wu&&this.onChangeCallback(),this},setFromQuaternion:function(){var Vu=new E;return function(Wu,ju,qu){return Vu.makeRotationFromQuaternion(Wu),this.setFromRotationMatrix(Vu,ju,qu)}}(),setFromVector3:function(Vu,ku){return this.set(Vu.x,Vu.y,Vu.z,ku||this._order)},reorder:function(){var Vu=new L;return function(Wu){return Vu.setFromEuler(this),this.setFromQuaternion(Vu,Wu)}}(),equals:function(Vu){return Vu._x===this._x&&Vu._y===this._y&&Vu._z===this._z&&Vu._order===this._order},fromArray:function(Vu){return this._x=Vu[0],this._y=Vu[1],this._z=Vu[2],void 0!==Vu[3]&&(this._order=Vu[3]),this.onChangeCallback(),this},toArray:function(Vu,ku){return void 0===Vu&&(Vu=[]),void 0===ku&&(ku=0),Vu[ku]=this._x,Vu[ku+1]=this._y,Vu[ku+2]=this._z,Vu[ku+3]=this._order,Vu},toVector3:function(Vu){return Vu?Vu.set(this._x,this._y,this._z):new A(this._x,this._y,this._z)},onChange:function(Vu){return this.onChangeCallback=Vu,this},onChangeCallback:function(){}}),Object.assign(Q.prototype,{set:function(Vu){this.mask=0|1<<Vu},enable:function(Vu){this.mask|=0|1<<Vu},toggle:function(Vu){this.mask^=0|1<<Vu},disable:function(Vu){this.mask&=~(0|1<<Vu)},test:function(Vu){return 0!=(this.mask&Vu.mask)}});var Vc=0;K.DefaultUp=new A(0,1,0),K.DefaultMatrixAutoUpdate=!0,K.prototype=Object.assign(Object.create(M.prototype),{constructor:K,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(Vu){this.matrix.multiplyMatrices(Vu,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(Vu){return this.quaternion.premultiply(Vu),this},setRotationFromAxisAngle:function(Vu,ku){this.quaternion.setFromAxisAngle(Vu,ku)},setRotationFromEuler:function(Vu){this.quaternion.setFromEuler(Vu,!0)},setRotationFromMatrix:function(Vu){this.quaternion.setFromRotationMatrix(Vu)},setRotationFromQuaternion:function(Vu){this.quaternion.copy(Vu)},rotateOnAxis:function(){var Vu=new L;return function(Wu,ju){return Vu.setFromAxisAngle(Wu,ju),this.quaternion.multiply(Vu),this}}(),rotateOnWorldAxis:function(){var Vu=new L;return function(Wu,ju){return Vu.setFromAxisAngle(Wu,ju),this.quaternion.premultiply(Vu),this}}(),rotateX:function(){var Vu=new A(1,0,0);return function(Wu){return this.rotateOnAxis(Vu,Wu)}}(),rotateY:function(){var Vu=new A(0,1,0);return function(Wu){return this.rotateOnAxis(Vu,Wu)}}(),rotateZ:function(){var Vu=new A(0,0,1);return function(Wu){return this.rotateOnAxis(Vu,Wu)}}(),translateOnAxis:function(){var Vu=new A;return function(Wu,ju){return Vu.copy(Wu).applyQuaternion(this.quaternion),this.position.add(Vu.multiplyScalar(ju)),this}}(),translateX:function(){var Vu=new A(1,0,0);return function(Wu){return this.translateOnAxis(Vu,Wu)}}(),translateY:function(){var Vu=new A(0,1,0);return function(Wu){return this.translateOnAxis(Vu,Wu)}}(),translateZ:function(){var Vu=new A(0,0,1);return function(Wu){return this.translateOnAxis(Vu,Wu)}}(),localToWorld:function(Vu){return Vu.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var Vu=new E;return function(Wu){return Wu.applyMatrix4(Vu.getInverse(this.matrixWorld))}}(),lookAt:function(){var Vu=new L,ku=new E,Wu=new A,ju=new A;return function(Xu,Yu,Zu){Xu.isVector3?Wu.copy(Xu):Wu.set(Xu,Yu,Zu);var Ju=this.parent;this.updateWorldMatrix(!0,!1),ju.setFromMatrixPosition(this.matrixWorld),this.isCamera?ku.lookAt(ju,Wu,this.up):ku.lookAt(Wu,ju,this.up),this.quaternion.setFromRotationMatrix(ku),Ju&&(ku.extractRotation(Ju.matrixWorld),Vu.setFromRotationMatrix(ku),this.quaternion.premultiply(Vu.inverse()))}}(),add:function(Vu){if(1<arguments.length){for(var ku=0;ku<arguments.length;ku++)this.add(arguments[ku]);return this}return Vu===this?(console.error('THREE.Object3D.add: object can\'t be added as a child of itself.',Vu),this):(Vu&&Vu.isObject3D?(null!==Vu.parent&&Vu.parent.remove(Vu),Vu.parent=this,Vu.dispatchEvent({type:'added'}),this.children.push(Vu)):console.error('THREE.Object3D.add: object not an instance of THREE.Object3D.',Vu),this)},remove:function(Vu){if(1<arguments.length){for(var ku=0;ku<arguments.length;ku++)this.remove(arguments[ku]);return this}var Wu=this.children.indexOf(Vu);return-1!==Wu&&(Vu.parent=null,Vu.dispatchEvent({type:'removed'}),this.children.splice(Wu,1)),this},getObjectById:function(Vu){return this.getObjectByProperty('id',Vu)},getObjectByName:function(Vu){return this.getObjectByProperty('name',Vu)},getObjectByProperty:function(Vu,ku){if(this[Vu]===ku)return this;for(var Wu=0,ju=this.children.length;Wu<ju;Wu++){var qu=this.children[Wu],Xu=qu.getObjectByProperty(Vu,ku);if(Xu!==void 0)return Xu}},getWorldPosition:function(Vu){return void 0===Vu&&(console.warn('THREE.Object3D: .getWorldPosition() target is now required'),Vu=new A),this.updateMatrixWorld(!0),Vu.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var Vu=new A,ku=new A;return function(ju){return void 0===ju&&(console.warn('THREE.Object3D: .getWorldQuaternion() target is now required'),ju=new L),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Vu,ju,ku),ju}}(),getWorldScale:function(){var Vu=new A,ku=new L;return function(ju){return void 0===ju&&(console.warn('THREE.Object3D: .getWorldScale() target is now required'),ju=new A),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Vu,ku,ju),ju}}(),getWorldDirection:function(Vu){Vu===void 0&&(console.warn('THREE.Object3D: .getWorldDirection() target is now required'),Vu=new A),this.updateMatrixWorld(!0);var ku=this.matrixWorld.elements;return Vu.set(ku[8],ku[9],ku[10]).normalize()},raycast:function(){},traverse:function(Vu){Vu(this);for(var ku=this.children,Wu=0,ju=ku.length;Wu<ju;Wu++)ku[Wu].traverse(Vu)},traverseVisible:function(Vu){if(!1!==this.visible){Vu(this);for(var ku=this.children,Wu=0,ju=ku.length;Wu<ju;Wu++)ku[Wu].traverseVisible(Vu)}},traverseAncestors:function(Vu){var ku=this.parent;null!==ku&&(Vu(ku),ku.traverseAncestors(Vu))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(Vu){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||Vu)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,Vu=!0);for(var ku=this.children,Wu=0,ju=ku.length;Wu<ju;Wu++)ku[Wu].updateMatrixWorld(Vu)},updateWorldMatrix:function(Vu,ku){var Wu=this.parent;if(!0===Vu&&null!==Wu&&Wu.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===ku)for(var ju=this.children,qu=0,Xu=ju.length;qu<Xu;qu++)ju[qu].updateWorldMatrix(!1,!0)},toJSON:function(Vu){function ku(om,im){return void 0===om[im.uuid]&&(om[im.uuid]=im.toJSON(Vu)),im.uuid}function Wu(om){var im=[];for(var nm in om){var sm=om[nm];delete sm.metadata,im.push(sm)}return im}var ju=void 0===Vu||'string'==typeof Vu,qu={};ju&&(Vu={geometries:{},materials:{},textures:{},images:{},shapes:{}},qu.metadata={version:4.5,type:'Object',generator:'Object3D.toJSON'});var Xu={};if(Xu.uuid=this.uuid,Xu.type=this.type,''!==this.name&&(Xu.name=this.name),!0===this.castShadow&&(Xu.castShadow=!0),!0===this.receiveShadow&&(Xu.receiveShadow=!0),!1===this.visible&&(Xu.visible=!1),!1===this.frustumCulled&&(Xu.frustumCulled=!1),0!==this.renderOrder&&(Xu.renderOrder=this.renderOrder),'{}'!==JSON.stringify(this.userData)&&(Xu.userData=this.userData),Xu.layers=this.layers.mask,Xu.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(Xu.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){Xu.geometry=ku(Vu.geometries,this.geometry);var Yu=this.geometry.parameters;if(void 0!==Yu&&void 0!==Yu.shapes){var Zu=Yu.shapes;if(Array.isArray(Zu))for(var Ju=0,Qu=Zu.length,Ku;Ju<Qu;Ju++)Ku=Zu[Ju],ku(Vu.shapes,Ku);else ku(Vu.shapes,Zu)}}if(void 0!==this.material)if(Array.isArray(this.material)){for(var $u=[],Ju=0,Qu=this.material.length;Ju<Qu;Ju++)$u.push(ku(Vu.materials,this.material[Ju]));Xu.material=$u}else Xu.material=ku(Vu.materials,this.material);if(0<this.children.length){Xu.children=[];for(var Ju=0;Ju<this.children.length;Ju++)Xu.children.push(this.children[Ju].toJSON(Vu).object)}if(ju){var em=Wu(Vu.geometries),tm=Wu(Vu.materials),rm=Wu(Vu.textures),am=Wu(Vu.images),Zu=Wu(Vu.shapes);0<em.length&&(qu.geometries=em),0<tm.length&&(qu.materials=tm),0<rm.length&&(qu.textures=rm),0<am.length&&(qu.images=am),0<Zu.length&&(qu.shapes=Zu)}return qu.object=Xu,qu},clone:function(Vu){return new this.constructor().copy(this,Vu)},copy:function(Vu,ku){if(void 0===ku&&(ku=!0),this.name=Vu.name,this.up.copy(Vu.up),this.position.copy(Vu.position),this.quaternion.copy(Vu.quaternion),this.scale.copy(Vu.scale),this.matrix.copy(Vu.matrix),this.matrixWorld.copy(Vu.matrixWorld),this.matrixAutoUpdate=Vu.matrixAutoUpdate,this.matrixWorldNeedsUpdate=Vu.matrixWorldNeedsUpdate,this.layers.mask=Vu.layers.mask,this.visible=Vu.visible,this.castShadow=Vu.castShadow,this.receiveShadow=Vu.receiveShadow,this.frustumCulled=Vu.frustumCulled,this.renderOrder=Vu.renderOrder,this.userData=JSON.parse(JSON.stringify(Vu.userData)),!0===ku)for(var Wu=0,ju;Wu<Vu.children.length;Wu++)ju=Vu.children[Wu],this.add(ju.clone());return this}});var kc=0;ee.prototype=Object.assign(Object.create(M.prototype),{constructor:ee,isGeometry:!0,applyMatrix:function(Vu){for(var ku=new C().getNormalMatrix(Vu),Wu=0,ju=this.vertices.length,qu;Wu<ju;Wu++)qu=this.vertices[Wu],qu.applyMatrix4(Vu);for(var Wu=0,ju=this.faces.length,Xu;Wu<ju;Wu++){Xu=this.faces[Wu],Xu.normal.applyMatrix3(ku).normalize();for(var Yu=0,Zu=Xu.vertexNormals.length;Yu<Zu;Yu++)Xu.vertexNormals[Yu].applyMatrix3(ku).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var Vu=new E;return function(Wu){return Vu.makeRotationX(Wu),this.applyMatrix(Vu),this}}(),rotateY:function(){var Vu=new E;return function(Wu){return Vu.makeRotationY(Wu),this.applyMatrix(Vu),this}}(),rotateZ:function(){var Vu=new E;return function(Wu){return Vu.makeRotationZ(Wu),this.applyMatrix(Vu),this}}(),translate:function(){var Vu=new E;return function(Wu,ju,qu){return Vu.makeTranslation(Wu,ju,qu),this.applyMatrix(Vu),this}}(),scale:function(){var Vu=new E;return function(Wu,ju,qu){return Vu.makeScale(Wu,ju,qu),this.applyMatrix(Vu),this}}(),lookAt:function(){var Vu=new K;return function(Wu){Vu.lookAt(Wu),Vu.updateMatrix(),this.applyMatrix(Vu.matrix)}}(),fromBufferGeometry:function(Vu){function ku(im,nm,sm,lm){var pm=void 0===Zu?[]:[Wu.colors[im].clone(),Wu.colors[nm].clone(),Wu.colors[sm].clone()],dm=void 0===Yu?[]:[new A().fromArray(Yu,3*im),new A().fromArray(Yu,3*nm),new A().fromArray(Yu,3*sm)],cm=new Z(im,nm,sm,dm,pm,lm);Wu.faces.push(cm),void 0!==Ju&&Wu.faceVertexUvs[0].push([new S().fromArray(Ju,2*im),new S().fromArray(Ju,2*nm),new S().fromArray(Ju,2*sm)]),void 0!==Qu&&Wu.faceVertexUvs[1].push([new S().fromArray(Qu,2*im),new S().fromArray(Qu,2*nm),new S().fromArray(Qu,2*sm)])}var Wu=this,ju=null===Vu.index?void 0:Vu.index.array,qu=Vu.attributes,Xu=qu.position.array,Yu=void 0===qu.normal?void 0:qu.normal.array,Zu=void 0===qu.color?void 0:qu.color.array,Ju=void 0===qu.uv?void 0:qu.uv.array,Qu=void 0===qu.uv2?void 0:qu.uv2.array;void 0!==Qu&&(this.faceVertexUvs[1]=[]);for(var Ku=0,$u=0;Ku<Xu.length;Ku+=3,$u+=2)Wu.vertices.push(new A().fromArray(Xu,Ku)),void 0!==Zu&&Wu.colors.push(new W().fromArray(Zu,Ku));var em=Vu.groups;if(0<em.length)for(var Ku=0;Ku<em.length;Ku++)for(var tm=em[Ku],rm=tm.start,am=tm.count,$u=rm;$u<rm+am;$u+=3)void 0===ju?ku($u,$u+1,$u+2,tm.materialIndex):ku(ju[$u],ju[$u+1],ju[$u+2],tm.materialIndex);else if(void 0!==ju)for(var Ku=0;Ku<ju.length;Ku+=3)ku(ju[Ku],ju[Ku+1],ju[Ku+2]);else for(var Ku=0;Ku<Xu.length/3;Ku+=3)ku(Ku,Ku+1,Ku+2);return this.computeFaceNormals(),null!==Vu.boundingBox&&(this.boundingBox=Vu.boundingBox.clone()),null!==Vu.boundingSphere&&(this.boundingSphere=Vu.boundingSphere.clone()),this},center:function(){var Vu=new A;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vu).negate(),this.translate(Vu.x,Vu.y,Vu.z),this}}(),normalize:function(){this.computeBoundingSphere();var Vu=this.boundingSphere.center,ku=this.boundingSphere.radius,Wu=0===ku?1:1/ku,ju=new E;return ju.set(Wu,0,0,-Wu*Vu.x,0,Wu,0,-Wu*Vu.y,0,0,Wu,-Wu*Vu.z,0,0,0,1),this.applyMatrix(ju),this},computeFaceNormals:function(){for(var Vu=new A,ku=new A,Wu=0,ju=this.faces.length;Wu<ju;Wu++){var qu=this.faces[Wu],Xu=this.vertices[qu.a],Yu=this.vertices[qu.b],Zu=this.vertices[qu.c];Vu.subVectors(Zu,Yu),ku.subVectors(Xu,Yu),Vu.cross(ku),Vu.normalize(),qu.normal.copy(Vu)}},computeVertexNormals:function(Vu){Vu===void 0&&(Vu=!0);var ku,Wu,ju,qu,Xu,Yu;for(Yu=Array(this.vertices.length),ku=0,Wu=this.vertices.length;ku<Wu;ku++)Yu[ku]=new A;if(Vu){var Zu,Ju,Qu,Ku=new A,$u=new A;for(ju=0,qu=this.faces.length;ju<qu;ju++)Xu=this.faces[ju],Zu=this.vertices[Xu.a],Ju=this.vertices[Xu.b],Qu=this.vertices[Xu.c],Ku.subVectors(Qu,Ju),$u.subVectors(Zu,Ju),Ku.cross($u),Yu[Xu.a].add(Ku),Yu[Xu.b].add(Ku),Yu[Xu.c].add(Ku)}else for(this.computeFaceNormals(),ju=0,qu=this.faces.length;ju<qu;ju++)Xu=this.faces[ju],Yu[Xu.a].add(Xu.normal),Yu[Xu.b].add(Xu.normal),Yu[Xu.c].add(Xu.normal);for(ku=0,Wu=this.vertices.length;ku<Wu;ku++)Yu[ku].normalize();for(ju=0,qu=this.faces.length;ju<qu;ju++){Xu=this.faces[ju];var em=Xu.vertexNormals;3===em.length?(em[0].copy(Yu[Xu.a]),em[1].copy(Yu[Xu.b]),em[2].copy(Yu[Xu.c])):(em[0]=Yu[Xu.a].clone(),em[1]=Yu[Xu.b].clone(),em[2]=Yu[Xu.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var Vu,ku,Wu;for(this.computeFaceNormals(),Vu=0,ku=this.faces.length;Vu<ku;Vu++){Wu=this.faces[Vu];var ju=Wu.vertexNormals;3===ju.length?(ju[0].copy(Wu.normal),ju[1].copy(Wu.normal),ju[2].copy(Wu.normal)):(ju[0]=Wu.normal.clone(),ju[1]=Wu.normal.clone(),ju[2]=Wu.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var Vu,ku,Wu,ju,qu;for(Wu=0,ju=this.faces.length;Wu<ju;Wu++)for(qu=this.faces[Wu],qu.__originalFaceNormal?qu.__originalFaceNormal.copy(qu.normal):qu.__originalFaceNormal=qu.normal.clone(),qu.__originalVertexNormals||(qu.__originalVertexNormals=[]),(Vu=0,ku=qu.vertexNormals.length);Vu<ku;Vu++)qu.__originalVertexNormals[Vu]?qu.__originalVertexNormals[Vu].copy(qu.vertexNormals[Vu]):qu.__originalVertexNormals[Vu]=qu.vertexNormals[Vu].clone();var Xu=new ee;for(Xu.faces=this.faces,Vu=0,ku=this.morphTargets.length;Vu<ku;Vu++){if(!this.morphNormals[Vu]){this.morphNormals[Vu]={},this.morphNormals[Vu].faceNormals=[],this.morphNormals[Vu].vertexNormals=[];var Yu=this.morphNormals[Vu].faceNormals,Zu=this.morphNormals[Vu].vertexNormals,Ju,Qu;for(Wu=0,ju=this.faces.length;Wu<ju;Wu++)Ju=new A,Qu={a:new A,b:new A,c:new A},Yu.push(Ju),Zu.push(Qu)}var Ku=this.morphNormals[Vu];Xu.vertices=this.morphTargets[Vu].vertices,Xu.computeFaceNormals(),Xu.computeVertexNormals();var Ju,Qu;for(Wu=0,ju=this.faces.length;Wu<ju;Wu++)qu=this.faces[Wu],Ju=Ku.faceNormals[Wu],Qu=Ku.vertexNormals[Wu],Ju.copy(qu.normal),Qu.a.copy(qu.vertexNormals[0]),Qu.b.copy(qu.vertexNormals[1]),Qu.c.copy(qu.vertexNormals[2])}for(Wu=0,ju=this.faces.length;Wu<ju;Wu++)qu=this.faces[Wu],qu.normal=qu.__originalFaceNormal,qu.vertexNormals=qu.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new O),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new F),this.boundingSphere.setFromPoints(this.vertices)},merge:function(Vu,ku,Wu){if(!(Vu&&Vu.isGeometry))return void console.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.',Vu);var qu=this.vertices.length,Xu=this.vertices,Yu=Vu.vertices,Zu=this.faces,Ju=Vu.faces,Qu=this.faceVertexUvs[0],Ku=Vu.faceVertexUvs[0],$u=this.colors,em=Vu.colors,ju;Wu===void 0&&(Wu=0),ku!==void 0&&(ju=new C().getNormalMatrix(ku));for(var tm=0,rm=Yu.length;tm<rm;tm++){var am=Yu[tm],om=am.clone();ku!==void 0&&om.applyMatrix4(ku),Xu.push(om)}for(var tm=0,rm=em.length;tm<rm;tm++)$u.push(em[tm].clone());for(tm=0,rm=Ju.length;tm<rm;tm++){var im=Ju[tm],pm=im.vertexNormals,dm=im.vertexColors,nm,sm,lm;nm=new Z(im.a+qu,im.b+qu,im.c+qu),nm.normal.copy(im.normal),ju!=void 0&&nm.normal.applyMatrix3(ju).normalize();for(var cm=0,um=pm.length;cm<um;cm++)sm=pm[cm].clone(),void 0!=ju&&sm.applyMatrix3(ju).normalize(),nm.vertexNormals.push(sm);nm.color.copy(im.color);for(var cm=0,um=dm.length;cm<um;cm++)lm=dm[cm],nm.vertexColors.push(lm.clone());nm.materialIndex=im.materialIndex+Wu,Zu.push(nm)}for(tm=0,rm=Ku.length;tm<rm;tm++){var mm=Ku[tm],gm=[];if(void 0!==mm){for(var cm=0,um=mm.length;cm<um;cm++)gm.push(mm[cm].clone());Qu.push(gm)}}},mergeMesh:function(Vu){return Vu&&Vu.isMesh?void(Vu.matrixAutoUpdate&&Vu.updateMatrix(),this.merge(Vu.geometry,Vu.matrix)):void console.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.',Vu)},mergeVertices:function(){var Vu={},ku=[],Wu=[],Yu=Math.pow(10,4),ju,qu,Zu,Ju,Qu,Ku,$u,em;for(Zu=0,Ju=this.vertices.length;Zu<Ju;Zu++)ju=this.vertices[Zu],qu=Math.round(ju.x*Yu)+'_'+Math.round(ju.y*Yu)+'_'+Math.round(ju.z*Yu),void 0===Vu[qu]?(Vu[qu]=Zu,ku.push(this.vertices[Zu]),Wu[Zu]=ku.length-1):Wu[Zu]=Wu[Vu[qu]];var tm=[];for(Zu=0,Ju=this.faces.length;Zu<Ju;Zu++){Qu=this.faces[Zu],Qu.a=Wu[Qu.a],Qu.b=Wu[Qu.b],Qu.c=Wu[Qu.c],Ku=[Qu.a,Qu.b,Qu.c];for(var rm=0;3>rm;rm++)if(Ku[rm]===Ku[(rm+1)%3]){tm.push(Zu);break}}for(Zu=tm.length-1;0<=Zu;Zu--){var am=tm[Zu];for(this.faces.splice(am,1),$u=0,em=this.faceVertexUvs.length;$u<em;$u++)this.faceVertexUvs[$u].splice(am,1)}var om=this.vertices.length-ku.length;return this.vertices=ku,om},setFromPoints:function(Vu){this.vertices=[];for(var ku=0,Wu=Vu.length,ju;ku<Wu;ku++)ju=Vu[ku],this.vertices.push(new A(ju.x,ju.y,ju.z||0));return this},sortFacesByMaterialIndex:function(){for(var ku=this.faces,Wu=ku.length,ju=0;ju<Wu;ju++)ku[ju]._id=ju;ku.sort(function(Qu,Ku){return Qu.materialIndex-Ku.materialIndex});var qu=this.faceVertexUvs[0],Xu=this.faceVertexUvs[1],Yu,Zu;qu&&qu.length===Wu&&(Yu=[]),Xu&&Xu.length===Wu&&(Zu=[]);for(var ju=0,Ju;ju<Wu;ju++)Ju=ku[ju]._id,Yu&&Yu.push(qu[Ju]),Zu&&Zu.push(Xu[Ju]);Yu&&(this.faceVertexUvs[0]=Yu),Zu&&(this.faceVertexUvs[1]=Zu)},toJSON:function(){function Vu(ym,xm,vm){return vm?ym|1<<xm:ym&~(1<<xm)}function ku(ym){var xm=ym.x.toString()+ym.y.toString()+ym.z.toString();return void 0===em[xm]?(em[xm]=$u.length/3,$u.push(ym.x,ym.y,ym.z),em[xm]):em[xm]}function Wu(ym){var xm=ym.r.toString()+ym.g.toString()+ym.b.toString();return void 0===rm[xm]?(rm[xm]=tm.length,tm.push(ym.getHex()),rm[xm]):rm[xm]}function ju(ym){var xm=ym.x.toString()+ym.y.toString();return void 0===om[xm]?(om[xm]=am.length/2,am.push(ym.x,ym.y),om[xm]):om[xm]}var qu={metadata:{version:4.5,type:'Geometry',generator:'Geometry.toJSON'}};if(qu.uuid=this.uuid,qu.type=this.type,''!==this.name&&(qu.name=this.name),void 0!==this.parameters){var Xu=this.parameters;for(var Yu in Xu)void 0!==Xu[Yu]&&(qu[Yu]=Xu[Yu]);return qu}for(var Zu=[],Ju=0,Qu;Ju<this.vertices.length;Ju++)Qu=this.vertices[Ju],Zu.push(Qu.x,Qu.y,Qu.z);for(var Ku=[],$u=[],em={},tm=[],rm={},am=[],om={},Ju=0;Ju<this.faces.length;Ju++){var im=this.faces[Ju],lm=void 0!==this.faceVertexUvs[0][Ju],pm=0<im.normal.length(),dm=0<im.vertexNormals.length,cm=1!==im.color.r||1!==im.color.g||1!==im.color.b,um=0<im.vertexColors.length,mm=0;if(mm=Vu(mm,0,0),mm=Vu(mm,1,!0),mm=Vu(mm,2,!1),mm=Vu(mm,3,lm),mm=Vu(mm,4,pm),mm=Vu(mm,5,dm),mm=Vu(mm,6,cm),mm=Vu(mm,7,um),Ku.push(mm),Ku.push(im.a,im.b,im.c),Ku.push(im.materialIndex),lm){var gm=this.faceVertexUvs[0][Ju];Ku.push(ju(gm[0]),ju(gm[1]),ju(gm[2]))}if(pm&&Ku.push(ku(im.normal)),dm){var fm=im.vertexNormals;Ku.push(ku(fm[0]),ku(fm[1]),ku(fm[2]))}if(cm&&Ku.push(Wu(im.color)),um){var hm=im.vertexColors;Ku.push(Wu(hm[0]),Wu(hm[1]),Wu(hm[2]))}}return qu.data={},qu.data.vertices=Zu,qu.data.normals=$u,0<tm.length&&(qu.data.colors=tm),0<am.length&&(qu.data.uvs=[am]),qu.data.faces=Ku,qu},clone:function(){return new ee().copy(this)},copy:function(Vu){var ku,Wu,ju,qu,Xu,Yu;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=Vu.name;var Zu=Vu.vertices;for(ku=0,Wu=Zu.length;ku<Wu;ku++)this.vertices.push(Zu[ku].clone());var Ju=Vu.colors;for(ku=0,Wu=Ju.length;ku<Wu;ku++)this.colors.push(Ju[ku].clone());var Qu=Vu.faces;for(ku=0,Wu=Qu.length;ku<Wu;ku++)this.faces.push(Qu[ku].clone());for(ku=0,Wu=Vu.faceVertexUvs.length;ku<Wu;ku++){var Ku=Vu.faceVertexUvs[ku];for(void 0===this.faceVertexUvs[ku]&&(this.faceVertexUvs[ku]=[]),ju=0,qu=Ku.length;ju<qu;ju++){var $u=Ku[ju],em=[];for(Xu=0,Yu=$u.length;Xu<Yu;Xu++){var tm=$u[Xu];em.push(tm.clone())}this.faceVertexUvs[ku].push(em)}}var rm=Vu.morphTargets;for(ku=0,Wu=rm.length;ku<Wu;ku++){var am={name:rm[ku].name};if(void 0!==rm[ku].vertices)for(am.vertices=[],ju=0,qu=rm[ku].vertices.length;ju<qu;ju++)am.vertices.push(rm[ku].vertices[ju].clone());if(void 0!==rm[ku].normals)for(am.normals=[],ju=0,qu=rm[ku].normals.length;ju<qu;ju++)am.normals.push(rm[ku].normals[ju].clone());this.morphTargets.push(am)}var om=Vu.morphNormals;for(ku=0,Wu=om.length;ku<Wu;ku++){var im={};if(void 0!==om[ku].vertexNormals)for(im.vertexNormals=[],ju=0,qu=om[ku].vertexNormals.length;ju<qu;ju++){var nm=om[ku].vertexNormals[ju],sm={};sm.a=nm.a.clone(),sm.b=nm.b.clone(),sm.c=nm.c.clone(),im.vertexNormals.push(sm)}if(void 0!==om[ku].faceNormals)for(im.faceNormals=[],ju=0,qu=om[ku].faceNormals.length;ju<qu;ju++)im.faceNormals.push(om[ku].faceNormals[ju].clone());this.morphNormals.push(im)}var lm=Vu.skinWeights;for(ku=0,Wu=lm.length;ku<Wu;ku++)this.skinWeights.push(lm[ku].clone());var pm=Vu.skinIndices;for(ku=0,Wu=pm.length;ku<Wu;ku++)this.skinIndices.push(pm[ku].clone());var dm=Vu.lineDistances;for(ku=0,Wu=dm.length;ku<Wu;ku++)this.lineDistances.push(dm[ku]);var cm=Vu.boundingBox;null!==cm&&(this.boundingBox=cm.clone());var um=Vu.boundingSphere;return null!==um&&(this.boundingSphere=um.clone()),this.elementsNeedUpdate=Vu.elementsNeedUpdate,this.verticesNeedUpdate=Vu.verticesNeedUpdate,this.uvsNeedUpdate=Vu.uvsNeedUpdate,this.normalsNeedUpdate=Vu.normalsNeedUpdate,this.colorsNeedUpdate=Vu.colorsNeedUpdate,this.lineDistancesNeedUpdate=Vu.lineDistancesNeedUpdate,this.groupsNeedUpdate=Vu.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),Object.defineProperty(re.prototype,'needsUpdate',{set:function(Vu){!0===Vu&&this.version++}}),Object.assign(re.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(Vu){if(Array.isArray(Vu))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');return this.count=void 0===Vu?0:Vu.length/this.itemSize,this.array=Vu,this},setDynamic:function(Vu){return this.dynamic=Vu,this},copy:function(Vu){return this.name=Vu.name,this.array=new Vu.array.constructor(Vu.array),this.itemSize=Vu.itemSize,this.count=Vu.count,this.normalized=Vu.normalized,this.dynamic=Vu.dynamic,this},copyAt:function(Vu,ku,Wu){Vu*=this.itemSize,Wu*=ku.itemSize;for(var ju=0,qu=this.itemSize;ju<qu;ju++)this.array[Vu+ju]=ku.array[Wu+ju];return this},copyArray:function(Vu){return this.array.set(Vu),this},copyColorsArray:function(Vu){for(var ku=this.array,Wu=0,ju=0,qu=Vu.length,Xu;ju<qu;ju++)Xu=Vu[ju],void 0===Xu&&(console.warn('THREE.BufferAttribute.copyColorsArray(): color is undefined',ju),Xu=new W),ku[Wu++]=Xu.r,ku[Wu++]=Xu.g,ku[Wu++]=Xu.b;return this},copyVector2sArray:function(Vu){for(var ku=this.array,Wu=0,ju=0,qu=Vu.length,Xu;ju<qu;ju++)Xu=Vu[ju],void 0===Xu&&(console.warn('THREE.BufferAttribute.copyVector2sArray(): vector is undefined',ju),Xu=new S),ku[Wu++]=Xu.x,ku[Wu++]=Xu.y;return this},copyVector3sArray:function(Vu){for(var ku=this.array,Wu=0,ju=0,qu=Vu.length,Xu;ju<qu;ju++)Xu=Vu[ju],void 0===Xu&&(console.warn('THREE.BufferAttribute.copyVector3sArray(): vector is undefined',ju),Xu=new A),ku[Wu++]=Xu.x,ku[Wu++]=Xu.y,ku[Wu++]=Xu.z;return this},copyVector4sArray:function(Vu){for(var ku=this.array,Wu=0,ju=0,qu=Vu.length,Xu;ju<qu;ju++)Xu=Vu[ju],void 0===Xu&&(console.warn('THREE.BufferAttribute.copyVector4sArray(): vector is undefined',ju),Xu=new I),ku[Wu++]=Xu.x,ku[Wu++]=Xu.y,ku[Wu++]=Xu.z,ku[Wu++]=Xu.w;return this},set:function(Vu,ku){return void 0===ku&&(ku=0),this.array.set(Vu,ku),this},getX:function(Vu){return this.array[Vu*this.itemSize]},setX:function(Vu,ku){return this.array[Vu*this.itemSize]=ku,this},getY:function(Vu){return this.array[Vu*this.itemSize+1]},setY:function(Vu,ku){return this.array[Vu*this.itemSize+1]=ku,this},getZ:function(Vu){return this.array[Vu*this.itemSize+2]},setZ:function(Vu,ku){return this.array[Vu*this.itemSize+2]=ku,this},getW:function(Vu){return this.array[Vu*this.itemSize+3]},setW:function(Vu,ku){return this.array[Vu*this.itemSize+3]=ku,this},setXY:function(Vu,ku,Wu){return Vu*=this.itemSize,this.array[Vu+0]=ku,this.array[Vu+1]=Wu,this},setXYZ:function(Vu,ku,Wu,ju){return Vu*=this.itemSize,this.array[Vu+0]=ku,this.array[Vu+1]=Wu,this.array[Vu+2]=ju,this},setXYZW:function(Vu,ku,Wu,ju,qu){return Vu*=this.itemSize,this.array[Vu+0]=ku,this.array[Vu+1]=Wu,this.array[Vu+2]=ju,this.array[Vu+3]=qu,this},onUpload:function(Vu){return this.onUploadCallback=Vu,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),oe.prototype=Object.create(re.prototype),oe.prototype.constructor=oe,ie.prototype=Object.create(re.prototype),ie.prototype.constructor=ie,ne.prototype=Object.create(re.prototype),ne.prototype.constructor=ne,se.prototype=Object.create(re.prototype),se.prototype.constructor=se,le.prototype=Object.create(re.prototype),le.prototype.constructor=le,pe.prototype=Object.create(re.prototype),pe.prototype.constructor=pe,ue.prototype=Object.create(re.prototype),ue.prototype.constructor=ue,ge.prototype=Object.create(re.prototype),ge.prototype.constructor=ge,fe.prototype=Object.create(re.prototype),fe.prototype.constructor=fe,Object.assign(he.prototype,{computeGroups:function(Vu){for(var Wu=[],ju=void 0,qu=Vu.faces,Xu=0,ku,Yu;Xu<qu.length;Xu++)Yu=qu[Xu],Yu.materialIndex!==ju&&(ju=Yu.materialIndex,void 0!=ku&&(ku.count=3*Xu-ku.start,Wu.push(ku)),ku={start:3*Xu,materialIndex:ju});ku!==void 0&&(ku.count=3*Xu-ku.start,Wu.push(ku)),this.groups=Wu},fromGeometry:function(Vu){var ku=Vu.faces,Wu=Vu.vertices,ju=Vu.faceVertexUvs,qu=ju[0]&&0<ju[0].length,Xu=ju[1]&&0<ju[1].length,Yu=Vu.morphTargets,Zu=Yu.length,Ju;if(0<Zu){Ju=[];for(var Qu=0;Qu<Zu;Qu++)Ju[Qu]={name:Yu[Qu].name,data:[]};this.morphTargets.position=Ju}var Ku=Vu.morphNormals,$u=Ku.length,em;if(0<$u){em=[];for(var Qu=0;Qu<$u;Qu++)em[Qu]={name:Ku[Qu].name,data:[]};this.morphTargets.normal=em}var tm=Vu.skinIndices,rm=Vu.skinWeights,am=tm.length===Wu.length,om=rm.length===Wu.length;0<Wu.length&&0===ku.length&&console.error('THREE.DirectGeometry: Faceless geometries are not supported.');for(var Qu=0,im;Qu<ku.length;Qu++){im=ku[Qu],this.vertices.push(Wu[im.a],Wu[im.b],Wu[im.c]);var nm=im.vertexNormals;if(3===nm.length)this.normals.push(nm[0],nm[1],nm[2]);else{var sm=im.normal;this.normals.push(sm,sm,sm)}var lm=im.vertexColors;if(3===lm.length)this.colors.push(lm[0],lm[1],lm[2]);else{var pm=im.color;this.colors.push(pm,pm,pm)}if(!0===qu){var dm=ju[0][Qu];void 0===dm?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ',Qu),this.uvs.push(new S,new S,new S)):this.uvs.push(dm[0],dm[1],dm[2])}if(!0===Xu){var dm=ju[1][Qu];void 0===dm?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ',Qu),this.uvs2.push(new S,new S,new S)):this.uvs2.push(dm[0],dm[1],dm[2])}for(var cm=0,um;cm<Zu;cm++)um=Yu[cm].vertices,Ju[cm].data.push(um[im.a],um[im.b],um[im.c]);for(var cm=0,mm;cm<$u;cm++)mm=Ku[cm].vertexNormals[Qu],em[cm].data.push(mm.a,mm.b,mm.c);am&&this.skinIndices.push(tm[im.a],tm[im.b],tm[im.c]),om&&this.skinWeights.push(rm[im.a],rm[im.b],rm[im.c])}return this.computeGroups(Vu),this.verticesNeedUpdate=Vu.verticesNeedUpdate,this.normalsNeedUpdate=Vu.normalsNeedUpdate,this.colorsNeedUpdate=Vu.colorsNeedUpdate,this.uvsNeedUpdate=Vu.uvsNeedUpdate,this.groupsNeedUpdate=Vu.groupsNeedUpdate,this}});var Wc=1;xe.prototype=Object.assign(Object.create(M.prototype),{constructor:xe,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(Vu){this.index=Array.isArray(Vu)?new(65535<ye(Vu)?ue:le)(Vu,1):Vu},addAttribute:function(Vu,ku){return ku&&ku.isBufferAttribute||ku&&ku.isInterleavedBufferAttribute?'index'===Vu?(console.warn('THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.'),this.setIndex(ku),this):(this.attributes[Vu]=ku,this):(console.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).'),this.addAttribute(Vu,new re(arguments[1],arguments[2])))},getAttribute:function(Vu){return this.attributes[Vu]},removeAttribute:function(Vu){return delete this.attributes[Vu],this},addGroup:function(Vu,ku,Wu){this.groups.push({start:Vu,count:ku,materialIndex:Wu===void 0?0:Wu})},clearGroups:function(){this.groups=[]},setDrawRange:function(Vu,ku){this.drawRange.start=Vu,this.drawRange.count=ku},applyMatrix:function(Vu){var ku=this.attributes.position;void 0!==ku&&(Vu.applyToBufferAttribute(ku),ku.needsUpdate=!0);var Wu=this.attributes.normal;if(void 0!==Wu){var ju=new C().getNormalMatrix(Vu);ju.applyToBufferAttribute(Wu),Wu.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var Vu=new E;return function(Wu){return Vu.makeRotationX(Wu),this.applyMatrix(Vu),this}}(),rotateY:function(){var Vu=new E;return function(Wu){return Vu.makeRotationY(Wu),this.applyMatrix(Vu),this}}(),rotateZ:function(){var Vu=new E;return function(Wu){return Vu.makeRotationZ(Wu),this.applyMatrix(Vu),this}}(),translate:function(){var Vu=new E;return function(Wu,ju,qu){return Vu.makeTranslation(Wu,ju,qu),this.applyMatrix(Vu),this}}(),scale:function(){var Vu=new E;return function(Wu,ju,qu){return Vu.makeScale(Wu,ju,qu),this.applyMatrix(Vu),this}}(),lookAt:function(){var Vu=new K;return function(Wu){Vu.lookAt(Wu),Vu.updateMatrix(),this.applyMatrix(Vu.matrix)}}(),center:function(){var Vu=new A;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vu).negate(),this.translate(Vu.x,Vu.y,Vu.z),this}}(),setFromObject:function(Vu){var ku=Vu.geometry;if(Vu.isPoints||Vu.isLine){var Wu=new ge(3*ku.vertices.length,3),ju=new ge(3*ku.colors.length,3);if(this.addAttribute('position',Wu.copyVector3sArray(ku.vertices)),this.addAttribute('color',ju.copyColorsArray(ku.colors)),ku.lineDistances&&ku.lineDistances.length===ku.vertices.length){var qu=new ge(ku.lineDistances.length,1);this.addAttribute('lineDistance',qu.copyArray(ku.lineDistances))}null!==ku.boundingSphere&&(this.boundingSphere=ku.boundingSphere.clone()),null!==ku.boundingBox&&(this.boundingBox=ku.boundingBox.clone())}else Vu.isMesh&&ku&&ku.isGeometry&&this.fromGeometry(ku);return this},setFromPoints:function(Vu){for(var ku=[],Wu=0,ju=Vu.length,qu;Wu<ju;Wu++)qu=Vu[Wu],ku.push(qu.x,qu.y,qu.z||0);return this.addAttribute('position',new ge(ku,3)),this},updateFromObject:function(Vu){var ku=Vu.geometry;if(Vu.isMesh){var Wu=ku.__directGeometry;if(!0===ku.elementsNeedUpdate&&(Wu=void 0,ku.elementsNeedUpdate=!1),void 0===Wu)return this.fromGeometry(ku);Wu.verticesNeedUpdate=ku.verticesNeedUpdate,Wu.normalsNeedUpdate=ku.normalsNeedUpdate,Wu.colorsNeedUpdate=ku.colorsNeedUpdate,Wu.uvsNeedUpdate=ku.uvsNeedUpdate,Wu.groupsNeedUpdate=ku.groupsNeedUpdate,ku.verticesNeedUpdate=!1,ku.normalsNeedUpdate=!1,ku.colorsNeedUpdate=!1,ku.uvsNeedUpdate=!1,ku.groupsNeedUpdate=!1,ku=Wu}var ju;return!0===ku.verticesNeedUpdate&&(ju=this.attributes.position,void 0!=ju&&(ju.copyVector3sArray(ku.vertices),ju.needsUpdate=!0),ku.verticesNeedUpdate=!1),!0===ku.normalsNeedUpdate&&(ju=this.attributes.normal,void 0!=ju&&(ju.copyVector3sArray(ku.normals),ju.needsUpdate=!0),ku.normalsNeedUpdate=!1),!0===ku.colorsNeedUpdate&&(ju=this.attributes.color,void 0!=ju&&(ju.copyColorsArray(ku.colors),ju.needsUpdate=!0),ku.colorsNeedUpdate=!1),ku.uvsNeedUpdate&&(ju=this.attributes.uv,void 0!=ju&&(ju.copyVector2sArray(ku.uvs),ju.needsUpdate=!0),ku.uvsNeedUpdate=!1),ku.lineDistancesNeedUpdate&&(ju=this.attributes.lineDistance,void 0!=ju&&(ju.copyArray(ku.lineDistances),ju.needsUpdate=!0),ku.lineDistancesNeedUpdate=!1),ku.groupsNeedUpdate&&(ku.computeGroups(Vu.geometry),this.groups=ku.groups,ku.groupsNeedUpdate=!1),this},fromGeometry:function(Vu){return Vu.__directGeometry=new he().fromGeometry(Vu),this.fromDirectGeometry(Vu.__directGeometry)},fromDirectGeometry:function(Vu){var ku=new Float32Array(3*Vu.vertices.length);if(this.addAttribute('position',new re(ku,3).copyVector3sArray(Vu.vertices)),0<Vu.normals.length){var Wu=new Float32Array(3*Vu.normals.length);this.addAttribute('normal',new re(Wu,3).copyVector3sArray(Vu.normals))}if(0<Vu.colors.length){var ju=new Float32Array(3*Vu.colors.length);this.addAttribute('color',new re(ju,3).copyColorsArray(Vu.colors))}if(0<Vu.uvs.length){var qu=new Float32Array(2*Vu.uvs.length);this.addAttribute('uv',new re(qu,2).copyVector2sArray(Vu.uvs))}if(0<Vu.uvs2.length){var Xu=new Float32Array(2*Vu.uvs2.length);this.addAttribute('uv2',new re(Xu,2).copyVector2sArray(Vu.uvs2))}for(var Yu in this.groups=Vu.groups,Vu.morphTargets){for(var Zu=[],Ju=Vu.morphTargets[Yu],Qu=0,Ku=Ju.length;Qu<Ku;Qu++){var $u=Ju[Qu],em=new ge(3*$u.data.length,3);em.name=$u.name,Zu.push(em.copyVector3sArray($u.data))}this.morphAttributes[Yu]=Zu}if(0<Vu.skinIndices.length){var tm=new ge(4*Vu.skinIndices.length,4);this.addAttribute('skinIndex',tm.copyVector4sArray(Vu.skinIndices))}if(0<Vu.skinWeights.length){var rm=new ge(4*Vu.skinWeights.length,4);this.addAttribute('skinWeight',rm.copyVector4sArray(Vu.skinWeights))}return null!==Vu.boundingSphere&&(this.boundingSphere=Vu.boundingSphere.clone()),null!==Vu.boundingBox&&(this.boundingBox=Vu.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new O);var Vu=this.attributes.position;Vu===void 0?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(Vu),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var Vu=new O,ku=new A;return function(){null===this.boundingSphere&&(this.boundingSphere=new F);var ju=this.attributes.position;if(ju){var qu=this.boundingSphere.center;Vu.setFromBufferAttribute(ju),Vu.getCenter(qu);for(var Xu=0,Yu=0,Zu=ju.count;Yu<Zu;Yu++)ku.x=ju.getX(Yu),ku.y=ju.getY(Yu),ku.z=ju.getZ(Yu),Xu=Math.max(Xu,qu.distanceToSquared(ku));this.boundingSphere.radius=Math.sqrt(Xu),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var Vu=this.index,ku=this.attributes;if(ku.position){var Wu=ku.position.array;if(ku.normal===void 0)this.addAttribute('normal',new re(new Float32Array(Wu.length),3));else for(var ju=ku.normal.array,qu=0,Xu=ju.length;qu<Xu;qu++)ju[qu]=0;var Yu=ku.normal.array,Zu,Ju,Qu,Ku=new A,$u=new A,em=new A,tm=new A,rm=new A;if(Vu)for(var am=Vu.array,qu=0,Xu=Vu.count;qu<Xu;qu+=3)Zu=3*am[qu+0],Ju=3*am[qu+1],Qu=3*am[qu+2],Ku.fromArray(Wu,Zu),$u.fromArray(Wu,Ju),em.fromArray(Wu,Qu),tm.subVectors(em,$u),rm.subVectors(Ku,$u),tm.cross(rm),Yu[Zu]+=tm.x,Yu[Zu+1]+=tm.y,Yu[Zu+2]+=tm.z,Yu[Ju]+=tm.x,Yu[Ju+1]+=tm.y,Yu[Ju+2]+=tm.z,Yu[Qu]+=tm.x,Yu[Qu+1]+=tm.y,Yu[Qu+2]+=tm.z;else for(var qu=0,Xu=Wu.length;qu<Xu;qu+=9)Ku.fromArray(Wu,qu),$u.fromArray(Wu,qu+3),em.fromArray(Wu,qu+6),tm.subVectors(em,$u),rm.subVectors(Ku,$u),tm.cross(rm),Yu[qu]=tm.x,Yu[qu+1]=tm.y,Yu[qu+2]=tm.z,Yu[qu+3]=tm.x,Yu[qu+4]=tm.y,Yu[qu+5]=tm.z,Yu[qu+6]=tm.x,Yu[qu+7]=tm.y,Yu[qu+8]=tm.z;this.normalizeNormals(),ku.normal.needsUpdate=!0}},merge:function(Vu,ku){if(!(Vu&&Vu.isBufferGeometry))return void console.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.',Vu);ku===void 0&&(ku=0,console.warn('THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'));var Wu=this.attributes;for(var ju in Wu)if(Vu.attributes[ju]!==void 0)for(var qu=Wu[ju],Xu=qu.array,Yu=Vu.attributes[ju],Zu=Yu.array,Ju=Yu.itemSize,Qu=0,Ku=Ju*ku;Qu<Zu.length;Qu++,Ku++)Xu[Ku]=Zu[Qu];return this},normalizeNormals:function(){var Vu=new A;return function(){for(var Wu=this.attributes.normal,ju=0,qu=Wu.count;ju<qu;ju++)Vu.x=Wu.getX(ju),Vu.y=Wu.getY(ju),Vu.z=Wu.getZ(ju),Vu.normalize(),Wu.setXYZ(ju,Vu.x,Vu.y,Vu.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn('THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.'),this;var Vu=new xe,ku=this.index.array,Wu=this.attributes;for(var ju in Wu){for(var qu=Wu[ju],Xu=qu.array,Yu=qu.itemSize,Zu=new Xu.constructor(ku.length*Yu),Ju=0,Qu=0,Ku=0,$u=ku.length;Ku<$u;Ku++){Ju=ku[Ku]*Yu;for(var em=0;em<Yu;em++)Zu[Qu++]=Xu[Ju++]}Vu.addAttribute(ju,new re(Zu,Yu))}for(var tm=this.groups,Ku=0,$u=tm.length,rm;Ku<$u;Ku++)rm=tm[Ku],Vu.addGroup(rm.start,rm.count,rm.materialIndex);return Vu},toJSON:function(){var Vu={metadata:{version:4.5,type:'BufferGeometry',generator:'BufferGeometry.toJSON'}};if(Vu.uuid=this.uuid,Vu.type=this.type,''!==this.name&&(Vu.name=this.name),0<Object.keys(this.userData).length&&(Vu.userData=this.userData),void 0!==this.parameters){var ku=this.parameters;for(var Wu in ku)void 0!==ku[Wu]&&(Vu[Wu]=ku[Wu]);return Vu}Vu.data={attributes:{}};var ju=this.index;if(null!==ju){var qu=Array.prototype.slice.call(ju.array);Vu.data.index={type:ju.array.constructor.name,array:qu}}var Xu=this.attributes;for(var Wu in Xu){var Yu=Xu[Wu],qu=Array.prototype.slice.call(Yu.array);Vu.data.attributes[Wu]={itemSize:Yu.itemSize,type:Yu.array.constructor.name,array:qu,normalized:Yu.normalized}}var Zu=this.groups;0<Zu.length&&(Vu.data.groups=JSON.parse(JSON.stringify(Zu)));var Ju=this.boundingSphere;return null!==Ju&&(Vu.data.boundingSphere={center:Ju.center.toArray(),radius:Ju.radius}),Vu},clone:function(){return new xe().copy(this)},copy:function(Vu){var ku,Wu,ju;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=Vu.name;var qu=Vu.index;null!==qu&&this.setIndex(qu.clone());var Xu=Vu.attributes;for(ku in Xu){var Yu=Xu[ku];this.addAttribute(ku,Yu.clone())}var Zu=Vu.morphAttributes;for(ku in Zu){var Ju=[],Qu=Zu[ku];for(Wu=0,ju=Qu.length;Wu<ju;Wu++)Ju.push(Qu[Wu].clone());this.morphAttributes[ku]=Ju}var Ku=Vu.groups;for(Wu=0,ju=Ku.length;Wu<ju;Wu++){var $u=Ku[Wu];this.addGroup($u.start,$u.count,$u.materialIndex)}var em=Vu.boundingBox;null!==em&&(this.boundingBox=em.clone());var tm=Vu.boundingSphere;return null!==tm&&(this.boundingSphere=tm.clone()),this.drawRange.start=Vu.drawRange.start,this.drawRange.count=Vu.drawRange.count,this.userData=Vu.userData,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),ve.prototype=Object.create(ee.prototype),ve.prototype.constructor=ve,_e.prototype=Object.create(xe.prototype),_e.prototype.constructor=_e,Me.prototype=Object.create(ee.prototype),Me.prototype.constructor=Me,Se.prototype=Object.create(xe.prototype),Se.prototype.constructor=Se;var jc=0;Te.prototype=Object.assign(Object.create(M.prototype),{constructor:Te,isMaterial:!0,onBeforeCompile:function(){},setValues:function(Vu){if(void 0!==Vu)for(var ku in Vu){var Wu=Vu[ku];if(void 0===Wu){console.warn('THREE.Material: \''+ku+'\' parameter is undefined.');continue}if('shading'==ku){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=Wu===Un;continue}var ju=this[ku];if(void 0===ju){console.warn('THREE.'+this.type+': \''+ku+'\' is not a property of this material.');continue}ju&&ju.isColor?ju.set(Wu):ju&&ju.isVector3&&Wu&&Wu.isVector3?ju.copy(Wu):this[ku]=Wu}},toJSON:function(Vu){function ku(Yu){var Zu=[];for(var Ju in Yu){var Qu=Yu[Ju];delete Qu.metadata,Zu.push(Qu)}return Zu}var Wu=void 0===Vu||'string'==typeof Vu;Wu&&(Vu={textures:{},images:{}});var ju={metadata:{version:4.5,type:'Material',generator:'Material.toJSON'}};if(ju.uuid=this.uuid,ju.type=this.type,''!==this.name&&(ju.name=this.name),this.color&&this.color.isColor&&(ju.color=this.color.getHex()),void 0!==this.roughness&&(ju.roughness=this.roughness),void 0!==this.metalness&&(ju.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(ju.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(ju.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(ju.specular=this.specular.getHex()),void 0!==this.shininess&&(ju.shininess=this.shininess),void 0!==this.clearCoat&&(ju.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(ju.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(ju.map=this.map.toJSON(Vu).uuid),this.alphaMap&&this.alphaMap.isTexture&&(ju.alphaMap=this.alphaMap.toJSON(Vu).uuid),this.lightMap&&this.lightMap.isTexture&&(ju.lightMap=this.lightMap.toJSON(Vu).uuid),this.aoMap&&this.aoMap.isTexture&&(ju.aoMap=this.aoMap.toJSON(Vu).uuid,ju.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(ju.bumpMap=this.bumpMap.toJSON(Vu).uuid,ju.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(ju.normalMap=this.normalMap.toJSON(Vu).uuid,ju.normalMapType=this.normalMapType,ju.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(ju.displacementMap=this.displacementMap.toJSON(Vu).uuid,ju.displacementScale=this.displacementScale,ju.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(ju.roughnessMap=this.roughnessMap.toJSON(Vu).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(ju.metalnessMap=this.metalnessMap.toJSON(Vu).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(ju.emissiveMap=this.emissiveMap.toJSON(Vu).uuid),this.specularMap&&this.specularMap.isTexture&&(ju.specularMap=this.specularMap.toJSON(Vu).uuid),this.envMap&&this.envMap.isTexture&&(ju.envMap=this.envMap.toJSON(Vu).uuid,ju.reflectivity=this.reflectivity,void 0!==this.combine&&(ju.combine=this.combine),void 0!==this.envMapIntensity&&(ju.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(ju.gradientMap=this.gradientMap.toJSON(Vu).uuid),void 0!==this.size&&(ju.size=this.size),void 0!==this.sizeAttenuation&&(ju.sizeAttenuation=this.sizeAttenuation),this.blending!==Vn&&(ju.blending=this.blending),!0===this.flatShading&&(ju.flatShading=this.flatShading),this.side!==zn&&(ju.side=this.side),this.vertexColors!==Gn&&(ju.vertexColors=this.vertexColors),1>this.opacity&&(ju.opacity=this.opacity),!0===this.transparent&&(ju.transparent=this.transparent),ju.depthFunc=this.depthFunc,ju.depthTest=this.depthTest,ju.depthWrite=this.depthWrite,0!==this.rotation&&(ju.rotation=this.rotation),!0===this.polygonOffset&&(ju.polygonOffset=!0),0!==this.polygonOffsetFactor&&(ju.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(ju.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(ju.linewidth=this.linewidth),void 0!==this.dashSize&&(ju.dashSize=this.dashSize),void 0!==this.gapSize&&(ju.gapSize=this.gapSize),void 0!==this.scale&&(ju.scale=this.scale),!0===this.dithering&&(ju.dithering=!0),0<this.alphaTest&&(ju.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(ju.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(ju.wireframe=this.wireframe),1<this.wireframeLinewidth&&(ju.wireframeLinewidth=this.wireframeLinewidth),'round'!==this.wireframeLinecap&&(ju.wireframeLinecap=this.wireframeLinecap),'round'!==this.wireframeLinejoin&&(ju.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(ju.morphTargets=!0),!0===this.skinning&&(ju.skinning=!0),!1===this.visible&&(ju.visible=!1),'{}'!==JSON.stringify(this.userData)&&(ju.userData=this.userData),Wu){var qu=ku(Vu.textures),Xu=ku(Vu.images);0<qu.length&&(ju.textures=qu),0<Xu.length&&(ju.images=Xu)}return ju},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){this.name=Vu.name,this.fog=Vu.fog,this.lights=Vu.lights,this.blending=Vu.blending,this.side=Vu.side,this.flatShading=Vu.flatShading,this.vertexColors=Vu.vertexColors,this.opacity=Vu.opacity,this.transparent=Vu.transparent,this.blendSrc=Vu.blendSrc,this.blendDst=Vu.blendDst,this.blendEquation=Vu.blendEquation,this.blendSrcAlpha=Vu.blendSrcAlpha,this.blendDstAlpha=Vu.blendDstAlpha,this.blendEquationAlpha=Vu.blendEquationAlpha,this.depthFunc=Vu.depthFunc,this.depthTest=Vu.depthTest,this.depthWrite=Vu.depthWrite,this.colorWrite=Vu.colorWrite,this.precision=Vu.precision,this.polygonOffset=Vu.polygonOffset,this.polygonOffsetFactor=Vu.polygonOffsetFactor,this.polygonOffsetUnits=Vu.polygonOffsetUnits,this.dithering=Vu.dithering,this.alphaTest=Vu.alphaTest,this.premultipliedAlpha=Vu.premultipliedAlpha,this.visible=Vu.visible,this.userData=JSON.parse(JSON.stringify(Vu.userData)),this.clipShadows=Vu.clipShadows,this.clipIntersection=Vu.clipIntersection;var ku=Vu.clippingPlanes,Wu=null;if(null!==ku){var ju=ku.length;Wu=Array(ju);for(var qu=0;qu!==ju;++qu)Wu[qu]=ku[qu].clone()}return this.clippingPlanes=Wu,this.shadowSide=Vu.shadowSide,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),Ee.prototype=Object.create(Te.prototype),Ee.prototype.constructor=Ee,Ee.prototype.isShaderMaterial=!0,Ee.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.fragmentShader=Vu.fragmentShader,this.vertexShader=Vu.vertexShader,this.uniforms=Gc.clone(Vu.uniforms),this.defines=Object.assign({},Vu.defines),this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this.lights=Vu.lights,this.clipping=Vu.clipping,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.morphNormals=Vu.morphNormals,this.extensions=Vu.extensions,this},Ee.prototype.toJSON=function(Vu){var ku=Te.prototype.toJSON.call(this,Vu);for(var Wu in ku.uniforms={},this.uniforms){var ju=this.uniforms[Wu],qu=ju.value;ku.uniforms[Wu]=qu.isTexture?{type:'t',value:qu.toJSON(Vu).uuid}:qu.isColor?{type:'c',value:qu.getHex()}:qu.isVector2?{type:'v2',value:qu.toArray()}:qu.isVector3?{type:'v3',value:qu.toArray()}:qu.isVector4?{type:'v4',value:qu.toArray()}:qu.isMatrix4?{type:'m4',value:qu.toArray()}:{value:qu}}return 0<Object.keys(this.defines).length&&(ku.defines=this.defines),ku.vertexShader=this.vertexShader,ku.fragmentShader=this.fragmentShader,ku},Object.assign(we.prototype,{set:function(Vu,ku){return this.origin.copy(Vu),this.direction.copy(ku),this},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.origin.copy(Vu.origin),this.direction.copy(Vu.direction),this},at:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Ray: .at() target is now required'),ku=new A),ku.copy(this.direction).multiplyScalar(Vu).add(this.origin)},lookAt:function(Vu){return this.direction.copy(Vu).sub(this.origin).normalize(),this},recast:function(){var Vu=new A;return function(Wu){return this.origin.copy(this.at(Wu,Vu)),this}}(),closestPointToPoint:function(Vu,ku){ku===void 0&&(console.warn('THREE.Ray: .closestPointToPoint() target is now required'),ku=new A),ku.subVectors(Vu,this.origin);var Wu=ku.dot(this.direction);return 0>Wu?ku.copy(this.origin):ku.copy(this.direction).multiplyScalar(Wu).add(this.origin)},distanceToPoint:function(Vu){return Math.sqrt(this.distanceSqToPoint(Vu))},distanceSqToPoint:function(){var Vu=new A;return function(Wu){var ju=Vu.subVectors(Wu,this.origin).dot(this.direction);return 0>ju?this.origin.distanceToSquared(Wu):(Vu.copy(this.direction).multiplyScalar(ju).add(this.origin),Vu.distanceToSquared(Wu))}}(),distanceSqToSegment:function(){var Vu=new A,ku=new A,Wu=new A;return function(qu,Xu,Yu,Zu){Vu.copy(qu).add(Xu).multiplyScalar(0.5),ku.copy(Xu).sub(qu).normalize(),Wu.copy(this.origin).sub(Vu);var Ju=0.5*qu.distanceTo(Xu),Qu=-this.direction.dot(ku),Ku=Wu.dot(this.direction),$u=-Wu.dot(ku),em=Wu.lengthSq(),tm=Math.abs(1-Qu*Qu),rm,am,om,im;if(!(0<tm))am=0<Qu?-Ju:Ju,rm=Math.max(0,-(Qu*am+Ku)),om=-rm*rm+am*(am+2*$u)+em;else if(rm=Qu*$u-Ku,am=Qu*Ku-$u,im=Ju*tm,!(0<=rm))am<=-im?(rm=Math.max(0,-(-Qu*Ju+Ku)),am=0<rm?-Ju:Math.min(Math.max(-Ju,-$u),Ju),om=-rm*rm+am*(am+2*$u)+em):am<=im?(rm=0,am=Math.min(Math.max(-Ju,-$u),Ju),om=am*(am+2*$u)+em):(rm=Math.max(0,-(Qu*Ju+Ku)),am=0<rm?Ju:Math.min(Math.max(-Ju,-$u),Ju),om=-rm*rm+am*(am+2*$u)+em);else if(!(am>=-im))am=-Ju,rm=Math.max(0,-(Qu*am+Ku)),om=-rm*rm+am*(am+2*$u)+em;else if(am<=im){var nm=1/tm;rm*=nm,am*=nm,om=rm*(rm+Qu*am+2*Ku)+am*(Qu*rm+am+2*$u)+em}else am=Ju,rm=Math.max(0,-(Qu*am+Ku)),om=-rm*rm+am*(am+2*$u)+em;return Yu&&Yu.copy(this.direction).multiplyScalar(rm).add(this.origin),Zu&&Zu.copy(ku).multiplyScalar(am).add(Vu),om}}(),intersectSphere:function(){var Vu=new A;return function(Wu,ju){Vu.subVectors(Wu.center,this.origin);var qu=Vu.dot(this.direction),Xu=Vu.dot(Vu)-qu*qu,Yu=Wu.radius*Wu.radius;if(Xu>Yu)return null;var Zu=Math.sqrt(Yu-Xu),Ju=qu-Zu,Qu=qu+Zu;return 0>Ju&&0>Qu?null:0>Ju?this.at(Qu,ju):this.at(Ju,ju)}}(),intersectsSphere:function(Vu){return this.distanceSqToPoint(Vu.center)<=Vu.radius*Vu.radius},distanceToPlane:function(Vu){var ku=Vu.normal.dot(this.direction);if(0===ku)return 0===Vu.distanceToPoint(this.origin)?0:null;var Wu=-(this.origin.dot(Vu.normal)+Vu.constant)/ku;return 0<=Wu?Wu:null},intersectPlane:function(Vu,ku){var Wu=this.distanceToPlane(Vu);return null===Wu?null:this.at(Wu,ku)},intersectsPlane:function(Vu){var ku=Vu.distanceToPoint(this.origin);if(0===ku)return!0;var Wu=Vu.normal.dot(this.direction);return!!(0>Wu*ku)},intersectBox:function(Vu,ku){var Ju=1/this.direction.x,Qu=1/this.direction.y,Ku=1/this.direction.z,$u=this.origin,Wu,ju,qu,Xu,Yu,Zu;return(0<=Ju?(Wu=(Vu.min.x-$u.x)*Ju,ju=(Vu.max.x-$u.x)*Ju):(Wu=(Vu.max.x-$u.x)*Ju,ju=(Vu.min.x-$u.x)*Ju),0<=Qu?(qu=(Vu.min.y-$u.y)*Qu,Xu=(Vu.max.y-$u.y)*Qu):(qu=(Vu.max.y-$u.y)*Qu,Xu=(Vu.min.y-$u.y)*Qu),Wu>Xu||qu>ju)?null:((qu>Wu||Wu!=Wu)&&(Wu=qu),(Xu<ju||ju!=ju)&&(ju=Xu),0<=Ku?(Yu=(Vu.min.z-$u.z)*Ku,Zu=(Vu.max.z-$u.z)*Ku):(Yu=(Vu.max.z-$u.z)*Ku,Zu=(Vu.min.z-$u.z)*Ku),Wu>Zu||Yu>ju)?null:((Yu>Wu||Wu!=Wu)&&(Wu=Yu),(Zu<ju||ju!=ju)&&(ju=Zu),0>ju?null:this.at(0<=Wu?Wu:ju,ku))},intersectsBox:function(){var Vu=new A;return function(Wu){return null!==this.intersectBox(Wu,Vu)}}(),intersectTriangle:function(){var Vu=new A,ku=new A,Wu=new A,ju=new A;return function(Xu,Yu,Zu,Ju,Qu){ku.subVectors(Yu,Xu),Wu.subVectors(Zu,Xu),ju.crossVectors(ku,Wu);var Ku=this.direction.dot(ju),$u;if(0<Ku){if(Ju)return null;$u=1}else if(0>Ku)$u=-1,Ku=-Ku;else return null;Vu.subVectors(this.origin,Xu);var em=$u*this.direction.dot(Wu.crossVectors(Vu,Wu));if(0>em)return null;var tm=$u*this.direction.dot(ku.cross(Vu));if(0>tm)return null;if(em+tm>Ku)return null;var rm=-$u*Vu.dot(ju);return 0>rm?null:this.at(rm/Ku,Qu)}}(),applyMatrix4:function(Vu){return this.origin.applyMatrix4(Vu),this.direction.transformDirection(Vu),this},equals:function(Vu){return Vu.origin.equals(this.origin)&&Vu.direction.equals(this.direction)}}),Object.assign(Le,{getNormal:function(){var Vu=new A;return function(Wu,ju,qu,Xu){Xu===void 0&&(console.warn('THREE.Triangle: .getNormal() target is now required'),Xu=new A),Xu.subVectors(qu,ju),Vu.subVectors(Wu,ju),Xu.cross(Vu);var Yu=Xu.lengthSq();return 0<Yu?Xu.multiplyScalar(1/Math.sqrt(Yu)):Xu.set(0,0,0)}}(),getBarycoord:function(){var Vu=new A,ku=new A,Wu=new A;return function(qu,Xu,Yu,Zu,Ju){Vu.subVectors(Zu,Xu),ku.subVectors(Yu,Xu),Wu.subVectors(qu,Xu);var Qu=Vu.dot(Vu),Ku=Vu.dot(ku),$u=Vu.dot(Wu),em=ku.dot(ku),tm=ku.dot(Wu),rm=Qu*em-Ku*Ku;if(void 0===Ju&&(console.warn('THREE.Triangle: .getBarycoord() target is now required'),Ju=new A),0==rm)return Ju.set(-2,-1,-1);var am=1/rm,om=(em*$u-Ku*tm)*am,im=(Qu*tm-Ku*$u)*am;return Ju.set(1-om-im,im,om)}}(),containsPoint:function(){var Vu=new A;return function(Wu,ju,qu,Xu){return Le.getBarycoord(Wu,ju,qu,Xu,Vu),0<=Vu.x&&0<=Vu.y&&1>=Vu.x+Vu.y}}(),getUV:function(){var Vu=new A;return function(Wu,ju,qu,Xu,Yu,Zu,Ju,Qu){return this.getBarycoord(Wu,ju,qu,Xu,Vu),Qu.set(0,0),Qu.addScaledVector(Yu,Vu.x),Qu.addScaledVector(Zu,Vu.y),Qu.addScaledVector(Ju,Vu.z),Qu}}()}),Object.assign(Le.prototype,{set:function(Vu,ku,Wu){return this.a.copy(Vu),this.b.copy(ku),this.c.copy(Wu),this},setFromPointsAndIndices:function(Vu,ku,Wu,ju){return this.a.copy(Vu[ku]),this.b.copy(Vu[Wu]),this.c.copy(Vu[ju]),this},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.a.copy(Vu.a),this.b.copy(Vu.b),this.c.copy(Vu.c),this},getArea:function(){var Vu=new A,ku=new A;return function(){return Vu.subVectors(this.c,this.b),ku.subVectors(this.a,this.b),0.5*Vu.cross(ku).length()}}(),getMidpoint:function(Vu){return void 0===Vu&&(console.warn('THREE.Triangle: .getMidpoint() target is now required'),Vu=new A),Vu.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(Vu){return Le.getNormal(this.a,this.b,this.c,Vu)},getPlane:function(Vu){return void 0===Vu&&(console.warn('THREE.Triangle: .getPlane() target is now required'),Vu=new A),Vu.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(Vu,ku){return Le.getBarycoord(Vu,this.a,this.b,this.c,ku)},containsPoint:function(Vu){return Le.containsPoint(Vu,this.a,this.b,this.c)},getUV:function(Vu,ku,Wu,ju,qu){return Le.getUV(Vu,this.a,this.b,this.c,ku,Wu,ju,qu)},intersectsBox:function(Vu){return Vu.intersectsTriangle(this)},closestPointToPoint:function(){var Vu=new A,ku=new A,Wu=new A,ju=new A,qu=new A,Xu=new A;return function(Zu,Ju){void 0===Ju&&(console.warn('THREE.Triangle: .closestPointToPoint() target is now required'),Ju=new A);var Qu=this.a,Ku=this.b,$u=this.c,em,tm;Vu.subVectors(Ku,Qu),ku.subVectors($u,Qu),ju.subVectors(Zu,Qu);var rm=Vu.dot(ju),am=ku.dot(ju);if(0>=rm&&0>=am)return Ju.copy(Qu);qu.subVectors(Zu,Ku);var om=Vu.dot(qu),im=ku.dot(qu);if(0<=om&&im<=om)return Ju.copy(Ku);var nm=rm*im-om*am;if(0>=nm&&0<=rm&&0>=om)return em=rm/(rm-om),Ju.copy(Qu).addScaledVector(Vu,em);Xu.subVectors(Zu,$u);var sm=Vu.dot(Xu),lm=ku.dot(Xu);if(0<=lm&&sm<=lm)return Ju.copy($u);var pm=sm*am-rm*lm;if(0>=pm&&0<=am&&0>=lm)return tm=am/(am-lm),Ju.copy(Qu).addScaledVector(ku,tm);var dm=om*lm-sm*im;if(0>=dm&&0<=im-om&&0<=sm-lm)return Wu.subVectors($u,Ku),tm=(im-om)/(im-om+(sm-lm)),Ju.copy(Ku).addScaledVector(Wu,tm);var cm=1/(dm+pm+nm);return em=pm*cm,tm=nm*cm,Ju.copy(Qu).addScaledVector(Vu,em).addScaledVector(ku,tm)}}(),equals:function(Vu){return Vu.a.equals(this.a)&&Vu.b.equals(this.b)&&Vu.c.equals(this.c)}}),Ae.prototype=Object.create(Te.prototype),Ae.prototype.constructor=Ae,Ae.prototype.isMeshBasicMaterial=!0,Ae.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.map=Vu.map,this.lightMap=Vu.lightMap,this.lightMapIntensity=Vu.lightMapIntensity,this.aoMap=Vu.aoMap,this.aoMapIntensity=Vu.aoMapIntensity,this.specularMap=Vu.specularMap,this.alphaMap=Vu.alphaMap,this.envMap=Vu.envMap,this.combine=Vu.combine,this.reflectivity=Vu.reflectivity,this.refractionRatio=Vu.refractionRatio,this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this.wireframeLinecap=Vu.wireframeLinecap,this.wireframeLinejoin=Vu.wireframeLinejoin,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this},Pe.prototype=Object.assign(Object.create(K.prototype),{constructor:Pe,isMesh:!0,setDrawMode:function(Vu){this.drawMode=Vu},copy:function(Vu){return K.prototype.copy.call(this,Vu),this.drawMode=Vu.drawMode,void 0!==Vu.morphTargetInfluences&&(this.morphTargetInfluences=Vu.morphTargetInfluences.slice()),void 0!==Vu.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},Vu.morphTargetDictionary)),this},updateMorphTargets:function(){var Vu=this.geometry,ku,Wu,ju;if(Vu.isBufferGeometry){var qu=Vu.morphAttributes,Xu=Object.keys(qu);if(0<Xu.length){var Yu=qu[Xu[0]];if(Yu!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},(ku=0,Wu=Yu.length);ku<Wu;ku++)ju=Yu[ku].name||ku+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[ju]=ku}}else{var Zu=Vu.morphTargets;if(Zu!==void 0&&0<Zu.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},(ku=0,Wu=Zu.length);ku<Wu;ku++)ju=Zu[ku].name||ku+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[ju]=ku}},raycast:function(){function Vu(om,im,nm,sm,lm,pm,dm,cm){var um;if(um=im.side===Nn?sm.intersectTriangle(dm,pm,lm,!0,cm):sm.intersectTriangle(lm,pm,dm,im.side!==Bn,cm),null===um)return null;am.copy(cm),am.applyMatrix4(om.matrixWorld);var mm=nm.ray.origin.distanceTo(am);return mm<nm.near||mm>nm.far?null:{distance:mm,point:am.clone(),object:om}}function ku(om,im,nm,sm,lm,pm,dm,cm,um){Xu.fromBufferAttribute(lm,dm),Yu.fromBufferAttribute(lm,cm),Zu.fromBufferAttribute(lm,um);var mm=Vu(om,im,nm,sm,Xu,Yu,Zu,rm);if(mm){pm&&($u.fromBufferAttribute(pm,dm),em.fromBufferAttribute(pm,cm),tm.fromBufferAttribute(pm,um),mm.uv=Le.getUV(rm,Xu,Yu,Zu,$u,em,tm,new S));var gm=new Z(dm,cm,um);Le.getNormal(Xu,Yu,Zu,gm.normal),mm.face=gm}return mm}var Wu=new E,ju=new we,qu=new F,Xu=new A,Yu=new A,Zu=new A,Ju=new A,Qu=new A,Ku=new A,$u=new S,em=new S,tm=new S,rm=new A,am=new A;return function(im,nm){var sm=this.geometry,lm=this.material,pm=this.matrixWorld;if(void 0!==lm&&(null===sm.boundingSphere&&sm.computeBoundingSphere(),qu.copy(sm.boundingSphere),qu.applyMatrix4(pm),!1!==im.ray.intersectsSphere(qu))&&(Wu.getInverse(pm),ju.copy(im.ray).applyMatrix4(Wu),null===sm.boundingBox||!1!==ju.intersectsBox(sm.boundingBox))){var dm;if(sm.isBufferGeometry){var gm=sm.index,fm=sm.attributes.position,hm=sm.attributes.uv,ym=sm.groups,xm=sm.drawRange,cm,um,mm,vm,_m,bm,Mm,Sm,Tm,Em,wm;if(null!==gm){if(Array.isArray(lm))for(vm=0,bm=ym.length;vm<bm;vm++)for(Sm=ym[vm],Tm=lm[Sm.materialIndex],Em=Math.max(Sm.start,xm.start),wm=Math.min(Sm.start+Sm.count,xm.start+xm.count),(_m=Em,Mm=wm);_m<Mm;_m+=3)cm=gm.getX(_m),um=gm.getX(_m+1),mm=gm.getX(_m+2),dm=ku(this,Tm,im,ju,fm,hm,cm,um,mm),dm&&(dm.faceIndex=Math.floor(_m/3),nm.push(dm));else for(Em=Math.max(0,xm.start),wm=Math.min(gm.count,xm.start+xm.count),(vm=Em,bm=wm);vm<bm;vm+=3)cm=gm.getX(vm),um=gm.getX(vm+1),mm=gm.getX(vm+2),dm=ku(this,lm,im,ju,fm,hm,cm,um,mm),dm&&(dm.faceIndex=Math.floor(vm/3),nm.push(dm));}else if(void 0!==fm)if(Array.isArray(lm))for(vm=0,bm=ym.length;vm<bm;vm++)for(Sm=ym[vm],Tm=lm[Sm.materialIndex],Em=Math.max(Sm.start,xm.start),wm=Math.min(Sm.start+Sm.count,xm.start+xm.count),(_m=Em,Mm=wm);_m<Mm;_m+=3)cm=_m,um=_m+1,mm=_m+2,dm=ku(this,Tm,im,ju,fm,hm,cm,um,mm),dm&&(dm.faceIndex=Math.floor(_m/3),nm.push(dm));else for(Em=Math.max(0,xm.start),wm=Math.min(fm.count,xm.start+xm.count),(vm=Em,bm=wm);vm<bm;vm+=3)cm=vm,um=vm+1,mm=vm+2,dm=ku(this,lm,im,ju,fm,hm,cm,um,mm),dm&&(dm.faceIndex=Math.floor(vm/3),nm.push(dm))}else if(sm.isGeometry){var Cm=Array.isArray(lm),Rm=sm.vertices,Im=sm.faces,zm=sm.faceVertexUvs[0],Lm,Am,Pm,Dm;0<zm.length&&(Dm=zm);for(var Nm=0,Bm=Im.length;Nm<Bm;Nm++){var Um=Im[Nm],Gm=Cm?lm[Um.materialIndex]:lm;if(void 0!==Gm){if(Lm=Rm[Um.a],Am=Rm[Um.b],Pm=Rm[Um.c],!0===Gm.morphTargets){var Om=sm.morphTargets,Fm=this.morphTargetInfluences;Xu.set(0,0,0),Yu.set(0,0,0),Zu.set(0,0,0);for(var Hm=0,Vm=Om.length,km;Hm<Vm;Hm++)if(km=Fm[Hm],0!==km){var Wm=Om[Hm].vertices;Xu.addScaledVector(Ju.subVectors(Wm[Um.a],Lm),km),Yu.addScaledVector(Qu.subVectors(Wm[Um.b],Am),km),Zu.addScaledVector(Ku.subVectors(Wm[Um.c],Pm),km)}Xu.add(Lm),Yu.add(Am),Zu.add(Pm),Lm=Xu,Am=Yu,Pm=Zu}if(dm=Vu(this,Gm,im,ju,Lm,Am,Pm,rm),dm){if(Dm&&Dm[Nm]){var jm=Dm[Nm];$u.copy(jm[0]),em.copy(jm[1]),tm.copy(jm[2]),dm.uv=Le.getUV(rm,Lm,Am,Pm,$u,em,tm,new S)}dm.face=Um,dm.faceIndex=Nm,nm.push(dm)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),He.prototype=Object.create(R.prototype),He.prototype.constructor=He,He.prototype.isCubeTexture=!0,Object.defineProperty(He.prototype,'images',{get:function(){return this.image},set:function(Vu){this.image=Vu}}),Ve.prototype=Object.create(R.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isDataTexture3D=!0;var qc=new R,Xc=new Ve,Yc=new He,Zc=[],Jc=[],Qc=new Float32Array(16),Kc=new Float32Array(9),$c=new Float32Array(4);Mt.prototype.updateCache=function(Vu){var ku=this.cache;Vu instanceof Float32Array&&ku.length!==Vu.length&&(this.cache=new Float32Array(Vu.length)),qe(ku,Vu)},St.prototype.setValue=function(Vu,ku,Wu){for(var ju=this.seq,qu=0,Xu=ju.length,Yu;qu!==Xu;++qu)Yu=ju[qu],Yu.setValue(Vu,ku[Yu.id],Wu)};var eu=/([\w\d_]+)(\])?(\[|\.)?/g;wt.prototype.setValue=function(Vu,ku,Wu){var ju=this.map[ku];ju!==void 0&&ju.setValue(Vu,Wu,this.renderer)},wt.prototype.setOptional=function(Vu,ku,Wu){var ju=ku[Wu];ju!==void 0&&this.setValue(Vu,Wu,ju)},wt.upload=function(Vu,ku,Wu,ju){for(var qu=0,Xu=ku.length;qu!==Xu;++qu){var Yu=ku[qu],Zu=Wu[Yu.id];!1!==Zu.needsUpdate&&Yu.setValue(Vu,Zu.value,ju)}},wt.seqWithValue=function(Vu,ku){for(var Wu=[],ju=0,qu=Vu.length,Xu;ju!==qu;++ju)Xu=Vu[ju],Xu.id in ku&&Wu.push(Xu);return Wu};var tu=0,ru=0;Kt.prototype=Object.create(Te.prototype),Kt.prototype.constructor=Kt,Kt.prototype.isMeshDepthMaterial=!0,Kt.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.depthPacking=Vu.depthPacking,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.map=Vu.map,this.alphaMap=Vu.alphaMap,this.displacementMap=Vu.displacementMap,this.displacementScale=Vu.displacementScale,this.displacementBias=Vu.displacementBias,this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this},$t.prototype=Object.create(Te.prototype),$t.prototype.constructor=$t,$t.prototype.isMeshDistanceMaterial=!0,$t.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.referencePosition.copy(Vu.referencePosition),this.nearDistance=Vu.nearDistance,this.farDistance=Vu.farDistance,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.map=Vu.map,this.alphaMap=Vu.alphaMap,this.displacementMap=Vu.displacementMap,this.displacementScale=Vu.displacementScale,this.displacementBias=Vu.displacementBias,this},or.prototype=Object.assign(Object.create(K.prototype),{constructor:or,isGroup:!0}),ir.prototype=Object.assign(Object.create(K.prototype),{constructor:ir,isCamera:!0,copy:function(Vu,ku){return K.prototype.copy.call(this,Vu,ku),this.matrixWorldInverse.copy(Vu.matrixWorldInverse),this.projectionMatrix.copy(Vu.projectionMatrix),this.projectionMatrixInverse.copy(Vu.projectionMatrixInverse),this},getWorldDirection:function(Vu){Vu===void 0&&(console.warn('THREE.Camera: .getWorldDirection() target is now required'),Vu=new A),this.updateMatrixWorld(!0);var ku=this.matrixWorld.elements;return Vu.set(-ku[8],-ku[9],-ku[10]).normalize()},updateMatrixWorld:function(Vu){K.prototype.updateMatrixWorld.call(this,Vu),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),nr.prototype=Object.assign(Object.create(ir.prototype),{constructor:nr,isPerspectiveCamera:!0,copy:function(Vu,ku){return ir.prototype.copy.call(this,Vu,ku),this.fov=Vu.fov,this.zoom=Vu.zoom,this.near=Vu.near,this.far=Vu.far,this.focus=Vu.focus,this.aspect=Vu.aspect,this.view=null===Vu.view?null:Object.assign({},Vu.view),this.filmGauge=Vu.filmGauge,this.filmOffset=Vu.filmOffset,this},setFocalLength:function(Vu){var ku=0.5*this.getFilmHeight()/Vu;this.fov=2*hp.RAD2DEG*Math.atan(ku),this.updateProjectionMatrix()},getFocalLength:function(){var Vu=Math.tan(0.5*hp.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/Vu},getEffectiveFOV:function(){return 2*hp.RAD2DEG*Math.atan(Math.tan(0.5*hp.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(Vu,ku,Wu,ju,qu,Xu){this.aspect=Vu/ku,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=Vu,this.view.fullHeight=ku,this.view.offsetX=Wu,this.view.offsetY=ju,this.view.width=qu,this.view.height=Xu,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var Vu=this.near,ku=Vu*Math.tan(0.5*hp.DEG2RAD*this.fov)/this.zoom,Wu=2*ku,ju=this.aspect*Wu,qu=-0.5*ju,Xu=this.view;if(null!==this.view&&this.view.enabled){var Yu=Xu.fullWidth,Zu=Xu.fullHeight;qu+=Xu.offsetX*ju/Yu,ku-=Xu.offsetY*Wu/Zu,ju*=Xu.width/Yu,Wu*=Xu.height/Zu}var Ju=this.filmOffset;0!==Ju&&(qu+=Vu*Ju/this.getFilmWidth()),this.projectionMatrix.makePerspective(qu,qu+ju,ku,ku-Wu,Vu,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(Vu){var ku=K.prototype.toJSON.call(this,Vu);return ku.object.fov=this.fov,ku.object.zoom=this.zoom,ku.object.near=this.near,ku.object.far=this.far,ku.object.focus=this.focus,ku.object.aspect=this.aspect,null!==this.view&&(ku.object.view=Object.assign({},this.view)),ku.object.filmGauge=this.filmGauge,ku.object.filmOffset=this.filmOffset,ku}}),sr.prototype=Object.assign(Object.create(nr.prototype),{constructor:sr,isArrayCamera:!0});var au=new A,ou=new A;ur.prototype.isFogExp2=!0,ur.prototype.clone=function(){return new ur(this.color,this.density)},ur.prototype.toJSON=function(){return{type:'FogExp2',color:this.color.getHex(),density:this.density}},mr.prototype.isFog=!0,mr.prototype.clone=function(){return new mr(this.color,this.near,this.far)},mr.prototype.toJSON=function(){return{type:'Fog',color:this.color.getHex(),near:this.near,far:this.far}},gr.prototype=Object.assign(Object.create(K.prototype),{constructor:gr,copy:function(Vu,ku){return K.prototype.copy.call(this,Vu,ku),null!==Vu.background&&(this.background=Vu.background.clone()),null!==Vu.fog&&(this.fog=Vu.fog.clone()),null!==Vu.overrideMaterial&&(this.overrideMaterial=Vu.overrideMaterial.clone()),this.autoUpdate=Vu.autoUpdate,this.matrixAutoUpdate=Vu.matrixAutoUpdate,this},toJSON:function(Vu){var ku=K.prototype.toJSON.call(this,Vu);return null!==this.background&&(ku.object.background=this.background.toJSON(Vu)),null!==this.fog&&(ku.object.fog=this.fog.toJSON()),ku}}),Object.defineProperty(fr.prototype,'needsUpdate',{set:function(Vu){!0===Vu&&this.version++}}),Object.assign(fr.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(Vu){if(Array.isArray(Vu))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');return this.count=void 0===Vu?0:Vu.length/this.stride,this.array=Vu,this},setDynamic:function(Vu){return this.dynamic=Vu,this},copy:function(Vu){return this.array=new Vu.array.constructor(Vu.array),this.count=Vu.count,this.stride=Vu.stride,this.dynamic=Vu.dynamic,this},copyAt:function(Vu,ku,Wu){Vu*=this.stride,Wu*=ku.stride;for(var ju=0,qu=this.stride;ju<qu;ju++)this.array[Vu+ju]=ku.array[Wu+ju];return this},set:function(Vu,ku){return void 0===ku&&(ku=0),this.array.set(Vu,ku),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(Vu){return this.onUploadCallback=Vu,this}}),Object.defineProperties(hr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(hr.prototype,{isInterleavedBufferAttribute:!0,setX:function(Vu,ku){return this.data.array[Vu*this.data.stride+this.offset]=ku,this},setY:function(Vu,ku){return this.data.array[Vu*this.data.stride+this.offset+1]=ku,this},setZ:function(Vu,ku){return this.data.array[Vu*this.data.stride+this.offset+2]=ku,this},setW:function(Vu,ku){return this.data.array[Vu*this.data.stride+this.offset+3]=ku,this},getX:function(Vu){return this.data.array[Vu*this.data.stride+this.offset]},getY:function(Vu){return this.data.array[Vu*this.data.stride+this.offset+1]},getZ:function(Vu){return this.data.array[Vu*this.data.stride+this.offset+2]},getW:function(Vu){return this.data.array[Vu*this.data.stride+this.offset+3]},setXY:function(Vu,ku,Wu){return Vu=Vu*this.data.stride+this.offset,this.data.array[Vu+0]=ku,this.data.array[Vu+1]=Wu,this},setXYZ:function(Vu,ku,Wu,ju){return Vu=Vu*this.data.stride+this.offset,this.data.array[Vu+0]=ku,this.data.array[Vu+1]=Wu,this.data.array[Vu+2]=ju,this},setXYZW:function(Vu,ku,Wu,ju,qu){return Vu=Vu*this.data.stride+this.offset,this.data.array[Vu+0]=ku,this.data.array[Vu+1]=Wu,this.data.array[Vu+2]=ju,this.data.array[Vu+3]=qu,this}}),yr.prototype=Object.create(Te.prototype),yr.prototype.constructor=yr,yr.prototype.isSpriteMaterial=!0,yr.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.map=Vu.map,this.rotation=Vu.rotation,this.sizeAttenuation=Vu.sizeAttenuation,this};var iu;xr.prototype=Object.assign(Object.create(K.prototype),{constructor:xr,isSprite:!0,raycast:function(){function Vu(tm,rm,am,om,im,nm){qu.subVectors(tm,am).addScalar(0.5).multiply(om),im===void 0?Xu.copy(qu):(Xu.x=nm*qu.x-im*qu.y,Xu.y=im*qu.x+nm*qu.y),tm.copy(rm),tm.x+=Xu.x,tm.y+=Xu.y,tm.applyMatrix4(Yu)}var ku=new A,Wu=new A,ju=new A,qu=new S,Xu=new S,Yu=new E,Zu=new A,Ju=new A,Qu=new A,Ku=new S,$u=new S,em=new S;return function(rm,am){Wu.setFromMatrixScale(this.matrixWorld),Yu.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),ju.setFromMatrixPosition(this.modelViewMatrix);var om=this.material.rotation,im,nm;0!==om&&(nm=Math.cos(om),im=Math.sin(om));var sm=this.center;Vu(Zu.set(-0.5,-0.5,0),ju,sm,Wu,im,nm),Vu(Ju.set(0.5,-0.5,0),ju,sm,Wu,im,nm),Vu(Qu.set(0.5,0.5,0),ju,sm,Wu,im,nm),Ku.set(0,0),$u.set(1,0),em.set(1,1);var lm=rm.ray.intersectTriangle(Zu,Ju,Qu,!1,ku);if(!(null===lm&&(Vu(Ju.set(-0.5,0.5,0),ju,sm,Wu,im,nm),$u.set(0,1),lm=rm.ray.intersectTriangle(Zu,Qu,Ju,!1,ku),null===lm))){var pm=rm.ray.origin.distanceTo(ku);pm<rm.near||pm>rm.far||am.push({distance:pm,point:ku.clone(),uv:Le.getUV(ku,Zu,Ju,Qu,Ku,$u,em,new S),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(Vu){return K.prototype.copy.call(this,Vu),void 0!==Vu.center&&this.center.copy(Vu.center),this}}),_r.prototype=Object.assign(Object.create(K.prototype),{constructor:_r,copy:function(Vu){K.prototype.copy.call(this,Vu,!1);for(var ku=Vu.levels,Wu=0,ju=ku.length,qu;Wu<ju;Wu++)qu=ku[Wu],this.addLevel(qu.object.clone(),qu.distance);return this},addLevel:function(Vu,ku){ku===void 0&&(ku=0),ku=Math.abs(ku);for(var Wu=this.levels,ju=0;ju<Wu.length&&!(ku<Wu[ju].distance);ju++);Wu.splice(ju,0,{distance:ku,object:Vu}),this.add(Vu)},getObjectForDistance:function(Vu){for(var ku=this.levels,Wu=1,ju=ku.length;Wu<ju&&!(Vu<ku[Wu].distance);Wu++);return ku[Wu-1].object},raycast:function(){var Vu=new A;return function(Wu,ju){Vu.setFromMatrixPosition(this.matrixWorld);var qu=Wu.ray.origin.distanceTo(Vu);this.getObjectForDistance(qu).raycast(Wu,ju)}}(),update:function(){var Vu=new A,ku=new A;return function(ju){var qu=this.levels;if(1<qu.length){Vu.setFromMatrixPosition(ju.matrixWorld),ku.setFromMatrixPosition(this.matrixWorld);var Xu=Vu.distanceTo(ku);qu[0].object.visible=!0;for(var Yu=1,Zu=qu.length;Yu<Zu&&Xu>=qu[Yu].distance;Yu++)qu[Yu-1].object.visible=!1,qu[Yu].object.visible=!0;for(;Yu<Zu;Yu++)qu[Yu].object.visible=!1}}}(),toJSON:function(Vu){var ku=K.prototype.toJSON.call(this,Vu);ku.object.levels=[];for(var Wu=this.levels,ju=0,qu=Wu.length,Xu;ju<qu;ju++)Xu=Wu[ju],ku.object.levels.push({object:Xu.object.uuid,distance:Xu.distance});return ku}}),Object.assign(br.prototype,{calculateInverses:function(){this.boneInverses=[];for(var Vu=0,ku=this.bones.length,Wu;Vu<ku;Vu++)Wu=new E,this.bones[Vu]&&Wu.getInverse(this.bones[Vu].matrixWorld),this.boneInverses.push(Wu)},pose:function(){var Vu,ku,Wu;for(ku=0,Wu=this.bones.length;ku<Wu;ku++)Vu=this.bones[ku],Vu&&Vu.matrixWorld.getInverse(this.boneInverses[ku]);for(ku=0,Wu=this.bones.length;ku<Wu;ku++)Vu=this.bones[ku],Vu&&(Vu.parent&&Vu.parent.isBone?(Vu.matrix.getInverse(Vu.parent.matrixWorld),Vu.matrix.multiply(Vu.matrixWorld)):Vu.matrix.copy(Vu.matrixWorld),Vu.matrix.decompose(Vu.position,Vu.quaternion,Vu.scale))},update:function(){var Vu=new E,ku=new E;return function(){for(var ju=this.bones,qu=this.boneInverses,Xu=this.boneMatrices,Yu=this.boneTexture,Zu=0,Ju=ju.length,Qu;Zu<Ju;Zu++)Qu=ju[Zu]?ju[Zu].matrixWorld:ku,Vu.multiplyMatrices(Qu,qu[Zu]),Vu.toArray(Xu,16*Zu);Yu!==void 0&&(Yu.needsUpdate=!0)}}(),clone:function(){return new br(this.bones,this.boneInverses)},getBoneByName:function(Vu){for(var ku=0,Wu=this.bones.length,ju;ku<Wu;ku++)if(ju=this.bones[ku],ju.name===Vu)return ju}}),Mr.prototype=Object.assign(Object.create(K.prototype),{constructor:Mr,isBone:!0}),Sr.prototype=Object.assign(Object.create(Pe.prototype),{constructor:Sr,isSkinnedMesh:!0,initBones:function(){var Vu=[],ku,Wu,ju,qu;if(this.geometry&&void 0!==this.geometry.bones){for(ju=0,qu=this.geometry.bones.length;ju<qu;ju++)Wu=this.geometry.bones[ju],ku=new Mr,Vu.push(ku),ku.name=Wu.name,ku.position.fromArray(Wu.pos),ku.quaternion.fromArray(Wu.rotq),void 0!==Wu.scl&&ku.scale.fromArray(Wu.scl);for(ju=0,qu=this.geometry.bones.length;ju<qu;ju++)Wu=this.geometry.bones[ju],-1!==Wu.parent&&null!==Wu.parent&&void 0!==Vu[Wu.parent]?Vu[Wu.parent].add(Vu[ju]):this.add(Vu[ju])}return this.updateMatrixWorld(!0),Vu},bind:function(Vu,ku){this.skeleton=Vu,ku===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),ku=this.matrixWorld),this.bindMatrix.copy(ku),this.bindMatrixInverse.getInverse(ku)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var Vu,ku;if(this.geometry&&this.geometry.isGeometry)for(ku=0;ku<this.geometry.skinWeights.length;ku++){var Wu=this.geometry.skinWeights[ku];Vu=1/Wu.manhattanLength(),Vu===Infinity?Wu.set(1,0,0,0):Wu.multiplyScalar(Vu)}else if(this.geometry&&this.geometry.isBufferGeometry){var ju=new I,qu=this.geometry.attributes.skinWeight;for(ku=0;ku<qu.count;ku++)ju.x=qu.getX(ku),ju.y=qu.getY(ku),ju.z=qu.getZ(ku),ju.w=qu.getW(ku),Vu=1/ju.manhattanLength(),Vu===Infinity?ju.set(1,0,0,0):ju.multiplyScalar(Vu),qu.setXYZW(ku,ju.x,ju.y,ju.z,ju.w)}},updateMatrixWorld:function(Vu){Pe.prototype.updateMatrixWorld.call(this,Vu),'attached'===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):'detached'===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn('THREE.SkinnedMesh: Unrecognized bindMode: '+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Tr.prototype=Object.create(Te.prototype),Tr.prototype.constructor=Tr,Tr.prototype.isLineBasicMaterial=!0,Tr.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.linewidth=Vu.linewidth,this.linecap=Vu.linecap,this.linejoin=Vu.linejoin,this},Er.prototype=Object.assign(Object.create(K.prototype),{constructor:Er,isLine:!0,computeLineDistances:function(){var Vu=new A,ku=new A;return function(){var ju=this.geometry;if(ju.isBufferGeometry){if(null===ju.index){for(var qu=ju.attributes.position,Xu=[0],Yu=1,Zu=qu.count;Yu<Zu;Yu++)Vu.fromBufferAttribute(qu,Yu-1),ku.fromBufferAttribute(qu,Yu),Xu[Yu]=Xu[Yu-1],Xu[Yu]+=Vu.distanceTo(ku);ju.addAttribute('lineDistance',new ge(Xu,1))}else console.warn('THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.');}else if(ju.isGeometry){var Ju=ju.vertices,Xu=ju.lineDistances;Xu[0]=0;for(var Yu=1,Zu=Ju.length;Yu<Zu;Yu++)Xu[Yu]=Xu[Yu-1],Xu[Yu]+=Ju[Yu-1].distanceTo(Ju[Yu])}return this}}(),raycast:function(){var Vu=new E,ku=new we,Wu=new F;return function(qu,Xu){var Yu=qu.linePrecision,Zu=this.geometry,Ju=this.matrixWorld;if(null===Zu.boundingSphere&&Zu.computeBoundingSphere(),Wu.copy(Zu.boundingSphere),Wu.applyMatrix4(Ju),Wu.radius+=Yu,!1!==qu.ray.intersectsSphere(Wu)){Vu.getInverse(Ju),ku.copy(qu.ray).applyMatrix4(Vu);var Qu=Yu/((this.scale.x+this.scale.y+this.scale.z)/3),Ku=Qu*Qu,$u=new A,em=new A,tm=new A,rm=new A,am=this&&this.isLineSegments?2:1;if(Zu.isBufferGeometry){var om=Zu.index,im=Zu.attributes,nm=im.position.array;if(null!==om)for(var sm=om.array,lm=0,pm=sm.length-1;lm<pm;lm+=am){var dm=sm[lm],cm=sm[lm+1];$u.fromArray(nm,3*dm),em.fromArray(nm,3*cm);var um=ku.distanceSqToSegment($u,em,rm,tm);if(!(um>Ku)){rm.applyMatrix4(this.matrixWorld);var mm=qu.ray.origin.distanceTo(rm);mm<qu.near||mm>qu.far||Xu.push({distance:mm,point:tm.clone().applyMatrix4(this.matrixWorld),index:lm,face:null,faceIndex:null,object:this})}}else for(var lm=0,pm=nm.length/3-1;lm<pm;lm+=am){$u.fromArray(nm,3*lm),em.fromArray(nm,3*lm+3);var um=ku.distanceSqToSegment($u,em,rm,tm);if(!(um>Ku)){rm.applyMatrix4(this.matrixWorld);var mm=qu.ray.origin.distanceTo(rm);mm<qu.near||mm>qu.far||Xu.push({distance:mm,point:tm.clone().applyMatrix4(this.matrixWorld),index:lm,face:null,faceIndex:null,object:this})}}}else if(Zu.isGeometry)for(var gm=Zu.vertices,fm=gm.length,lm=0,um;lm<fm-1;lm+=am)if(um=ku.distanceSqToSegment(gm[lm],gm[lm+1],rm,tm),!(um>Ku)){rm.applyMatrix4(this.matrixWorld);var mm=qu.ray.origin.distanceTo(rm);mm<qu.near||mm>qu.far||Xu.push({distance:mm,point:tm.clone().applyMatrix4(this.matrixWorld),index:lm,face:null,faceIndex:null,object:this})}}}}(),copy:function(Vu){return K.prototype.copy.call(this,Vu),this.geometry.copy(Vu.geometry),this.material.copy(Vu.material),this},clone:function(){return new this.constructor().copy(this)}}),wr.prototype=Object.assign(Object.create(Er.prototype),{constructor:wr,isLineSegments:!0,computeLineDistances:function(){var Vu=new A,ku=new A;return function(){var ju=this.geometry;if(ju.isBufferGeometry){if(null===ju.index){for(var qu=ju.attributes.position,Xu=[],Yu=0,Zu=qu.count;Yu<Zu;Yu+=2)Vu.fromBufferAttribute(qu,Yu),ku.fromBufferAttribute(qu,Yu+1),Xu[Yu]=0==Yu?0:Xu[Yu-1],Xu[Yu+1]=Xu[Yu]+Vu.distanceTo(ku);ju.addAttribute('lineDistance',new ge(Xu,1))}else console.warn('THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.');}else if(ju.isGeometry)for(var Ju=ju.vertices,Xu=ju.lineDistances,Yu=0,Zu=Ju.length;Yu<Zu;Yu+=2)Vu.copy(Ju[Yu]),ku.copy(Ju[Yu+1]),Xu[Yu]=0==Yu?0:Xu[Yu-1],Xu[Yu+1]=Xu[Yu]+Vu.distanceTo(ku);return this}}()}),Lr.prototype=Object.assign(Object.create(Er.prototype),{constructor:Lr,isLineLoop:!0}),Ar.prototype=Object.create(Te.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isPointsMaterial=!0,Ar.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.map=Vu.map,this.size=Vu.size,this.sizeAttenuation=Vu.sizeAttenuation,this.morphTargets=Vu.morphTargets,this},Pr.prototype=Object.assign(Object.create(K.prototype),{constructor:Pr,isPoints:!0,raycast:function(){var Vu=new E,ku=new we,Wu=new F;return function(qu,Xu){function Yu(um,mm){var gm=ku.distanceSqToPoint(um);if(gm<em){ku.closestPointToPoint(um,rm),rm.applyMatrix4(Qu);var fm=qu.ray.origin.distanceTo(rm);if(fm<qu.near||fm>qu.far)return;Xu.push({distance:fm,distanceToRay:Math.sqrt(gm),point:rm.clone(),index:mm,face:null,object:Zu})}}var Zu=this,Ju=this.geometry,Qu=this.matrixWorld,Ku=qu.params.Points.threshold;if(null===Ju.boundingSphere&&Ju.computeBoundingSphere(),Wu.copy(Ju.boundingSphere),Wu.applyMatrix4(Qu),Wu.radius+=Ku,!1!==qu.ray.intersectsSphere(Wu)){Vu.getInverse(Qu),ku.copy(qu.ray).applyMatrix4(Vu);var $u=Ku/((this.scale.x+this.scale.y+this.scale.z)/3),em=$u*$u,tm=new A,rm=new A;if(Ju.isBufferGeometry){var am=Ju.index,om=Ju.attributes,im=om.position.array;if(null!==am)for(var nm=am.array,sm=0,lm=nm.length,pm;sm<lm;sm++)pm=nm[sm],tm.fromArray(im,3*pm),Yu(tm,pm);else for(var sm=0,dm=im.length/3;sm<dm;sm++)tm.fromArray(im,3*sm),Yu(tm,sm)}else for(var cm=Ju.vertices,sm=0,dm=cm.length;sm<dm;sm++)Yu(cm[sm],sm)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Cr.prototype=Object.assign(Object.create(R.prototype),{constructor:Cr,isVideoTexture:!0,update:function(){var Vu=this.image;Vu.readyState>=Vu.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Rr.prototype=Object.create(R.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isCompressedTexture=!0,Ir.prototype=Object.create(R.prototype),Ir.prototype.constructor=Ir,Ir.prototype.isCanvasTexture=!0,Dr.prototype=Object.create(R.prototype),Dr.prototype.constructor=Dr,Dr.prototype.isDepthTexture=!0,zr.prototype=Object.create(xe.prototype),zr.prototype.constructor=zr,Nr.prototype=Object.create(ee.prototype),Nr.prototype.constructor=Nr,Br.prototype=Object.create(xe.prototype),Br.prototype.constructor=Br,Ur.prototype=Object.create(ee.prototype),Ur.prototype.constructor=Ur,Gr.prototype=Object.create(xe.prototype),Gr.prototype.constructor=Gr,Or.prototype=Object.create(ee.prototype),Or.prototype.constructor=Or,Fr.prototype=Object.create(Gr.prototype),Fr.prototype.constructor=Fr,Hr.prototype=Object.create(ee.prototype),Hr.prototype.constructor=Hr,Vr.prototype=Object.create(Gr.prototype),Vr.prototype.constructor=Vr,kr.prototype=Object.create(ee.prototype),kr.prototype.constructor=kr,Wr.prototype=Object.create(Gr.prototype),Wr.prototype.constructor=Wr,jr.prototype=Object.create(ee.prototype),jr.prototype.constructor=jr,qr.prototype=Object.create(Gr.prototype),qr.prototype.constructor=qr,Xr.prototype=Object.create(ee.prototype),Xr.prototype.constructor=Xr,Yr.prototype=Object.create(xe.prototype),Yr.prototype.constructor=Yr,Zr.prototype=Object.create(ee.prototype),Zr.prototype.constructor=Zr,Jr.prototype=Object.create(xe.prototype),Jr.prototype.constructor=Jr,Qr.prototype=Object.create(ee.prototype),Qr.prototype.constructor=Qr,Kr.prototype=Object.create(xe.prototype),Kr.prototype.constructor=Kr;var nu={triangulate:function(Vu,ku,Wu){Wu=Wu||2;var ju=ku&&ku.length,qu=ju?ku[0]*Wu:Vu.length,Xu=$r(Vu,0,qu,Wu,!0),Yu=[];if(!Xu)return Yu;var Zu,Ju,Qu,Ku,$u,em,tm;if(ju&&(Xu=na(Vu,ku,Xu,Wu)),Vu.length>80*Wu){Zu=Qu=Vu[0],Ju=Ku=Vu[1];for(var rm=Wu;rm<qu;rm+=Wu)$u=Vu[rm],em=Vu[rm+1],$u<Zu&&(Zu=$u),em<Ju&&(Ju=em),$u>Qu&&(Qu=$u),em>Ku&&(Ku=em);tm=Math.max(Qu-Zu,Ku-Ju),tm=0===tm?0:1/tm}return ta(Xu,Yu,Wu,Zu,Ju,tm),Yu}},lu={area:function(Vu){for(var ku=Vu.length,Wu=0,ju=ku-1,qu=0;qu<ku;ju=qu++)Wu+=Vu[ju].x*Vu[qu].y-Vu[qu].x*Vu[ju].y;return 0.5*Wu},isClockWise:function(Vu){return 0>lu.area(Vu)},triangulateShape:function(Vu,ku){var Wu=[],ju=[],qu=[];Aa(Vu),Pa(Wu,Vu);var Xu=Vu.length;ku.forEach(Aa);for(var Yu=0;Yu<ku.length;Yu++)ju.push(Xu),Xu+=ku[Yu].length,Pa(Wu,ku[Yu]);for(var Zu=nu.triangulate(Wu,ju),Yu=0;Yu<Zu.length;Yu+=3)qu.push(Zu.slice(Yu,Yu+3));return qu}};Ca.prototype=Object.create(ee.prototype),Ca.prototype.constructor=Ca,Ca.prototype.toJSON=function(){var Vu=ee.prototype.toJSON.call(this),ku=this.parameters.shapes,Wu=this.parameters.options;return Ia(ku,Wu,Vu)},Ra.prototype=Object.create(xe.prototype),Ra.prototype.constructor=Ra,Ra.prototype.toJSON=function(){var Vu=xe.prototype.toJSON.call(this),ku=this.parameters.shapes,Wu=this.parameters.options;return Ia(ku,Wu,Vu)};var du={generateTopUV:function(Vu,ku,Wu,ju,qu){var Xu=ku[3*Wu],Yu=ku[3*Wu+1],Zu=ku[3*ju],Ju=ku[3*ju+1],Qu=ku[3*qu],Ku=ku[3*qu+1];return[new S(Xu,Yu),new S(Zu,Ju),new S(Qu,Ku)]},generateSideWallUV:function(Vu,ku,Wu,ju,qu,Xu){var Yu=ku[3*Wu],Zu=ku[3*Wu+1],Ju=ku[3*Wu+2],Qu=ku[3*ju],Ku=ku[3*ju+1],$u=ku[3*ju+2],em=ku[3*qu],tm=ku[3*qu+1],rm=ku[3*qu+2],am=ku[3*Xu],om=ku[3*Xu+1],im=ku[3*Xu+2];return 0.01>Math.abs(Zu-Ku)?[new S(Yu,1-Ju),new S(Qu,1-$u),new S(em,1-rm),new S(am,1-im)]:[new S(Zu,1-Ju),new S(Ku,1-$u),new S(tm,1-rm),new S(om,1-im)]}};Da.prototype=Object.create(ee.prototype),Da.prototype.constructor=Da,za.prototype=Object.create(Ra.prototype),za.prototype.constructor=za,Na.prototype=Object.create(ee.prototype),Na.prototype.constructor=Na,Ba.prototype=Object.create(xe.prototype),Ba.prototype.constructor=Ba,Ua.prototype=Object.create(ee.prototype),Ua.prototype.constructor=Ua,Ga.prototype=Object.create(xe.prototype),Ga.prototype.constructor=Ga,Oa.prototype=Object.create(ee.prototype),Oa.prototype.constructor=Oa,Fa.prototype=Object.create(xe.prototype),Fa.prototype.constructor=Fa,Ha.prototype=Object.create(ee.prototype),Ha.prototype.constructor=Ha,Ha.prototype.toJSON=function(){var Vu=ee.prototype.toJSON.call(this),ku=this.parameters.shapes;return ka(ku,Vu)},Va.prototype=Object.create(xe.prototype),Va.prototype.constructor=Va,Va.prototype.toJSON=function(){var Vu=xe.prototype.toJSON.call(this),ku=this.parameters.shapes;return ka(ku,Vu)},Wa.prototype=Object.create(xe.prototype),Wa.prototype.constructor=Wa,ja.prototype=Object.create(ee.prototype),ja.prototype.constructor=ja,Xa.prototype=Object.create(xe.prototype),Xa.prototype.constructor=Xa,Ya.prototype=Object.create(ja.prototype),Ya.prototype.constructor=Ya,Za.prototype=Object.create(Xa.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(ee.prototype),Ja.prototype.constructor=Ja,Qa.prototype=Object.create(xe.prototype),Qa.prototype.constructor=Qa;var uu=Object.freeze({WireframeGeometry:zr,ParametricGeometry:Nr,ParametricBufferGeometry:Br,TetrahedronGeometry:Or,TetrahedronBufferGeometry:Fr,OctahedronGeometry:Hr,OctahedronBufferGeometry:Vr,IcosahedronGeometry:kr,IcosahedronBufferGeometry:Wr,DodecahedronGeometry:jr,DodecahedronBufferGeometry:qr,PolyhedronGeometry:Ur,PolyhedronBufferGeometry:Gr,TubeGeometry:Xr,TubeBufferGeometry:Yr,TorusKnotGeometry:Zr,TorusKnotBufferGeometry:Jr,TorusGeometry:Qr,TorusBufferGeometry:Kr,TextGeometry:Da,TextBufferGeometry:za,SphereGeometry:Na,SphereBufferGeometry:Ba,RingGeometry:Ua,RingBufferGeometry:Ga,PlaneGeometry:Me,PlaneBufferGeometry:Se,LatheGeometry:Oa,LatheBufferGeometry:Fa,ShapeGeometry:Ha,ShapeBufferGeometry:Va,ExtrudeGeometry:Ca,ExtrudeBufferGeometry:Ra,EdgesGeometry:Wa,ConeGeometry:Ya,ConeBufferGeometry:Za,CylinderGeometry:ja,CylinderBufferGeometry:Xa,CircleGeometry:Ja,CircleBufferGeometry:Qa,BoxGeometry:ve,BoxBufferGeometry:_e});Ka.prototype=Object.create(Te.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isShadowMaterial=!0,Ka.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this},$a.prototype=Object.create(Ee.prototype),$a.prototype.constructor=$a,$a.prototype.isRawShaderMaterial=!0,eo.prototype=Object.create(Te.prototype),eo.prototype.constructor=eo,eo.prototype.isMeshStandardMaterial=!0,eo.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.defines={STANDARD:''},this.color.copy(Vu.color),this.roughness=Vu.roughness,this.metalness=Vu.metalness,this.map=Vu.map,this.lightMap=Vu.lightMap,this.lightMapIntensity=Vu.lightMapIntensity,this.aoMap=Vu.aoMap,this.aoMapIntensity=Vu.aoMapIntensity,this.emissive.copy(Vu.emissive),this.emissiveMap=Vu.emissiveMap,this.emissiveIntensity=Vu.emissiveIntensity,this.bumpMap=Vu.bumpMap,this.bumpScale=Vu.bumpScale,this.normalMap=Vu.normalMap,this.normalMapType=Vu.normalMapType,this.normalScale.copy(Vu.normalScale),this.displacementMap=Vu.displacementMap,this.displacementScale=Vu.displacementScale,this.displacementBias=Vu.displacementBias,this.roughnessMap=Vu.roughnessMap,this.metalnessMap=Vu.metalnessMap,this.alphaMap=Vu.alphaMap,this.envMap=Vu.envMap,this.envMapIntensity=Vu.envMapIntensity,this.refractionRatio=Vu.refractionRatio,this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this.wireframeLinecap=Vu.wireframeLinecap,this.wireframeLinejoin=Vu.wireframeLinejoin,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.morphNormals=Vu.morphNormals,this},ro.prototype=Object.create(eo.prototype),ro.prototype.constructor=ro,ro.prototype.isMeshPhysicalMaterial=!0,ro.prototype.copy=function(Vu){return eo.prototype.copy.call(this,Vu),this.defines={PHYSICAL:''},this.reflectivity=Vu.reflectivity,this.clearCoat=Vu.clearCoat,this.clearCoatRoughness=Vu.clearCoatRoughness,this},ao.prototype=Object.create(Te.prototype),ao.prototype.constructor=ao,ao.prototype.isMeshPhongMaterial=!0,ao.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.specular.copy(Vu.specular),this.shininess=Vu.shininess,this.map=Vu.map,this.lightMap=Vu.lightMap,this.lightMapIntensity=Vu.lightMapIntensity,this.aoMap=Vu.aoMap,this.aoMapIntensity=Vu.aoMapIntensity,this.emissive.copy(Vu.emissive),this.emissiveMap=Vu.emissiveMap,this.emissiveIntensity=Vu.emissiveIntensity,this.bumpMap=Vu.bumpMap,this.bumpScale=Vu.bumpScale,this.normalMap=Vu.normalMap,this.normalMapType=Vu.normalMapType,this.normalScale.copy(Vu.normalScale),this.displacementMap=Vu.displacementMap,this.displacementScale=Vu.displacementScale,this.displacementBias=Vu.displacementBias,this.specularMap=Vu.specularMap,this.alphaMap=Vu.alphaMap,this.envMap=Vu.envMap,this.combine=Vu.combine,this.reflectivity=Vu.reflectivity,this.refractionRatio=Vu.refractionRatio,this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this.wireframeLinecap=Vu.wireframeLinecap,this.wireframeLinejoin=Vu.wireframeLinejoin,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.morphNormals=Vu.morphNormals,this},oo.prototype=Object.create(ao.prototype),oo.prototype.constructor=oo,oo.prototype.isMeshToonMaterial=!0,oo.prototype.copy=function(Vu){return ao.prototype.copy.call(this,Vu),this.gradientMap=Vu.gradientMap,this},io.prototype=Object.create(Te.prototype),io.prototype.constructor=io,io.prototype.isMeshNormalMaterial=!0,io.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.bumpMap=Vu.bumpMap,this.bumpScale=Vu.bumpScale,this.normalMap=Vu.normalMap,this.normalMapType=Vu.normalMapType,this.normalScale.copy(Vu.normalScale),this.displacementMap=Vu.displacementMap,this.displacementScale=Vu.displacementScale,this.displacementBias=Vu.displacementBias,this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.morphNormals=Vu.morphNormals,this},no.prototype=Object.create(Te.prototype),no.prototype.constructor=no,no.prototype.isMeshLambertMaterial=!0,no.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.map=Vu.map,this.lightMap=Vu.lightMap,this.lightMapIntensity=Vu.lightMapIntensity,this.aoMap=Vu.aoMap,this.aoMapIntensity=Vu.aoMapIntensity,this.emissive.copy(Vu.emissive),this.emissiveMap=Vu.emissiveMap,this.emissiveIntensity=Vu.emissiveIntensity,this.specularMap=Vu.specularMap,this.alphaMap=Vu.alphaMap,this.envMap=Vu.envMap,this.combine=Vu.combine,this.reflectivity=Vu.reflectivity,this.refractionRatio=Vu.refractionRatio,this.wireframe=Vu.wireframe,this.wireframeLinewidth=Vu.wireframeLinewidth,this.wireframeLinecap=Vu.wireframeLinecap,this.wireframeLinejoin=Vu.wireframeLinejoin,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.morphNormals=Vu.morphNormals,this},so.prototype=Object.create(Te.prototype),so.prototype.constructor=so,so.prototype.isMeshMatcapMaterial=!0,so.prototype.copy=function(Vu){return Te.prototype.copy.call(this,Vu),this.defines={MATCAP:''},this.color.copy(Vu.color),this.matcap=Vu.matcap,this.map=Vu.map,this.bumpMap=Vu.bumpMap,this.bumpScale=Vu.bumpScale,this.normalMap=Vu.normalMap,this.normalMapType=Vu.normalMapType,this.normalScale.copy(Vu.normalScale),this.displacementMap=Vu.displacementMap,this.displacementScale=Vu.displacementScale,this.displacementBias=Vu.displacementBias,this.alphaMap=Vu.alphaMap,this.skinning=Vu.skinning,this.morphTargets=Vu.morphTargets,this.morphNormals=Vu.morphNormals,this},lo.prototype=Object.create(Tr.prototype),lo.prototype.constructor=lo,lo.prototype.isLineDashedMaterial=!0,lo.prototype.copy=function(Vu){return Tr.prototype.copy.call(this,Vu),this.scale=Vu.scale,this.dashSize=Vu.dashSize,this.gapSize=Vu.gapSize,this};var mu=Object.freeze({ShadowMaterial:Ka,SpriteMaterial:yr,RawShaderMaterial:$a,ShaderMaterial:Ee,PointsMaterial:Ar,MeshPhysicalMaterial:ro,MeshStandardMaterial:eo,MeshPhongMaterial:ao,MeshToonMaterial:oo,MeshNormalMaterial:io,MeshLambertMaterial:no,MeshDepthMaterial:Kt,MeshDistanceMaterial:$t,MeshBasicMaterial:Ae,MeshMatcapMaterial:so,LineDashedMaterial:lo,LineBasicMaterial:Tr,Material:Te}),gu={arraySlice:function(Vu,ku,Wu){return gu.isTypedArray(Vu)?new Vu.constructor(Vu.subarray(ku,void 0===Wu?Vu.length:Wu)):Vu.slice(ku,Wu)},convertArray:function(Vu,ku,Wu){return Vu&&(Wu||Vu.constructor!==ku)?'number'==typeof ku.BYTES_PER_ELEMENT?new ku(Vu):Array.prototype.slice.call(Vu):Vu},isTypedArray:function(Vu){return ArrayBuffer.isView(Vu)&&!(Vu instanceof DataView)},getKeyframeOrder:function(Vu){for(var Wu=Vu.length,ju=Array(Wu),qu=0;qu!==Wu;++qu)ju[qu]=qu;return ju.sort(function(Xu,Yu){return Vu[Xu]-Vu[Yu]}),ju},sortedArray:function(Vu,ku,Wu){for(var ju=Vu.length,qu=new Vu.constructor(ju),Xu=0,Yu=0,Zu;Yu!==ju;++Xu){Zu=Wu[Xu]*ku;for(var Ju=0;Ju!==ku;++Ju)qu[Yu++]=Vu[Zu+Ju]}return qu},flattenJSON:function(Vu,ku,Wu,ju){for(var qu=1,Xu=Vu[0];Xu!==void 0&&Xu[ju]===void 0;)Xu=Vu[qu++];if(void 0!==Xu){var Yu=Xu[ju];if(void 0!==Yu)if(Array.isArray(Yu))do Yu=Xu[ju],void 0!==Yu&&(ku.push(Xu.time),Wu.push.apply(Wu,Yu)),Xu=Vu[qu++];while(void 0!==Xu);else if(void 0!==Yu.toArray)do Yu=Xu[ju],void 0!==Yu&&(ku.push(Xu.time),Yu.toArray(Wu,Wu.length)),Xu=Vu[qu++];while(void 0!==Xu);else do Yu=Xu[ju],void 0!==Yu&&(ku.push(Xu.time),Wu.push(Yu)),Xu=Vu[qu++];while(void 0!==Xu)}}};Object.assign(po.prototype,{evaluate:function(Vu){var ku=this.parameterPositions,Wu=this._cachedIndex,ju=ku[Wu],qu=ku[Wu-1];validate_interval:{seek:{var Xu;linear_scan:{forward_scan:if(!(Vu<ju)){for(var Yu=Wu+2;;){if(void 0===ju){if(Vu<qu)break forward_scan;return Wu=ku.length,this._cachedIndex=Wu,this.afterEnd_(Wu-1,Vu,qu)}if(Wu===Yu)break;if(qu=ju,ju=ku[++Wu],Vu<ju)break seek}Xu=ku.length;break linear_scan}if(!(Vu>=qu)){var Zu=ku[1];Vu<Zu&&(Wu=2,qu=Zu);for(var Yu=Wu-2;;){if(void 0===qu)return this._cachedIndex=0,this.beforeStart_(0,Vu,ju);if(Wu===Yu)break;if(ju=qu,qu=ku[--Wu-1],Vu>=qu)break seek}Xu=Wu,Wu=0;break linear_scan}break validate_interval}for(;Wu<Xu;){var Ju=Wu+Xu>>>1;Vu<ku[Ju]?Xu=Ju:Wu=Ju+1}if(ju=ku[Wu],qu=ku[Wu-1],void 0===qu)return this._cachedIndex=0,this.beforeStart_(0,Vu,ju);if(void 0===ju)return Wu=ku.length,this._cachedIndex=Wu,this.afterEnd_(Wu-1,qu,Vu)}this._cachedIndex=Wu,this.intervalChanged_(Wu,qu,ju)}return this.interpolate_(Wu,qu,Vu,ju)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(Vu){for(var ku=this.resultBuffer,Wu=this.sampleValues,ju=this.valueSize,Xu=0;Xu!==ju;++Xu)ku[Xu]=Wu[Vu*ju+Xu];return ku},interpolate_:function(){throw new Error('call to abstract method')},intervalChanged_:function(){}}),Object.assign(po.prototype,{beforeStart_:po.prototype.copySampleValue_,afterEnd_:po.prototype.copySampleValue_}),co.prototype=Object.assign(Object.create(po.prototype),{constructor:co,DefaultSettings_:{endingStart:Ql,endingEnd:Ql},intervalChanged_:function(Vu,ku,Wu){var ju=this.parameterPositions,qu=Vu-2,Xu=Vu+1,Yu=ju[qu],Zu=ju[Xu];if(Yu===void 0)switch(this.getSettings_().endingStart){case Kl:qu=Vu,Yu=2*ku-Wu;break;case $l:qu=ju.length-2,Yu=ku+ju[qu]-ju[qu+1];break;default:qu=Vu,Yu=Wu;}if(void 0===Zu)switch(this.getSettings_().endingEnd){case Kl:Xu=Vu,Zu=2*Wu-ku;break;case $l:Xu=1,Zu=Wu+ju[1]-ju[0];break;default:Xu=Vu-1,Zu=ku;}var Ju=0.5*(Wu-ku),Qu=this.valueSize;this._weightPrev=Ju/(ku-Yu),this._weightNext=Ju/(Zu-Wu),this._offsetPrev=qu*Qu,this._offsetNext=Xu*Qu},interpolate_:function(Vu,ku,Wu,ju){for(var qu=this.resultBuffer,Xu=this.sampleValues,Yu=this.valueSize,Zu=Vu*Yu,Qu=this._offsetPrev,Ku=this._offsetNext,$u=this._weightPrev,em=this._weightNext,tm=(Wu-ku)/(ju-ku),rm=tm*tm,am=rm*tm,lm=0;lm!==Yu;++lm)qu[lm]=(-$u*am+2*$u*rm-$u*tm)*Xu[Qu+lm]+((1+$u)*am+(-1.5-2*$u)*rm+(-0.5+$u)*tm+1)*Xu[Zu-Yu+lm]+((-1-em)*am+(1.5+em)*rm+0.5*tm)*Xu[Zu+lm]+(em*am-em*rm)*Xu[Ku+lm];return qu}}),uo.prototype=Object.assign(Object.create(po.prototype),{constructor:uo,interpolate_:function(Vu,ku,Wu,ju){for(var qu=this.resultBuffer,Xu=this.sampleValues,Yu=this.valueSize,Zu=Vu*Yu,Qu=(Wu-ku)/(ju-ku),$u=0;$u!==Yu;++$u)qu[$u]=Xu[Zu-Yu+$u]*(1-Qu)+Xu[Zu+$u]*Qu;return qu}}),mo.prototype=Object.assign(Object.create(po.prototype),{constructor:mo,interpolate_:function(Vu){return this.copySampleValue_(Vu-1)}}),Object.assign(go,{toJSON:function(Vu){var ku=Vu.constructor,Wu;if(void 0!==ku.toJSON)Wu=ku.toJSON(Vu);else{Wu={name:Vu.name,times:gu.convertArray(Vu.times,Array),values:gu.convertArray(Vu.values,Array)};var ju=Vu.getInterpolation();ju!==Vu.DefaultInterpolation&&(Wu.interpolation=ju)}return Wu.type=Vu.ValueTypeName,Wu}}),Object.assign(go.prototype,{constructor:go,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Zl,InterpolantFactoryMethodDiscrete:function(Vu){return new mo(this.times,this.values,this.getValueSize(),Vu)},InterpolantFactoryMethodLinear:function(Vu){return new uo(this.times,this.values,this.getValueSize(),Vu)},InterpolantFactoryMethodSmooth:function(Vu){return new co(this.times,this.values,this.getValueSize(),Vu)},setInterpolation:function(Vu){var ku;if(Vu===Yl?ku=this.InterpolantFactoryMethodDiscrete:Vu===Zl?ku=this.InterpolantFactoryMethodLinear:Vu===Jl?ku=this.InterpolantFactoryMethodSmooth:void 0,void 0===ku){var Wu='unsupported interpolation for '+this.ValueTypeName+' keyframe track named '+this.name;if(void 0===this.createInterpolant)if(Vu!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(Wu);return console.warn('THREE.KeyframeTrack:',Wu),this}return this.createInterpolant=ku,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Yl;case this.InterpolantFactoryMethodLinear:return Zl;case this.InterpolantFactoryMethodSmooth:return Jl;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(Vu){if(0!==Vu)for(var ku=this.times,Wu=0,ju=ku.length;Wu!==ju;++Wu)ku[Wu]+=Vu;return this},scale:function(Vu){if(1!==Vu)for(var ku=this.times,Wu=0,ju=ku.length;Wu!==ju;++Wu)ku[Wu]*=Vu;return this},trim:function(Vu,ku){for(var Wu=this.times,ju=Wu.length,qu=0,Xu=ju-1;qu!==ju&&Wu[qu]<Vu;)++qu;for(;-1!=Xu&&Wu[Xu]>ku;)--Xu;if(++Xu,0!==qu||Xu!==ju){qu>=Xu&&(Xu=Math.max(Xu,1),qu=Xu-1);var Yu=this.getValueSize();this.times=gu.arraySlice(Wu,qu,Xu),this.values=gu.arraySlice(this.values,qu*Yu,Xu*Yu)}return this},validate:function(){var Vu=!0,ku=this.getValueSize();0!=ku-Math.floor(ku)&&(console.error('THREE.KeyframeTrack: Invalid value size in track.',this),Vu=!1);var Wu=this.times,ju=this.values,qu=Wu.length;0===qu&&(console.error('THREE.KeyframeTrack: Track is empty.',this),Vu=!1);for(var Xu=null,Yu=0,Zu;Yu!==qu;Yu++){if(Zu=Wu[Yu],'number'==typeof Zu&&isNaN(Zu)){console.error('THREE.KeyframeTrack: Time is not a valid number.',this,Yu,Zu),Vu=!1;break}if(null!=Xu&&Xu>Zu){console.error('THREE.KeyframeTrack: Out of order keys.',this,Yu,Zu,Xu),Vu=!1;break}Xu=Zu}if(ju!==void 0&&gu.isTypedArray(ju))for(var Yu=0,Ju=ju.length,Qu;Yu!==Ju;++Yu)if(Qu=ju[Yu],isNaN(Qu)){console.error('THREE.KeyframeTrack: Value is not a valid number.',this,Yu,Qu),Vu=!1;break}return Vu},optimize:function(){for(var Vu=this.times,ku=this.values,Wu=this.getValueSize(),ju=this.getInterpolation()===Jl,qu=1,Xu=Vu.length-1,Yu=1;Yu<Xu;++Yu){var Zu=!1,Ju=Vu[Yu],Qu=Vu[Yu+1];if(Ju!==Qu&&(1!==Yu||Ju!==Ju[0]))if(!ju){for(var Ku=Yu*Wu,tm=0,rm;tm!==Wu;++tm)if(rm=ku[Ku+tm],rm!==ku[Ku-Wu+tm]||rm!==ku[Ku+Wu+tm]){Zu=!0;break}}else Zu=!0;if(Zu){if(Yu!==qu){Vu[qu]=Vu[Yu];for(var am=Yu*Wu,om=qu*Wu,tm=0;tm!==Wu;++tm)ku[om+tm]=ku[am+tm]}++qu}}if(0<Xu){Vu[qu]=Vu[Xu];for(var am=Xu*Wu,om=qu*Wu,tm=0;tm!==Wu;++tm)ku[om+tm]=ku[am+tm];++qu}return qu!==Vu.length&&(this.times=gu.arraySlice(Vu,0,qu),this.values=gu.arraySlice(ku,0,qu*Wu)),this}}),fo.prototype=Object.assign(Object.create(go.prototype),{constructor:fo,ValueTypeName:'bool',ValueBufferType:Array,DefaultInterpolation:Yl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),yo.prototype=Object.assign(Object.create(go.prototype),{constructor:yo,ValueTypeName:'color'}),xo.prototype=Object.assign(Object.create(go.prototype),{constructor:xo,ValueTypeName:'number'}),vo.prototype=Object.assign(Object.create(po.prototype),{constructor:vo,interpolate_:function(Vu,ku,Wu,ju){for(var qu=this.resultBuffer,Xu=this.sampleValues,Yu=this.valueSize,Zu=Vu*Yu,Qu=Zu+Yu;Zu!==Qu;Zu+=4)L.slerpFlat(qu,0,Xu,Zu-Yu,Xu,Zu,(Wu-ku)/(ju-ku));return qu}}),_o.prototype=Object.assign(Object.create(go.prototype),{constructor:_o,ValueTypeName:'quaternion',DefaultInterpolation:Zl,InterpolantFactoryMethodLinear:function(Vu){return new vo(this.times,this.values,this.getValueSize(),Vu)},InterpolantFactoryMethodSmooth:void 0}),bo.prototype=Object.assign(Object.create(go.prototype),{constructor:bo,ValueTypeName:'string',ValueBufferType:Array,DefaultInterpolation:Yl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Mo.prototype=Object.assign(Object.create(go.prototype),{constructor:Mo,ValueTypeName:'vector'}),Object.assign(So,{parse:function(Vu){for(var ku=[],Wu=Vu.tracks,ju=1/(Vu.fps||1),qu=0,Xu=Wu.length;qu!==Xu;++qu)ku.push(Eo(Wu[qu]).scale(ju));return new So(Vu.name,Vu.duration,ku)},toJSON:function(Vu){for(var ku=[],Wu=Vu.tracks,ju={name:Vu.name,duration:Vu.duration,tracks:ku,uuid:Vu.uuid},qu=0,Xu=Wu.length;qu!==Xu;++qu)ku.push(go.toJSON(Wu[qu]));return ju},CreateFromMorphTargetSequence:function(Vu,ku,Wu,ju){for(var qu=ku.length,Xu=[],Yu=0;Yu<qu;Yu++){var Zu=[],Ju=[];Zu.push((Yu+qu-1)%qu,Yu,(Yu+1)%qu),Ju.push(0,1,0);var Qu=gu.getKeyframeOrder(Zu);Zu=gu.sortedArray(Zu,1,Qu),Ju=gu.sortedArray(Ju,1,Qu),ju||0!==Zu[0]||(Zu.push(qu),Ju.push(Ju[0])),Xu.push(new xo('.morphTargetInfluences['+ku[Yu].name+']',Zu,Ju).scale(1/Wu))}return new So(Vu,-1,Xu)},findByName:function(Vu,ku){var Wu=Vu;if(!Array.isArray(Vu)){var ju=Vu;Wu=ju.geometry&&ju.geometry.animations||ju.animations}for(var qu=0;qu<Wu.length;qu++)if(Wu[qu].name===ku)return Wu[qu];return null},CreateClipsFromMorphTargetSequences:function(Vu,ku,Wu){for(var ju={},qu=/^([\w-]*?)([\d]+)$/,Xu=0,Yu=Vu.length;Xu<Yu;Xu++){var Zu=Vu[Xu],Ju=Zu.name.match(qu);if(Ju&&1<Ju.length){var Qu=Ju[1],Ku=ju[Qu];Ku||(ju[Qu]=Ku=[]),Ku.push(Zu)}}var $u=[];for(var Qu in ju)$u.push(So.CreateFromMorphTargetSequence(Qu,ju[Qu],ku,Wu));return $u},parseAnimation:function(Vu,ku){if(!Vu)return console.error('THREE.AnimationClip: No animation in JSONLoader data.'),null;for(var Wu=function(sm,lm,pm,dm,cm){if(0!==pm.length){var um=[],mm=[];gu.flattenJSON(pm,um,mm,dm),0!==um.length&&cm.push(new sm(lm,um,mm))}},ju=[],qu=Vu.name||'default',Xu=Vu.length||-1,Yu=Vu.fps||30,Zu=Vu.hierarchy||[],Ju=0,Qu;Ju<Zu.length;Ju++)if(Qu=Zu[Ju].keys,Qu&&0!==Qu.length)if(Qu[0].morphTargets){for(var Ku={},$u=0;$u<Qu.length;$u++)if(Qu[$u].morphTargets)for(var em=0;em<Qu[$u].morphTargets.length;em++)Ku[Qu[$u].morphTargets[em]]=-1;for(var tm in Ku){for(var rm=[],am=[],em=0,om;em!==Qu[$u].morphTargets.length;++em)om=Qu[$u],rm.push(om.time),am.push(om.morphTarget===tm?1:0);ju.push(new xo('.morphTargetInfluence['+tm+']',rm,am))}Xu=Ku.length*(Yu||1)}else{var im='.bones['+ku[Ju].name+']';Wu(Mo,im+'.position',Qu,'pos',ju),Wu(_o,im+'.quaternion',Qu,'rot',ju),Wu(Mo,im+'.scale',Qu,'scl',ju)}if(0===ju.length)return null;var nm=new So(qu,Xu,ju);return nm}}),Object.assign(So.prototype,{resetDuration:function(){for(var Vu=this.tracks,ku=0,Wu=0,ju=Vu.length,qu;Wu!==ju;++Wu)qu=this.tracks[Wu],ku=Math.max(ku,qu.times[qu.times.length-1]);return this.duration=ku,this},trim:function(){for(var Vu=0;Vu<this.tracks.length;Vu++)this.tracks[Vu].trim(0,this.duration);return this},validate:function(){for(var Vu=!0,ku=0;ku<this.tracks.length;ku++)Vu=Vu&&this.tracks[ku].validate();return Vu},optimize:function(){for(var Vu=0;Vu<this.tracks.length;Vu++)this.tracks[Vu].optimize();return this}});var fu={enabled:!1,files:{},add:function(Vu,ku){!1===this.enabled||(this.files[Vu]=ku)},get:function(Vu){return!1===this.enabled?void 0:this.files[Vu]},remove:function(Vu){delete this.files[Vu]},clear:function(){this.files={}}},hu=new wo,yu={};Object.assign(Lo.prototype,{load:function(Vu,ku,Wu,ju){void 0===Vu&&(Vu=''),void 0!==this.path&&(Vu=this.path+Vu),Vu=this.manager.resolveURL(Vu);var qu=this,Xu=fu.get(Vu);if(void 0!==Xu)return qu.manager.itemStart(Vu),setTimeout(function(){ku&&ku(Xu),qu.manager.itemEnd(Vu)},0),Xu;if(void 0!==yu[Vu])return void yu[Vu].push({onLoad:ku,onProgress:Wu,onError:ju});var Yu=/^data:(.*?)(;base64)?,(.*)$/,Zu=Vu.match(Yu);if(Zu){var Ju=Zu[1],Qu=!!Zu[2],Ku=Zu[3];Ku=decodeURIComponent(Ku),Qu&&(Ku=atob(Ku));try{var em=(this.responseType||'').toLowerCase(),$u;switch(em){case'arraybuffer':case'blob':for(var tm=new Uint8Array(Ku.length),rm=0;rm<Ku.length;rm++)tm[rm]=Ku.charCodeAt(rm);$u='blob'===em?new Blob([tm.buffer],{type:Ju}):tm.buffer;break;case'document':var am=new DOMParser;$u=am.parseFromString(Ku,Ju);break;case'json':$u=JSON.parse(Ku);break;default:$u=Ku;}setTimeout(function(){ku&&ku($u),qu.manager.itemEnd(Vu)},0)}catch(nm){setTimeout(function(){ju&&ju(nm),qu.manager.itemError(Vu),qu.manager.itemEnd(Vu)},0)}}else{yu[Vu]=[],yu[Vu].push({onLoad:ku,onProgress:Wu,onError:ju});var om=new XMLHttpRequest;for(var im in om.open('GET',Vu,!0),om.addEventListener('load',function(nm){var sm=this.response;fu.add(Vu,sm);var lm=yu[Vu];if(delete yu[Vu],200===this.status||0===this.status){0===this.status&&console.warn('THREE.FileLoader: HTTP Status 0 received.');for(var pm=0,dm=lm.length,cm;pm<dm;pm++)cm=lm[pm],cm.onLoad&&cm.onLoad(sm);qu.manager.itemEnd(Vu)}else{for(var pm=0,dm=lm.length,cm;pm<dm;pm++)cm=lm[pm],cm.onError&&cm.onError(nm);qu.manager.itemError(Vu),qu.manager.itemEnd(Vu)}},!1),om.addEventListener('progress',function(nm){for(var sm=yu[Vu],lm=0,pm=sm.length,dm;lm<pm;lm++)dm=sm[lm],dm.onProgress&&dm.onProgress(nm)},!1),om.addEventListener('error',function(nm){var sm=yu[Vu];delete yu[Vu];for(var lm=0,pm=sm.length,dm;lm<pm;lm++)dm=sm[lm],dm.onError&&dm.onError(nm);qu.manager.itemError(Vu),qu.manager.itemEnd(Vu)},!1),om.addEventListener('abort',function(nm){var sm=yu[Vu];delete yu[Vu];for(var lm=0,pm=sm.length,dm;lm<pm;lm++)dm=sm[lm],dm.onError&&dm.onError(nm);qu.manager.itemError(Vu),qu.manager.itemEnd(Vu)},!1),void 0!==this.responseType&&(om.responseType=this.responseType),void 0!==this.withCredentials&&(om.withCredentials=this.withCredentials),om.overrideMimeType&&om.overrideMimeType(void 0===this.mimeType?'text/plain':this.mimeType),this.requestHeader)om.setRequestHeader(im,this.requestHeader[im]);om.send(null)}return qu.manager.itemStart(Vu),om},setPath:function(Vu){return this.path=Vu,this},setResponseType:function(Vu){return this.responseType=Vu,this},setWithCredentials:function(Vu){return this.withCredentials=Vu,this},setMimeType:function(Vu){return this.mimeType=Vu,this},setRequestHeader:function(Vu){return this.requestHeader=Vu,this}}),Object.assign(function(Vu){this.manager=Vu===void 0?hu:Vu}.prototype,{load:function(Vu,ku,Wu,ju){var qu=this,Xu=new Lo(qu.manager);Xu.setPath(qu.path),Xu.load(Vu,function(Yu){ku(qu.parse(JSON.parse(Yu)))},Wu,ju)},parse:function(Vu,ku){for(var Wu=[],ju=0,qu;ju<Vu.length;ju++)qu=So.parse(Vu[ju]),Wu.push(qu);ku(Wu)},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(function(Vu){this.manager=Vu===void 0?hu:Vu,this._parser=null}.prototype,{load:function(Vu,ku,Wu,ju){function qu(em){Ju.load(Vu[em],function(tm){var rm=Xu._parser(tm,!0);Yu[em]={width:rm.width,height:rm.height,format:rm.format,mipmaps:rm.mipmaps},Qu+=1,6===Qu&&(1===rm.mipmapCount&&(Zu.minFilter=Hs),Zu.format=rm.format,Zu.needsUpdate=!0,ku&&ku(Zu))},Wu,ju)}var Xu=this,Yu=[],Zu=new Rr;Zu.image=Yu;var Ju=new Lo(this.manager);if(Ju.setPath(this.path),Ju.setResponseType('arraybuffer'),Array.isArray(Vu))for(var Qu=0,Ku=0,$u=Vu.length;Ku<$u;++Ku)qu(Ku);else Ju.load(Vu,function(em){var tm=Xu._parser(em,!0);if(tm.isCubemap)for(var rm=tm.mipmaps.length/tm.mipmapCount,am=0;am<rm;am++){Yu[am]={mipmaps:[]};for(var om=0;om<tm.mipmapCount;om++)Yu[am].mipmaps.push(tm.mipmaps[am*tm.mipmapCount+om]),Yu[am].format=tm.format,Yu[am].width=tm.width,Yu[am].height=tm.height}else Zu.image.width=tm.width,Zu.image.height=tm.height,Zu.mipmaps=tm.mipmaps;1===tm.mipmapCount&&(Zu.minFilter=Hs),Zu.format=tm.format,Zu.needsUpdate=!0,ku&&ku(Zu)},Wu,ju);return Zu},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(function(Vu){this.manager=Vu===void 0?hu:Vu,this._parser=null}.prototype,{load:function(Vu,ku,Wu,ju){var qu=this,Xu=new G,Yu=new Lo(this.manager);return Yu.setResponseType('arraybuffer'),Yu.setPath(this.path),Yu.load(Vu,function(Zu){var Ju=qu._parser(Zu);Ju&&(void 0===Ju.image?void 0!==Ju.data&&(Xu.image.width=Ju.width,Xu.image.height=Ju.height,Xu.image.data=Ju.data):Xu.image=Ju.image,Xu.wrapS=void 0===Ju.wrapS?Bs:Ju.wrapS,Xu.wrapT=void 0===Ju.wrapT?Bs:Ju.wrapT,Xu.magFilter=void 0===Ju.magFilter?Hs:Ju.magFilter,Xu.minFilter=void 0===Ju.minFilter?ks:Ju.minFilter,Xu.anisotropy=void 0===Ju.anisotropy?1:Ju.anisotropy,void 0!==Ju.format&&(Xu.format=Ju.format),void 0!==Ju.type&&(Xu.type=Ju.type),void 0!==Ju.mipmaps&&(Xu.mipmaps=Ju.mipmaps),1===Ju.mipmapCount&&(Xu.minFilter=Hs),Xu.needsUpdate=!0,ku&&ku(Xu,Ju))},Wu,ju),Xu},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(Ro.prototype,{crossOrigin:'anonymous',load:function(Vu,ku,Wu,ju){function qu(){Ju.removeEventListener('load',qu,!1),Ju.removeEventListener('error',Xu,!1),fu.add(Vu,this),ku&&ku(this),Yu.manager.itemEnd(Vu)}function Xu(Qu){Ju.removeEventListener('load',qu,!1),Ju.removeEventListener('error',Xu,!1),ju&&ju(Qu),Yu.manager.itemError(Vu),Yu.manager.itemEnd(Vu)}void 0===Vu&&(Vu=''),void 0!==this.path&&(Vu=this.path+Vu),Vu=this.manager.resolveURL(Vu);var Yu=this,Zu=fu.get(Vu);if(void 0!==Zu)return Yu.manager.itemStart(Vu),setTimeout(function(){ku&&ku(Zu),Yu.manager.itemEnd(Vu)},0),Zu;var Ju=document.createElementNS('http://www.w3.org/1999/xhtml','img');return Ju.addEventListener('load',qu,!1),Ju.addEventListener('error',Xu,!1),'data:'!==Vu.substr(0,5)&&void 0!==this.crossOrigin&&(Ju.crossOrigin=this.crossOrigin),Yu.manager.itemStart(Vu),Ju.src=Vu,Ju},setCrossOrigin:function(Vu){return this.crossOrigin=Vu,this},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(Io.prototype,{crossOrigin:'anonymous',load:function(Vu,ku,Wu,ju){function qu(Qu){Yu.load(Vu[Qu],function(Ku){Xu.images[Qu]=Ku,Zu++,6===Zu&&(Xu.needsUpdate=!0,ku&&ku(Xu))},void 0,ju)}var Xu=new He,Yu=new Ro(this.manager);Yu.setCrossOrigin(this.crossOrigin),Yu.setPath(this.path);for(var Zu=0,Ju=0;Ju<Vu.length;++Ju)qu(Ju);return Xu},setCrossOrigin:function(Vu){return this.crossOrigin=Vu,this},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(Do.prototype,{crossOrigin:'anonymous',load:function(Vu,ku,Wu,ju){var qu=new R,Xu=new Ro(this.manager);return Xu.setCrossOrigin(this.crossOrigin),Xu.setPath(this.path),Xu.load(Vu,function(Yu){qu.image=Yu;var Zu=0<Vu.search(/\.jpe?g$/i)||0===Vu.search(/^data\:image\/jpeg/);qu.format=Zu?nl:ll,qu.needsUpdate=!0,void 0!==ku&&ku(qu)},Wu,ju),qu},setCrossOrigin:function(Vu){return this.crossOrigin=Vu,this},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(zo.prototype,{getPoint:function(){return console.warn('THREE.Curve: .getPoint() not implemented.'),null},getPointAt:function(Vu,ku){var Wu=this.getUtoTmapping(Vu);return this.getPoint(Wu,ku)},getPoints:function(Vu){Vu===void 0&&(Vu=5);for(var ku=[],Wu=0;Wu<=Vu;Wu++)ku.push(this.getPoint(Wu/Vu));return ku},getSpacedPoints:function(Vu){Vu===void 0&&(Vu=5);for(var ku=[],Wu=0;Wu<=Vu;Wu++)ku.push(this.getPointAt(Wu/Vu));return ku},getLength:function(){var Vu=this.getLengths();return Vu[Vu.length-1]},getLengths:function(Vu){if(void 0===Vu&&(Vu=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===Vu+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var ku=[],ju=this.getPoint(0),Xu=0,Wu,qu;for(ku.push(0),qu=1;qu<=Vu;qu++)Wu=this.getPoint(qu/Vu),Xu+=Wu.distanceTo(ju),ku.push(Xu),ju=Wu;return this.cacheArcLengths=ku,ku},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(Vu,ku){var Wu=this.getLengths(),ju=0,qu=Wu.length,Xu;Xu=ku?ku:Vu*Wu[qu-1];for(var Yu=0,Zu=qu-1,Ju;Yu<=Zu;)if(ju=Math.floor(Yu+(Zu-Yu)/2),Ju=Wu[ju]-Xu,0>Ju)Yu=ju+1;else if(0<Ju)Zu=ju-1;else{Zu=ju;break}if(ju=Zu,Wu[ju]===Xu)return ju/(qu-1);var Qu=Wu[ju],Ku=Wu[ju+1],em=(Xu-Qu)/(Ku-Qu),tm=(ju+em)/(qu-1);return tm},getTangent:function(Vu){var ku=1e-4,Wu=Vu-ku,ju=Vu+ku;0>Wu&&(Wu=0),1<ju&&(ju=1);var qu=this.getPoint(Wu),Xu=this.getPoint(ju),Yu=Xu.clone().sub(qu);return Yu.normalize()},getTangentAt:function(Vu){var ku=this.getUtoTmapping(Vu);return this.getTangent(ku)},computeFrenetFrames:function(Vu,ku){var Wu=new A,ju=[],qu=[],Xu=[],Yu=new A,Zu=new E,Ju,Qu,Ku;for(Ju=0;Ju<=Vu;Ju++)Qu=Ju/Vu,ju[Ju]=this.getTangentAt(Qu),ju[Ju].normalize();qu[0]=new A,Xu[0]=new A;var $u=Number.MAX_VALUE,em=Math.abs(ju[0].x),tm=Math.abs(ju[0].y),rm=Math.abs(ju[0].z);for(em<=$u&&($u=em,Wu.set(1,0,0)),tm<=$u&&($u=tm,Wu.set(0,1,0)),rm<=$u&&Wu.set(0,0,1),Yu.crossVectors(ju[0],Wu).normalize(),qu[0].crossVectors(ju[0],Yu),Xu[0].crossVectors(ju[0],qu[0]),Ju=1;Ju<=Vu;Ju++)qu[Ju]=qu[Ju-1].clone(),Xu[Ju]=Xu[Ju-1].clone(),Yu.crossVectors(ju[Ju-1],ju[Ju]),Yu.length()>Number.EPSILON&&(Yu.normalize(),Ku=Math.acos(hp.clamp(ju[Ju-1].dot(ju[Ju]),-1,1)),qu[Ju].applyMatrix4(Zu.makeRotationAxis(Yu,Ku))),Xu[Ju].crossVectors(ju[Ju],qu[Ju]);if(!0===ku)for(Ku=Math.acos(hp.clamp(qu[0].dot(qu[Vu]),-1,1)),Ku/=Vu,0<ju[0].dot(Yu.crossVectors(qu[0],qu[Vu]))&&(Ku=-Ku),Ju=1;Ju<=Vu;Ju++)qu[Ju].applyMatrix4(Zu.makeRotationAxis(ju[Ju],Ku*Ju)),Xu[Ju].crossVectors(ju[Ju],qu[Ju]);return{tangents:ju,normals:qu,binormals:Xu}},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.arcLengthDivisions=Vu.arcLengthDivisions,this},toJSON:function(){var Vu={metadata:{version:4.5,type:'Curve',generator:'Curve.toJSON'},arcLengthDivisions:this.arcLengthDivisions,type:this.type};return Vu},fromJSON:function(Vu){return this.arcLengthDivisions=Vu.arcLengthDivisions,this}}),No.prototype=Object.create(zo.prototype),No.prototype.constructor=No,No.prototype.isEllipseCurve=!0,No.prototype.getPoint=function(Vu,ku){for(var Wu=ku||new S,ju=2*Math.PI,qu=this.aEndAngle-this.aStartAngle,Xu=Math.abs(qu)<Number.EPSILON;0>qu;)qu+=ju;for(;qu>ju;)qu-=ju;qu<Number.EPSILON&&(Xu?qu=0:qu=ju),!0!==this.aClockwise||Xu||(qu==ju?qu=-ju:qu-=ju);var Yu=this.aStartAngle+Vu*qu,Zu=this.aX+this.xRadius*Math.cos(Yu),Ju=this.aY+this.yRadius*Math.sin(Yu);if(0!==this.aRotation){var Qu=Math.cos(this.aRotation),Ku=Math.sin(this.aRotation),$u=Zu-this.aX,em=Ju-this.aY;Zu=$u*Qu-em*Ku+this.aX,Ju=$u*Ku+em*Qu+this.aY}return Wu.set(Zu,Ju)},No.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.aX=Vu.aX,this.aY=Vu.aY,this.xRadius=Vu.xRadius,this.yRadius=Vu.yRadius,this.aStartAngle=Vu.aStartAngle,this.aEndAngle=Vu.aEndAngle,this.aClockwise=Vu.aClockwise,this.aRotation=Vu.aRotation,this},No.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.aX=this.aX,Vu.aY=this.aY,Vu.xRadius=this.xRadius,Vu.yRadius=this.yRadius,Vu.aStartAngle=this.aStartAngle,Vu.aEndAngle=this.aEndAngle,Vu.aClockwise=this.aClockwise,Vu.aRotation=this.aRotation,Vu},No.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.aX=Vu.aX,this.aY=Vu.aY,this.xRadius=Vu.xRadius,this.yRadius=Vu.yRadius,this.aStartAngle=Vu.aStartAngle,this.aEndAngle=Vu.aEndAngle,this.aClockwise=Vu.aClockwise,this.aRotation=Vu.aRotation,this},Bo.prototype=Object.create(No.prototype),Bo.prototype.constructor=Bo,Bo.prototype.isArcCurve=!0;var xu=new A,vu=new Uo,_u=new Uo,bu=new Uo;Go.prototype=Object.create(zo.prototype),Go.prototype.constructor=Go,Go.prototype.isCatmullRomCurve3=!0,Go.prototype.getPoint=function(Vu,ku){var Wu=ku||new A,ju=this.points,qu=ju.length,Xu=(qu-(this.closed?0:1))*Vu,Yu=Math.floor(Xu),Zu=Xu-Yu;this.closed?Yu+=0<Yu?0:(Math.floor(Math.abs(Yu)/qu)+1)*qu:0==Zu&&Yu===qu-1&&(Yu=qu-2,Zu=1);var Ju,Qu,Ku,$u;if(this.closed||0<Yu?Ju=ju[(Yu-1)%qu]:(xu.subVectors(ju[0],ju[1]).add(ju[0]),Ju=xu),Qu=ju[Yu%qu],Ku=ju[(Yu+1)%qu],this.closed||Yu+2<qu?$u=ju[(Yu+2)%qu]:(xu.subVectors(ju[qu-1],ju[qu-2]).add(ju[qu-1]),$u=xu),'centripetal'===this.curveType||'chordal'===this.curveType){var em='chordal'===this.curveType?0.5:0.25,tm=Math.pow(Ju.distanceToSquared(Qu),em),rm=Math.pow(Qu.distanceToSquared(Ku),em),am=Math.pow(Ku.distanceToSquared($u),em);1e-4>rm&&(rm=1),1e-4>tm&&(tm=rm),1e-4>am&&(am=rm),vu.initNonuniformCatmullRom(Ju.x,Qu.x,Ku.x,$u.x,tm,rm,am),_u.initNonuniformCatmullRom(Ju.y,Qu.y,Ku.y,$u.y,tm,rm,am),bu.initNonuniformCatmullRom(Ju.z,Qu.z,Ku.z,$u.z,tm,rm,am)}else'catmullrom'===this.curveType&&(vu.initCatmullRom(Ju.x,Qu.x,Ku.x,$u.x,this.tension),_u.initCatmullRom(Ju.y,Qu.y,Ku.y,$u.y,this.tension),bu.initCatmullRom(Ju.z,Qu.z,Ku.z,$u.z,this.tension));return Wu.set(vu.calc(Zu),_u.calc(Zu),bu.calc(Zu)),Wu},Go.prototype.copy=function(Vu){zo.prototype.copy.call(this,Vu),this.points=[];for(var ku=0,Wu=Vu.points.length,ju;ku<Wu;ku++)ju=Vu.points[ku],this.points.push(ju.clone());return this.closed=Vu.closed,this.curveType=Vu.curveType,this.tension=Vu.tension,this},Go.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);Vu.points=[];for(var ku=0,Wu=this.points.length,ju;ku<Wu;ku++)ju=this.points[ku],Vu.points.push(ju.toArray());return Vu.closed=this.closed,Vu.curveType=this.curveType,Vu.tension=this.tension,Vu},Go.prototype.fromJSON=function(Vu){zo.prototype.fromJSON.call(this,Vu),this.points=[];for(var ku=0,Wu=Vu.points.length,ju;ku<Wu;ku++)ju=Vu.points[ku],this.points.push(new A().fromArray(ju));return this.closed=Vu.closed,this.curveType=Vu.curveType,this.tension=Vu.tension,this},Zo.prototype=Object.create(zo.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isCubicBezierCurve=!0,Zo.prototype.getPoint=function(Vu,ku){var Wu=ku||new S,ju=this.v0,qu=this.v1,Xu=this.v2,Yu=this.v3;return Wu.set(Yo(Vu,ju.x,qu.x,Xu.x,Yu.x),Yo(Vu,ju.y,qu.y,Xu.y,Yu.y)),Wu},Zo.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.v0.copy(Vu.v0),this.v1.copy(Vu.v1),this.v2.copy(Vu.v2),this.v3.copy(Vu.v3),this},Zo.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.v0=this.v0.toArray(),Vu.v1=this.v1.toArray(),Vu.v2=this.v2.toArray(),Vu.v3=this.v3.toArray(),Vu},Zo.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.v0.fromArray(Vu.v0),this.v1.fromArray(Vu.v1),this.v2.fromArray(Vu.v2),this.v3.fromArray(Vu.v3),this},Jo.prototype=Object.create(zo.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isCubicBezierCurve3=!0,Jo.prototype.getPoint=function(Vu,ku){var Wu=ku||new A,ju=this.v0,qu=this.v1,Xu=this.v2,Yu=this.v3;return Wu.set(Yo(Vu,ju.x,qu.x,Xu.x,Yu.x),Yo(Vu,ju.y,qu.y,Xu.y,Yu.y),Yo(Vu,ju.z,qu.z,Xu.z,Yu.z)),Wu},Jo.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.v0.copy(Vu.v0),this.v1.copy(Vu.v1),this.v2.copy(Vu.v2),this.v3.copy(Vu.v3),this},Jo.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.v0=this.v0.toArray(),Vu.v1=this.v1.toArray(),Vu.v2=this.v2.toArray(),Vu.v3=this.v3.toArray(),Vu},Jo.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.v0.fromArray(Vu.v0),this.v1.fromArray(Vu.v1),this.v2.fromArray(Vu.v2),this.v3.fromArray(Vu.v3),this},Qo.prototype=Object.create(zo.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isLineCurve=!0,Qo.prototype.getPoint=function(Vu,ku){var Wu=ku||new S;return 1===Vu?Wu.copy(this.v2):(Wu.copy(this.v2).sub(this.v1),Wu.multiplyScalar(Vu).add(this.v1)),Wu},Qo.prototype.getPointAt=function(Vu,ku){return this.getPoint(Vu,ku)},Qo.prototype.getTangent=function(){var Vu=this.v2.clone().sub(this.v1);return Vu.normalize()},Qo.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.v1.copy(Vu.v1),this.v2.copy(Vu.v2),this},Qo.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.v1=this.v1.toArray(),Vu.v2=this.v2.toArray(),Vu},Qo.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.v1.fromArray(Vu.v1),this.v2.fromArray(Vu.v2),this},Ko.prototype=Object.create(zo.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isLineCurve3=!0,Ko.prototype.getPoint=function(Vu,ku){var Wu=ku||new A;return 1===Vu?Wu.copy(this.v2):(Wu.copy(this.v2).sub(this.v1),Wu.multiplyScalar(Vu).add(this.v1)),Wu},Ko.prototype.getPointAt=function(Vu,ku){return this.getPoint(Vu,ku)},Ko.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.v1.copy(Vu.v1),this.v2.copy(Vu.v2),this},Ko.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.v1=this.v1.toArray(),Vu.v2=this.v2.toArray(),Vu},Ko.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.v1.fromArray(Vu.v1),this.v2.fromArray(Vu.v2),this},$o.prototype=Object.create(zo.prototype),$o.prototype.constructor=$o,$o.prototype.isQuadraticBezierCurve=!0,$o.prototype.getPoint=function(Vu,ku){var Wu=ku||new S,ju=this.v0,qu=this.v1,Xu=this.v2;return Wu.set(ko(Vu,ju.x,qu.x,Xu.x),ko(Vu,ju.y,qu.y,Xu.y)),Wu},$o.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.v0.copy(Vu.v0),this.v1.copy(Vu.v1),this.v2.copy(Vu.v2),this},$o.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.v0=this.v0.toArray(),Vu.v1=this.v1.toArray(),Vu.v2=this.v2.toArray(),Vu},$o.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.v0.fromArray(Vu.v0),this.v1.fromArray(Vu.v1),this.v2.fromArray(Vu.v2),this},ei.prototype=Object.create(zo.prototype),ei.prototype.constructor=ei,ei.prototype.isQuadraticBezierCurve3=!0,ei.prototype.getPoint=function(Vu,ku){var Wu=ku||new A,ju=this.v0,qu=this.v1,Xu=this.v2;return Wu.set(ko(Vu,ju.x,qu.x,Xu.x),ko(Vu,ju.y,qu.y,Xu.y),ko(Vu,ju.z,qu.z,Xu.z)),Wu},ei.prototype.copy=function(Vu){return zo.prototype.copy.call(this,Vu),this.v0.copy(Vu.v0),this.v1.copy(Vu.v1),this.v2.copy(Vu.v2),this},ei.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);return Vu.v0=this.v0.toArray(),Vu.v1=this.v1.toArray(),Vu.v2=this.v2.toArray(),Vu},ei.prototype.fromJSON=function(Vu){return zo.prototype.fromJSON.call(this,Vu),this.v0.fromArray(Vu.v0),this.v1.fromArray(Vu.v1),this.v2.fromArray(Vu.v2),this},ti.prototype=Object.create(zo.prototype),ti.prototype.constructor=ti,ti.prototype.isSplineCurve=!0,ti.prototype.getPoint=function(Vu,ku){var Wu=ku||new S,ju=this.points,qu=(ju.length-1)*Vu,Xu=Math.floor(qu),Yu=qu-Xu,Zu=ju[0===Xu?Xu:Xu-1],Ju=ju[Xu],Qu=ju[Xu>ju.length-2?ju.length-1:Xu+1],Ku=ju[Xu>ju.length-3?ju.length-1:Xu+2];return Wu.set(Oo(Yu,Zu.x,Ju.x,Qu.x,Ku.x),Oo(Yu,Zu.y,Ju.y,Qu.y,Ku.y)),Wu},ti.prototype.copy=function(Vu){zo.prototype.copy.call(this,Vu),this.points=[];for(var ku=0,Wu=Vu.points.length,ju;ku<Wu;ku++)ju=Vu.points[ku],this.points.push(ju.clone());return this},ti.prototype.toJSON=function(){var Vu=zo.prototype.toJSON.call(this);Vu.points=[];for(var ku=0,Wu=this.points.length,ju;ku<Wu;ku++)ju=this.points[ku],Vu.points.push(ju.toArray());return Vu},ti.prototype.fromJSON=function(Vu){zo.prototype.fromJSON.call(this,Vu),this.points=[];for(var ku=0,Wu=Vu.points.length,ju;ku<Wu;ku++)ju=Vu.points[ku],this.points.push(new S().fromArray(ju));return this};var Mu=Object.freeze({ArcCurve:Bo,CatmullRomCurve3:Go,CubicBezierCurve:Zo,CubicBezierCurve3:Jo,EllipseCurve:No,LineCurve:Qo,LineCurve3:Ko,QuadraticBezierCurve:$o,QuadraticBezierCurve3:ei,SplineCurve:ti});ri.prototype=Object.assign(Object.create(zo.prototype),{constructor:ri,add:function(Vu){this.curves.push(Vu)},closePath:function(){var Vu=this.curves[0].getPoint(0),ku=this.curves[this.curves.length-1].getPoint(1);Vu.equals(ku)||this.curves.push(new Qo(ku,Vu))},getPoint:function(Vu){for(var ku=Vu*this.getLength(),Wu=this.getCurveLengths(),ju=0;ju<Wu.length;){if(Wu[ju]>=ku){var qu=Wu[ju]-ku,Xu=this.curves[ju],Yu=Xu.getLength(),Zu=0===Yu?0:1-qu/Yu;return Xu.getPointAt(Zu)}ju++}return null},getLength:function(){var Vu=this.getCurveLengths();return Vu[Vu.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var Vu=[],ku=0,Wu=0,ju=this.curves.length;Wu<ju;Wu++)ku+=this.curves[Wu].getLength(),Vu.push(ku);return this.cacheLengths=Vu,Vu},getSpacedPoints:function(Vu){void 0===Vu&&(Vu=40);for(var ku=[],Wu=0;Wu<=Vu;Wu++)ku.push(this.getPoint(Wu/Vu));return this.autoClose&&ku.push(ku[0]),ku},getPoints:function(Vu){Vu=Vu||12;for(var ku=[],ju=0,qu=this.curves,Wu;ju<qu.length;ju++)for(var Xu=qu[ju],Yu=Xu&&Xu.isEllipseCurve?2*Vu:Xu&&(Xu.isLineCurve||Xu.isLineCurve3)?1:Xu&&Xu.isSplineCurve?Vu*Xu.points.length:Vu,Zu=Xu.getPoints(Yu),Ju=0,Qu;Ju<Zu.length;Ju++)Qu=Zu[Ju],Wu&&Wu.equals(Qu)||(ku.push(Qu),Wu=Qu);return this.autoClose&&1<ku.length&&!ku[ku.length-1].equals(ku[0])&&ku.push(ku[0]),ku},copy:function(Vu){zo.prototype.copy.call(this,Vu),this.curves=[];for(var ku=0,Wu=Vu.curves.length,ju;ku<Wu;ku++)ju=Vu.curves[ku],this.curves.push(ju.clone());return this.autoClose=Vu.autoClose,this},toJSON:function(){var Vu=zo.prototype.toJSON.call(this);Vu.autoClose=this.autoClose,Vu.curves=[];for(var ku=0,Wu=this.curves.length,ju;ku<Wu;ku++)ju=this.curves[ku],Vu.curves.push(ju.toJSON());return Vu},fromJSON:function(Vu){zo.prototype.fromJSON.call(this,Vu),this.autoClose=Vu.autoClose,this.curves=[];for(var ku=0,Wu=Vu.curves.length,ju;ku<Wu;ku++)ju=Vu.curves[ku],this.curves.push(new Mu[ju.type]().fromJSON(ju));return this}}),ai.prototype=Object.assign(Object.create(ri.prototype),{constructor:ai,setFromPoints:function(Vu){this.moveTo(Vu[0].x,Vu[0].y);for(var ku=1,Wu=Vu.length;ku<Wu;ku++)this.lineTo(Vu[ku].x,Vu[ku].y)},moveTo:function(Vu,ku){this.currentPoint.set(Vu,ku)},lineTo:function(Vu,ku){var Wu=new Qo(this.currentPoint.clone(),new S(Vu,ku));this.curves.push(Wu),this.currentPoint.set(Vu,ku)},quadraticCurveTo:function(Vu,ku,Wu,ju){var qu=new $o(this.currentPoint.clone(),new S(Vu,ku),new S(Wu,ju));this.curves.push(qu),this.currentPoint.set(Wu,ju)},bezierCurveTo:function(Vu,ku,Wu,ju,qu,Xu){var Yu=new Zo(this.currentPoint.clone(),new S(Vu,ku),new S(Wu,ju),new S(qu,Xu));this.curves.push(Yu),this.currentPoint.set(qu,Xu)},splineThru:function(Vu){var ku=[this.currentPoint.clone()].concat(Vu),Wu=new ti(ku);this.curves.push(Wu),this.currentPoint.copy(Vu[Vu.length-1])},arc:function(Vu,ku,Wu,ju,qu,Xu){var Yu=this.currentPoint.x,Zu=this.currentPoint.y;this.absarc(Vu+Yu,ku+Zu,Wu,ju,qu,Xu)},absarc:function(Vu,ku,Wu,ju,qu,Xu){this.absellipse(Vu,ku,Wu,Wu,ju,qu,Xu)},ellipse:function(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){var Ju=this.currentPoint.x,Qu=this.currentPoint.y;this.absellipse(Vu+Ju,ku+Qu,Wu,ju,qu,Xu,Yu,Zu)},absellipse:function(Vu,ku,Wu,ju,qu,Xu,Yu,Zu){var Ju=new No(Vu,ku,Wu,ju,qu,Xu,Yu,Zu);if(0<this.curves.length){var Qu=Ju.getPoint(0);Qu.equals(this.currentPoint)||this.lineTo(Qu.x,Qu.y)}this.curves.push(Ju);var Ku=Ju.getPoint(1);this.currentPoint.copy(Ku)},copy:function(Vu){return ri.prototype.copy.call(this,Vu),this.currentPoint.copy(Vu.currentPoint),this},toJSON:function(){var Vu=ri.prototype.toJSON.call(this);return Vu.currentPoint=this.currentPoint.toArray(),Vu},fromJSON:function(Vu){return ri.prototype.fromJSON.call(this,Vu),this.currentPoint.fromArray(Vu.currentPoint),this}}),oi.prototype=Object.assign(Object.create(ai.prototype),{constructor:oi,getPointsHoles:function(Vu){for(var ku=[],Wu=0,ju=this.holes.length;Wu<ju;Wu++)ku[Wu]=this.holes[Wu].getPoints(Vu);return ku},extractPoints:function(Vu){return{shape:this.getPoints(Vu),holes:this.getPointsHoles(Vu)}},copy:function(Vu){ai.prototype.copy.call(this,Vu),this.holes=[];for(var ku=0,Wu=Vu.holes.length,ju;ku<Wu;ku++)ju=Vu.holes[ku],this.holes.push(ju.clone());return this},toJSON:function(){var Vu=ai.prototype.toJSON.call(this);Vu.uuid=this.uuid,Vu.holes=[];for(var ku=0,Wu=this.holes.length,ju;ku<Wu;ku++)ju=this.holes[ku],Vu.holes.push(ju.toJSON());return Vu},fromJSON:function(Vu){ai.prototype.fromJSON.call(this,Vu),this.uuid=Vu.uuid,this.holes=[];for(var ku=0,Wu=Vu.holes.length,ju;ku<Wu;ku++)ju=Vu.holes[ku],this.holes.push(new ai().fromJSON(ju));return this}}),ii.prototype=Object.assign(Object.create(K.prototype),{constructor:ii,isLight:!0,copy:function(Vu){return K.prototype.copy.call(this,Vu),this.color.copy(Vu.color),this.intensity=Vu.intensity,this},toJSON:function(Vu){var ku=K.prototype.toJSON.call(this,Vu);return ku.object.color=this.color.getHex(),ku.object.intensity=this.intensity,void 0!==this.groundColor&&(ku.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(ku.object.distance=this.distance),void 0!==this.angle&&(ku.object.angle=this.angle),void 0!==this.decay&&(ku.object.decay=this.decay),void 0!==this.penumbra&&(ku.object.penumbra=this.penumbra),void 0!==this.shadow&&(ku.object.shadow=this.shadow.toJSON()),ku}}),ni.prototype=Object.assign(Object.create(ii.prototype),{constructor:ni,isHemisphereLight:!0,copy:function(Vu){return ii.prototype.copy.call(this,Vu),this.groundColor.copy(Vu.groundColor),this}}),Object.assign(si.prototype,{copy:function(Vu){return this.camera=Vu.camera.clone(),this.bias=Vu.bias,this.radius=Vu.radius,this.mapSize.copy(Vu.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var Vu={};return 0!==this.bias&&(Vu.bias=this.bias),1!==this.radius&&(Vu.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(Vu.mapSize=this.mapSize.toArray()),Vu.camera=this.camera.toJSON(!1).object,delete Vu.camera.matrix,Vu}}),li.prototype=Object.assign(Object.create(si.prototype),{constructor:li,isSpotLightShadow:!0,update:function(Vu){var ku=this.camera,Wu=2*hp.RAD2DEG*Vu.angle,ju=this.mapSize.width/this.mapSize.height,qu=Vu.distance||ku.far;(Wu!==ku.fov||ju!==ku.aspect||qu!==ku.far)&&(ku.fov=Wu,ku.aspect=ju,ku.far=qu,ku.updateProjectionMatrix())}}),pi.prototype=Object.assign(Object.create(ii.prototype),{constructor:pi,isSpotLight:!0,copy:function(Vu){return ii.prototype.copy.call(this,Vu),this.distance=Vu.distance,this.angle=Vu.angle,this.penumbra=Vu.penumbra,this.decay=Vu.decay,this.target=Vu.target.clone(),this.shadow=Vu.shadow.clone(),this}}),di.prototype=Object.assign(Object.create(ii.prototype),{constructor:di,isPointLight:!0,copy:function(Vu){return ii.prototype.copy.call(this,Vu),this.distance=Vu.distance,this.decay=Vu.decay,this.shadow=Vu.shadow.clone(),this}}),ci.prototype=Object.assign(Object.create(ir.prototype),{constructor:ci,isOrthographicCamera:!0,copy:function(Vu,ku){return ir.prototype.copy.call(this,Vu,ku),this.left=Vu.left,this.right=Vu.right,this.top=Vu.top,this.bottom=Vu.bottom,this.near=Vu.near,this.far=Vu.far,this.zoom=Vu.zoom,this.view=null===Vu.view?null:Object.assign({},Vu.view),this},setViewOffset:function(Vu,ku,Wu,ju,qu,Xu){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=Vu,this.view.fullHeight=ku,this.view.offsetX=Wu,this.view.offsetY=ju,this.view.width=qu,this.view.height=Xu,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var Vu=(this.right-this.left)/(2*this.zoom),ku=(this.top-this.bottom)/(2*this.zoom),Wu=(this.right+this.left)/2,ju=(this.top+this.bottom)/2,qu=Wu-Vu,Xu=Wu+Vu,Yu=ju+ku,Zu=ju-ku;if(null!==this.view&&this.view.enabled){var Ju=this.zoom/(this.view.width/this.view.fullWidth),Qu=this.zoom/(this.view.height/this.view.fullHeight),Ku=(this.right-this.left)/this.view.width,$u=(this.top-this.bottom)/this.view.height;qu+=Ku*(this.view.offsetX/Ju),Xu=qu+Ku*(this.view.width/Ju),Yu-=$u*(this.view.offsetY/Qu),Zu=Yu-$u*(this.view.height/Qu)}this.projectionMatrix.makeOrthographic(qu,Xu,Yu,Zu,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(Vu){var ku=K.prototype.toJSON.call(this,Vu);return ku.object.zoom=this.zoom,ku.object.left=this.left,ku.object.right=this.right,ku.object.top=this.top,ku.object.bottom=this.bottom,ku.object.near=this.near,ku.object.far=this.far,null!==this.view&&(ku.object.view=Object.assign({},this.view)),ku}}),ui.prototype=Object.assign(Object.create(si.prototype),{constructor:ui}),mi.prototype=Object.assign(Object.create(ii.prototype),{constructor:mi,isDirectionalLight:!0,copy:function(Vu){return ii.prototype.copy.call(this,Vu),this.target=Vu.target.clone(),this.shadow=Vu.shadow.clone(),this}}),gi.prototype=Object.assign(Object.create(ii.prototype),{constructor:gi,isAmbientLight:!0}),hi.prototype=Object.assign(Object.create(ii.prototype),{constructor:hi,isRectAreaLight:!0,copy:function(Vu){return ii.prototype.copy.call(this,Vu),this.width=Vu.width,this.height=Vu.height,this},toJSON:function(Vu){var ku=ii.prototype.toJSON.call(this,Vu);return ku.object.width=this.width,ku.object.height=this.height,ku}}),Object.assign(yi.prototype,{load:function(Vu,ku,Wu,ju){var qu=this,Xu=new Lo(qu.manager);Xu.setPath(qu.path),Xu.load(Vu,function(Yu){ku(qu.parse(JSON.parse(Yu)))},Wu,ju)},parse:function(Vu){function ku(Zu){return void 0===Wu[Zu]&&console.warn('THREE.MaterialLoader: Undefined texture',Zu),Wu[Zu]}var Wu=this.textures,ju=new mu[Vu.type];if(void 0!==Vu.uuid&&(ju.uuid=Vu.uuid),void 0!==Vu.name&&(ju.name=Vu.name),void 0!==Vu.color&&ju.color.setHex(Vu.color),void 0!==Vu.roughness&&(ju.roughness=Vu.roughness),void 0!==Vu.metalness&&(ju.metalness=Vu.metalness),void 0!==Vu.emissive&&ju.emissive.setHex(Vu.emissive),void 0!==Vu.specular&&ju.specular.setHex(Vu.specular),void 0!==Vu.shininess&&(ju.shininess=Vu.shininess),void 0!==Vu.clearCoat&&(ju.clearCoat=Vu.clearCoat),void 0!==Vu.clearCoatRoughness&&(ju.clearCoatRoughness=Vu.clearCoatRoughness),void 0!==Vu.vertexColors&&(ju.vertexColors=Vu.vertexColors),void 0!==Vu.fog&&(ju.fog=Vu.fog),void 0!==Vu.flatShading&&(ju.flatShading=Vu.flatShading),void 0!==Vu.blending&&(ju.blending=Vu.blending),void 0!==Vu.combine&&(ju.combine=Vu.combine),void 0!==Vu.side&&(ju.side=Vu.side),void 0!==Vu.opacity&&(ju.opacity=Vu.opacity),void 0!==Vu.transparent&&(ju.transparent=Vu.transparent),void 0!==Vu.alphaTest&&(ju.alphaTest=Vu.alphaTest),void 0!==Vu.depthTest&&(ju.depthTest=Vu.depthTest),void 0!==Vu.depthWrite&&(ju.depthWrite=Vu.depthWrite),void 0!==Vu.colorWrite&&(ju.colorWrite=Vu.colorWrite),void 0!==Vu.wireframe&&(ju.wireframe=Vu.wireframe),void 0!==Vu.wireframeLinewidth&&(ju.wireframeLinewidth=Vu.wireframeLinewidth),void 0!==Vu.wireframeLinecap&&(ju.wireframeLinecap=Vu.wireframeLinecap),void 0!==Vu.wireframeLinejoin&&(ju.wireframeLinejoin=Vu.wireframeLinejoin),void 0!==Vu.rotation&&(ju.rotation=Vu.rotation),1!==Vu.linewidth&&(ju.linewidth=Vu.linewidth),void 0!==Vu.dashSize&&(ju.dashSize=Vu.dashSize),void 0!==Vu.gapSize&&(ju.gapSize=Vu.gapSize),void 0!==Vu.scale&&(ju.scale=Vu.scale),void 0!==Vu.polygonOffset&&(ju.polygonOffset=Vu.polygonOffset),void 0!==Vu.polygonOffsetFactor&&(ju.polygonOffsetFactor=Vu.polygonOffsetFactor),void 0!==Vu.polygonOffsetUnits&&(ju.polygonOffsetUnits=Vu.polygonOffsetUnits),void 0!==Vu.skinning&&(ju.skinning=Vu.skinning),void 0!==Vu.morphTargets&&(ju.morphTargets=Vu.morphTargets),void 0!==Vu.dithering&&(ju.dithering=Vu.dithering),void 0!==Vu.visible&&(ju.visible=Vu.visible),void 0!==Vu.userData&&(ju.userData=Vu.userData),void 0!==Vu.uniforms)for(var qu in Vu.uniforms){var Xu=Vu.uniforms[qu];switch(ju.uniforms[qu]={},Xu.type){case't':ju.uniforms[qu].value=ku(Xu.value);break;case'c':ju.uniforms[qu].value=new W().setHex(Xu.value);break;case'v2':ju.uniforms[qu].value=new S().fromArray(Xu.value);break;case'v3':ju.uniforms[qu].value=new A().fromArray(Xu.value);break;case'v4':ju.uniforms[qu].value=new I().fromArray(Xu.value);break;case'm4':ju.uniforms[qu].value=new E().fromArray(Xu.value);break;default:ju.uniforms[qu].value=Xu.value;}}if(void 0!==Vu.defines&&(ju.defines=Vu.defines),void 0!==Vu.vertexShader&&(ju.vertexShader=Vu.vertexShader),void 0!==Vu.fragmentShader&&(ju.fragmentShader=Vu.fragmentShader),void 0!==Vu.shading&&(ju.flatShading=1===Vu.shading),void 0!==Vu.size&&(ju.size=Vu.size),void 0!==Vu.sizeAttenuation&&(ju.sizeAttenuation=Vu.sizeAttenuation),void 0!==Vu.map&&(ju.map=ku(Vu.map)),void 0!==Vu.alphaMap&&(ju.alphaMap=ku(Vu.alphaMap),ju.transparent=!0),void 0!==Vu.bumpMap&&(ju.bumpMap=ku(Vu.bumpMap)),void 0!==Vu.bumpScale&&(ju.bumpScale=Vu.bumpScale),void 0!==Vu.normalMap&&(ju.normalMap=ku(Vu.normalMap)),void 0!==Vu.normalMapType&&(ju.normalMapType=Vu.normalMapType),void 0!==Vu.normalScale){var Yu=Vu.normalScale;!1===Array.isArray(Yu)&&(Yu=[Yu,Yu]),ju.normalScale=new S().fromArray(Yu)}return void 0!==Vu.displacementMap&&(ju.displacementMap=ku(Vu.displacementMap)),void 0!==Vu.displacementScale&&(ju.displacementScale=Vu.displacementScale),void 0!==Vu.displacementBias&&(ju.displacementBias=Vu.displacementBias),void 0!==Vu.roughnessMap&&(ju.roughnessMap=ku(Vu.roughnessMap)),void 0!==Vu.metalnessMap&&(ju.metalnessMap=ku(Vu.metalnessMap)),void 0!==Vu.emissiveMap&&(ju.emissiveMap=ku(Vu.emissiveMap)),void 0!==Vu.emissiveIntensity&&(ju.emissiveIntensity=Vu.emissiveIntensity),void 0!==Vu.specularMap&&(ju.specularMap=ku(Vu.specularMap)),void 0!==Vu.envMap&&(ju.envMap=ku(Vu.envMap)),void 0!==Vu.envMapIntensity&&(ju.envMapIntensity=Vu.envMapIntensity),void 0!==Vu.reflectivity&&(ju.reflectivity=Vu.reflectivity),void 0!==Vu.lightMap&&(ju.lightMap=ku(Vu.lightMap)),void 0!==Vu.lightMapIntensity&&(ju.lightMapIntensity=Vu.lightMapIntensity),void 0!==Vu.aoMap&&(ju.aoMap=ku(Vu.aoMap)),void 0!==Vu.aoMapIntensity&&(ju.aoMapIntensity=Vu.aoMapIntensity),void 0!==Vu.gradientMap&&(ju.gradientMap=ku(Vu.gradientMap)),ju},setPath:function(Vu){return this.path=Vu,this},setTextures:function(Vu){return this.textures=Vu,this}});var Su={decodeText:function(Vu){if('undefined'!=typeof TextDecoder)return new TextDecoder().decode(Vu);for(var ku='',Wu=0,ju=Vu.length;Wu<ju;Wu++)ku+=String.fromCharCode(Vu[Wu]);return decodeURIComponent(escape(ku))},extractUrlBase:function(Vu){var ku=Vu.lastIndexOf('/');return-1===ku?'./':Vu.substr(0,ku+1)}};Object.assign(xi.prototype,{load:function(Vu,ku,Wu,ju){var qu=this,Xu=new Lo(qu.manager);Xu.setPath(qu.path),Xu.load(Vu,function(Yu){ku(qu.parse(JSON.parse(Yu)))},Wu,ju)},parse:function(Vu){var ku=new xe,Wu=Vu.data.index;if(Wu!==void 0){var ju=new Tu[Wu.type](Wu.array);ku.setIndex(new re(ju,1))}var qu=Vu.data.attributes;for(var Xu in qu){var Yu=qu[Xu],ju=new Tu[Yu.type](Yu.array);ku.addAttribute(Xu,new re(ju,Yu.itemSize,Yu.normalized))}var Zu=Vu.data.groups||Vu.data.drawcalls||Vu.data.offsets;if(Zu!==void 0)for(var Ju=0,Qu=Zu.length,Ku;Ju!==Qu;++Ju)Ku=Zu[Ju],ku.addGroup(Ku.start,Ku.count,Ku.materialIndex);var $u=Vu.data.boundingSphere;if($u!==void 0){var em=new A;$u.center!==void 0&&em.fromArray($u.center),ku.boundingSphere=new F(em,$u.radius)}return ku},setPath:function(Vu){return this.path=Vu,this}});var Tu={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:'undefined'==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};vi.Handlers={handlers:[],add:function(Vu,ku){this.handlers.push(Vu,ku)},get:function(Vu){for(var ku=this.handlers,Wu=0,ju=ku.length;Wu<ju;Wu+=2){var qu=ku[Wu],Xu=ku[Wu+1];if(qu.test(Vu))return Xu}return null}},Object.assign(vi.prototype,{crossOrigin:'anonymous',onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(Vu,ku,Wu){for(var ju=[],qu=0;qu<Vu.length;++qu)ju[qu]=this.createMaterial(Vu[qu],ku,Wu);return ju},createMaterial:function(){var Vu={NoBlending:Hn,NormalBlending:Vn,AdditiveBlending:kn,SubtractiveBlending:Wn,MultiplyBlending:jn,CustomBlending:qn},ku=new W,Wu=new Do,ju=new yi;return function(Xu,Yu,Zu){function Ju(tm,rm,am,om,im){var nm=Yu+tm,sm=vi.Handlers.get(nm),lm;null===sm?(Wu.setCrossOrigin(Zu),lm=Wu.load(nm)):lm=sm.load(nm),void 0!==rm&&(lm.repeat.fromArray(rm),1!==rm[0]&&(lm.wrapS=Ns),1!==rm[1]&&(lm.wrapT=Ns)),void 0!==am&&lm.offset.fromArray(am),void 0!==om&&('repeat'===om[0]&&(lm.wrapS=Ns),'mirror'===om[0]&&(lm.wrapS=Us),'repeat'===om[1]&&(lm.wrapT=Ns),'mirror'===om[1]&&(lm.wrapT=Us)),void 0!==im&&(lm.anisotropy=im);var pm=hp.generateUUID();return Qu[pm]=lm,pm}var Qu={},Ku={uuid:hp.generateUUID(),type:'MeshLambertMaterial'};for(var $u in Xu){var em=Xu[$u];switch($u){case'DbgColor':case'DbgIndex':case'opticalDensity':case'illumination':break;case'DbgName':Ku.name=em;break;case'blending':Ku.blending=Vu[em];break;case'colorAmbient':case'mapAmbient':console.warn('THREE.Loader.createMaterial:',$u,'is no longer supported.');break;case'colorDiffuse':Ku.color=ku.fromArray(em).getHex();break;case'colorSpecular':Ku.specular=ku.fromArray(em).getHex();break;case'colorEmissive':Ku.emissive=ku.fromArray(em).getHex();break;case'specularCoef':Ku.shininess=em;break;case'shading':'basic'===em.toLowerCase()&&(Ku.type='MeshBasicMaterial'),'phong'===em.toLowerCase()&&(Ku.type='MeshPhongMaterial'),'standard'===em.toLowerCase()&&(Ku.type='MeshStandardMaterial');break;case'mapDiffuse':Ku.map=Ju(em,Xu.mapDiffuseRepeat,Xu.mapDiffuseOffset,Xu.mapDiffuseWrap,Xu.mapDiffuseAnisotropy);break;case'mapDiffuseRepeat':case'mapDiffuseOffset':case'mapDiffuseWrap':case'mapDiffuseAnisotropy':break;case'mapEmissive':Ku.emissiveMap=Ju(em,Xu.mapEmissiveRepeat,Xu.mapEmissiveOffset,Xu.mapEmissiveWrap,Xu.mapEmissiveAnisotropy);break;case'mapEmissiveRepeat':case'mapEmissiveOffset':case'mapEmissiveWrap':case'mapEmissiveAnisotropy':break;case'mapLight':Ku.lightMap=Ju(em,Xu.mapLightRepeat,Xu.mapLightOffset,Xu.mapLightWrap,Xu.mapLightAnisotropy);break;case'mapLightRepeat':case'mapLightOffset':case'mapLightWrap':case'mapLightAnisotropy':break;case'mapAO':Ku.aoMap=Ju(em,Xu.mapAORepeat,Xu.mapAOOffset,Xu.mapAOWrap,Xu.mapAOAnisotropy);break;case'mapAORepeat':case'mapAOOffset':case'mapAOWrap':case'mapAOAnisotropy':break;case'mapBump':Ku.bumpMap=Ju(em,Xu.mapBumpRepeat,Xu.mapBumpOffset,Xu.mapBumpWrap,Xu.mapBumpAnisotropy);break;case'mapBumpScale':Ku.bumpScale=em;break;case'mapBumpRepeat':case'mapBumpOffset':case'mapBumpWrap':case'mapBumpAnisotropy':break;case'mapNormal':Ku.normalMap=Ju(em,Xu.mapNormalRepeat,Xu.mapNormalOffset,Xu.mapNormalWrap,Xu.mapNormalAnisotropy);break;case'mapNormalFactor':Ku.normalScale=em;break;case'mapNormalRepeat':case'mapNormalOffset':case'mapNormalWrap':case'mapNormalAnisotropy':break;case'mapSpecular':Ku.specularMap=Ju(em,Xu.mapSpecularRepeat,Xu.mapSpecularOffset,Xu.mapSpecularWrap,Xu.mapSpecularAnisotropy);break;case'mapSpecularRepeat':case'mapSpecularOffset':case'mapSpecularWrap':case'mapSpecularAnisotropy':break;case'mapMetalness':Ku.metalnessMap=Ju(em,Xu.mapMetalnessRepeat,Xu.mapMetalnessOffset,Xu.mapMetalnessWrap,Xu.mapMetalnessAnisotropy);break;case'mapMetalnessRepeat':case'mapMetalnessOffset':case'mapMetalnessWrap':case'mapMetalnessAnisotropy':break;case'mapRoughness':Ku.roughnessMap=Ju(em,Xu.mapRoughnessRepeat,Xu.mapRoughnessOffset,Xu.mapRoughnessWrap,Xu.mapRoughnessAnisotropy);break;case'mapRoughnessRepeat':case'mapRoughnessOffset':case'mapRoughnessWrap':case'mapRoughnessAnisotropy':break;case'mapAlpha':Ku.alphaMap=Ju(em,Xu.mapAlphaRepeat,Xu.mapAlphaOffset,Xu.mapAlphaWrap,Xu.mapAlphaAnisotropy);break;case'mapAlphaRepeat':case'mapAlphaOffset':case'mapAlphaWrap':case'mapAlphaAnisotropy':break;case'flipSided':Ku.side=Nn;break;case'doubleSided':Ku.side=Bn;break;case'transparency':console.warn('THREE.Loader.createMaterial: transparency has been renamed to opacity'),Ku.opacity=em;break;case'depthTest':case'depthWrite':case'colorWrite':case'opacity':case'reflectivity':case'transparent':case'visible':case'wireframe':Ku[$u]=em;break;case'vertexColors':!0===em&&(Ku.vertexColors=Fn),'face'===em&&(Ku.vertexColors=On);break;default:console.error('THREE.Loader.createMaterial: Unsupported',$u,em);}}return'MeshBasicMaterial'===Ku.type&&delete Ku.emissive,'MeshPhongMaterial'!==Ku.type&&delete Ku.specular,1>Ku.opacity&&(Ku.transparent=!0),ju.setTextures(Qu),ju.parse(Ku)}}()}),Object.assign(_i.prototype,{crossOrigin:'anonymous',load:function(Vu,ku,Wu,ju){var qu=this,Xu=this.path===void 0?Su.extractUrlBase(Vu):this.path,Yu=new Lo(this.manager);Yu.setPath(this.path),Yu.setWithCredentials(this.withCredentials),Yu.load(Vu,function(Zu){var Ju=JSON.parse(Zu),Qu=Ju.metadata;if(Qu!==void 0){var Ku=Qu.type;if(Ku!==void 0&&'object'===Ku.toLowerCase())return void console.error('THREE.JSONLoader: '+Vu+' should be loaded with THREE.ObjectLoader instead.')}var $u=qu.parse(Ju,Xu);ku($u.geometry,$u.materials)},Wu,ju)},setPath:function(Vu){return this.path=Vu,this},setResourcePath:function(Vu){return this.resourcePath=Vu,this},setCrossOrigin:function(Vu){return this.crossOrigin=Vu,this},parse:function(){function Vu(qu,Xu){function Yu(Am,Pm){return Am&1<<Pm}var Mm=qu.faces,Sm=qu.vertices,Tm=qu.normals,Em=qu.colors,wm=qu.scale,Lm=0,Zu,Ju,Qu,Ku,$u,em,tm,rm,am,om,im,nm,sm,lm,pm,dm,cm,um,mm,gm,fm,hm,ym,xm,vm,_m,bm;if(qu.uvs!==void 0){for(Zu=0;Zu<qu.uvs.length;Zu++)qu.uvs[Zu].length&&Lm++;for(Zu=0;Zu<Lm;Zu++)Xu.faceVertexUvs[Zu]=[]}for(Ku=0,$u=Sm.length;Ku<$u;)um=new A,um.x=Sm[Ku++]*wm,um.y=Sm[Ku++]*wm,um.z=Sm[Ku++]*wm,Xu.vertices.push(um);for(Ku=0,$u=Mm.length;Ku<$u;)if(om=Mm[Ku++],im=Yu(om,0),nm=Yu(om,1),sm=Yu(om,3),lm=Yu(om,4),pm=Yu(om,5),dm=Yu(om,6),cm=Yu(om,7),im){if(gm=new Z,gm.a=Mm[Ku],gm.b=Mm[Ku+1],gm.c=Mm[Ku+3],fm=new Z,fm.a=Mm[Ku+1],fm.b=Mm[Ku+2],fm.c=Mm[Ku+3],Ku+=4,nm&&(am=Mm[Ku++],gm.materialIndex=am,fm.materialIndex=am),Qu=Xu.faces.length,sm)for(Zu=0;Zu<Lm;Zu++)for(xm=qu.uvs[Zu],Xu.faceVertexUvs[Zu][Qu]=[],Xu.faceVertexUvs[Zu][Qu+1]=[],Ju=0;4>Ju;Ju++)rm=Mm[Ku++],_m=xm[2*rm],bm=xm[2*rm+1],vm=new S(_m,bm),2!==Ju&&Xu.faceVertexUvs[Zu][Qu].push(vm),0!==Ju&&Xu.faceVertexUvs[Zu][Qu+1].push(vm);if(lm&&(tm=3*Mm[Ku++],gm.normal.set(Tm[tm++],Tm[tm++],Tm[tm]),fm.normal.copy(gm.normal)),pm)for(Zu=0;4>Zu;Zu++)tm=3*Mm[Ku++],ym=new A(Tm[tm++],Tm[tm++],Tm[tm]),2!==Zu&&gm.vertexNormals.push(ym),0!==Zu&&fm.vertexNormals.push(ym);if(dm&&(em=Mm[Ku++],hm=Em[em],gm.color.setHex(hm),fm.color.setHex(hm)),cm)for(Zu=0;4>Zu;Zu++)em=Mm[Ku++],hm=Em[em],2!==Zu&&gm.vertexColors.push(new W(hm)),0!==Zu&&fm.vertexColors.push(new W(hm));Xu.faces.push(gm),Xu.faces.push(fm)}else{if(mm=new Z,mm.a=Mm[Ku++],mm.b=Mm[Ku++],mm.c=Mm[Ku++],nm&&(am=Mm[Ku++],mm.materialIndex=am),Qu=Xu.faces.length,sm)for(Zu=0;Zu<Lm;Zu++)for(xm=qu.uvs[Zu],Xu.faceVertexUvs[Zu][Qu]=[],Ju=0;3>Ju;Ju++)rm=Mm[Ku++],_m=xm[2*rm],bm=xm[2*rm+1],vm=new S(_m,bm),Xu.faceVertexUvs[Zu][Qu].push(vm);if(lm&&(tm=3*Mm[Ku++],mm.normal.set(Tm[tm++],Tm[tm++],Tm[tm])),pm)for(Zu=0;3>Zu;Zu++)tm=3*Mm[Ku++],ym=new A(Tm[tm++],Tm[tm++],Tm[tm]),mm.vertexNormals.push(ym);if(dm&&(em=Mm[Ku++],mm.color.setHex(Em[em])),cm)for(Zu=0;3>Zu;Zu++)em=Mm[Ku++],mm.vertexColors.push(new W(Em[em]));Xu.faces.push(mm)}}function ku(qu,Xu){var Yu=qu.influencesPerVertex===void 0?2:qu.influencesPerVertex;if(qu.skinWeights)for(var Zu=0,Ju=qu.skinWeights.length;Zu<Ju;Zu+=Yu){var Qu=qu.skinWeights[Zu],Ku=1<Yu?qu.skinWeights[Zu+1]:0,$u=2<Yu?qu.skinWeights[Zu+2]:0,em=3<Yu?qu.skinWeights[Zu+3]:0;Xu.skinWeights.push(new I(Qu,Ku,$u,em))}if(qu.skinIndices)for(var Zu=0,Ju=qu.skinIndices.length;Zu<Ju;Zu+=Yu){var tm=qu.skinIndices[Zu],rm=1<Yu?qu.skinIndices[Zu+1]:0,am=2<Yu?qu.skinIndices[Zu+2]:0,om=3<Yu?qu.skinIndices[Zu+3]:0;Xu.skinIndices.push(new I(tm,rm,am,om))}Xu.bones=qu.bones,Xu.bones&&0<Xu.bones.length&&(Xu.skinWeights.length!==Xu.skinIndices.length||Xu.skinIndices.length!==Xu.vertices.length)&&console.warn('When skinning, number of vertices ('+Xu.vertices.length+'), skinIndices ('+Xu.skinIndices.length+'), and skinWeights ('+Xu.skinWeights.length+') should match.')}function Wu(qu,Xu){var Yu=qu.scale;if(qu.morphTargets!==void 0)for(var Zu=0,Ju=qu.morphTargets.length;Zu<Ju;Zu++){Xu.morphTargets[Zu]={},Xu.morphTargets[Zu].name=qu.morphTargets[Zu].name,Xu.morphTargets[Zu].vertices=[];for(var Qu=Xu.morphTargets[Zu].vertices,Ku=qu.morphTargets[Zu].vertices,$u=0,em=Ku.length,tm;$u<em;$u+=3)tm=new A,tm.x=Ku[$u]*Yu,tm.y=Ku[$u+1]*Yu,tm.z=Ku[$u+2]*Yu,Qu.push(tm)}if(void 0!==qu.morphColors&&0<qu.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var rm=Xu.faces,am=qu.morphColors[0].colors,Zu=0,Ju=rm.length;Zu<Ju;Zu++)rm[Zu].color.fromArray(am,3*Zu)}}function ju(qu,Xu){var Yu=[],Zu=[];qu.animation!==void 0&&Zu.push(qu.animation),qu.animations!==void 0&&(qu.animations.length?Zu=Zu.concat(qu.animations):Zu.push(qu.animations));for(var Ju=0,Qu;Ju<Zu.length;Ju++)Qu=So.parseAnimation(Zu[Ju],Xu.bones),Qu&&Yu.push(Qu);if(Xu.morphTargets){var Ku=So.CreateClipsFromMorphTargetSequences(Xu.morphTargets,10);Yu=Yu.concat(Ku)}0<Yu.length&&(Xu.animations=Yu)}return function(Xu,Yu){void 0!==Xu.data&&(Xu=Xu.data),Xu.scale=void 0===Xu.scale?1:1/Xu.scale;var Zu=new ee;if(Vu(Xu,Zu),ku(Xu,Zu),Wu(Xu,Zu),ju(Xu,Zu),Zu.computeFaceNormals(),Zu.computeBoundingSphere(),void 0===Xu.materials||0===Xu.materials.length)return{geometry:Zu};var Ju=vi.prototype.initMaterials(Xu.materials,this.resourcePath||Yu,this.crossOrigin);return{geometry:Zu,materials:Ju}}}()}),Object.assign(bi.prototype,{crossOrigin:'anonymous',load:function(Vu,ku,Wu,ju){var qu=this,Xu=this.path===void 0?Su.extractUrlBase(Vu):this.path;this.resourcePath=this.resourcePath||Xu;var Yu=new Lo(qu.manager);Yu.setPath(this.path),Yu.load(Vu,function(Zu){var Ju=null;try{Ju=JSON.parse(Zu)}catch(Ku){return void 0!==ju&&ju(Ku),void console.error('THREE:ObjectLoader: Can\'t parse '+Vu+'.',Ku.message)}var Qu=Ju.metadata;return void 0===Qu||void 0===Qu.type||'geometry'===Qu.type.toLowerCase()?void console.error('THREE.ObjectLoader: Can\'t load '+Vu+'. Use THREE.JSONLoader instead.'):void qu.parse(Ju,ku)},Wu,ju)},setPath:function(Vu){return this.path=Vu,this},setResourcePath:function(Vu){return this.resourcePath=Vu,this},setCrossOrigin:function(Vu){return this.crossOrigin=Vu,this},parse:function(Vu,ku){var Wu=this.parseShape(Vu.shapes),ju=this.parseGeometries(Vu.geometries,Wu),qu=this.parseImages(Vu.images,function(){void 0!==ku&&ku(Zu)}),Xu=this.parseTextures(Vu.textures,qu),Yu=this.parseMaterials(Vu.materials,Xu),Zu=this.parseObject(Vu.object,ju,Yu);return Vu.animations&&(Zu.animations=this.parseAnimations(Vu.animations)),(void 0===Vu.images||0===Vu.images.length)&&void 0!==ku&&ku(Zu),Zu},parseShape:function(Vu){var ku={};if(Vu!==void 0)for(var Wu=0,ju=Vu.length,qu;Wu<ju;Wu++)qu=new oi().fromJSON(Vu[Wu]),ku[qu.uuid]=qu;return ku},parseGeometries:function(Vu,ku){var Wu={};if(Vu!==void 0)for(var ju=new _i,qu=new xi,Xu=0,Yu=Vu.length;Xu<Yu;Xu++){var Ju=Vu[Xu],Zu;switch(Ju.type){case'PlaneGeometry':case'PlaneBufferGeometry':Zu=new uu[Ju.type](Ju.width,Ju.height,Ju.widthSegments,Ju.heightSegments);break;case'BoxGeometry':case'BoxBufferGeometry':case'CubeGeometry':Zu=new uu[Ju.type](Ju.width,Ju.height,Ju.depth,Ju.widthSegments,Ju.heightSegments,Ju.depthSegments);break;case'CircleGeometry':case'CircleBufferGeometry':Zu=new uu[Ju.type](Ju.radius,Ju.segments,Ju.thetaStart,Ju.thetaLength);break;case'CylinderGeometry':case'CylinderBufferGeometry':Zu=new uu[Ju.type](Ju.radiusTop,Ju.radiusBottom,Ju.height,Ju.radialSegments,Ju.heightSegments,Ju.openEnded,Ju.thetaStart,Ju.thetaLength);break;case'ConeGeometry':case'ConeBufferGeometry':Zu=new uu[Ju.type](Ju.radius,Ju.height,Ju.radialSegments,Ju.heightSegments,Ju.openEnded,Ju.thetaStart,Ju.thetaLength);break;case'SphereGeometry':case'SphereBufferGeometry':Zu=new uu[Ju.type](Ju.radius,Ju.widthSegments,Ju.heightSegments,Ju.phiStart,Ju.phiLength,Ju.thetaStart,Ju.thetaLength);break;case'DodecahedronGeometry':case'DodecahedronBufferGeometry':case'IcosahedronGeometry':case'IcosahedronBufferGeometry':case'OctahedronGeometry':case'OctahedronBufferGeometry':case'TetrahedronGeometry':case'TetrahedronBufferGeometry':Zu=new uu[Ju.type](Ju.radius,Ju.detail);break;case'RingGeometry':case'RingBufferGeometry':Zu=new uu[Ju.type](Ju.innerRadius,Ju.outerRadius,Ju.thetaSegments,Ju.phiSegments,Ju.thetaStart,Ju.thetaLength);break;case'TorusGeometry':case'TorusBufferGeometry':Zu=new uu[Ju.type](Ju.radius,Ju.tube,Ju.radialSegments,Ju.tubularSegments,Ju.arc);break;case'TorusKnotGeometry':case'TorusKnotBufferGeometry':Zu=new uu[Ju.type](Ju.radius,Ju.tube,Ju.tubularSegments,Ju.radialSegments,Ju.p,Ju.q);break;case'LatheGeometry':case'LatheBufferGeometry':Zu=new uu[Ju.type](Ju.points,Ju.segments,Ju.phiStart,Ju.phiLength);break;case'PolyhedronGeometry':case'PolyhedronBufferGeometry':Zu=new uu[Ju.type](Ju.vertices,Ju.indices,Ju.radius,Ju.details);break;case'ShapeGeometry':case'ShapeBufferGeometry':for(var Qu=[],Ku=0,$u=Ju.shapes.length,em;Ku<$u;Ku++)em=ku[Ju.shapes[Ku]],Qu.push(em);Zu=new uu[Ju.type](Qu,Ju.curveSegments);break;case'ExtrudeGeometry':case'ExtrudeBufferGeometry':for(var Qu=[],Ku=0,$u=Ju.shapes.length,em;Ku<$u;Ku++)em=ku[Ju.shapes[Ku]],Qu.push(em);var tm=Ju.options.extrudePath;void 0!==tm&&(Ju.options.extrudePath=new Mu[tm.type]().fromJSON(tm)),Zu=new uu[Ju.type](Qu,Ju.options);break;case'BufferGeometry':Zu=qu.parse(Ju);break;case'Geometry':Zu=ju.parse(Ju,this.resourcePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Ju.type+'"');continue;}Zu.uuid=Ju.uuid,void 0!==Ju.name&&(Zu.name=Ju.name),!0===Zu.isBufferGeometry&&void 0!==Ju.userData&&(Zu.userData=Ju.userData),Wu[Ju.uuid]=Zu}return Wu},parseMaterials:function(Vu,ku){var Wu={},ju={};if(Vu!==void 0){var qu=new yi;qu.setTextures(ku);for(var Xu=0,Yu=Vu.length,Zu;Xu<Yu;Xu++)if(Zu=Vu[Xu],'MultiMaterial'===Zu.type){for(var Ju=[],Qu=0,Ku;Qu<Zu.materials.length;Qu++)Ku=Zu.materials[Qu],void 0===Wu[Ku.uuid]&&(Wu[Ku.uuid]=qu.parse(Ku)),Ju.push(Wu[Ku.uuid]);ju[Zu.uuid]=Ju}else ju[Zu.uuid]=qu.parse(Zu),Wu[Zu.uuid]=ju[Zu.uuid]}return ju},parseAnimations:function(Vu){for(var ku=[],Wu=0;Wu<Vu.length;Wu++){var ju=Vu[Wu],qu=So.parse(ju);ju.uuid!==void 0&&(qu.uuid=ju.uuid),ku.push(qu)}return ku},parseImages:function(Vu,ku){function Wu(am){return ju.manager.itemStart(am),Yu.load(am,function(){ju.manager.itemEnd(am)},void 0,function(){ju.manager.itemError(am),ju.manager.itemEnd(am)})}var ju=this,qu={};if(Vu!==void 0&&0<Vu.length){var Xu=new wo(ku),Yu=new Ro(Xu);Yu.setCrossOrigin(this.crossOrigin);for(var Zu=0,Ju=Vu.length;Zu<Ju;Zu++){var Qu=Vu[Zu],Ku=Qu.url;if(Array.isArray(Ku)){qu[Qu.uuid]=[];for(var $u=0,em=Ku.length;$u<em;$u++){var tm=Ku[$u],rm=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(tm)?tm:ju.resourcePath+tm;qu[Qu.uuid].push(Wu(rm))}}else{var rm=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Qu.url)?Qu.url:ju.resourcePath+Qu.url;qu[Qu.uuid]=Wu(rm)}}}return qu},parseTextures:function(Vu,ku){function Wu(Ju,Qu){return'number'==typeof Ju?Ju:(console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.',Ju),Qu[Ju])}var ju={};if(Vu!==void 0)for(var qu=0,Xu=Vu.length,Yu;qu<Xu;qu++){Yu=Vu[qu],void 0===Yu.image&&console.warn('THREE.ObjectLoader: No "image" specified for',Yu.uuid),void 0===ku[Yu.image]&&console.warn('THREE.ObjectLoader: Undefined image',Yu.image);var Zu;Zu=Array.isArray(ku[Yu.image])?new He(ku[Yu.image]):new R(ku[Yu.image]),Zu.needsUpdate=!0,Zu.uuid=Yu.uuid,void 0!==Yu.name&&(Zu.name=Yu.name),void 0!==Yu.mapping&&(Zu.mapping=Wu(Yu.mapping,Eu)),void 0!==Yu.offset&&Zu.offset.fromArray(Yu.offset),void 0!==Yu.repeat&&Zu.repeat.fromArray(Yu.repeat),void 0!==Yu.center&&Zu.center.fromArray(Yu.center),void 0!==Yu.rotation&&(Zu.rotation=Yu.rotation),void 0!==Yu.wrap&&(Zu.wrapS=Wu(Yu.wrap[0],wu),Zu.wrapT=Wu(Yu.wrap[1],wu)),void 0!==Yu.format&&(Zu.format=Yu.format),void 0!==Yu.minFilter&&(Zu.minFilter=Wu(Yu.minFilter,Lu)),void 0!==Yu.magFilter&&(Zu.magFilter=Wu(Yu.magFilter,Lu)),void 0!==Yu.anisotropy&&(Zu.anisotropy=Yu.anisotropy),void 0!==Yu.flipY&&(Zu.flipY=Yu.flipY),ju[Yu.uuid]=Zu}return ju},parseObject:function(Vu,ku,Wu){function ju(rm){return void 0===ku[rm]&&console.warn('THREE.ObjectLoader: Undefined geometry',rm),ku[rm]}function qu(rm){if(void 0!==rm){if(Array.isArray(rm)){for(var am=[],om=0,im=rm.length,nm;om<im;om++)nm=rm[om],void 0===Wu[nm]&&console.warn('THREE.ObjectLoader: Undefined material',nm),am.push(Wu[nm]);return am}return void 0===Wu[rm]&&console.warn('THREE.ObjectLoader: Undefined material',rm),Wu[rm]}}var Xu;switch(Vu.type){case'Scene':Xu=new gr,void 0!==Vu.background&&Number.isInteger(Vu.background)&&(Xu.background=new W(Vu.background)),void 0!==Vu.fog&&('Fog'===Vu.fog.type?Xu.fog=new mr(Vu.fog.color,Vu.fog.near,Vu.fog.far):'FogExp2'===Vu.fog.type&&(Xu.fog=new ur(Vu.fog.color,Vu.fog.density)));break;case'PerspectiveCamera':Xu=new nr(Vu.fov,Vu.aspect,Vu.near,Vu.far),void 0!==Vu.focus&&(Xu.focus=Vu.focus),void 0!==Vu.zoom&&(Xu.zoom=Vu.zoom),void 0!==Vu.filmGauge&&(Xu.filmGauge=Vu.filmGauge),void 0!==Vu.filmOffset&&(Xu.filmOffset=Vu.filmOffset),void 0!==Vu.view&&(Xu.view=Object.assign({},Vu.view));break;case'OrthographicCamera':Xu=new ci(Vu.left,Vu.right,Vu.top,Vu.bottom,Vu.near,Vu.far),void 0!==Vu.zoom&&(Xu.zoom=Vu.zoom),void 0!==Vu.view&&(Xu.view=Object.assign({},Vu.view));break;case'AmbientLight':Xu=new gi(Vu.color,Vu.intensity);break;case'DirectionalLight':Xu=new mi(Vu.color,Vu.intensity);break;case'PointLight':Xu=new di(Vu.color,Vu.intensity,Vu.distance,Vu.decay);break;case'RectAreaLight':Xu=new hi(Vu.color,Vu.intensity,Vu.width,Vu.height);break;case'SpotLight':Xu=new pi(Vu.color,Vu.intensity,Vu.distance,Vu.angle,Vu.penumbra,Vu.decay);break;case'HemisphereLight':Xu=new ni(Vu.color,Vu.groundColor,Vu.intensity);break;case'SkinnedMesh':console.warn('THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.');case'Mesh':var Yu=ju(Vu.geometry),Zu=qu(Vu.material);Xu=Yu.bones&&0<Yu.bones.length?new Sr(Yu,Zu):new Pe(Yu,Zu);break;case'LOD':Xu=new _r;break;case'Line':Xu=new Er(ju(Vu.geometry),qu(Vu.material),Vu.mode);break;case'LineLoop':Xu=new Lr(ju(Vu.geometry),qu(Vu.material));break;case'LineSegments':Xu=new wr(ju(Vu.geometry),qu(Vu.material));break;case'PointCloud':case'Points':Xu=new Pr(ju(Vu.geometry),qu(Vu.material));break;case'Sprite':Xu=new xr(qu(Vu.material));break;case'Group':Xu=new or;break;default:Xu=new K;}if(Xu.uuid=Vu.uuid,void 0!==Vu.name&&(Xu.name=Vu.name),void 0===Vu.matrix?(void 0!==Vu.position&&Xu.position.fromArray(Vu.position),void 0!==Vu.rotation&&Xu.rotation.fromArray(Vu.rotation),void 0!==Vu.quaternion&&Xu.quaternion.fromArray(Vu.quaternion),void 0!==Vu.scale&&Xu.scale.fromArray(Vu.scale)):(Xu.matrix.fromArray(Vu.matrix),void 0!==Vu.matrixAutoUpdate&&(Xu.matrixAutoUpdate=Vu.matrixAutoUpdate),Xu.matrixAutoUpdate&&Xu.matrix.decompose(Xu.position,Xu.quaternion,Xu.scale)),void 0!==Vu.castShadow&&(Xu.castShadow=Vu.castShadow),void 0!==Vu.receiveShadow&&(Xu.receiveShadow=Vu.receiveShadow),Vu.shadow&&(void 0!==Vu.shadow.bias&&(Xu.shadow.bias=Vu.shadow.bias),void 0!==Vu.shadow.radius&&(Xu.shadow.radius=Vu.shadow.radius),void 0!==Vu.shadow.mapSize&&Xu.shadow.mapSize.fromArray(Vu.shadow.mapSize),void 0!==Vu.shadow.camera&&(Xu.shadow.camera=this.parseObject(Vu.shadow.camera))),void 0!==Vu.visible&&(Xu.visible=Vu.visible),void 0!==Vu.frustumCulled&&(Xu.frustumCulled=Vu.frustumCulled),void 0!==Vu.renderOrder&&(Xu.renderOrder=Vu.renderOrder),void 0!==Vu.userData&&(Xu.userData=Vu.userData),void 0!==Vu.layers&&(Xu.layers.mask=Vu.layers),void 0!==Vu.children)for(var Ju=Vu.children,Qu=0;Qu<Ju.length;Qu++)Xu.add(this.parseObject(Ju[Qu],ku,Wu));if('LOD'===Vu.type)for(var Ku=Vu.levels,$u=0;$u<Ku.length;$u++){var em=Ku[$u],tm=Xu.getObjectByProperty('uuid',em.object);void 0!==tm&&Xu.addLevel(tm,em.distance)}return Xu}});var Eu={UVMapping:Ls,CubeReflectionMapping:As,CubeRefractionMapping:Ps,EquirectangularReflectionMapping:Cs,EquirectangularRefractionMapping:Rs,SphericalReflectionMapping:Is,CubeUVReflectionMapping:Ds,CubeUVRefractionMapping:zs},wu={RepeatWrapping:Ns,ClampToEdgeWrapping:Bs,MirroredRepeatWrapping:Us},Lu={NearestFilter:Gs,NearestMipMapNearestFilter:Os,NearestMipMapLinearFilter:Fs,LinearFilter:Hs,LinearMipMapNearestFilter:Vs,LinearMipMapLinearFilter:ks};Object.assign(Mi.prototype,{moveTo:function(Vu,ku){this.currentPath=new ai,this.subPaths.push(this.currentPath),this.currentPath.moveTo(Vu,ku)},lineTo:function(Vu,ku){this.currentPath.lineTo(Vu,ku)},quadraticCurveTo:function(Vu,ku,Wu,ju){this.currentPath.quadraticCurveTo(Vu,ku,Wu,ju)},bezierCurveTo:function(Vu,ku,Wu,ju,qu,Xu){this.currentPath.bezierCurveTo(Vu,ku,Wu,ju,qu,Xu)},splineThru:function(Vu){this.currentPath.splineThru(Vu)},toShapes:function(Vu,ku){function Wu(vm){for(var _m=[],bm=0,Mm=vm.length;bm<Mm;bm++){var Sm=vm[bm],Tm=new oi;Tm.curves=Sm.curves,_m.push(Tm)}return _m}function ju(vm,_m){for(var bm=_m.length,Mm=!1,Sm=bm-1,Tm=0;Tm<bm;Sm=Tm++){var Em=_m[Sm],wm=_m[Tm],Lm=wm.x-Em.x,Am=wm.y-Em.y;if(Math.abs(Am)>Number.EPSILON){if(0>Am&&(Em=_m[Tm],Lm=-Lm,wm=_m[Sm],Am=-Am),vm.y<Em.y||vm.y>wm.y)continue;if(vm.y!==Em.y){var Pm=Am*(vm.x-Em.x)-Lm*(vm.y-Em.y);if(0==Pm)return!0;if(0>Pm)continue;Mm=!Mm}else if(vm.x===Em.x)return!0}else{if(vm.y!==Em.y)continue;if(wm.x<=vm.x&&vm.x<=Em.x||Em.x<=vm.x&&vm.x<=wm.x)return!0}}return Mm}var qu=lu.isClockWise,Xu=this.subPaths;if(0===Xu.length)return[];if(!0===ku)return Wu(Xu);var Qu=[],Yu,Zu,Ju;if(1===Xu.length)return Zu=Xu[0],Ju=new oi,Ju.curves=Zu.curves,Qu.push(Ju),Qu;var Ku=!qu(Xu[0].getPoints());Ku=Vu?!Ku:Ku;var $u=[],em=[],tm=[],rm=0,am;em[rm]=void 0,tm[rm]=[];for(var om=0,im=Xu.length;om<im;om++)Zu=Xu[om],am=Zu.getPoints(),Yu=qu(am),Yu=Vu?!Yu:Yu,Yu?(!Ku&&em[rm]&&rm++,em[rm]={s:new oi,p:am},em[rm].s.curves=Zu.curves,Ku&&rm++,tm[rm]=[]):tm[rm].push({h:Zu,p:am[0]});if(!em[0])return Wu(Xu);if(1<em.length){for(var nm=!1,sm=[],lm=0,pm=em.length;lm<pm;lm++)$u[lm]=[];for(var lm=0,pm=em.length,dm;lm<pm;lm++){dm=tm[lm];for(var cm=0;cm<dm.length;cm++){for(var um=dm[cm],mm=!0,gm=0;gm<em.length;gm++)ju(um.p,em[gm].p)&&(lm!==gm&&sm.push({froms:lm,tos:gm,hole:cm}),mm?(mm=!1,$u[gm].push(um)):nm=!0);mm&&$u[lm].push(um)}}0<sm.length&&!nm&&(tm=$u)}for(var om=0,hm=em.length,fm;om<hm;om++){Ju=em[om].s,Qu.push(Ju),fm=tm[om];for(var ym=0,xm=fm.length;ym<xm;ym++)Ju.holes.push(fm[ym].h)}return Qu}}),Object.assign(Si.prototype,{isFont:!0,generateShapes:function(Vu,ku){ku===void 0&&(ku=100);for(var Wu=[],ju=Ti(Vu,ku,this.data),qu=0,Xu=ju.length;qu<Xu;qu++)Array.prototype.push.apply(Wu,ju[qu].toShapes());return Wu}}),Object.assign(function(Vu){this.manager=Vu===void 0?hu:Vu}.prototype,{load:function(Vu,ku,Wu,ju){var qu=this,Xu=new Lo(this.manager);Xu.setPath(this.path),Xu.load(Vu,function(Yu){var Zu;try{Zu=JSON.parse(Yu)}catch(Qu){console.warn('THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.'),Zu=JSON.parse(Yu.substring(65,Yu.length-2))}var Ju=qu.parse(Zu);ku&&ku(Ju)},Wu,ju)},parse:function(Vu){return new Si(Vu)},setPath:function(Vu){return this.path=Vu,this}});var Au,Pu={getContext:function(){return void 0==Au&&(Au=new(window.AudioContext||window.webkitAudioContext)),Au},setContext:function(Vu){Au=Vu}};Object.assign(Li.prototype,{load:function(Vu,ku,Wu,ju){var qu=new Lo(this.manager);qu.setResponseType('arraybuffer'),qu.setPath(this.path),qu.load(Vu,function(Xu){var Yu=Xu.slice(0),Zu=Pu.getContext();Zu.decodeAudioData(Yu,function(Ju){ku(Ju)})},Wu,ju)},setPath:function(Vu){return this.path=Vu,this}}),Object.assign(function(){this.type='StereoCamera',this.aspect=1,this.eyeSep=0.064,this.cameraL=new nr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new nr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}.prototype,{update:function(){var Vu,ku,Wu,ju,qu,Xu,Yu,Zu,Ju=new E,Qu=new E;return function($u){var em=Vu!==this||ku!==$u.focus||Wu!==$u.fov||ju!==$u.aspect*this.aspect||qu!==$u.near||Xu!==$u.far||Yu!==$u.zoom||Zu!==this.eyeSep;if(em){Vu=this,ku=$u.focus,Wu=$u.fov,ju=$u.aspect*this.aspect,qu=$u.near,Xu=$u.far,Yu=$u.zoom;var tm=$u.projectionMatrix.clone();Zu=this.eyeSep/2;var rm=Zu*qu/ku,am=qu*Math.tan(0.5*(hp.DEG2RAD*Wu))/Yu,om,im;Qu.elements[12]=-Zu,Ju.elements[12]=Zu,om=-am*ju+rm,im=am*ju+rm,tm.elements[0]=2*qu/(im-om),tm.elements[8]=(im+om)/(im-om),this.cameraL.projectionMatrix.copy(tm),om=-am*ju-rm,im=am*ju-rm,tm.elements[0]=2*qu/(im-om),tm.elements[8]=(im+om)/(im-om),this.cameraR.projectionMatrix.copy(tm)}this.cameraL.matrixWorld.copy($u.matrixWorld).multiply(Qu),this.cameraR.matrixWorld.copy($u.matrixWorld).multiply(Ju)}}()}),Pi.prototype=Object.create(K.prototype),Pi.prototype.constructor=Pi,Object.assign(Ci.prototype,{start:function(){this.startTime=('undefined'==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var Vu=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var ku=('undefined'==typeof performance?Date:performance).now();Vu=(ku-this.oldTime)/1e3,this.oldTime=ku,this.elapsedTime+=Vu}return Vu}}),Ri.prototype=Object.assign(Object.create(K.prototype),{constructor:Ri,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(Vu){return null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=Vu,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(Vu){return this.gain.gain.setTargetAtTime(Vu,this.context.currentTime,0.01),this},updateMatrixWorld:function(){var Vu=new A,ku=new L,Wu=new A,ju=new A,qu=new Ci;return function(Yu){K.prototype.updateMatrixWorld.call(this,Yu);var Zu=this.context.listener,Ju=this.up;if(this.timeDelta=qu.getDelta(),this.matrixWorld.decompose(Vu,ku,Wu),ju.set(0,0,-1).applyQuaternion(ku),Zu.positionX){var Qu=this.context.currentTime+this.timeDelta;Zu.positionX.linearRampToValueAtTime(Vu.x,Qu),Zu.positionY.linearRampToValueAtTime(Vu.y,Qu),Zu.positionZ.linearRampToValueAtTime(Vu.z,Qu),Zu.forwardX.linearRampToValueAtTime(ju.x,Qu),Zu.forwardY.linearRampToValueAtTime(ju.y,Qu),Zu.forwardZ.linearRampToValueAtTime(ju.z,Qu),Zu.upX.linearRampToValueAtTime(Ju.x,Qu),Zu.upY.linearRampToValueAtTime(Ju.y,Qu),Zu.upZ.linearRampToValueAtTime(Ju.z,Qu)}else Zu.setPosition(Vu.x,Vu.y,Vu.z),Zu.setOrientation(ju.x,ju.y,ju.z,Ju.x,Ju.y,Ju.z)}}()}),Ii.prototype=Object.assign(Object.create(K.prototype),{constructor:Ii,getOutput:function(){return this.gain},setNodeSource:function(Vu){return this.hasPlaybackControl=!1,this.sourceType='audioNode',this.source=Vu,this.connect(),this},setMediaElementSource:function(Vu){return this.hasPlaybackControl=!1,this.sourceType='mediaNode',this.source=this.context.createMediaElementSource(Vu),this.connect(),this},setBuffer:function(Vu){return this.buffer=Vu,this.sourceType='buffer',this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var Vu=this.context.createBufferSource();return Vu.buffer=this.buffer,Vu.loop=this.loop,Vu.onended=this.onEnded.bind(this),Vu.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,Vu.start(this.startTime,this.offset),this.isPlaying=!0,this.source=Vu,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var Vu=1,ku=this.filters.length;Vu<ku;Vu++)this.filters[Vu-1].connect(this.filters[Vu]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var Vu=1,ku=this.filters.length;Vu<ku;Vu++)this.filters[Vu-1].disconnect(this.filters[Vu]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(Vu){return Vu||(Vu=[]),!0===this.isPlaying?(this.disconnect(),this.filters=Vu,this.connect()):this.filters=Vu,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(Vu){return this.setFilters(Vu?[Vu]:[])},setPlaybackRate:function(Vu){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.playbackRate=Vu,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn('THREE.Audio: this Audio has no playback control.'),!1):this.loop},setLoop:function(Vu){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.loop=Vu,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(Vu){return this.gain.gain.setTargetAtTime(Vu,this.context.currentTime,0.01),this}}),Di.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Di,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(Vu){return this.panner.refDistance=Vu,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(Vu){return this.panner.rolloffFactor=Vu,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(Vu){return this.panner.distanceModel=Vu,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(Vu){return this.panner.maxDistance=Vu,this},setDirectionalCone:function(Vu,ku,Wu){return this.panner.coneInnerAngle=Vu,this.panner.coneOuterAngle=ku,this.panner.coneOuterGain=Wu,this},updateMatrixWorld:function(){var Vu=new A,ku=new L,Wu=new A,ju=new A;return function(Xu){K.prototype.updateMatrixWorld.call(this,Xu);var Yu=this.panner;if(this.matrixWorld.decompose(Vu,ku,Wu),ju.set(0,0,1).applyQuaternion(ku),Yu.positionX){var Zu=this.context.currentTime+this.listener.timeDelta;Yu.positionX.linearRampToValueAtTime(Vu.x,Zu),Yu.positionY.linearRampToValueAtTime(Vu.y,Zu),Yu.positionZ.linearRampToValueAtTime(Vu.z,Zu),Yu.orientationX.linearRampToValueAtTime(ju.x,Zu),Yu.orientationY.linearRampToValueAtTime(ju.y,Zu),Yu.orientationZ.linearRampToValueAtTime(ju.z,Zu)}else Yu.setPosition(Vu.x,Vu.y,Vu.z),Yu.setOrientation(ju.x,ju.y,ju.z)}}()}),Object.assign(zi.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var Vu=0,ku=this.getFrequencyData(),Wu=0;Wu<ku.length;Wu++)Vu+=ku[Wu];return Vu/ku.length}}),Object.assign(Ni.prototype,{accumulate:function(Vu,ku){var Wu=this.buffer,ju=this.valueSize,qu=Vu*ju+ju,Xu=this.cumulativeWeight;if(0===Xu){for(var Yu=0;Yu!==ju;++Yu)Wu[qu+Yu]=Wu[Yu];Xu=ku}else{Xu+=ku;var Zu=ku/Xu;this._mixBufferRegion(Wu,qu,0,Zu,ju)}this.cumulativeWeight=Xu},apply:function(Vu){var ku=this.valueSize,Wu=this.buffer,ju=Vu*ku+ku,qu=this.cumulativeWeight,Xu=this.binding;if(this.cumulativeWeight=0,1>qu){this._mixBufferRegion(Wu,ju,3*ku,1-qu,ku)}for(var Zu=ku;Zu!==ku+ku;++Zu)if(Wu[Zu]!==Wu[Zu+ku]){Xu.setValue(Wu,ju);break}},saveOriginalState:function(){var Vu=this.binding,ku=this.buffer,Wu=this.valueSize,ju=3*Wu;Vu.getValue(ku,ju);for(var qu=Wu;qu!==ju;++qu)ku[qu]=ku[ju+qu%Wu];this.cumulativeWeight=0},restoreOriginalState:function(){var Vu=3*this.valueSize;this.binding.setValue(this.buffer,Vu)},_select:function(Vu,ku,Wu,ju,qu){if(0.5<=ju)for(var Xu=0;Xu!==qu;++Xu)Vu[ku+Xu]=Vu[Wu+Xu]},_slerp:function(Vu,ku,Wu,ju){L.slerpFlat(Vu,ku,Vu,ku,Vu,Wu,ju)},_lerp:function(Vu,ku,Wu,ju,qu){for(var Yu=0,Zu;Yu!==qu;++Yu)Zu=ku+Yu,Vu[Zu]=Vu[Zu]*(1-ju)+Vu[Wu+Yu]*ju}});var Cu='\\[\\]\\.:\\/';Object.assign(Bi.prototype,{getValue:function(Vu,ku){this.bind();var Wu=this._targetGroup.nCachedObjects_,ju=this._bindings[Wu];ju!==void 0&&ju.getValue(Vu,ku)},setValue:function(Vu,ku){for(var Wu=this._bindings,ju=this._targetGroup.nCachedObjects_,qu=Wu.length;ju!==qu;++ju)Wu[ju].setValue(Vu,ku)},bind:function(){for(var Vu=this._bindings,ku=this._targetGroup.nCachedObjects_,Wu=Vu.length;ku!==Wu;++ku)Vu[ku].bind()},unbind:function(){for(var Vu=this._bindings,ku=this._targetGroup.nCachedObjects_,Wu=Vu.length;ku!==Wu;++ku)Vu[ku].unbind()}}),Object.assign(Ui,{Composite:Bi,create:function(Vu,ku,Wu){return Vu&&Vu.isAnimationObjectGroup?new Ui.Composite(Vu,ku,Wu):new Ui(Vu,ku,Wu)},sanitizeNodeName:function(){var Vu=/[\[\]\.:\/]/g;return function(Wu){return Wu.replace(/\s/g,'_').replace(Vu,'')}}(),parseTrackName:function(){var Vu='[^'+Cu+']',ku='[^'+Cu.replace('\\.','')+']',Wu=/((?:WC+[\/:])*)/.source.replace('WC',Vu),ju=/(WCOD+)?/.source.replace('WCOD',ku),qu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace('WC',Vu),Xu=/\.(WC+)(?:\[(.+)\])?/.source.replace('WC',Vu),Yu=new RegExp('^'+Wu+ju+qu+Xu+'$'),Zu=['material','materials','bones'];return function(Qu){var Ku=Yu.exec(Qu);if(!Ku)throw new Error('PropertyBinding: Cannot parse trackName: '+Qu);var $u={nodeName:Ku[2],objectName:Ku[3],objectIndex:Ku[4],propertyName:Ku[5],propertyIndex:Ku[6]},em=$u.nodeName&&$u.nodeName.lastIndexOf('.');if(em!==void 0&&-1!==em){var tm=$u.nodeName.substring(em+1);-1!==Zu.indexOf(tm)&&($u.nodeName=$u.nodeName.substring(0,em),$u.objectName=tm)}if(null===$u.propertyName||0===$u.propertyName.length)throw new Error('PropertyBinding: can not parse propertyName from trackName: '+Qu);return $u}}(),findNode:function(Vu,ku){if(!ku||''===ku||'root'===ku||'.'===ku||-1===ku||ku===Vu.name||ku===Vu.uuid)return Vu;if(Vu.skeleton){var Wu=Vu.skeleton.getBoneByName(ku);if(void 0!==Wu)return Wu}if(Vu.children){var ju=function(Xu){for(var Yu=0,Zu;Yu<Xu.length;Yu++){if(Zu=Xu[Yu],Zu.name===ku||Zu.uuid===ku)return Zu;var Ju=ju(Zu.children);if(Ju)return Ju}return null},qu=ju(Vu.children);if(qu)return qu}return null}}),Object.assign(Ui.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(ku,Wu){ku[Wu]=this.node[this.propertyName]},function(ku,Wu){for(var ju=this.resolvedProperty,qu=0,Xu=ju.length;qu!==Xu;++qu)ku[Wu++]=ju[qu]},function(ku,Wu){ku[Wu]=this.resolvedProperty[this.propertyIndex]},function(ku,Wu){this.resolvedProperty.toArray(ku,Wu)}],SetterByBindingTypeAndVersioning:[[function(ku,Wu){this.targetObject[this.propertyName]=ku[Wu]},function(ku,Wu){this.targetObject[this.propertyName]=ku[Wu],this.targetObject.needsUpdate=!0},function(ku,Wu){this.targetObject[this.propertyName]=ku[Wu],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ku,Wu){for(var ju=this.resolvedProperty,qu=0,Xu=ju.length;qu!==Xu;++qu)ju[qu]=ku[Wu++]},function(ku,Wu){for(var ju=this.resolvedProperty,qu=0,Xu=ju.length;qu!==Xu;++qu)ju[qu]=ku[Wu++];this.targetObject.needsUpdate=!0},function(ku,Wu){for(var ju=this.resolvedProperty,qu=0,Xu=ju.length;qu!==Xu;++qu)ju[qu]=ku[Wu++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ku,Wu){this.resolvedProperty[this.propertyIndex]=ku[Wu]},function(ku,Wu){this.resolvedProperty[this.propertyIndex]=ku[Wu],this.targetObject.needsUpdate=!0},function(ku,Wu){this.resolvedProperty[this.propertyIndex]=ku[Wu],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ku,Wu){this.resolvedProperty.fromArray(ku,Wu)},function(ku,Wu){this.resolvedProperty.fromArray(ku,Wu),this.targetObject.needsUpdate=!0},function(ku,Wu){this.resolvedProperty.fromArray(ku,Wu),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(ku,Wu){this.bind(),this.getValue(ku,Wu)},setValue:function(ku,Wu){this.bind(),this.setValue(ku,Wu)},bind:function(){var Vu=this.node,ku=this.parsedPath,Wu=ku.objectName,ju=ku.propertyName,qu=ku.propertyIndex;if(Vu||(Vu=Ui.findNode(this.rootNode,ku.nodeName)||this.rootNode,this.node=Vu),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!Vu)return void console.error('THREE.PropertyBinding: Trying to update node for track: '+this.path+' but it wasn\'t found.');if(Wu){var Xu=ku.objectIndex;switch(Wu){case'materials':if(!Vu.material)return void console.error('THREE.PropertyBinding: Can not bind to material as node does not have a material.',this);if(!Vu.material.materials)return void console.error('THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.',this);Vu=Vu.material.materials;break;case'bones':if(!Vu.skeleton)return void console.error('THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.',this);Vu=Vu.skeleton.bones;for(var Yu=0;Yu<Vu.length;Yu++)if(Vu[Yu].name===Xu){Xu=Yu;break}break;default:if(void 0===Vu[Wu])return void console.error('THREE.PropertyBinding: Can not bind to objectName of node undefined.',this);Vu=Vu[Wu];}if(void 0!==Xu){if(void 0===Vu[Xu])return void console.error('THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.',this,Vu);Vu=Vu[Xu]}}var Zu=Vu[ju];if(void 0===Zu){var Ju=ku.nodeName;return void console.error('THREE.PropertyBinding: Trying to update property for track: '+Ju+'.'+ju+' but it wasn\'t found.',Vu)}var Qu=this.Versioning.None;this.targetObject=Vu,void 0===Vu.needsUpdate?void 0!==Vu.matrixWorldNeedsUpdate&&(Qu=this.Versioning.MatrixWorldNeedsUpdate):Qu=this.Versioning.NeedsUpdate;var Ku=this.BindingType.Direct;if(void 0!==qu){if('morphTargetInfluences'===ju){if(!Vu.geometry)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.',this);if(Vu.geometry.isBufferGeometry){if(!Vu.geometry.morphAttributes)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.',this);for(var Yu=0;Yu<this.node.geometry.morphAttributes.position.length;Yu++)if(Vu.geometry.morphAttributes.position[Yu].name===qu){qu=Yu;break}}else{if(!Vu.geometry.morphTargets)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.',this);for(var Yu=0;Yu<this.node.geometry.morphTargets.length;Yu++)if(Vu.geometry.morphTargets[Yu].name===qu){qu=Yu;break}}}Ku=this.BindingType.ArrayElement,this.resolvedProperty=Zu,this.propertyIndex=qu}else void 0!==Zu.fromArray&&void 0!==Zu.toArray?(Ku=this.BindingType.HasFromToArray,this.resolvedProperty=Zu):Array.isArray(Zu)?(Ku=this.BindingType.EntireArray,this.resolvedProperty=Zu):this.propertyName=ju;this.getValue=this.GetterByBindingType[Ku],this.setValue=this.SetterByBindingTypeAndVersioning[Ku][Qu]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ui.prototype,{_getValue_unbound:Ui.prototype.getValue,_setValue_unbound:Ui.prototype.setValue}),Object.assign(function(){this.uuid=hp.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var Vu={};this._indicesByUUID=Vu;for(var ku=0,Wu=arguments.length;ku!==Wu;++ku)Vu[arguments[ku].uuid]=ku;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var ju=this;this.stats={objects:{get total(){return ju._objects.length},get inUse(){return this.total-ju.nCachedObjects_}},get bindingsPerObject(){return ju._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var Vu=this._objects,ku=Vu.length,Wu=this.nCachedObjects_,ju=this._indicesByUUID,qu=this._paths,Xu=this._parsedPaths,Yu=this._bindings,Zu=Yu.length,Ju=void 0,Qu=0,Ku=arguments.length;Qu!==Ku;++Qu){var $u=arguments[Qu],em=$u.uuid,tm=ju[em];if(tm===void 0){tm=ku++,ju[em]=tm,Vu.push($u);for(var rm=0,am=Zu;rm!==am;++rm)Yu[rm].push(new Ui($u,qu[rm],Xu[rm]))}else if(tm<Wu){Ju=Vu[tm];var om=--Wu,im=Vu[om];ju[im.uuid]=tm,Vu[tm]=im,ju[em]=om,Vu[om]=$u;for(var rm=0,am=Zu;rm!==am;++rm){var nm=Yu[rm],sm=nm[om],lm=nm[tm];nm[tm]=sm,lm===void 0&&(lm=new Ui($u,qu[rm],Xu[rm])),nm[om]=lm}}else Vu[tm]!==Ju&&console.error('THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.')}this.nCachedObjects_=Wu},remove:function(){for(var Vu=this._objects,ku=this.nCachedObjects_,Wu=this._indicesByUUID,ju=this._bindings,qu=ju.length,Xu=0,Yu=arguments.length;Xu!==Yu;++Xu){var Zu=arguments[Xu],Ju=Zu.uuid,Qu=Wu[Ju];if(Qu!==void 0&&Qu>=ku){var Ku=ku++,$u=Vu[Ku];Wu[$u.uuid]=Qu,Vu[Qu]=$u,Wu[Ju]=Ku,Vu[Ku]=Zu;for(var em=0;em!==qu;++em){var rm=ju[em],am=rm[Ku],om=rm[Qu];rm[Qu]=am,rm[Ku]=om}}}this.nCachedObjects_=ku},uncache:function(){for(var Vu=this._objects,ku=Vu.length,Wu=this.nCachedObjects_,ju=this._indicesByUUID,qu=this._bindings,Xu=qu.length,Yu=0,Zu=arguments.length;Yu!==Zu;++Yu){var Ju=arguments[Yu],Qu=Ju.uuid,Ku=ju[Qu];if(void 0!==Ku)if(delete ju[Qu],Ku<Wu){var $u=--Wu,em=Vu[$u],tm=--ku,rm=Vu[tm];ju[em.uuid]=Ku,Vu[Ku]=em,ju[rm.uuid]=$u,Vu[$u]=rm,Vu.pop();for(var am=0,om=Xu;am!==om;++am){var im=qu[am],nm=im[$u],sm=im[tm];im[Ku]=nm,im[$u]=sm,im.pop()}}else{var tm=--ku,rm=Vu[tm];ju[rm.uuid]=Ku,Vu[Ku]=rm,Vu.pop();for(var am=0,om=Xu,im;am!==om;++am)im=qu[am],im[Ku]=im[tm],im.pop()}}this.nCachedObjects_=Wu},subscribe_:function(Vu,ku){var Wu=this._bindingsIndicesByPath,ju=Wu[Vu],qu=this._bindings;if(ju!==void 0)return qu[ju];var Xu=this._paths,Yu=this._parsedPaths,Zu=this._objects,Ju=Zu.length,Qu=this.nCachedObjects_,Ku=Array(Ju);ju=qu.length,Wu[Vu]=ju,Xu.push(Vu),Yu.push(ku),qu.push(Ku);for(var $u=Qu,em=Zu.length,tm;$u!==em;++$u)tm=Zu[$u],Ku[$u]=new Ui(tm,Vu,ku);return Ku},unsubscribe_:function(Vu){var ku=this._bindingsIndicesByPath,Wu=ku[Vu];if(Wu!==void 0){var ju=this._paths,qu=this._parsedPaths,Xu=this._bindings,Yu=Xu.length-1,Zu=Xu[Yu],Ju=Vu[Yu];ku[Ju]=Wu,Xu[Wu]=Zu,Xu.pop(),qu[Wu]=qu[Yu],qu.pop(),ju[Wu]=ju[Yu],ju.pop()}}}),Object.assign(Oi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(Vu){return this._startTime=Vu,this},setLoop:function(Vu,ku){return this.loop=Vu,this.repetitions=ku,this},setEffectiveWeight:function(Vu){return this.weight=Vu,this._effectiveWeight=this.enabled?Vu:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(Vu){return this._scheduleFading(Vu,0,1)},fadeOut:function(Vu){return this._scheduleFading(Vu,1,0)},crossFadeFrom:function(Vu,ku,Wu){if(Vu.fadeOut(ku),this.fadeIn(ku),Wu){var ju=this._clip.duration,qu=Vu._clip.duration;Vu.warp(1,qu/ju,ku),this.warp(ju/qu,1,ku)}return this},crossFadeTo:function(Vu,ku,Wu){return Vu.crossFadeFrom(this,ku,Wu)},stopFading:function(){var Vu=this._weightInterpolant;return null!==Vu&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(Vu)),this},setEffectiveTimeScale:function(Vu){return this.timeScale=Vu,this._effectiveTimeScale=this.paused?0:Vu,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(Vu){return this.timeScale=this._clip.duration/Vu,this.stopWarping()},syncWith:function(Vu){return this.time=Vu.time,this.timeScale=Vu.timeScale,this.stopWarping()},halt:function(Vu){return this.warp(this._effectiveTimeScale,0,Vu)},warp:function(Vu,ku,Wu){var ju=this._mixer,qu=ju.time,Xu=this._timeScaleInterpolant,Yu=this.timeScale;null===Xu&&(Xu=ju._lendControlInterpolant(),this._timeScaleInterpolant=Xu);var Zu=Xu.parameterPositions,Ju=Xu.sampleValues;return Zu[0]=qu,Zu[1]=qu+Wu,Ju[0]=Vu/Yu,Ju[1]=ku/Yu,this},stopWarping:function(){var Vu=this._timeScaleInterpolant;return null!==Vu&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(Vu)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(Vu,ku,Wu,ju){if(!this.enabled)return void this._updateWeight(Vu);var qu=this._startTime;if(null!==qu){var Xu=(Vu-qu)*Wu;if(0>Xu||0===Wu)return;this._startTime=null,ku=Wu*Xu}ku*=this._updateTimeScale(Vu);var Yu=this._updateTime(ku),Zu=this._updateWeight(Vu);if(0<Zu)for(var Ju=this._interpolants,Qu=this._propertyBindings,Ku=0,$u=Ju.length;Ku!==$u;++Ku)Ju[Ku].evaluate(Yu),Qu[Ku].accumulate(ju,Zu)},_updateWeight:function(Vu){var ku=0;if(this.enabled){ku=this.weight;var Wu=this._weightInterpolant;if(null!==Wu){var ju=Wu.evaluate(Vu)[0];ku*=ju,Vu>Wu.parameterPositions[1]&&(this.stopFading(),0===ju&&(this.enabled=!1))}}return this._effectiveWeight=ku,ku},_updateTimeScale:function(Vu){var ku=0;if(!this.paused){ku=this.timeScale;var Wu=this._timeScaleInterpolant;if(null!==Wu){var ju=Wu.evaluate(Vu)[0];ku*=ju,Vu>Wu.parameterPositions[1]&&(this.stopWarping(),0==ku?this.paused=!0:this.timeScale=ku)}}return this._effectiveTimeScale=ku,ku},_updateTime:function(Vu){var ku=this.time+Vu,Wu=this._clip.duration,ju=this.loop,qu=this._loopCount,Xu=ju===2202;if(0===Vu)return-1===qu?ku:Xu&&1==(1&qu)?Wu-ku:ku;if(ju===2200){-1===qu&&(this._loopCount=0,this._setEndings(!0,!0,!1));handle_stop:{if(ku>=Wu)ku=Wu;else if(0>ku)ku=0;else break handle_stop;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:'finished',action:this,direction:0>Vu?-1:1})}}else{if(-1===qu&&(0<=Vu?(qu=0,this._setEndings(!0,0===this.repetitions,Xu)):this._setEndings(0===this.repetitions,!0,Xu)),ku>=Wu||0>ku){var Yu=Math.floor(ku/Wu);ku-=Wu*Yu,qu+=Math.abs(Yu);var Zu=this.repetitions-qu;if(0>=Zu)this.clampWhenFinished?this.paused=!0:this.enabled=!1,ku=0<Vu?Wu:0,this._mixer.dispatchEvent({type:'finished',action:this,direction:0<Vu?1:-1});else{if(1==Zu){var Ju=0>Vu;this._setEndings(Ju,!Ju,Xu)}else this._setEndings(!1,!1,Xu);this._loopCount=qu,this._mixer.dispatchEvent({type:'loop',action:this,loopDelta:Yu})}}if(Xu&&1==(1&qu))return this.time=ku,Wu-ku}return this.time=ku,ku},_setEndings:function(Vu,ku,Wu){var ju=this._interpolantSettings;Wu?(ju.endingStart=Kl,ju.endingEnd=Kl):(ju.endingStart=Vu?this.zeroSlopeAtStart?Kl:Ql:$l,ju.endingEnd=ku?this.zeroSlopeAtEnd?Kl:Ql:$l)},_scheduleFading:function(Vu,ku,Wu){var ju=this._mixer,qu=ju.time,Xu=this._weightInterpolant;null===Xu&&(Xu=ju._lendControlInterpolant(),this._weightInterpolant=Xu);var Yu=Xu.parameterPositions,Zu=Xu.sampleValues;return Yu[0]=qu,Zu[0]=ku,Yu[1]=qu+Vu,Zu[1]=Wu,this}}),Fi.prototype=Object.assign(Object.create(M.prototype),{constructor:Fi,_bindAction:function(Vu,ku){var Wu=Vu._localRoot||this._root,ju=Vu._clip.tracks,qu=ju.length,Xu=Vu._propertyBindings,Yu=Vu._interpolants,Zu=Wu.uuid,Ju=this._bindingsByRootAndName,Qu=Ju[Zu];Qu===void 0&&(Qu={},Ju[Zu]=Qu);for(var Ku=0;Ku!==qu;++Ku){var $u=ju[Ku],em=$u.name,tm=Qu[em];if(void 0!==tm)Xu[Ku]=tm;else{if(tm=Xu[Ku],void 0!==tm){null===tm._cacheIndex&&(++tm.referenceCount,this._addInactiveBinding(tm,Zu,em));continue}var rm=ku&&ku._propertyBindings[Ku].binding.parsedPath;tm=new Ni(Ui.create(Wu,em,rm),$u.ValueTypeName,$u.getValueSize()),++tm.referenceCount,this._addInactiveBinding(tm,Zu,em),Xu[Ku]=tm}Yu[Ku].resultBuffer=tm.buffer}},_activateAction:function(Vu){if(!this._isActiveAction(Vu)){if(null===Vu._cacheIndex){var ku=(Vu._localRoot||this._root).uuid,Wu=Vu._clip.uuid,ju=this._actionsByClip[Wu];this._bindAction(Vu,ju&&ju.knownActions[0]),this._addInactiveAction(Vu,Wu,ku)}for(var qu=Vu._propertyBindings,Xu=0,Yu=qu.length,Zu;Xu!==Yu;++Xu)Zu=qu[Xu],0==Zu.useCount++&&(this._lendBinding(Zu),Zu.saveOriginalState());this._lendAction(Vu)}},_deactivateAction:function(Vu){if(this._isActiveAction(Vu)){for(var ku=Vu._propertyBindings,Wu=0,ju=ku.length,qu;Wu!==ju;++Wu)qu=ku[Wu],0==--qu.useCount&&(qu.restoreOriginalState(),this._takeBackBinding(qu));this._takeBackAction(Vu)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var Vu=this;this.stats={actions:{get total(){return Vu._actions.length},get inUse(){return Vu._nActiveActions}},bindings:{get total(){return Vu._bindings.length},get inUse(){return Vu._nActiveBindings}},controlInterpolants:{get total(){return Vu._controlInterpolants.length},get inUse(){return Vu._nActiveControlInterpolants}}}},_isActiveAction:function(Vu){var ku=Vu._cacheIndex;return null!==ku&&ku<this._nActiveActions},_addInactiveAction:function(Vu,ku,Wu){var ju=this._actions,qu=this._actionsByClip,Xu=qu[ku];if(Xu===void 0)Xu={knownActions:[Vu],actionByRoot:{}},Vu._byClipCacheIndex=0,qu[ku]=Xu;else{var Yu=Xu.knownActions;Vu._byClipCacheIndex=Yu.length,Yu.push(Vu)}Vu._cacheIndex=ju.length,ju.push(Vu),Xu.actionByRoot[Wu]=Vu},_removeInactiveAction:function(Vu){var ku=this._actions,Wu=ku[ku.length-1],ju=Vu._cacheIndex;Wu._cacheIndex=ju,ku[ju]=Wu,ku.pop(),Vu._cacheIndex=null;var qu=Vu._clip.uuid,Xu=this._actionsByClip,Yu=Xu[qu],Zu=Yu.knownActions,Ju=Zu[Zu.length-1],Qu=Vu._byClipCacheIndex;Ju._byClipCacheIndex=Qu,Zu[Qu]=Ju,Zu.pop(),Vu._byClipCacheIndex=null;var Ku=Yu.actionByRoot,$u=(Vu._localRoot||this._root).uuid;delete Ku[$u],0===Zu.length&&delete Xu[qu],this._removeInactiveBindingsForAction(Vu)},_removeInactiveBindingsForAction:function(Vu){for(var ku=Vu._propertyBindings,Wu=0,ju=ku.length,qu;Wu!==ju;++Wu)qu=ku[Wu],0==--qu.referenceCount&&this._removeInactiveBinding(qu)},_lendAction:function(Vu){var ku=this._actions,Wu=Vu._cacheIndex,ju=this._nActiveActions++,qu=ku[ju];Vu._cacheIndex=ju,ku[ju]=Vu,qu._cacheIndex=Wu,ku[Wu]=qu},_takeBackAction:function(Vu){var ku=this._actions,Wu=Vu._cacheIndex,ju=--this._nActiveActions,qu=ku[ju];Vu._cacheIndex=ju,ku[ju]=Vu,qu._cacheIndex=Wu,ku[Wu]=qu},_addInactiveBinding:function(Vu,ku,Wu){var ju=this._bindingsByRootAndName,qu=ju[ku],Xu=this._bindings;qu===void 0&&(qu={},ju[ku]=qu),qu[Wu]=Vu,Vu._cacheIndex=Xu.length,Xu.push(Vu)},_removeInactiveBinding:function(Vu){var ku=this._bindings,Wu=Vu.binding,ju=Wu.rootNode.uuid,qu=Wu.path,Xu=this._bindingsByRootAndName,Yu=Xu[ju],Zu=ku[ku.length-1],Ju=Vu._cacheIndex;Zu._cacheIndex=Ju,ku[Ju]=Zu,ku.pop(),delete Yu[qu];remove_empty_map:{for(var Qu in Yu)break remove_empty_map;delete Xu[ju]}},_lendBinding:function(Vu){var ku=this._bindings,Wu=Vu._cacheIndex,ju=this._nActiveBindings++,qu=ku[ju];Vu._cacheIndex=ju,ku[ju]=Vu,qu._cacheIndex=Wu,ku[Wu]=qu},_takeBackBinding:function(Vu){var ku=this._bindings,Wu=Vu._cacheIndex,ju=--this._nActiveBindings,qu=ku[ju];Vu._cacheIndex=ju,ku[ju]=Vu,qu._cacheIndex=Wu,ku[Wu]=qu},_lendControlInterpolant:function(){var Vu=this._controlInterpolants,ku=this._nActiveControlInterpolants++,Wu=Vu[ku];return void 0===Wu&&(Wu=new uo(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),Wu.__cacheIndex=ku,Vu[ku]=Wu),Wu},_takeBackControlInterpolant:function(Vu){var ku=this._controlInterpolants,Wu=Vu.__cacheIndex,ju=--this._nActiveControlInterpolants,qu=ku[ju];Vu.__cacheIndex=ju,ku[ju]=Vu,qu.__cacheIndex=Wu,ku[Wu]=qu},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(Vu,ku){var Wu=ku||this._root,ju=Wu.uuid,qu='string'==typeof Vu?So.findByName(Wu,Vu):Vu,Xu=null===qu?Vu:qu.uuid,Yu=this._actionsByClip[Xu],Zu=null;if(void 0!==Yu){var Ju=Yu.actionByRoot[ju];if(void 0!==Ju)return Ju;Zu=Yu.knownActions[0],null===qu&&(qu=Zu._clip)}if(null===qu)return null;var Qu=new Oi(this,qu,ku);return this._bindAction(Qu,Zu),this._addInactiveAction(Qu,Xu,ju),Qu},existingAction:function(Vu,ku){var Wu=ku||this._root,ju=Wu.uuid,qu='string'==typeof Vu?So.findByName(Wu,Vu):Vu,Xu=qu?qu.uuid:Vu,Yu=this._actionsByClip[Xu];return void 0===Yu?null:Yu.actionByRoot[ju]||null},stopAllAction:function(){var Vu=this._actions,ku=this._nActiveActions,Wu=this._bindings,ju=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var qu=0;qu!==ku;++qu)Vu[qu].reset();for(var qu=0;qu!==ju;++qu)Wu[qu].useCount=0;return this},update:function(Vu){Vu*=this.timeScale;for(var ku=this._actions,Wu=this._nActiveActions,ju=this.time+=Vu,qu=Math.sign(Vu),Xu=this._accuIndex^=1,Yu=0,Zu;Yu!==Wu;++Yu)Zu=ku[Yu],Zu._update(ju,Vu,qu,Xu);for(var Ju=this._bindings,Qu=this._nActiveBindings,Yu=0;Yu!==Qu;++Yu)Ju[Yu].apply(Xu);return this},getRoot:function(){return this._root},uncacheClip:function(Vu){var ku=this._actions,Wu=Vu.uuid,ju=this._actionsByClip,qu=ju[Wu];if(qu!==void 0){for(var Xu=qu.knownActions,Yu=0,Zu=Xu.length,Ju;Yu!==Zu;++Yu){Ju=Xu[Yu],this._deactivateAction(Ju);var Qu=Ju._cacheIndex,Ku=ku[ku.length-1];Ju._cacheIndex=null,Ju._byClipCacheIndex=null,Ku._cacheIndex=Qu,ku[Qu]=Ku,ku.pop(),this._removeInactiveBindingsForAction(Ju)}delete ju[Wu]}},uncacheRoot:function(Vu){var ku=Vu.uuid,Wu=this._actionsByClip;for(var ju in Wu){var qu=Wu[ju].actionByRoot,Xu=qu[ku];Xu!==void 0&&(this._deactivateAction(Xu),this._removeInactiveAction(Xu))}var Yu=this._bindingsByRootAndName,Zu=Yu[ku];if(Zu!==void 0)for(var Ju in Zu){var Qu=Zu[Ju];Qu.restoreOriginalState(),this._removeInactiveBinding(Qu)}},uncacheAction:function(Vu,ku){var Wu=this.existingAction(Vu,ku);null!==Wu&&(this._deactivateAction(Wu),this._removeInactiveAction(Wu))}}),Hi.prototype.clone=function(){return new Hi(this.value.clone===void 0?this.value:this.value.clone())},Vi.prototype=Object.assign(Object.create(xe.prototype),{constructor:Vi,isInstancedBufferGeometry:!0,copy:function(Vu){return xe.prototype.copy.call(this,Vu),this.maxInstancedCount=Vu.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}}),ki.prototype=Object.assign(Object.create(fr.prototype),{constructor:ki,isInstancedInterleavedBuffer:!0,copy:function(Vu){return fr.prototype.copy.call(this,Vu),this.meshPerAttribute=Vu.meshPerAttribute,this}}),Wi.prototype=Object.assign(Object.create(re.prototype),{constructor:Wi,isInstancedBufferAttribute:!0,copy:function(Vu){return re.prototype.copy.call(this,Vu),this.meshPerAttribute=Vu.meshPerAttribute,this}}),Object.assign(function(Vu,ku,Wu,ju){this.ray=new we(Vu,ku),this.near=Wu||0,this.far=ju||Infinity,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn('THREE.Raycaster: params.PointCloud has been renamed to params.Points.'),this.Points}}})}.prototype,{linePrecision:1,set:function(Vu,ku){this.ray.set(Vu,ku)},setFromCamera:function(Vu,ku){ku&&ku.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(ku.matrixWorld),this.ray.direction.set(Vu.x,Vu.y,0.5).unproject(ku).sub(this.ray.origin).normalize()):ku&&ku.isOrthographicCamera?(this.ray.origin.set(Vu.x,Vu.y,(ku.near+ku.far)/(ku.near-ku.far)).unproject(ku),this.ray.direction.set(0,0,-1).transformDirection(ku.matrixWorld)):console.error('THREE.Raycaster: Unsupported camera type.')},intersectObject:function(Vu,ku,Wu){var ju=Wu||[];return Xi(Vu,this,ju,ku),ju.sort(qi),ju},intersectObjects:function(Vu,ku,Wu){var ju=Wu||[];if(!1===Array.isArray(Vu))return console.warn('THREE.Raycaster.intersectObjects: objects is not an Array.'),ju;for(var qu=0,Xu=Vu.length;qu<Xu;qu++)Xi(Vu[qu],this,ju,ku);return ju.sort(qi),ju}}),Object.assign(function(Vu,ku,Wu){return this.radius=void 0===Vu?1:Vu,this.phi=void 0===ku?0:ku,this.theta=void 0===Wu?0:Wu,this}.prototype,{set:function(Vu,ku,Wu){return this.radius=Vu,this.phi=ku,this.theta=Wu,this},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.radius=Vu.radius,this.phi=Vu.phi,this.theta=Vu.theta,this},makeSafe:function(){var Vu=1e-6;return this.phi=Math.max(Vu,Math.min(Math.PI-Vu,this.phi)),this},setFromVector3:function(Vu){return this.setFromCartesianCoords(Vu.x,Vu.y,Vu.z)},setFromCartesianCoords:function(Vu,ku,Wu){return this.radius=Math.sqrt(Vu*Vu+ku*ku+Wu*Wu),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(Vu,Wu),this.phi=Math.acos(hp.clamp(ku/this.radius,-1,1))),this}}),Object.assign(function(Vu,ku,Wu){return this.radius=void 0===Vu?1:Vu,this.theta=void 0===ku?0:ku,this.y=void 0===Wu?0:Wu,this}.prototype,{set:function(Vu,ku,Wu){return this.radius=Vu,this.theta=ku,this.y=Wu,this},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.radius=Vu.radius,this.theta=Vu.theta,this.y=Vu.y,this},setFromVector3:function(Vu){return this.setFromCartesianCoords(Vu.x,Vu.y,Vu.z)},setFromCartesianCoords:function(Vu,ku,Wu){return this.radius=Math.sqrt(Vu*Vu+Wu*Wu),this.theta=Math.atan2(Vu,Wu),this.y=ku,this}}),Object.assign(Ji.prototype,{set:function(Vu,ku){return this.min.copy(Vu),this.max.copy(ku),this},setFromPoints:function(Vu){this.makeEmpty();for(var ku=0,Wu=Vu.length;ku<Wu;ku++)this.expandByPoint(Vu[ku]);return this},setFromCenterAndSize:function(){var Vu=new S;return function(Wu,ju){var qu=Vu.copy(ju).multiplyScalar(0.5);return this.min.copy(Wu).sub(qu),this.max.copy(Wu).add(qu),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.min.copy(Vu.min),this.max.copy(Vu.max),this},makeEmpty:function(){return this.min.x=this.min.y=+Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(Vu){return void 0===Vu&&(console.warn('THREE.Box2: .getCenter() target is now required'),Vu=new S),this.isEmpty()?Vu.set(0,0):Vu.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(Vu){return void 0===Vu&&(console.warn('THREE.Box2: .getSize() target is now required'),Vu=new S),this.isEmpty()?Vu.set(0,0):Vu.subVectors(this.max,this.min)},expandByPoint:function(Vu){return this.min.min(Vu),this.max.max(Vu),this},expandByVector:function(Vu){return this.min.sub(Vu),this.max.add(Vu),this},expandByScalar:function(Vu){return this.min.addScalar(-Vu),this.max.addScalar(Vu),this},containsPoint:function(Vu){return Vu.x<this.min.x||Vu.x>this.max.x||Vu.y<this.min.y||Vu.y>this.max.y?!1:!0},containsBox:function(Vu){return this.min.x<=Vu.min.x&&Vu.max.x<=this.max.x&&this.min.y<=Vu.min.y&&Vu.max.y<=this.max.y},getParameter:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Box2: .getParameter() target is now required'),ku=new S),ku.set((Vu.x-this.min.x)/(this.max.x-this.min.x),(Vu.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(Vu){return Vu.max.x<this.min.x||Vu.min.x>this.max.x||Vu.max.y<this.min.y||Vu.min.y>this.max.y?!1:!0},clampPoint:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Box2: .clampPoint() target is now required'),ku=new S),ku.copy(Vu).clamp(this.min,this.max)},distanceToPoint:function(){var Vu=new S;return function(Wu){var ju=Vu.copy(Wu).clamp(this.min,this.max);return ju.sub(Wu).length()}}(),intersect:function(Vu){return this.min.max(Vu.min),this.max.min(Vu.max),this},union:function(Vu){return this.min.min(Vu.min),this.max.max(Vu.max),this},translate:function(Vu){return this.min.add(Vu),this.max.add(Vu),this},equals:function(Vu){return Vu.min.equals(this.min)&&Vu.max.equals(this.max)}}),Object.assign(Qi.prototype,{set:function(Vu,ku){return this.start.copy(Vu),this.end.copy(ku),this},clone:function(){return new this.constructor().copy(this)},copy:function(Vu){return this.start.copy(Vu.start),this.end.copy(Vu.end),this},getCenter:function(Vu){return void 0===Vu&&(console.warn('THREE.Line3: .getCenter() target is now required'),Vu=new A),Vu.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(Vu){return void 0===Vu&&(console.warn('THREE.Line3: .delta() target is now required'),Vu=new A),Vu.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(Vu,ku){return void 0===ku&&(console.warn('THREE.Line3: .at() target is now required'),ku=new A),this.delta(ku).multiplyScalar(Vu).add(this.start)},closestPointToPointParameter:function(){var Vu=new A,ku=new A;return function(ju,qu){Vu.subVectors(ju,this.start),ku.subVectors(this.end,this.start);var Xu=ku.dot(ku),Yu=ku.dot(Vu),Zu=Yu/Xu;return qu&&(Zu=hp.clamp(Zu,0,1)),Zu}}(),closestPointToPoint:function(Vu,ku,Wu){var ju=this.closestPointToPointParameter(Vu,ku);return void 0===Wu&&(console.warn('THREE.Line3: .closestPointToPoint() target is now required'),Wu=new A),this.delta(Wu).multiplyScalar(ju).add(this.start)},applyMatrix4:function(Vu){return this.start.applyMatrix4(Vu),this.end.applyMatrix4(Vu),this},equals:function(Vu){return Vu.start.equals(this.start)&&Vu.end.equals(this.end)}}),Ki.prototype=Object.create(K.prototype),Ki.prototype.constructor=Ki,Ki.prototype.isImmediateRenderObject=!0,$i.prototype=Object.create(wr.prototype),$i.prototype.constructor=$i,$i.prototype.update=function(){var Vu=new A,ku=new A,Wu=new C;return function(){var qu=['a','b','c'];this.object.updateMatrixWorld(!0),Wu.getNormalMatrix(this.object.matrixWorld);var Xu=this.object.matrixWorld,Yu=this.geometry.attributes.position,Zu=this.object.geometry;if(Zu&&Zu.isGeometry)for(var Ju=Zu.vertices,Qu=Zu.faces,Ku=0,$u=0,em=Qu.length,tm;$u<em;$u++){tm=Qu[$u];for(var rm=0,am=tm.vertexNormals.length;rm<am;rm++){var om=Ju[tm[qu[rm]]],im=tm.vertexNormals[rm];Vu.copy(om).applyMatrix4(Xu),ku.copy(im).applyMatrix3(Wu).normalize().multiplyScalar(this.size).add(Vu),Yu.setXYZ(Ku,Vu.x,Vu.y,Vu.z),++Ku,Yu.setXYZ(Ku,ku.x,ku.y,ku.z),++Ku}}else if(Zu&&Zu.isBufferGeometry)for(var nm=Zu.attributes.position,sm=Zu.attributes.normal,Ku=0,rm=0,am=nm.count;rm<am;rm++)Vu.set(nm.getX(rm),nm.getY(rm),nm.getZ(rm)).applyMatrix4(Xu),ku.set(sm.getX(rm),sm.getY(rm),sm.getZ(rm)),ku.applyMatrix3(Wu).normalize().multiplyScalar(this.size).add(Vu),Yu.setXYZ(Ku,Vu.x,Vu.y,Vu.z),++Ku,Yu.setXYZ(Ku,ku.x,ku.y,ku.z),++Ku;Yu.needsUpdate=!0}}(),en.prototype=Object.create(K.prototype),en.prototype.constructor=en,en.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},en.prototype.update=function(){var Vu=new A,ku=new A;return function(){this.light.updateMatrixWorld();var ju=this.light.distance?this.light.distance:1e3,qu=ju*Math.tan(this.light.angle);this.cone.scale.set(qu,qu,ju),Vu.setFromMatrixPosition(this.light.matrixWorld),ku.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ku.sub(Vu)),this.color===void 0?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),rn.prototype=Object.create(wr.prototype),rn.prototype.constructor=rn,rn.prototype.updateMatrixWorld=function(){var Vu=new A,ku=new E,Wu=new E;return function(qu){var Xu=this.bones,Yu=this.geometry,Zu=Yu.getAttribute('position');Wu.getInverse(this.root.matrixWorld);for(var Ju=0,Qu=0,Ku;Ju<Xu.length;Ju++)Ku=Xu[Ju],Ku.parent&&Ku.parent.isBone&&(ku.multiplyMatrices(Wu,Ku.matrixWorld),Vu.setFromMatrixPosition(ku),Zu.setXYZ(Qu,Vu.x,Vu.y,Vu.z),ku.multiplyMatrices(Wu,Ku.parent.matrixWorld),Vu.setFromMatrixPosition(ku),Zu.setXYZ(Qu+1,Vu.x,Vu.y,Vu.z),Qu+=2);Yu.getAttribute('position').needsUpdate=!0,K.prototype.updateMatrixWorld.call(this,qu)}}(),on.prototype=Object.create(Pe.prototype),on.prototype.constructor=on,on.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},on.prototype.update=function(){this.color===void 0?this.material.color.copy(this.light.color):this.material.color.set(this.color)},nn.prototype=Object.create(K.prototype),nn.prototype.constructor=nn,nn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},nn.prototype.update=function(){var Vu=0.5*this.light.width,ku=0.5*this.light.height,Wu=this.line.geometry.attributes.position,ju=Wu.array;ju[0]=Vu,ju[1]=-ku,ju[2]=0,ju[3]=Vu,ju[4]=ku,ju[5]=0,ju[6]=-Vu,ju[7]=ku,ju[8]=0,ju[9]=-Vu,ju[10]=-ku,ju[11]=0,ju[12]=Vu,ju[13]=-ku,ju[14]=0,Wu.needsUpdate=!0,this.color===void 0?this.line.material.color.copy(this.light.color):this.line.material.color.set(this.color)},sn.prototype=Object.create(K.prototype),sn.prototype.constructor=sn,sn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},sn.prototype.update=function(){var Vu=new A,ku=new W,Wu=new W;return function(){var qu=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var Xu=qu.geometry.getAttribute('color');ku.copy(this.light.color),Wu.copy(this.light.groundColor);for(var Yu=0,Zu=Xu.count,Ju;Yu<Zu;Yu++)Ju=Yu<Zu/2?ku:Wu,Xu.setXYZ(Yu,Ju.r,Ju.g,Ju.b);Xu.needsUpdate=!0}qu.lookAt(Vu.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),ln.prototype=Object.create(wr.prototype),ln.prototype.constructor=ln,pn.prototype=Object.create(wr.prototype),pn.prototype.constructor=pn,dn.prototype=Object.create(wr.prototype),dn.prototype.constructor=dn,dn.prototype.update=function(){var Vu=new A,ku=new A,Wu=new C;return function(){this.object.updateMatrixWorld(!0),Wu.getNormalMatrix(this.object.matrixWorld);for(var qu=this.object.matrixWorld,Xu=this.geometry.attributes.position,Yu=this.object.geometry,Zu=Yu.vertices,Ju=Yu.faces,Qu=0,Ku=0,$u=Ju.length;Ku<$u;Ku++){var em=Ju[Ku],tm=em.normal;Vu.copy(Zu[em.a]).add(Zu[em.b]).add(Zu[em.c]).divideScalar(3).applyMatrix4(qu),ku.copy(tm).applyMatrix3(Wu).normalize().multiplyScalar(this.size).add(Vu),Xu.setXYZ(Qu,Vu.x,Vu.y,Vu.z),++Qu,Xu.setXYZ(Qu,ku.x,ku.y,ku.z),++Qu}Xu.needsUpdate=!0}}(),cn.prototype=Object.create(K.prototype),cn.prototype.constructor=cn,cn.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},cn.prototype.update=function(){var Vu=new A,ku=new A,Wu=new A;return function(){Vu.setFromMatrixPosition(this.light.matrixWorld),ku.setFromMatrixPosition(this.light.target.matrixWorld),Wu.subVectors(ku,Vu),this.lightPlane.lookAt(ku),this.color===void 0?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(ku),this.targetLine.scale.z=Wu.length()}}(),un.prototype=Object.create(wr.prototype),un.prototype.constructor=un,un.prototype.update=function(){function Vu(Xu,Yu,Zu,Ju){ju.set(Yu,Zu,Ju).unproject(qu);var Qu=Wu[Xu];if(Qu!==void 0)for(var Ku=ku.getAttribute('position'),$u=0,em=Qu.length;$u<em;$u++)Ku.setXYZ(Qu[$u],ju.x,ju.y,ju.z)}var ku,Wu,ju=new A,qu=new ir;return function(){ku=this.geometry,Wu=this.pointMap;var Yu=1,Zu=1;qu.projectionMatrix.copy(this.camera.projectionMatrix),Vu('c',0,0,-1),Vu('t',0,0,1),Vu('n1',-Yu,-Zu,-1),Vu('n2',Yu,-Zu,-1),Vu('n3',-Yu,Zu,-1),Vu('n4',Yu,Zu,-1),Vu('f1',-Yu,-Zu,1),Vu('f2',Yu,-Zu,1),Vu('f3',-Yu,Zu,1),Vu('f4',Yu,Zu,1),Vu('u1',0.7*Yu,1.1*Zu,-1),Vu('u2',0.7*-Yu,1.1*Zu,-1),Vu('u3',0,2*Zu,-1),Vu('cf1',-Yu,0,1),Vu('cf2',Yu,0,1),Vu('cf3',0,-Zu,1),Vu('cf4',0,Zu,1),Vu('cn1',-Yu,0,-1),Vu('cn2',Yu,0,-1),Vu('cn3',0,-Zu,-1),Vu('cn4',0,Zu,-1),ku.getAttribute('position').needsUpdate=!0}}(),mn.prototype=Object.create(wr.prototype),mn.prototype.constructor=mn,mn.prototype.update=function(){var Vu=new O;return function(Wu){if(void 0!==Wu&&console.warn('THREE.BoxHelper: .update() has no longer arguments.'),void 0!==this.object&&Vu.setFromObject(this.object),!Vu.isEmpty()){var ju=Vu.min,qu=Vu.max,Xu=this.geometry.attributes.position,Yu=Xu.array;Yu[0]=qu.x,Yu[1]=qu.y,Yu[2]=qu.z,Yu[3]=ju.x,Yu[4]=qu.y,Yu[5]=qu.z,Yu[6]=ju.x,Yu[7]=ju.y,Yu[8]=qu.z,Yu[9]=qu.x,Yu[10]=ju.y,Yu[11]=qu.z,Yu[12]=qu.x,Yu[13]=qu.y,Yu[14]=ju.z,Yu[15]=ju.x,Yu[16]=qu.y,Yu[17]=ju.z,Yu[18]=ju.x,Yu[19]=ju.y,Yu[20]=ju.z,Yu[21]=qu.x,Yu[22]=ju.y,Yu[23]=ju.z,Xu.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),mn.prototype.setFromObject=function(Vu){return this.object=Vu,this.update(),this},mn.prototype.copy=function(Vu){return wr.prototype.copy.call(this,Vu),this.object=Vu.object,this},mn.prototype.clone=function(){return new this.constructor().copy(this)},gn.prototype=Object.create(wr.prototype),gn.prototype.constructor=gn,gn.prototype.updateMatrixWorld=function(Vu){var ku=this.box;ku.isEmpty()||(ku.getCenter(this.position),ku.getSize(this.scale),this.scale.multiplyScalar(0.5),K.prototype.updateMatrixWorld.call(this,Vu))},fn.prototype=Object.create(Er.prototype),fn.prototype.constructor=fn,fn.prototype.updateMatrixWorld=function(Vu){var ku=-this.plane.constant;1e-8>Math.abs(ku)&&(ku=1e-8),this.scale.set(0.5*this.size,0.5*this.size,ku),this.children[0].material.side=0>ku?Nn:zn,this.lookAt(this.plane.normal),K.prototype.updateMatrixWorld.call(this,Vu)};var Ru,Iu;hn.prototype=Object.create(K.prototype),hn.prototype.constructor=hn,hn.prototype.setDirection=function(){var Vu=new A,ku;return function(ju){0.99999<ju.y?this.quaternion.set(0,0,0,1):-0.99999>ju.y?this.quaternion.set(1,0,0,0):(Vu.set(ju.z,0,-ju.x).normalize(),ku=Math.acos(ju.y),this.quaternion.setFromAxisAngle(Vu,ku))}}(),hn.prototype.setLength=function(Vu,ku,Wu){ku===void 0&&(ku=0.2*Vu),Wu===void 0&&(Wu=0.2*ku),this.line.scale.set(1,Math.max(0,Vu-ku),1),this.line.updateMatrix(),this.cone.scale.set(Wu,ku,Wu),this.cone.position.y=Vu,this.cone.updateMatrix()},hn.prototype.setColor=function(Vu){this.line.material.color.copy(Vu),this.cone.material.color.copy(Vu)},hn.prototype.copy=function(Vu){return K.prototype.copy.call(this,Vu,!1),this.line.copy(Vu.line),this.cone.copy(Vu.cone),this},hn.prototype.clone=function(){return new this.constructor().copy(this)},yn.prototype=Object.create(wr.prototype),yn.prototype.constructor=yn,zo.create=function(Vu,ku){return console.log('THREE.Curve.create() has been deprecated'),Vu.prototype=Object.create(zo.prototype),Vu.prototype.constructor=Vu,Vu.prototype.getPoint=ku,Vu},Object.assign(ri.prototype,{createPointsGeometry:function(Vu){console.warn('THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var ku=this.getPoints(Vu);return this.createGeometry(ku)},createSpacedPointsGeometry:function(Vu){console.warn('THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var ku=this.getSpacedPoints(Vu);return this.createGeometry(ku)},createGeometry:function(Vu){console.warn('THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');for(var ku=new ee,Wu=0,ju=Vu.length,qu;Wu<ju;Wu++)qu=Vu[Wu],ku.vertices.push(new A(qu.x,qu.y,qu.z||0));return ku}}),Object.assign(ai.prototype,{fromPoints:function(Vu){console.warn('THREE.Path: .fromPoints() has been renamed to .setFromPoints().'),this.setFromPoints(Vu)}}),xn.prototype=Object.create(Go.prototype),Object.assign(xn.prototype,{initFromArray:function(){console.error('THREE.Spline: .initFromArray() has been removed.')},getControlPointsArray:function(){console.error('THREE.Spline: .getControlPointsArray() has been removed.')},reparametrizeByArcLength:function(){console.error('THREE.Spline: .reparametrizeByArcLength() has been removed.')}}),ln.prototype.setColors=function(){console.error('THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.')},rn.prototype.update=function(){console.error('THREE.SkeletonHelper: update() no longer needs to be called.')},Object.assign(vi.prototype,{extractUrlBase:function(Vu){return console.warn('THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.'),Su.extractUrlBase(Vu)}}),Object.assign(_i.prototype,{setTexturePath:function(Vu){return console.warn('THREE.JSONLoader: .setTexturePath() has been renamed to .setResourcePath().'),this.setResourcePath(Vu)}}),Object.assign(bi.prototype,{setTexturePath:function(Vu){return console.warn('THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().'),this.setResourcePath(Vu)}}),Object.assign(Ji.prototype,{center:function(Vu){return console.warn('THREE.Box2: .center() has been renamed to .getCenter().'),this.getCenter(Vu)},empty:function(){return console.warn('THREE.Box2: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(Vu){return console.warn('THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Vu)},size:function(Vu){return console.warn('THREE.Box2: .size() has been renamed to .getSize().'),this.getSize(Vu)}}),Object.assign(O.prototype,{center:function(Vu){return console.warn('THREE.Box3: .center() has been renamed to .getCenter().'),this.getCenter(Vu)},empty:function(){return console.warn('THREE.Box3: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(Vu){return console.warn('THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Vu)},isIntersectionSphere:function(Vu){return console.warn('THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(Vu)},size:function(Vu){return console.warn('THREE.Box3: .size() has been renamed to .getSize().'),this.getSize(Vu)}}),Qi.prototype.center=function(Vu){return console.warn('THREE.Line3: .center() has been renamed to .getCenter().'),this.getCenter(Vu)},Object.assign(hp,{random16:function(){return console.warn('THREE.Math: .random16() has been deprecated. Use Math.random() instead.'),Math.random()},nearestPowerOfTwo:function(Vu){return console.warn('THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().'),hp.floorPowerOfTwo(Vu)},nextPowerOfTwo:function(Vu){return console.warn('THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().'),hp.ceilPowerOfTwo(Vu)}}),Object.assign(C.prototype,{flattenToArrayOffset:function(Vu,ku){return console.warn('THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(Vu,ku)},multiplyVector3:function(Vu){return console.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.'),Vu.applyMatrix3(this)},multiplyVector3Array:function(){console.error('THREE.Matrix3: .multiplyVector3Array() has been removed.')},applyToBuffer:function(Vu){return console.warn('THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(Vu)},applyToVector3Array:function(){console.error('THREE.Matrix3: .applyToVector3Array() has been removed.')}}),Object.assign(E.prototype,{extractPosition:function(Vu){return console.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().'),this.copyPosition(Vu)},flattenToArrayOffset:function(Vu,ku){return console.warn('THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(Vu,ku)},getPosition:function(){var Vu;return function(){return void 0==Vu&&(Vu=new A),console.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.'),Vu.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(Vu){return console.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().'),this.makeRotationFromQuaternion(Vu)},multiplyToArray:function(){console.warn('THREE.Matrix4: .multiplyToArray() has been removed.')},multiplyVector3:function(Vu){return console.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Vu.applyMatrix4(this)},multiplyVector4:function(Vu){return console.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Vu.applyMatrix4(this)},multiplyVector3Array:function(){console.error('THREE.Matrix4: .multiplyVector3Array() has been removed.')},rotateAxis:function(Vu){console.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.'),Vu.transformDirection(this)},crossVector:function(Vu){return console.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Vu.applyMatrix4(this)},translate:function(){console.error('THREE.Matrix4: .translate() has been removed.')},rotateX:function(){console.error('THREE.Matrix4: .rotateX() has been removed.')},rotateY:function(){console.error('THREE.Matrix4: .rotateY() has been removed.')},rotateZ:function(){console.error('THREE.Matrix4: .rotateZ() has been removed.')},rotateByAxis:function(){console.error('THREE.Matrix4: .rotateByAxis() has been removed.')},applyToBuffer:function(Vu){return console.warn('THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(Vu)},applyToVector3Array:function(){console.error('THREE.Matrix4: .applyToVector3Array() has been removed.')},makeFrustum:function(Vu,ku,Wu,ju,qu,Xu){return console.warn('THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.'),this.makePerspective(Vu,ku,ju,Wu,qu,Xu)}}),H.prototype.isIntersectionLine=function(Vu){return console.warn('THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().'),this.intersectsLine(Vu)},L.prototype.multiplyVector3=function(Vu){return console.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.'),Vu.applyQuaternion(this)},Object.assign(we.prototype,{isIntersectionBox:function(Vu){return console.warn('THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Vu)},isIntersectionPlane:function(Vu){return console.warn('THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().'),this.intersectsPlane(Vu)},isIntersectionSphere:function(Vu){return console.warn('THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(Vu)}}),Object.assign(Le.prototype,{area:function(){return console.warn('THREE.Triangle: .area() has been renamed to .getArea().'),this.getArea()},barycoordFromPoint:function(Vu,ku){return console.warn('THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().'),this.getBarycoord(Vu,ku)},midpoint:function(Vu){return console.warn('THREE.Triangle: .midpoint() has been renamed to .getMidpoint().'),this.getMidpoint(Vu)},normal:function(Vu){return console.warn('THREE.Triangle: .normal() has been renamed to .getNormal().'),this.getNormal(Vu)},plane:function(Vu){return console.warn('THREE.Triangle: .plane() has been renamed to .getPlane().'),this.getPlane(Vu)}}),Object.assign(Le,{barycoordFromPoint:function(Vu,ku,Wu,ju,qu){return console.warn('THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().'),Le.getBarycoord(Vu,ku,Wu,ju,qu)},normal:function(Vu,ku,Wu,ju){return console.warn('THREE.Triangle: .normal() has been renamed to .getNormal().'),Le.getNormal(Vu,ku,Wu,ju)}}),Object.assign(oi.prototype,{extractAllPoints:function(Vu){return console.warn('THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.'),this.extractPoints(Vu)},extrude:function(Vu){return console.warn('THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.'),new Ca(this,Vu)},makeGeometry:function(Vu){return console.warn('THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.'),new Ha(this,Vu)}}),Object.assign(S.prototype,{fromAttribute:function(Vu,ku,Wu){return console.warn('THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Vu,ku,Wu)},distanceToManhattan:function(Vu){return console.warn('THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(Vu)},lengthManhattan:function(){return console.warn('THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(A.prototype,{setEulerFromRotationMatrix:function(){console.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.')},setEulerFromQuaternion:function(){console.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.')},getPositionFromMatrix:function(Vu){return console.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().'),this.setFromMatrixPosition(Vu)},getScaleFromMatrix:function(Vu){return console.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().'),this.setFromMatrixScale(Vu)},getColumnFromMatrix:function(Vu,ku){return console.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().'),this.setFromMatrixColumn(ku,Vu)},applyProjection:function(Vu){return console.warn('THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.'),this.applyMatrix4(Vu)},fromAttribute:function(Vu,ku,Wu){return console.warn('THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Vu,ku,Wu)},distanceToManhattan:function(Vu){return console.warn('THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(Vu)},lengthManhattan:function(){return console.warn('THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(I.prototype,{fromAttribute:function(Vu,ku,Wu){return console.warn('THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Vu,ku,Wu)},lengthManhattan:function(){return console.warn('THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(ee.prototype,{computeTangents:function(){console.error('THREE.Geometry: .computeTangents() has been removed.')},computeLineDistances:function(){console.error('THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.')}}),Object.assign(K.prototype,{getChildByName:function(Vu){return console.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().'),this.getObjectByName(Vu)},renderDepth:function(){console.warn('THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.')},translate:function(Vu,ku){return console.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.'),this.translateOnAxis(ku,Vu)},getWorldRotation:function(){console.error('THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.')}}),Object.defineProperties(K.prototype,{eulerOrder:{get:function(){return console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order},set:function(Vu){console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order=Vu}},useQuaternion:{get:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')},set:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')}}}),Object.defineProperties(_r.prototype,{objects:{get:function(){return console.warn('THREE.LOD: .objects has been renamed to .levels.'),this.levels}}}),Object.defineProperty(br.prototype,'useVertexTexture',{get:function(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')},set:function(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')}}),Object.defineProperty(zo.prototype,'__arcLengthDivisions',{get:function(){return console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions},set:function(Vu){console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions=Vu}}),nr.prototype.setLens=function(Vu,ku){console.warn('THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.'),ku!==void 0&&(this.filmGauge=ku),this.setFocalLength(Vu)},Object.defineProperties(ii.prototype,{onlyShadow:{set:function(){console.warn('THREE.Light: .onlyShadow has been removed.')}},shadowCameraFov:{set:function(Vu){console.warn('THREE.Light: .shadowCameraFov is now .shadow.camera.fov.'),this.shadow.camera.fov=Vu}},shadowCameraLeft:{set:function(Vu){console.warn('THREE.Light: .shadowCameraLeft is now .shadow.camera.left.'),this.shadow.camera.left=Vu}},shadowCameraRight:{set:function(Vu){console.warn('THREE.Light: .shadowCameraRight is now .shadow.camera.right.'),this.shadow.camera.right=Vu}},shadowCameraTop:{set:function(Vu){console.warn('THREE.Light: .shadowCameraTop is now .shadow.camera.top.'),this.shadow.camera.top=Vu}},shadowCameraBottom:{set:function(Vu){console.warn('THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.'),this.shadow.camera.bottom=Vu}},shadowCameraNear:{set:function(Vu){console.warn('THREE.Light: .shadowCameraNear is now .shadow.camera.near.'),this.shadow.camera.near=Vu}},shadowCameraFar:{set:function(Vu){console.warn('THREE.Light: .shadowCameraFar is now .shadow.camera.far.'),this.shadow.camera.far=Vu}},shadowCameraVisible:{set:function(){console.warn('THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.')}},shadowBias:{set:function(Vu){console.warn('THREE.Light: .shadowBias is now .shadow.bias.'),this.shadow.bias=Vu}},shadowDarkness:{set:function(){console.warn('THREE.Light: .shadowDarkness has been removed.')}},shadowMapWidth:{set:function(Vu){console.warn('THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.'),this.shadow.mapSize.width=Vu}},shadowMapHeight:{set:function(Vu){console.warn('THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.'),this.shadow.mapSize.height=Vu}}}),Object.defineProperties(re.prototype,{length:{get:function(){return console.warn('THREE.BufferAttribute: .length has been deprecated. Use .count instead.'),this.array.length}},copyIndicesArray:function(){console.error('THREE.BufferAttribute: .copyIndicesArray() has been removed.')}}),Object.assign(xe.prototype,{addIndex:function(Vu){console.warn('THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().'),this.setIndex(Vu)},addDrawCall:function(Vu,ku,Wu){Wu!==void 0&&console.warn('THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.'),console.warn('THREE.BufferGeometry: .addDrawCall() is now .addGroup().'),this.addGroup(Vu,ku)},clearDrawCalls:function(){console.warn('THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().'),this.clearGroups()},computeTangents:function(){console.warn('THREE.BufferGeometry: .computeTangents() has been removed.')},computeOffsets:function(){console.warn('THREE.BufferGeometry: .computeOffsets() has been removed.')}}),Object.defineProperties(xe.prototype,{drawcalls:{get:function(){return console.error('THREE.BufferGeometry: .drawcalls has been renamed to .groups.'),this.groups}},offsets:{get:function(){return console.warn('THREE.BufferGeometry: .offsets has been renamed to .groups.'),this.groups}}}),Object.assign(Ra.prototype,{getArrays:function(){console.error('THREE.ExtrudeBufferGeometry: .getArrays() has been removed.')},addShapeList:function(){console.error('THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.')},addShape:function(){console.error('THREE.ExtrudeBufferGeometry: .addShape() has been removed.')}}),Object.defineProperties(Hi.prototype,{dynamic:{set:function(){console.warn('THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.')}},onUpdate:{value:function(){return console.warn('THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.'),this}}}),Object.defineProperties(Te.prototype,{wrapAround:{get:function(){console.warn('THREE.Material: .wrapAround has been removed.')},set:function(){console.warn('THREE.Material: .wrapAround has been removed.')}},overdraw:{get:function(){console.warn('THREE.Material: .overdraw has been removed.')},set:function(){console.warn('THREE.Material: .overdraw has been removed.')}},wrapRGB:{get:function(){return console.warn('THREE.Material: .wrapRGB has been removed.'),new W}},shading:{get:function(){console.error('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.')},set:function(Vu){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=Vu===Un}}}),Object.defineProperties(ao.prototype,{metal:{get:function(){return console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.'),!1},set:function(){console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead')}}}),Object.defineProperties(Ee.prototype,{derivatives:{get:function(){return console.warn('THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives},set:function(Vu){console.warn('THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives=Vu}}}),Object.assign(cr.prototype,{clearTarget:function(Vu,ku,Wu,ju){console.warn('THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.'),this.setRenderTarget(Vu),this.clear(ku,Wu,ju)},animate:function(Vu){console.warn('THREE.WebGLRenderer: .animate() is now .setAnimationLoop().'),this.setAnimationLoop(Vu)},getCurrentRenderTarget:function(){return console.warn('THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().'),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn('THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().'),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn('THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.'),this.capabilities.precision},resetGLState:function(){return console.warn('THREE.WebGLRenderer: .resetGLState() is now .state.reset().'),this.state.reset()},supportsFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \'OES_texture_float\' ).'),this.extensions.get('OES_texture_float')},supportsHalfFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \'OES_texture_half_float\' ).'),this.extensions.get('OES_texture_half_float')},supportsStandardDerivatives:function(){return console.warn('THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \'OES_standard_derivatives\' ).'),this.extensions.get('OES_standard_derivatives')},supportsCompressedTextureS3TC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \'WEBGL_compressed_texture_s3tc\' ).'),this.extensions.get('WEBGL_compressed_texture_s3tc')},supportsCompressedTexturePVRTC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \'WEBGL_compressed_texture_pvrtc\' ).'),this.extensions.get('WEBGL_compressed_texture_pvrtc')},supportsBlendMinMax:function(){return console.warn('THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \'EXT_blend_minmax\' ).'),this.extensions.get('EXT_blend_minmax')},supportsVertexTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.'),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn('THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \'ANGLE_instanced_arrays\' ).'),this.extensions.get('ANGLE_instanced_arrays')},enableScissorTest:function(Vu){console.warn('THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().'),this.setScissorTest(Vu)},initMaterial:function(){console.warn('THREE.WebGLRenderer: .initMaterial() has been removed.')},addPrePlugin:function(){console.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.')},addPostPlugin:function(){console.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.')},updateShadowMap:function(){console.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.')},setFaceCulling:function(){console.warn('THREE.WebGLRenderer: .setFaceCulling() has been removed.')}}),Object.defineProperties(cr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(Vu){console.warn('THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.'),this.shadowMap.enabled=Vu}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(Vu){console.warn('THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.'),this.shadowMap.type=Vu}},shadowMapCullFace:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.')}}}),Object.defineProperties(er.prototype,{cullFace:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.')}},renderReverseSided:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.')}},renderSingleSided:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.')}}}),Object.defineProperties(D.prototype,{wrapS:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS=Vu}},wrapT:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT=Vu}},magFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter=Vu}},minFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter=Vu}},anisotropy:{get:function(){return console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy=Vu}},offset:{get:function(){return console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset=Vu}},repeat:{get:function(){return console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat=Vu}},format:{get:function(){return console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format=Vu}},type:{get:function(){return console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type=Vu}},generateMipmaps:{get:function(){return console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps},set:function(Vu){console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps=Vu}}}),Object.defineProperties(pr.prototype,{standing:{set:function(){console.warn('THREE.WebVRManager: .standing has been removed.')}},userHeight:{set:function(){console.warn('THREE.WebVRManager: .userHeight has been removed.')}}}),Ii.prototype.load=function(Vu){console.warn('THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.');var ku=this,Wu=new Li;return Wu.load(Vu,function(ju){ku.setBuffer(ju)}),this},zi.prototype.getData=function(){return console.warn('THREE.AudioAnalyser: .getData() is now .getFrequencyData().'),this.getFrequencyData()},Pi.prototype.updateCubeMap=function(Vu,ku){return console.warn('THREE.CubeCamera: .updateCubeMap() is now .update().'),this.update(Vu,ku)},yp.crossOrigin=void 0,yp.loadTexture=function(Vu,ku,Wu,ju){console.warn('THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.');var qu=new Do;qu.setCrossOrigin(this.crossOrigin);var Xu=qu.load(Vu,Wu,void 0,ju);return ku&&(Xu.mapping=ku),Xu},yp.loadTextureCube=function(Vu,ku,Wu,ju){console.warn('THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.');var qu=new Io;qu.setCrossOrigin(this.crossOrigin);var Xu=qu.load(Vu,Wu,void 0,ju);return ku&&(Xu.mapping=ku),Xu},yp.loadCompressedTexture=function(){console.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')},yp.loadCompressedTextureCube=function(){console.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')};var Du,zu,Nu,Bu,Uu,Gu,Ou;const Hu=0.02;$(document).ready(function(){vn()?(bn(),wn()):alert('Your graphics card does not seem to support WebGL.\n This game will not work.')})})();