var Start=function(S){'use strict';function M(){}function E(rg,ag){this.x=rg||0,this.y=ag||0}function L(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')}function A(rg,ag,og,ig){this._x=rg||0,this._y=ag||0,this._z=og||0,this._w=void 0===ig?1:ig}function C(rg,ag,og){this.x=rg||0,this.y=ag||0,this.z=og||0}function R(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')}function I(rg,ag,og,ig,ng,sg,lg,pg,dg,cg){Object.defineProperty(this,'id',{value:Tp++}),this.uuid=Sp.generateUUID(),this.name='',this.image=void 0===rg?I.DEFAULT_IMAGE:rg,this.mipmaps=[],this.mapping=void 0===ag?I.DEFAULT_MAPPING:ag,this.wrapS=void 0===og?Hs:og,this.wrapT=void 0===ig?Hs:ig,this.magFilter=void 0===ng?qs:ng,this.minFilter=void 0===sg?Xs:sg,this.anisotropy=void 0===dg?1:dg,this.format=void 0===lg?xl:lg,this.type=void 0===pg?Zs:pg,this.offset=new E(0,0),this.repeat=new E(1,1),this.center=new E(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new R,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0===cg?lp:cg,this.version=0,this.onUpdate=null}function D(rg,ag,og,ig){this.x=rg||0,this.y=ag||0,this.z=og||0,this.w=void 0===ig?1:ig}function U(rg,ag,og){this.width=rg,this.height=ag,this.scissor=new D(0,0,rg,ag),this.scissorTest=!1,this.viewport=new D(0,0,rg,ag),og=og||{},void 0===og.minFilter&&(og.minFilter=qs),this.texture=new I(void 0,void 0,og.wrapS,og.wrapT,og.magFilter,og.minFilter,og.format,og.type,og.anisotropy,og.encoding),this.texture.generateMipmaps=void 0===og.generateMipmaps||og.generateMipmaps,this.depthBuffer=void 0===og.depthBuffer||og.depthBuffer,this.stencilBuffer=void 0===og.stencilBuffer||og.stencilBuffer,this.depthTexture=void 0===og.depthTexture?null:og.depthTexture}function G(rg,ag,og){U.call(this,rg,ag,og),this.activeCubeFace=0,this.activeMipMapLevel=0}function O(rg,ag,og,ig,ng,sg,lg,pg,dg,cg,mg,ug){I.call(this,null,sg,lg,pg,dg,cg,ig,ng,mg,ug),this.image={data:rg,width:ag,height:og},this.magFilter=void 0===dg?ks:dg,this.minFilter=void 0===cg?ks:cg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function F(rg,ag){this.min=void 0===rg?new C(+Infinity,+Infinity,+Infinity):rg,this.max=void 0===ag?new C(-Infinity,-Infinity,-Infinity):ag}function H(rg,ag){this.center=void 0===rg?new C:rg,this.radius=void 0===ag?0:ag}function V(rg,ag){this.normal=void 0===rg?new C(1,0,0):rg,this.constant=void 0===ag?0:ag}function W(rg,ag,og,ig,ng,sg){this.planes=[void 0===rg?new V:rg,void 0===ag?new V:ag,void 0===og?new V:og,void 0===ig?new V:ig,void 0===ng?new V:ng,void 0===sg?new V:sg]}function Y(rg,ag,og){return void 0===ag&&void 0===og?this.set(rg):this.setRGB(rg,ag,og)}function X(){function rg(ng,sg){!1===og||(ig(ng,sg),ag.requestAnimationFrame(rg))}var ag=null,og=!1,ig=null;return{start:function(){!0==og||null==ig||(ag.requestAnimationFrame(rg),og=!0)},stop:function(){og=!1},setAnimationLoop:function(ng){ig=ng},setContext:function(ng){ag=ng}}}function Z(rg){function ag(pg,dg){var cg=pg.array,mg=pg.dynamic?35048:35044,ug=rg.createBuffer();rg.bindBuffer(dg,ug),rg.bufferData(dg,cg,mg),pg.onUploadCallback();var gg=5126;return cg instanceof Float32Array?gg=5126:cg instanceof Float64Array?console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.'):cg instanceof Uint16Array?gg=5123:cg instanceof Int16Array?gg=5122:cg instanceof Uint32Array?gg=5125:cg instanceof Int32Array?gg=5124:cg instanceof Int8Array?gg=5120:cg instanceof Uint8Array&&(gg=5121),{buffer:ug,type:gg,bytesPerElement:cg.BYTES_PER_ELEMENT,version:pg.version}}function og(pg,dg,cg){var mg=dg.array,ug=dg.updateRange;rg.bindBuffer(cg,pg),!1===dg.dynamic?rg.bufferData(cg,mg,35044):-1===ug.count?rg.bufferSubData(cg,0,mg):0===ug.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):(rg.bufferSubData(cg,ug.offset*mg.BYTES_PER_ELEMENT,mg.subarray(ug.offset,ug.offset+ug.count)),ug.count=-1)}var lg=new WeakMap;return{get:function(pg){return pg.isInterleavedBufferAttribute&&(pg=pg.data),lg.get(pg)},remove:function(pg){pg.isInterleavedBufferAttribute&&(pg=pg.data);var dg=lg.get(pg);dg&&(rg.deleteBuffer(dg.buffer),lg.delete(pg))},update:function(pg,dg){pg.isInterleavedBufferAttribute&&(pg=pg.data);var cg=lg.get(pg);void 0===cg?lg.set(pg,ag(pg,dg)):cg.version<pg.version&&(og(cg.buffer,pg,dg),cg.version=pg.version)}}}function J(rg,ag,og,ig,ng,sg){this.a=rg,this.b=ag,this.c=og,this.normal=ig&&ig.isVector3?ig:new C,this.vertexNormals=Array.isArray(ig)?ig:[],this.color=ng&&ng.isColor?ng:new Y,this.vertexColors=Array.isArray(ng)?ng:[],this.materialIndex=void 0===sg?0:sg}function Q(rg,ag,og,ig){this._x=rg||0,this._y=ag||0,this._z=og||0,this._order=ig||Q.DefaultOrder}function K(){this.mask=1}function ee(){Object.defineProperty(this,'id',{value:Yc++}),this.uuid=Sp.generateUUID(),this.name='',this.type='Object3D',this.parent=null,this.children=[],this.up=ee.DefaultUp.clone();var og=new C,ig=new Q,ng=new A,sg=new C(1,1,1);ig.onChange(function(){ng.setFromEuler(ig,!1)}),ng.onChange(function(){ig.setFromQuaternion(ng,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:og},rotation:{configurable:!0,enumerable:!0,value:ig},quaternion:{configurable:!0,enumerable:!0,value:ng},scale:{configurable:!0,enumerable:!0,value:sg},modelViewMatrix:{value:new L},normalMatrix:{value:new R}}),this.matrix=new L,this.matrixWorld=new L,this.matrixAutoUpdate=ee.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new K,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function re(){Object.defineProperty(this,'id',{value:Xc+=2}),this.uuid=Sp.generateUUID(),this.name='',this.type='Geometry',this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function oe(rg,ag,og){if(Array.isArray(rg))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.name='',this.array=rg,this.itemSize=ag,this.count=void 0===rg?0:rg.length/ag,this.normalized=!0===og,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ie(rg,ag,og){oe.call(this,new Int8Array(rg),ag,og)}function ne(rg,ag,og){oe.call(this,new Uint8Array(rg),ag,og)}function se(rg,ag,og){oe.call(this,new Uint8ClampedArray(rg),ag,og)}function le(rg,ag,og){oe.call(this,new Int16Array(rg),ag,og)}function pe(rg,ag,og){oe.call(this,new Uint16Array(rg),ag,og)}function ue(rg,ag,og){oe.call(this,new Int32Array(rg),ag,og)}function ge(rg,ag,og){oe.call(this,new Uint32Array(rg),ag,og)}function fe(rg,ag,og){oe.call(this,new Float32Array(rg),ag,og)}function he(rg,ag,og){oe.call(this,new Float64Array(rg),ag,og)}function ye(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function xe(rg){if(0===rg.length)return-Infinity;for(var ag=rg[0],og=1,ig=rg.length;og<ig;++og)rg[og]>ag&&(ag=rg[og]);return ag}function ve(){Object.defineProperty(this,'id',{value:Zc+=2}),this.uuid=Sp.generateUUID(),this.name='',this.type='BufferGeometry',this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:Infinity},this.userData={}}function _e(rg,ag,og,ig,ng,sg){re.call(this),this.type='BoxGeometry',this.parameters={width:rg,height:ag,depth:og,widthSegments:ig,heightSegments:ng,depthSegments:sg},this.fromBufferGeometry(new Se(rg,ag,og,ig,ng,sg)),this.mergeVertices()}function Se(rg,ag,og,ig,ng,sg){function lg(hg,yg,xg,vg,_g,bg,Sg,Mg,Tg,Eg,wg){var Ig=Tg+1,Dg=0,Bg=0,Gg=new C,Ng,Ug;for(Ug=0;Ug<Eg+1;Ug++){var Og=Ug*(Sg/Eg)-Sg/2;for(Ng=0;Ng<Ig;Ng++){var Fg=Ng*(bg/Tg)-bg/2;Gg[hg]=Fg*vg,Gg[yg]=Og*_g,Gg[xg]=Mg/2,cg.push(Gg.x,Gg.y,Gg.z),Gg[hg]=0,Gg[yg]=0,Gg[xg]=0<Mg?1:-1,mg.push(Gg.x,Gg.y,Gg.z),ug.push(Ng/Tg),ug.push(1-Ug/Eg),Dg+=1}}for(Ug=0;Ug<Eg;Ug++)for(Ng=0;Ng<Tg;Ng++){var Hg=gg+Ng+Ig*Ug,Vg=gg+Ng+Ig*(Ug+1),kg=gg+(Ng+1)+Ig*(Ug+1),Wg=gg+(Ng+1)+Ig*Ug;dg.push(Hg,Vg,Wg),dg.push(Vg,kg,Wg),Bg+=6}pg.addGroup(fg,Bg,wg),fg+=Bg,gg+=Dg}ve.call(this),this.type='BoxBufferGeometry',this.parameters={width:rg,height:ag,depth:og,widthSegments:ig,heightSegments:ng,depthSegments:sg};var pg=this;rg=rg||1,ag=ag||1,og=og||1,ig=Math.floor(ig)||1,ng=Math.floor(ng)||1,sg=Math.floor(sg)||1;var dg=[],cg=[],mg=[],ug=[],gg=0,fg=0;lg('z','y','x',-1,-1,og,ag,rg,sg,ng,0),lg('z','y','x',1,-1,og,ag,-rg,sg,ng,1),lg('x','z','y',1,1,rg,og,ag,ig,sg,2),lg('x','z','y',1,-1,rg,og,-ag,ig,sg,3),lg('x','y','z',1,-1,rg,ag,og,ig,ng,4),lg('x','y','z',-1,-1,rg,ag,-og,ig,ng,5),this.setIndex(dg),this.addAttribute('position',new fe(cg,3)),this.addAttribute('normal',new fe(mg,3)),this.addAttribute('uv',new fe(ug,2))}function Me(rg,ag,og,ig){re.call(this),this.type='PlaneGeometry',this.parameters={width:rg,height:ag,widthSegments:og,heightSegments:ig},this.fromBufferGeometry(new Te(rg,ag,og,ig)),this.mergeVertices()}function Te(rg,ag,og,ig){ve.call(this),this.type='PlaneBufferGeometry',this.parameters={width:rg,height:ag,widthSegments:og,heightSegments:ig},rg=rg||1,ag=ag||1;var ng=rg/2,sg=ag/2,lg=Math.floor(og)||1,pg=Math.floor(ig)||1,dg=lg+1,mg=rg/lg,ug=ag/pg,hg=[],yg=[],xg=[],vg=[],gg,fg;for(fg=0;fg<pg+1;fg++){var _g=fg*ug-sg;for(gg=0;gg<dg;gg++){var bg=gg*mg-ng;yg.push(bg,-_g,0),xg.push(0,0,1),vg.push(gg/lg),vg.push(1-fg/pg)}}for(fg=0;fg<pg;fg++)for(gg=0;gg<lg;gg++){var Sg=gg+dg*fg,Mg=gg+dg*(fg+1),Tg=gg+1+dg*(fg+1),Eg=gg+1+dg*fg;hg.push(Sg,Mg,Eg),hg.push(Mg,Tg,Eg)}this.setIndex(hg),this.addAttribute('position',new fe(yg,3)),this.addAttribute('normal',new fe(xg,3)),this.addAttribute('uv',new fe(vg,2))}function Ee(){Object.defineProperty(this,'id',{value:Jc++}),this.uuid=Sp.generateUUID(),this.name='',this.type='Material',this.fog=!0,this.lights=!0,this.blending=Yn,this.side=On,this.flatShading=!1,this.vertexColors=kn,this.opacity=1,this.transparent=!1,this.blendSrc=ss,this.blendDst=ls,this.blendEquation=Kn,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=xs,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function we(rg){Ee.call(this),this.type='ShaderMaterial',this.defines={},this.uniforms={},this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}',this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}',this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==rg&&(void 0!==rg.attributes&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(rg))}function Le(rg,ag){this.origin=void 0===rg?new C:rg,this.direction=void 0===ag?new C:ag}function Pe(rg,ag,og){this.a=void 0===rg?new C:rg,this.b=void 0===ag?new C:ag,this.c=void 0===og?new C:og}function Ae(rg){Ee.call(this),this.type='MeshBasicMaterial',this.color=new Y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ts,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(rg)}function Ce(rg,ag){ee.call(this),this.type='Mesh',this.geometry=void 0===rg?new ve:rg,this.material=void 0===ag?new Ae({color:16777215*Math.random()}):ag,this.drawMode=ip,this.updateMorphTargets()}function Re(rg,ag,og,ig){function sg(mg,ug){ag.buffers.color.setClear(mg.r,mg.g,mg.b,ug,ig)}var lg=new Y(0),pg=0,dg,cg;return{getClearColor:function(){return lg},setClearColor:function(mg,ug){lg.set(mg),pg=void 0===ug?1:ug,sg(lg,pg)},getClearAlpha:function(){return pg},setClearAlpha:function(mg){pg=mg,sg(lg,pg)},render:function(mg,ug,gg,fg){var hg=ug.background;null===hg?sg(lg,pg):hg&&hg.isColor&&(sg(hg,1),fg=!0),(rg.autoClear||fg)&&rg.clear(rg.autoClearColor,rg.autoClearDepth,rg.autoClearStencil),hg&&(hg.isCubeTexture||hg.isWebGLRenderTargetCube)?(void 0===cg&&(cg=new Ce(new Se(1,1,1),new we({type:'BackgroundCubeMaterial',uniforms:kc.clone(qc.cube.uniforms),vertexShader:qc.cube.vertexShader,fragmentShader:qc.cube.fragmentShader,side:Fn,depthTest:!0,depthWrite:!1,fog:!1})),cg.geometry.removeAttribute('normal'),cg.geometry.removeAttribute('uv'),cg.onBeforeRender=function(yg,xg,vg){this.matrixWorld.copyPosition(vg.matrixWorld)},Object.defineProperty(cg.material,'envMap',{get:function(){return this.uniforms.tCube.value}}),og.update(cg)),cg.material.uniforms.tCube.value=hg.isWebGLRenderTargetCube?hg.texture:hg,cg.material.uniforms.tFlip.value=hg.isWebGLRenderTargetCube?1:-1,mg.push(cg,cg.geometry,cg.material,0,null)):hg&&hg.isTexture&&(void 0===dg&&(dg=new Ce(new Te(2,2),new we({type:'BackgroundMaterial',uniforms:kc.clone(qc.background.uniforms),vertexShader:qc.background.vertexShader,fragmentShader:qc.background.fragmentShader,side:On,depthTest:!0,depthWrite:!1,fog:!1})),dg.geometry.removeAttribute('normal'),Object.defineProperty(dg.material,'map',{get:function(){return this.uniforms.t2D.value}}),og.update(dg)),dg.material.uniforms.t2D.value=hg,!0===hg.matrixAutoUpdate&&hg.updateMatrix(),dg.material.uniforms.uvTransform.value.copy(hg.matrix),mg.push(dg,dg.geometry,dg.material,0,null))}}}function Ie(rg,ag,og,ig){var pg;this.setMode=function(dg){pg=dg},this.render=function(dg,cg){rg.drawArrays(pg,dg,cg),og.update(cg,pg)},this.renderInstances=function(dg,cg,mg){var ug;if(ig.isWebGL2)ug=rg;else if(ug=ag.get('ANGLE_instanced_arrays'),null===ug)return void console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');ug[ig.isWebGL2?'drawArraysInstanced':'drawArraysInstancedANGLE'](pg,cg,mg,dg.maxInstancedCount),og.update(mg,pg,dg.maxInstancedCount)}}function ze(rg,ag,og){function ng(Mg){if('highp'===Mg){if(0<rg.getShaderPrecisionFormat(35633,36338).precision&&0<rg.getShaderPrecisionFormat(35632,36338).precision)return'highp';Mg='mediump'}return'mediump'===Mg&&0<rg.getShaderPrecisionFormat(35633,36337).precision&&0<rg.getShaderPrecisionFormat(35632,36337).precision?'mediump':'lowp'}var lg='undefined'!=typeof WebGL2RenderingContext&&rg instanceof WebGL2RenderingContext,pg=void 0===og.precision?'highp':og.precision,dg=ng(pg),sg;dg!==pg&&(console.warn('THREE.WebGLRenderer:',pg,'not supported, using',dg,'instead.'),pg=dg);var cg=!0===og.logarithmicDepthBuffer,mg=rg.getParameter(34930),ug=rg.getParameter(35660),gg=rg.getParameter(3379),fg=rg.getParameter(34076),hg=rg.getParameter(34921),yg=rg.getParameter(36347),xg=rg.getParameter(36348),vg=rg.getParameter(36349),_g=0<ug,bg=lg||!!ag.get('OES_texture_float');return{isWebGL2:lg,getMaxAnisotropy:function(){if(void 0!==sg)return sg;var Mg=ag.get('EXT_texture_filter_anisotropic');return sg=null===Mg?0:rg.getParameter(Mg.MAX_TEXTURE_MAX_ANISOTROPY_EXT),sg},getMaxPrecision:ng,precision:pg,logarithmicDepthBuffer:cg,maxTextures:mg,maxVertexTextures:ug,maxTextureSize:gg,maxCubemapSize:fg,maxAttributes:hg,maxVertexUniforms:yg,maxVaryings:xg,maxFragmentUniforms:vg,vertexTextures:_g,floatFragmentTextures:bg,floatVertexTextures:_g&&bg}}function De(){function rg(){cg.value!==ig&&(cg.value=ig,cg.needsUpdate=0<ng),og.numPlanes=ng,og.numIntersection=0}function ag(mg,ug,gg,fg){var hg=null===mg?0:mg.length,yg=null;if(0!==hg){if(yg=cg.value,!0!==fg||null==yg){var xg=gg+4*hg,vg=ug.matrixWorldInverse;dg.getNormalMatrix(vg),(null==yg||yg.length<xg)&&(yg=new Float32Array(xg));for(var _g=0,bg=gg;_g!==hg;++_g,bg+=4)pg.copy(mg[_g]).applyMatrix4(vg,dg),pg.normal.toArray(yg,bg),yg[bg+3]=pg.constant}cg.value=yg,cg.needsUpdate=!0}return og.numPlanes=hg,yg}var og=this,ig=null,ng=0,sg=!1,lg=!1,pg=new V,dg=new R,cg={value:null,needsUpdate:!1};this.uniform=cg,this.numPlanes=0,this.numIntersection=0,this.init=function(mg,ug,gg){var fg=0!==mg.length||ug||0!=ng||sg;return sg=ug,ig=ag(mg,gg,0),ng=mg.length,fg},this.beginShadows=function(){lg=!0,ag(null)},this.endShadows=function(){lg=!1,rg()},this.setState=function(mg,ug,gg,fg,hg,yg){if(!sg||null===mg||0===mg.length||lg&&!gg)lg?ag(null):rg();else{var xg=lg?0:ng,vg=4*xg,_g=hg.clippingState||null;cg.value=_g,_g=ag(mg,fg,vg,yg);for(var bg=0;bg!==vg;++bg)_g[bg]=ig[bg];hg.clippingState=_g,this.numIntersection=ug?this.numPlanes:0,this.numPlanes+=xg}}}function Be(rg){var ag={};return{get:function(og){if(void 0!==ag[og])return ag[og];var ig;return ig='WEBGL_depth_texture'===og?rg.getExtension('WEBGL_depth_texture')||rg.getExtension('MOZ_WEBGL_depth_texture')||rg.getExtension('WEBKIT_WEBGL_depth_texture'):'EXT_texture_filter_anisotropic'===og?rg.getExtension('EXT_texture_filter_anisotropic')||rg.getExtension('MOZ_EXT_texture_filter_anisotropic')||rg.getExtension('WEBKIT_EXT_texture_filter_anisotropic'):'WEBGL_compressed_texture_s3tc'===og?rg.getExtension('WEBGL_compressed_texture_s3tc')||rg.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||rg.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc'):'WEBGL_compressed_texture_pvrtc'===og?rg.getExtension('WEBGL_compressed_texture_pvrtc')||rg.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'):rg.getExtension(og),null===ig&&console.warn('THREE.WebGLRenderer: '+og+' extension not supported.'),ag[og]=ig,ig}}}function Ne(rg,ag,og){function ig(cg){var mg=cg.target,ug=pg[mg.id];for(var gg in null!==ug.index&&ag.remove(ug.index),ug.attributes)ag.remove(ug.attributes[gg]);mg.removeEventListener('dispose',ig),delete pg[mg.id];var fg=dg[ug.id];fg&&(ag.remove(fg),delete dg[ug.id]),og.memory.geometries--}var pg={},dg={};return{get:function(cg,mg){var ug=pg[mg.id];return ug?ug:(mg.addEventListener('dispose',ig),mg.isBufferGeometry?ug=mg:mg.isGeometry&&(void 0===mg._bufferGeometry&&(mg._bufferGeometry=new ve().setFromObject(cg)),ug=mg._bufferGeometry),pg[mg.id]=ug,og.memory.geometries++,ug)},update:function(cg){var mg=cg.index,ug=cg.attributes;for(var gg in null!==mg&&ag.update(mg,34963),ug)ag.update(ug[gg],34962);var fg=cg.morphAttributes;for(var gg in fg)for(var hg=fg[gg],yg=0,xg=hg.length;yg<xg;yg++)ag.update(hg[yg],34962)},getWireframeAttribute:function(cg){var mg=dg[cg.id];if(mg)return mg;var ug=[],gg=cg.index,fg=cg.attributes;if(null!==gg)for(var hg=gg.array,yg=0,xg=hg.length;yg<xg;yg+=3){var vg=hg[yg+0],_g=hg[yg+1],bg=hg[yg+2];ug.push(vg,_g,_g,bg,bg,vg)}else for(var hg=fg.position.array,yg=0,xg=hg.length/3-1;yg<xg;yg+=3){var vg=yg+0,_g=yg+1,bg=yg+2;ug.push(vg,_g,_g,bg,bg,vg)}return mg=new(65535<xe(ug)?ge:pe)(ug,1),ag.update(mg,34963),dg[cg.id]=mg,mg}}}function Ue(rg,ag,og,ig){var dg,cg,mg;this.setMode=function(ug){dg=ug},this.setIndex=function(ug){cg=ug.type,mg=ug.bytesPerElement},this.render=function(ug,gg){rg.drawElements(dg,gg,cg,ug*mg),og.update(gg,dg)},this.renderInstances=function(ug,gg,fg){var hg;if(ig.isWebGL2)hg=rg;else{var hg=ag.get('ANGLE_instanced_arrays');if(null===hg)return void console.error('THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.')}hg[ig.isWebGL2?'drawElementsInstanced':'drawElementsInstancedANGLE'](dg,fg,cg,gg*mg,ug.maxInstancedCount),og.update(fg,dg,ug.maxInstancedCount)}}function Ge(){var ng={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:ng,programs:null,autoReset:!0,reset:function(){ng.frame++,ng.calls=0,ng.triangles=0,ng.points=0,ng.lines=0},update:function(sg,lg,pg){switch(pg=pg||1,ng.calls++,lg){case 4:ng.triangles+=pg*(sg/3);break;case 5:case 6:ng.triangles+=pg*(sg-2);break;case 1:ng.lines+=pg*(sg/2);break;case 3:ng.lines+=pg*(sg-1);break;case 2:ng.lines+=pg*sg;break;case 0:ng.points+=pg*sg;break;default:console.error('THREE.WebGLInfo: Unknown draw mode:',lg);}}}}function Oe(rg,ag){return Math.abs(ag[1])-Math.abs(rg[1])}function Fe(rg){var og={},ig=new Float32Array(8);return{update:function(ng,sg,lg,pg){var dg=ng.morphTargetInfluences,cg=dg.length,mg=og[sg.id];if(void 0===mg){mg=[];for(var ug=0;ug<cg;ug++)mg[ug]=[ug,0];og[sg.id]=mg}for(var gg=lg.morphTargets&&sg.morphAttributes.position,fg=lg.morphNormals&&sg.morphAttributes.normal,ug=0,hg;ug<cg;ug++)hg=mg[ug],0!==hg[1]&&(gg&&sg.removeAttribute('morphTarget'+ug),fg&&sg.removeAttribute('morphNormal'+ug));for(var ug=0,hg;ug<cg;ug++)hg=mg[ug],hg[0]=ug,hg[1]=dg[ug];mg.sort(Oe);for(var ug=0,hg;8>ug;ug++){if(hg=mg[ug],hg){var yg=hg[0],xg=hg[1];if(xg){gg&&sg.addAttribute('morphTarget'+ug,gg[yg]),fg&&sg.addAttribute('morphNormal'+ug,fg[yg]),ig[ug]=xg;continue}}ig[ug]=0}pg.getUniforms().setValue(rg,'morphTargetInfluences',ig)}}}function He(rg,ag){var ng={};return{update:function(sg){var lg=ag.render.frame,pg=sg.geometry,dg=rg.get(sg,pg);return ng[dg.id]!==lg&&(pg.isGeometry&&dg.updateFromObject(sg),rg.update(dg),ng[dg.id]=lg),dg},dispose:function(){ng={}}}}function Ve(rg,ag,og,ig,ng,sg,lg,pg,dg,cg){rg=void 0===rg?[]:rg,ag=void 0===ag?zs:ag,I.call(this,rg,ag,og,ig,ng,sg,lg,pg,dg,cg),this.flipY=!1}function ke(rg,ag,og,ig){I.call(this,null),this.image={data:rg,width:ag,height:og,depth:ig},this.magFilter=ks,this.minFilter=ks,this.generateMipmaps=!1,this.flipY=!1}function We(){this.seq=[],this.map={}}function je(rg,ag,og){var ig=rg[0];if(0>=ig||0<ig)return rg;var ng=ag*og,sg=em[ng];if(void 0===sg&&(sg=new Float32Array(ng),em[ng]=sg),0!==ag){ig.toArray(sg,0);for(var lg=1,pg=0;lg!==ag;++lg)pg+=og,rg[lg].toArray(sg,pg)}return sg}function qe(rg,ag){if(rg.length!==ag.length)return!1;for(var og=0,ig=rg.length;og<ig;og++)if(rg[og]!==ag[og])return!1;return!0}function Ye(rg,ag){for(var og=0,ig=ag.length;og<ig;og++)rg[og]=ag[og]}function Xe(rg,ag){var og=tm[ag];void 0===og&&(og=new Int32Array(ag),tm[ag]=og);for(var ig=0;ig!==ag;++ig)og[ig]=rg.allocTextureUnit();return og}function Ze(rg,ag){var og=this.cache;og[0]===ag||(rg.uniform1f(this.addr,ag),og[0]=ag)}function Je(rg,ag){var og=this.cache;og[0]===ag||(rg.uniform1i(this.addr,ag),og[0]=ag)}function Qe(rg,ag){var og=this.cache;if(void 0!==ag.x)(og[0]!==ag.x||og[1]!==ag.y)&&(rg.uniform2f(this.addr,ag.x,ag.y),og[0]=ag.x,og[1]=ag.y);else{if(qe(og,ag))return;rg.uniform2fv(this.addr,ag),Ye(og,ag)}}function Ke(rg,ag){var og=this.cache;if(void 0!==ag.x)(og[0]!==ag.x||og[1]!==ag.y||og[2]!==ag.z)&&(rg.uniform3f(this.addr,ag.x,ag.y,ag.z),og[0]=ag.x,og[1]=ag.y,og[2]=ag.z);else if(void 0!==ag.r)(og[0]!==ag.r||og[1]!==ag.g||og[2]!==ag.b)&&(rg.uniform3f(this.addr,ag.r,ag.g,ag.b),og[0]=ag.r,og[1]=ag.g,og[2]=ag.b);else{if(qe(og,ag))return;rg.uniform3fv(this.addr,ag),Ye(og,ag)}}function $e(rg,ag){var og=this.cache;if(void 0!==ag.x)(og[0]!==ag.x||og[1]!==ag.y||og[2]!==ag.z||og[3]!==ag.w)&&(rg.uniform4f(this.addr,ag.x,ag.y,ag.z,ag.w),og[0]=ag.x,og[1]=ag.y,og[2]=ag.z,og[3]=ag.w);else{if(qe(og,ag))return;rg.uniform4fv(this.addr,ag),Ye(og,ag)}}function et(rg,ag){var og=this.cache,ig=ag.elements;if(void 0===ig){if(qe(og,ag))return;rg.uniformMatrix2fv(this.addr,!1,ag),Ye(og,ag)}else{if(qe(og,ig))return;om.set(ig),rg.uniformMatrix2fv(this.addr,!1,om),Ye(og,ig)}}function tt(rg,ag){var og=this.cache,ig=ag.elements;if(void 0===ig){if(qe(og,ag))return;rg.uniformMatrix3fv(this.addr,!1,ag),Ye(og,ag)}else{if(qe(og,ig))return;am.set(ig),rg.uniformMatrix3fv(this.addr,!1,am),Ye(og,ig)}}function rt(rg,ag){var og=this.cache,ig=ag.elements;if(void 0===ig){if(qe(og,ag))return;rg.uniformMatrix4fv(this.addr,!1,ag),Ye(og,ag)}else{if(qe(og,ig))return;rm.set(ig),rg.uniformMatrix4fv(this.addr,!1,rm),Ye(og,ig)}}function at(rg,ag,og){var ig=this.cache,ng=og.allocTextureUnit();ig[0]!==ng&&(rg.uniform1i(this.addr,ng),ig[0]=ng),og.setTexture2D(ag||Qc,ng)}function ot(rg,ag,og){var ig=this.cache,ng=og.allocTextureUnit();ig[0]!==ng&&(rg.uniform1i(this.addr,ng),ig[0]=ng),og.setTexture3D(ag||Kc,ng)}function it(rg,ag,og){var ig=this.cache,ng=og.allocTextureUnit();ig[0]!==ng&&(rg.uniform1i(this.addr,ng),ig[0]=ng),og.setTextureCube(ag||$c,ng)}function nt(rg,ag){var og=this.cache;qe(og,ag)||(rg.uniform2iv(this.addr,ag),Ye(og,ag))}function st(rg,ag){var og=this.cache;qe(og,ag)||(rg.uniform3iv(this.addr,ag),Ye(og,ag))}function lt(rg,ag){var og=this.cache;qe(og,ag)||(rg.uniform4iv(this.addr,ag),Ye(og,ag))}function dt(rg){return 5126===rg?Ze:35664===rg?Qe:35665===rg?Ke:35666===rg?$e:35674===rg?et:35675===rg?tt:35676===rg?rt:35678===rg||36198===rg?at:35679===rg?ot:35680===rg?it:5124===rg||35670===rg?Je:35667===rg||35671===rg?nt:35668===rg||35672===rg?st:35669===rg||35673===rg?lt:void 0}function ct(rg,ag){var og=this.cache;qe(og,ag)||(rg.uniform1fv(this.addr,ag),Ye(og,ag))}function mt(rg,ag){var og=this.cache;qe(og,ag)||(rg.uniform1iv(this.addr,ag),Ye(og,ag))}function ut(rg,ag){var og=this.cache,ig=je(ag,this.size,2);qe(og,ig)||(rg.uniform2fv(this.addr,ig),this.updateCache(ig))}function gt(rg,ag){var og=this.cache,ig=je(ag,this.size,3);qe(og,ig)||(rg.uniform3fv(this.addr,ig),this.updateCache(ig))}function ft(rg,ag){var og=this.cache,ig=je(ag,this.size,4);qe(og,ig)||(rg.uniform4fv(this.addr,ig),this.updateCache(ig))}function ht(rg,ag){var og=this.cache,ig=je(ag,this.size,4);qe(og,ig)||(rg.uniformMatrix2fv(this.addr,!1,ig),this.updateCache(ig))}function yt(rg,ag){var og=this.cache,ig=je(ag,this.size,9);qe(og,ig)||(rg.uniformMatrix3fv(this.addr,!1,ig),this.updateCache(ig))}function xt(rg,ag){var og=this.cache,ig=je(ag,this.size,16);qe(og,ig)||(rg.uniformMatrix4fv(this.addr,!1,ig),this.updateCache(ig))}function vt(rg,ag,og){var ig=this.cache,ng=ag.length,sg=Xe(og,ng);!1===qe(ig,sg)&&(rg.uniform1iv(this.addr,sg),Ye(ig,sg));for(var lg=0;lg!==ng;++lg)og.setTexture2D(ag[lg]||Qc,sg[lg])}function _t(rg,ag,og){var ig=this.cache,ng=ag.length,sg=Xe(og,ng);!1===qe(ig,sg)&&(rg.uniform1iv(this.addr,sg),Ye(ig,sg));for(var lg=0;lg!==ng;++lg)og.setTextureCube(ag[lg]||$c,sg[lg])}function bt(rg){return 5126===rg?ct:35664===rg?ut:35665===rg?gt:35666===rg?ft:35674===rg?ht:35675===rg?yt:35676===rg?xt:35678===rg?vt:35680===rg?_t:5124===rg||35670===rg?mt:35667===rg||35671===rg?nt:35668===rg||35672===rg?st:35669===rg||35673===rg?lt:void 0}function St(rg,ag,og){this.id=rg,this.addr=og,this.cache=[],this.setValue=dt(ag.type)}function Mt(rg,ag,og){this.id=rg,this.addr=og,this.cache=[],this.size=ag.size,this.setValue=bt(ag.type)}function Tt(rg){this.id=rg,We.call(this)}function Et(rg,ag){rg.seq.push(ag),rg.map[ag.id]=ag}function wt(rg,ag,og){var ig=rg.name,ng=ig.length;for(im.lastIndex=0;;){var sg=im.exec(ig),lg=im.lastIndex,pg=sg[1],dg=']'===sg[2],cg=sg[3];if(dg&&(pg|=0),void 0===cg||'['===cg&&lg+2===ng){Et(og,void 0===cg?new St(pg,rg,ag):new Mt(pg,rg,ag));break}else{var mg=og.map,ug=mg[pg];void 0===ug&&(ug=new Tt(pg),Et(og,ug)),og=ug}}}function Lt(rg,ag,og){We.call(this),this.renderer=og;for(var ig=rg.getProgramParameter(ag,35718),ng=0;ng<ig;++ng){var sg=rg.getActiveUniform(ag,ng),lg=rg.getUniformLocation(ag,sg.name);wt(sg,lg,this)}}function Pt(rg){for(var ag=rg.split('\n'),og=0;og<ag.length;og++)ag[og]=og+1+': '+ag[og];return ag.join('\n')}function At(rg,ag,og){var ig=rg.createShader(ag);return rg.shaderSource(ig,og),rg.compileShader(ig),!1===rg.getShaderParameter(ig,35713)&&console.error('THREE.WebGLShader: Shader couldn\'t compile.'),''!==rg.getShaderInfoLog(ig)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',35633===ag?'vertex':'fragment',rg.getShaderInfoLog(ig),Pt(og)),ig}function Ct(rg){switch(rg){case lp:return['Linear','( value )'];case 3001:return['sRGB','( value )'];case 3002:return['RGBE','( value )'];case 3004:return['RGBM','( value, 7.0 )'];case 3005:return['RGBM','( value, 16.0 )'];case 3006:return['RGBD','( value, 256.0 )'];case cp:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw new Error('unsupported encoding: '+rg);}}function Rt(rg,ag){var og=Ct(ag);return'vec4 '+rg+'( vec4 value ) { return '+og[0]+'ToLinear'+og[1]+'; }'}function It(rg,ag){var og=Ct(ag);return'vec4 '+rg+'( vec4 value ) { return LinearTo'+og[0]+og[1]+'; }'}function zt(rg,ag){var og;switch(ag){case Ps:og='Linear';break;case 2:og='Reinhard';break;case 3:og='Uncharted2';break;case 4:og='OptimizedCineon';break;default:throw new Error('unsupported toneMapping: '+ag);}return'vec3 '+rg+'( vec3 color ) { return '+og+'ToneMapping( color ); }'}function Dt(rg,ag,og){rg=rg||{};var ig=[rg.derivatives||ag.envMapCubeUV||ag.bumpMap||ag.normalMap&&!ag.objectSpaceNormalMap||ag.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(rg.fragDepth||ag.logarithmicDepthBuffer)&&og.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',rg.drawBuffers&&og.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(rg.shaderTextureLOD||ag.envMap)&&og.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''];return ig.filter(Ut).join('\n')}function Bt(rg){var ag=[];for(var og in rg){var ig=rg[og];!1===ig||ag.push('#define '+og+' '+ig)}return ag.join('\n')}function Nt(rg,ag){for(var og={},ig=rg.getProgramParameter(ag,35721),ng=0;ng<ig;ng++){var sg=rg.getActiveAttrib(ag,ng),lg=sg.name;og[lg]=rg.getAttribLocation(ag,lg)}return og}function Ut(rg){return''!==rg}function Gt(rg,ag){return rg.replace(/NUM_DIR_LIGHTS/g,ag.numDirLights).replace(/NUM_SPOT_LIGHTS/g,ag.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,ag.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,ag.numPointLights).replace(/NUM_HEMI_LIGHTS/g,ag.numHemiLights)}function Ot(rg,ag){return rg.replace(/NUM_CLIPPING_PLANES/g,ag.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,ag.numClippingPlanes-ag.numClipIntersection)}function Ft(rg){var og=/^[ \t]*#include +<([\w\d./]+)>/gm;return rg.replace(og,function(ig,ng){var sg=Vc[ng];if(void 0===sg)throw new Error('Can not resolve #include <'+ng+'>');return Ft(sg)})}function Ht(rg){var og=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return rg.replace(og,function(ig,ng,sg,lg){for(var pg='',dg=parseInt(ng);dg<parseInt(sg);dg++)pg+=lg.replace(/\[ i \]/g,'[ '+dg+' ]');return pg})}function Vt(rg,ag,og,ig,ng,sg,lg){var pg=rg.context,dg=ig.defines,cg=ng.vertexShader,mg=ng.fragmentShader,ug='SHADOWMAP_TYPE_BASIC';sg.shadowMapType===Un?ug='SHADOWMAP_TYPE_PCF':sg.shadowMapType===2&&(ug='SHADOWMAP_TYPE_PCF_SOFT');var gg='ENVMAP_TYPE_CUBE',fg='ENVMAP_MODE_REFLECTION',hg='ENVMAP_BLENDING_MULTIPLY';if(sg.envMap){switch(ig.envMap.mapping){case zs:case Ds:gg='ENVMAP_TYPE_CUBE';break;case Gs:case Os:gg='ENVMAP_TYPE_CUBE_UV';break;case Bs:case Ns:gg='ENVMAP_TYPE_EQUIREC';break;case Us:gg='ENVMAP_TYPE_SPHERE';}switch(ig.envMap.mapping){case Ds:case Ns:fg='ENVMAP_MODE_REFRACTION';}switch(ig.combine){case Ts:hg='ENVMAP_BLENDING_MULTIPLY';break;case 1:hg='ENVMAP_BLENDING_MIX';break;case 2:hg='ENVMAP_BLENDING_ADD';}}var yg=0<rg.gammaFactor?rg.gammaFactor:1,xg=lg.isWebGL2?'':Dt(ig.extensions,sg,ag),vg=Bt(dg),_g=pg.createProgram(),bg,Sg;if(ig.isRawShaderMaterial?(bg=[vg].filter(Ut).join('\n'),0<bg.length&&(bg+='\n'),Sg=[xg,vg].filter(Ut).join('\n'),0<Sg.length&&(Sg+='\n')):(bg=['precision '+sg.precision+' float;','precision '+sg.precision+' int;','#define SHADER_NAME '+ng.name,vg,sg.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+yg,'#define MAX_BONES '+sg.maxBones,sg.useFog&&sg.fog?'#define USE_FOG':'',sg.useFog&&sg.fogExp?'#define FOG_EXP2':'',sg.map?'#define USE_MAP':'',sg.envMap?'#define USE_ENVMAP':'',sg.envMap?'#define '+fg:'',sg.lightMap?'#define USE_LIGHTMAP':'',sg.aoMap?'#define USE_AOMAP':'',sg.emissiveMap?'#define USE_EMISSIVEMAP':'',sg.bumpMap?'#define USE_BUMPMAP':'',sg.normalMap?'#define USE_NORMALMAP':'',sg.normalMap&&sg.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',sg.displacementMap&&sg.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',sg.specularMap?'#define USE_SPECULARMAP':'',sg.roughnessMap?'#define USE_ROUGHNESSMAP':'',sg.metalnessMap?'#define USE_METALNESSMAP':'',sg.alphaMap?'#define USE_ALPHAMAP':'',sg.vertexColors?'#define USE_COLOR':'',sg.flatShading?'#define FLAT_SHADED':'',sg.skinning?'#define USE_SKINNING':'',sg.useVertexTexture?'#define BONE_TEXTURE':'',sg.morphTargets?'#define USE_MORPHTARGETS':'',sg.morphNormals&&!1===sg.flatShading?'#define USE_MORPHNORMALS':'',sg.doubleSided?'#define DOUBLE_SIDED':'',sg.flipSided?'#define FLIP_SIDED':'',sg.shadowMapEnabled?'#define USE_SHADOWMAP':'',sg.shadowMapEnabled?'#define '+ug:'',sg.sizeAttenuation?'#define USE_SIZEATTENUATION':'',sg.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',sg.logarithmicDepthBuffer&&(lg.isWebGL2||ag.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(Ut).join('\n'),Sg=[xg,'precision '+sg.precision+' float;','precision '+sg.precision+' int;','#define SHADER_NAME '+ng.name,vg,sg.alphaTest?'#define ALPHATEST '+sg.alphaTest+(sg.alphaTest%1?'':'.0'):'','#define GAMMA_FACTOR '+yg,sg.useFog&&sg.fog?'#define USE_FOG':'',sg.useFog&&sg.fogExp?'#define FOG_EXP2':'',sg.map?'#define USE_MAP':'',sg.envMap?'#define USE_ENVMAP':'',sg.envMap?'#define '+gg:'',sg.envMap?'#define '+fg:'',sg.envMap?'#define '+hg:'',sg.lightMap?'#define USE_LIGHTMAP':'',sg.aoMap?'#define USE_AOMAP':'',sg.emissiveMap?'#define USE_EMISSIVEMAP':'',sg.bumpMap?'#define USE_BUMPMAP':'',sg.normalMap?'#define USE_NORMALMAP':'',sg.normalMap&&sg.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',sg.specularMap?'#define USE_SPECULARMAP':'',sg.roughnessMap?'#define USE_ROUGHNESSMAP':'',sg.metalnessMap?'#define USE_METALNESSMAP':'',sg.alphaMap?'#define USE_ALPHAMAP':'',sg.vertexColors?'#define USE_COLOR':'',sg.gradientMap?'#define USE_GRADIENTMAP':'',sg.flatShading?'#define FLAT_SHADED':'',sg.doubleSided?'#define DOUBLE_SIDED':'',sg.flipSided?'#define FLIP_SIDED':'',sg.shadowMapEnabled?'#define USE_SHADOWMAP':'',sg.shadowMapEnabled?'#define '+ug:'',sg.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':'',sg.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',sg.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',sg.logarithmicDepthBuffer&&(lg.isWebGL2||ag.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'',sg.envMap&&(lg.isWebGL2||ag.get('EXT_shader_texture_lod'))?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',sg.toneMapping===Ls?'':'#define TONE_MAPPING',sg.toneMapping===Ls?'':Vc.tonemapping_pars_fragment,sg.toneMapping===Ls?'':zt('toneMapping',sg.toneMapping),sg.dithering?'#define DITHERING':'',sg.outputEncoding||sg.mapEncoding||sg.matcapEncoding||sg.envMapEncoding||sg.emissiveMapEncoding?Vc.encodings_pars_fragment:'',sg.mapEncoding?Rt('mapTexelToLinear',sg.mapEncoding):'',sg.matcapEncoding?Rt('matcapTexelToLinear',sg.matcapEncoding):'',sg.envMapEncoding?Rt('envMapTexelToLinear',sg.envMapEncoding):'',sg.emissiveMapEncoding?Rt('emissiveMapTexelToLinear',sg.emissiveMapEncoding):'',sg.outputEncoding?It('linearToOutputTexel',sg.outputEncoding):'',sg.depthPacking?'#define DEPTH_PACKING '+ig.depthPacking:'','\n'].filter(Ut).join('\n')),cg=Ft(cg),cg=Gt(cg,sg),cg=Ot(cg,sg),mg=Ft(mg),mg=Gt(mg,sg),mg=Ot(mg,sg),cg=Ht(cg),mg=Ht(mg),lg.isWebGL2&&!ig.isRawShaderMaterial){var Mg=!1,Tg=/^\s*#version\s+300\s+es\s*\n/;ig.isShaderMaterial&&null!==cg.match(Tg)&&null!==mg.match(Tg)&&(Mg=!0,cg=cg.replace(Tg,''),mg=mg.replace(Tg,'')),bg=['#version 300 es\n','#define attribute in','#define varying out','#define texture2D texture'].join('\n')+'\n'+bg,Sg=['#version 300 es\n','#define varying in',Mg?'':'out highp vec4 pc_fragColor;',Mg?'':'#define gl_FragColor pc_fragColor','#define gl_FragDepthEXT gl_FragDepth','#define texture2D texture','#define textureCube texture','#define texture2DProj textureProj','#define texture2DLodEXT textureLod','#define texture2DProjLodEXT textureProjLod','#define textureCubeLodEXT textureLod','#define texture2DGradEXT textureGrad','#define texture2DProjGradEXT textureProjGrad','#define textureCubeGradEXT textureGrad'].join('\n')+'\n'+Sg}var Eg=bg+cg,wg=Sg+mg,Lg=At(pg,35633,Eg),Pg=At(pg,35632,wg);pg.attachShader(_g,Lg),pg.attachShader(_g,Pg),void 0===ig.index0AttributeName?!0===sg.morphTargets&&pg.bindAttribLocation(_g,0,'position'):pg.bindAttribLocation(_g,0,ig.index0AttributeName),pg.linkProgram(_g);var Ag=pg.getProgramInfoLog(_g).trim(),Cg=pg.getShaderInfoLog(Lg).trim(),Rg=pg.getShaderInfoLog(Pg).trim(),Ig=!0,zg=!0;!1===pg.getProgramParameter(_g,35714)?(Ig=!1,console.error('THREE.WebGLProgram: shader error: ',pg.getError(),'35715',pg.getProgramParameter(_g,35715),'gl.getProgramInfoLog',Ag,Cg,Rg)):''===Ag?(''===Cg||''===Rg)&&(zg=!1):console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',Ag),zg&&(this.diagnostics={runnable:Ig,material:ig,programLog:Ag,vertexShader:{log:Cg,prefix:bg},fragmentShader:{log:Rg,prefix:Sg}}),pg.deleteShader(Lg),pg.deleteShader(Pg);var Dg;this.getUniforms=function(){return void 0==Dg&&(Dg=new Lt(pg,_g,rg)),Dg};var Bg;return this.getAttributes=function(){return void 0==Bg&&(Bg=Nt(pg,_g)),Bg},this.destroy=function(){pg.deleteProgram(_g),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().'),this.getUniforms()}},attributes:{get:function(){return console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().'),this.getAttributes()}}}),this.name=ng.name,this.id=nm++,this.code=og,this.usedTimes=1,this.program=_g,this.vertexShader=Lg,this.fragmentShader=Pg,this}function kt(rg,ag,og){function ig(dg){var cg=dg.skeleton,mg=cg.bones;if(og.floatVertexTextures)return 1024;var ug=og.maxVertexUniforms,gg=Math.floor((ug-20)/4),fg=Math.min(gg,mg.length);return fg<mg.length?(console.warn('THREE.WebGLRenderer: Skeleton has '+mg.length+' bones. This GPU supports '+fg+'.'),0):fg}function ng(dg,cg){var mg;return dg?dg.isTexture?mg=dg.encoding:dg.isWebGLRenderTarget&&(console.warn('THREE.WebGLPrograms.getTextureEncodingFromMap: don\'t use render targets as textures. Use their .texture property instead.'),mg=dg.texture.encoding):mg=lp,mg===lp&&cg&&(mg=cp),mg}var sg=[],lg={MeshDepthMaterial:'depth',MeshDistanceMaterial:'distanceRGBA',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',MeshToonMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',MeshMatcapMaterial:'matcap',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points',ShadowMaterial:'shadow',SpriteMaterial:'sprite'},pg=['precision','supportsVertexTextures','map','mapEncoding','matcapEncoding','envMap','envMapMode','envMapEncoding','lightMap','aoMap','emissiveMap','emissiveMapEncoding','bumpMap','normalMap','objectSpaceNormalMap','displacementMap','specularMap','roughnessMap','metalnessMap','gradientMap','alphaMap','combine','vertexColors','fog','useFog','fogExp','flatShading','sizeAttenuation','logarithmicDepthBuffer','skinning','maxBones','useVertexTexture','morphTargets','morphNormals','maxMorphTargets','maxMorphNormals','premultipliedAlpha','numDirLights','numPointLights','numSpotLights','numHemiLights','numRectAreaLights','shadowMapEnabled','shadowMapType','toneMapping','physicallyCorrectLights','alphaTest','doubleSided','flipSided','numClippingPlanes','numClipIntersection','depthPacking','dithering'];this.getParameters=function(dg,cg,mg,ug,gg,fg,hg){var yg=lg[dg.type],xg=hg.isSkinnedMesh?ig(hg):0,vg=og.precision;null!==dg.precision&&(vg=og.getMaxPrecision(dg.precision),vg!==dg.precision&&console.warn('THREE.WebGLProgram.getParameters:',dg.precision,'not supported, using',vg,'instead.'));var _g=rg.getRenderTarget(),bg={shaderID:yg,precision:vg,supportsVertexTextures:og.vertexTextures,outputEncoding:ng(_g?_g.texture:null,rg.gammaOutput),map:!!dg.map,mapEncoding:ng(dg.map,rg.gammaInput),matcap:!!dg.matcap,matcapEncoding:ng(dg.matcap,rg.gammaInput),envMap:!!dg.envMap,envMapMode:dg.envMap&&dg.envMap.mapping,envMapEncoding:ng(dg.envMap,rg.gammaInput),envMapCubeUV:!!dg.envMap&&(dg.envMap.mapping===Gs||dg.envMap.mapping===Os),lightMap:!!dg.lightMap,aoMap:!!dg.aoMap,emissiveMap:!!dg.emissiveMap,emissiveMapEncoding:ng(dg.emissiveMap,rg.gammaInput),bumpMap:!!dg.bumpMap,normalMap:!!dg.normalMap,objectSpaceNormalMap:dg.normalMapType===1,displacementMap:!!dg.displacementMap,roughnessMap:!!dg.roughnessMap,metalnessMap:!!dg.metalnessMap,specularMap:!!dg.specularMap,alphaMap:!!dg.alphaMap,gradientMap:!!dg.gradientMap,combine:dg.combine,vertexColors:dg.vertexColors,fog:!!ug,useFog:dg.fog,fogExp:ug&&ug.isFogExp2,flatShading:dg.flatShading,sizeAttenuation:dg.sizeAttenuation,logarithmicDepthBuffer:og.logarithmicDepthBuffer,skinning:dg.skinning&&0<xg,maxBones:xg,useVertexTexture:og.floatVertexTextures,morphTargets:dg.morphTargets,morphNormals:dg.morphNormals,maxMorphTargets:rg.maxMorphTargets,maxMorphNormals:rg.maxMorphNormals,numDirLights:cg.directional.length,numPointLights:cg.point.length,numSpotLights:cg.spot.length,numRectAreaLights:cg.rectArea.length,numHemiLights:cg.hemi.length,numClippingPlanes:gg,numClipIntersection:fg,dithering:dg.dithering,shadowMapEnabled:rg.shadowMap.enabled&&hg.receiveShadow&&0<mg.length,shadowMapType:rg.shadowMap.type,toneMapping:rg.toneMapping,physicallyCorrectLights:rg.physicallyCorrectLights,premultipliedAlpha:dg.premultipliedAlpha,alphaTest:dg.alphaTest,doubleSided:dg.side===Hn,flipSided:dg.side===Fn,depthPacking:void 0!==dg.depthPacking&&dg.depthPacking};return bg},this.getProgramCode=function(dg,cg){var mg=[];if(cg.shaderID?mg.push(cg.shaderID):(mg.push(dg.fragmentShader),mg.push(dg.vertexShader)),void 0!==dg.defines)for(var ug in dg.defines)mg.push(ug),mg.push(dg.defines[ug]);for(var gg=0;gg<pg.length;gg++)mg.push(cg[pg[gg]]);return mg.push(dg.onBeforeCompile.toString()),mg.push(rg.gammaOutput),mg.push(rg.gammaFactor),mg.join()},this.acquireProgram=function(dg,cg,mg,ug){for(var fg=0,hg=sg.length,gg,yg;fg<hg;fg++)if(yg=sg[fg],yg.code===ug){gg=yg,++gg.usedTimes;break}return void 0===gg&&(gg=new Vt(rg,ag,ug,dg,cg,mg,og),sg.push(gg)),gg},this.releaseProgram=function(dg){if(0==--dg.usedTimes){var cg=sg.indexOf(dg);sg[cg]=sg[sg.length-1],sg.pop(),dg.destroy()}},this.programs=sg}function Wt(){var ng=new WeakMap;return{get:function(sg){var lg=ng.get(sg);return void 0===lg&&(lg={},ng.set(sg,lg)),lg},remove:function(sg){ng.delete(sg)},update:function(sg,lg,pg){ng.get(sg)[lg]=pg},dispose:function(){ng=new WeakMap}}}function jt(rg,ag){return rg.renderOrder===ag.renderOrder?rg.program&&ag.program&&rg.program!==ag.program?rg.program.id-ag.program.id:rg.material.id===ag.material.id?rg.z===ag.z?rg.id-ag.id:rg.z-ag.z:rg.material.id-ag.material.id:rg.renderOrder-ag.renderOrder}function qt(rg,ag){return rg.renderOrder===ag.renderOrder?rg.z===ag.z?rg.id-ag.id:ag.z-rg.z:rg.renderOrder-ag.renderOrder}function Yt(){var ig=[],ng=0,sg=[],lg=[];return{opaque:sg,transparent:lg,init:function(){ng=0,sg.length=0,lg.length=0},push:function(pg,dg,cg,mg,ug){var gg=ig[ng];void 0===gg?(gg={id:pg.id,object:pg,geometry:dg,material:cg,program:cg.program,renderOrder:pg.renderOrder,z:mg,group:ug},ig[ng]=gg):(gg.id=pg.id,gg.object=pg,gg.geometry=dg,gg.material=cg,gg.program=cg.program,gg.renderOrder=pg.renderOrder,gg.z=mg,gg.group=ug),(!0===cg.transparent?lg:sg).push(gg),ng++},sort:function(){1<sg.length&&sg.sort(jt),1<lg.length&&lg.sort(qt)}}}function Xt(){var og={};return{get:function(ig,ng){var sg=og[ig.id],lg;return void 0===sg?(lg=new Yt,og[ig.id]={},og[ig.id][ng.id]=lg):(lg=sg[ng.id],void 0==lg&&(lg=new Yt,sg[ng.id]=lg)),lg},dispose:function(){og={}}}}function Zt(){var rg={};return{get:function(ag){if(void 0!==rg[ag.id])return rg[ag.id];var og;switch(ag.type){case'DirectionalLight':og={direction:new C,color:new Y,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new E};break;case'SpotLight':og={position:new C,direction:new C,color:new Y,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new E};break;case'PointLight':og={position:new C,color:new Y,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new E,shadowCameraNear:1,shadowCameraFar:1e3};break;case'HemisphereLight':og={direction:new C,skyColor:new Y,groundColor:new Y};break;case'RectAreaLight':og={color:new Y,position:new C,halfWidth:new C,halfHeight:new C};}return rg[ag.id]=og,og}}}function Jt(){var ag=new Zt,og={id:sm++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},ig=new C,ng=new L,sg=new L;return{setup:function(lg,pg,dg){for(var cg=0,mg=0,ug=0,gg=0,fg=0,hg=0,yg=0,xg=0,vg=dg.matrixWorldInverse,_g=0,bg=lg.length;_g<bg;_g++){var Sg=lg[_g],Mg=Sg.color,Tg=Sg.intensity,Eg=Sg.distance,wg=Sg.shadow&&Sg.shadow.map?Sg.shadow.map.texture:null;if(Sg.isAmbientLight)cg+=Mg.r*Tg,mg+=Mg.g*Tg,ug+=Mg.b*Tg;else if(Sg.isDirectionalLight){var Lg=ag.get(Sg);if(Lg.color.copy(Sg.color).multiplyScalar(Sg.intensity),Lg.direction.setFromMatrixPosition(Sg.matrixWorld),ig.setFromMatrixPosition(Sg.target.matrixWorld),Lg.direction.sub(ig),Lg.direction.transformDirection(vg),Lg.shadow=Sg.castShadow,Sg.castShadow){var Pg=Sg.shadow;Lg.shadowBias=Pg.bias,Lg.shadowRadius=Pg.radius,Lg.shadowMapSize=Pg.mapSize}og.directionalShadowMap[gg]=wg,og.directionalShadowMatrix[gg]=Sg.shadow.matrix,og.directional[gg]=Lg,gg++}else if(Sg.isSpotLight){var Lg=ag.get(Sg);if(Lg.position.setFromMatrixPosition(Sg.matrixWorld),Lg.position.applyMatrix4(vg),Lg.color.copy(Mg).multiplyScalar(Tg),Lg.distance=Eg,Lg.direction.setFromMatrixPosition(Sg.matrixWorld),ig.setFromMatrixPosition(Sg.target.matrixWorld),Lg.direction.sub(ig),Lg.direction.transformDirection(vg),Lg.coneCos=Math.cos(Sg.angle),Lg.penumbraCos=Math.cos(Sg.angle*(1-Sg.penumbra)),Lg.decay=Sg.decay,Lg.shadow=Sg.castShadow,Sg.castShadow){var Pg=Sg.shadow;Lg.shadowBias=Pg.bias,Lg.shadowRadius=Pg.radius,Lg.shadowMapSize=Pg.mapSize}og.spotShadowMap[hg]=wg,og.spotShadowMatrix[hg]=Sg.shadow.matrix,og.spot[hg]=Lg,hg++}else if(Sg.isRectAreaLight){var Lg=ag.get(Sg);Lg.color.copy(Mg).multiplyScalar(Tg),Lg.position.setFromMatrixPosition(Sg.matrixWorld),Lg.position.applyMatrix4(vg),sg.identity(),ng.copy(Sg.matrixWorld),ng.premultiply(vg),sg.extractRotation(ng),Lg.halfWidth.set(0.5*Sg.width,0,0),Lg.halfHeight.set(0,0.5*Sg.height,0),Lg.halfWidth.applyMatrix4(sg),Lg.halfHeight.applyMatrix4(sg),og.rectArea[yg]=Lg,yg++}else if(Sg.isPointLight){var Lg=ag.get(Sg);if(Lg.position.setFromMatrixPosition(Sg.matrixWorld),Lg.position.applyMatrix4(vg),Lg.color.copy(Sg.color).multiplyScalar(Sg.intensity),Lg.distance=Sg.distance,Lg.decay=Sg.decay,Lg.shadow=Sg.castShadow,Sg.castShadow){var Pg=Sg.shadow;Lg.shadowBias=Pg.bias,Lg.shadowRadius=Pg.radius,Lg.shadowMapSize=Pg.mapSize,Lg.shadowCameraNear=Pg.camera.near,Lg.shadowCameraFar=Pg.camera.far}og.pointShadowMap[fg]=wg,og.pointShadowMatrix[fg]=Sg.shadow.matrix,og.point[fg]=Lg,fg++}else if(Sg.isHemisphereLight){var Lg=ag.get(Sg);Lg.direction.setFromMatrixPosition(Sg.matrixWorld),Lg.direction.transformDirection(vg),Lg.direction.normalize(),Lg.skyColor.copy(Sg.color).multiplyScalar(Tg),Lg.groundColor.copy(Sg.groundColor).multiplyScalar(Tg),og.hemi[xg]=Lg,xg++}}og.ambient[0]=cg,og.ambient[1]=mg,og.ambient[2]=ug,og.directional.length=gg,og.spot.length=hg,og.rectArea.length=yg,og.point.length=fg,og.hemi.length=xg,og.hash.stateID=og.id,og.hash.directionalLength=gg,og.hash.pointLength=fg,og.hash.spotLength=hg,og.hash.rectAreaLength=yg,og.hash.hemiLength=xg,og.hash.shadowsLength=pg.length},state:og}}function Qt(){var ng=new Jt,sg=[],lg=[];return{init:function(){sg.length=0,lg.length=0},state:{lightsArray:sg,shadowsArray:lg,lights:ng},setupLights:function(dg){ng.setup(sg,lg,dg)},pushLight:function(dg){sg.push(dg)},pushShadow:function(dg){lg.push(dg)}}}function Kt(){var og={};return{get:function(ig,ng){var sg;return void 0===og[ig.id]?(sg=new Qt,og[ig.id]={},og[ig.id][ng.id]=sg):void 0===og[ig.id][ng.id]?(sg=new Qt,og[ig.id][ng.id]=sg):sg=og[ig.id][ng.id],sg},dispose:function(){og={}}}}function $t(rg){Ee.call(this),this.type='MeshDepthMaterial',this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(rg)}function er(rg){Ee.call(this),this.type='MeshDistanceMaterial',this.referencePosition=new C,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(rg)}function tr(rg,ag,og){function ig(Ag,Cg,Rg,Ig,zg,Dg){var Bg=Ag.geometry,Ng=null,Ug=hg,Gg=Ag.customDepthMaterial;if(Rg&&(Ug=yg,Gg=Ag.customDistanceMaterial),!Gg){var Og=!1;Cg.morphTargets&&(Bg&&Bg.isBufferGeometry?Og=Bg.morphAttributes&&Bg.morphAttributes.position&&0<Bg.morphAttributes.position.length:Bg&&Bg.isGeometry&&(Og=Bg.morphTargets&&0<Bg.morphTargets.length)),Ag.isSkinnedMesh&&!1===Cg.skinning&&console.warn('THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:',Ag);var Fg=Ag.isSkinnedMesh&&Cg.skinning,Hg=0;Og&&(Hg|=ug),Fg&&(Hg|=gg),Ng=Ug[Hg]}else Ng=Gg;if(rg.localClippingEnabled&&!0===Cg.clipShadows&&0!==Cg.clippingPlanes.length){var Vg=Ng.uuid,kg=Cg.uuid,Wg=xg[Vg];void 0===Wg&&(Wg={},xg[Vg]=Wg);var jg=Wg[kg];void 0===jg&&(jg=Ng.clone(),Wg[kg]=jg),Ng=jg}return Ng.visible=Cg.visible,Ng.wireframe=Cg.wireframe,Ng.side=null==Cg.shadowSide?vg[Cg.side]:Cg.shadowSide,Ng.clipShadows=Cg.clipShadows,Ng.clippingPlanes=Cg.clippingPlanes,Ng.clipIntersection=Cg.clipIntersection,Ng.wireframeLinewidth=Cg.wireframeLinewidth,Ng.linewidth=Cg.linewidth,Rg&&Ng.isMeshDistanceMaterial&&(Ng.referencePosition.copy(Ig),Ng.nearDistance=zg,Ng.farDistance=Dg),Ng}function ng(Ag,Cg,Rg,Ig){if(!1!==Ag.visible){var zg=Ag.layers.test(Cg.layers);if(zg&&(Ag.isMesh||Ag.isLine||Ag.isPoints)&&Ag.castShadow&&(!Ag.frustumCulled||sg.intersectsObject(Ag))){Ag.modelViewMatrix.multiplyMatrices(Rg.matrixWorldInverse,Ag.matrixWorld);var Dg=ag.update(Ag),Bg=Ag.material;if(Array.isArray(Bg))for(var Ng=Dg.groups,Ug=0,Gg=Ng.length;Ug<Gg;Ug++){var Og=Ng[Ug],Fg=Bg[Og.materialIndex];if(Fg&&Fg.visible){var Hg=ig(Ag,Fg,Ig,mg,Rg.near,Rg.far);rg.renderBufferDirect(Rg,null,Dg,Hg,Ag,Og)}}else if(Bg.visible){var Hg=ig(Ag,Bg,Ig,mg,Rg.near,Rg.far);rg.renderBufferDirect(Rg,null,Dg,Hg,Ag,null)}}for(var Vg=Ag.children,kg=0,Wg=Vg.length;kg<Wg;kg++)ng(Vg[kg],Cg,Rg,Ig)}}for(var sg=new W,lg=new L,pg=new E,dg=new E(og,og),cg=new C,mg=new C,ug=1,gg=2,hg=[,,,,],yg=[,,,,],xg={},vg={0:Fn,1:On,2:Hn},_g=[new C(1,0,0),new C(-1,0,0),new C(0,0,1),new C(0,0,-1),new C(0,1,0),new C(0,-1,0)],bg=[new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,1,0),new C(0,0,1),new C(0,0,-1)],Sg=[new D,new D,new D,new D,new D,new D],Mg=0;Mg!==(ug|gg)+1;++Mg){var Tg=0!=(Mg&ug),Eg=0!=(Mg&gg),wg=new $t({depthPacking:3201,morphTargets:Tg,skinning:Eg});hg[Mg]=wg;var Lg=new er({morphTargets:Tg,skinning:Eg});yg[Mg]=Lg}var Pg=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Un,this.render=function(Ag,Cg,Rg){if(!1!==Pg.enabled&&(!1!==Pg.autoUpdate||!1!==Pg.needsUpdate)&&0!==Ag.length){var Ig=rg.context,zg=rg.state;zg.disable(3042),zg.buffers.color.setClear(1,1,1,1),zg.buffers.depth.setTest(!0),zg.setScissorTest(!1);for(var Bg=0,Ng=Ag.length,Dg;Bg<Ng;Bg++){var Ug=Ag[Bg],Gg=Ug.shadow,Og=Ug&&Ug.isPointLight;if(void 0===Gg){console.warn('THREE.WebGLShadowMap:',Ug,'has no shadow.');continue}var Fg=Gg.camera;if(pg.copy(Gg.mapSize),pg.min(dg),Og){var Hg=pg.x,Vg=pg.y;Sg[0].set(2*Hg,Vg,Hg,Vg),Sg[1].set(0,Vg,Hg,Vg),Sg[2].set(3*Hg,Vg,Hg,Vg),Sg[3].set(Hg,Vg,Hg,Vg),Sg[4].set(3*Hg,0,Hg,Vg),Sg[5].set(Hg,0,Hg,Vg),pg.x*=4,pg.y*=2}if(null===Gg.map){Gg.map=new U(pg.x,pg.y,{minFilter:ks,magFilter:ks,format:xl}),Gg.map.texture.name=Ug.name+'.shadowMap',Fg.updateProjectionMatrix()}Gg.isSpotLightShadow&&Gg.update(Ug);var Wg=Gg.map,jg=Gg.matrix;mg.setFromMatrixPosition(Ug.matrixWorld),Fg.position.copy(mg),Og?(Dg=6,jg.makeTranslation(-mg.x,-mg.y,-mg.z)):(Dg=1,cg.setFromMatrixPosition(Ug.target.matrixWorld),Fg.lookAt(cg),Fg.updateMatrixWorld(),jg.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1),jg.multiply(Fg.projectionMatrix),jg.multiply(Fg.matrixWorldInverse)),rg.setRenderTarget(Wg),rg.clear();for(var qg=0;qg<Dg;qg++){if(Og){cg.copy(Fg.position),cg.add(_g[qg]),Fg.up.copy(bg[qg]),Fg.lookAt(cg),Fg.updateMatrixWorld();var Yg=Sg[qg];zg.viewport(Yg)}lg.multiplyMatrices(Fg.projectionMatrix,Fg.matrixWorldInverse),sg.setFromMatrix(lg),ng(Cg,Rg,Fg,Og)}}Pg.needsUpdate=!1}}}function rr(rg,ag,og,ig){function pg(yf,xf,vf){var _f=new Uint8Array(4),Sf=rg.createTexture();rg.bindTexture(yf,Sf),rg.texParameteri(yf,10241,9728),rg.texParameteri(yf,10240,9728);for(var Mf=0;Mf<vf;Mf++)rg.texImage2D(xf+Mf,0,6408,1,1,0,6408,5121,_f);return Sf}function mg(yf,xf){if(Ug[yf]=1,0===Gg[yf]&&(rg.enableVertexAttribArray(yf),Gg[yf]=1),Og[yf]!==xf){var vf=ig.isWebGL2?rg:ag.get('ANGLE_instanced_arrays');vf[ig.isWebGL2?'vertexAttribDivisor':'vertexAttribDivisorANGLE'](yf,xf),Og[yf]=xf}}function gg(yf){!0!==Fg[yf]&&(rg.enable(yf),Fg[yf]=!0)}function fg(yf){!1!==Fg[yf]&&(rg.disable(yf),Fg[yf]=!1)}function xg(yf,xf,vf,_f,Sf,Mf,Tf,Ef){return yf===qn?void(kg&&(fg(3042),kg=!1)):(kg||(gg(3042),kg=!0),yf===Qn?void(Sf=Sf||xf,Mf=Mf||vf,Tf=Tf||_f,(xf!==jg||Sf!==Xg)&&(rg.blendEquationSeparate(og.convert(xf),og.convert(Sf)),jg=xf,Xg=Sf),(vf!==qg||_f!==Yg||Mf!==Zg||Tf!==Jg)&&(rg.blendFuncSeparate(og.convert(vf),og.convert(_f),og.convert(Mf),og.convert(Tf)),qg=vf,Yg=_f,Zg=Mf,Jg=Tf),Wg=yf,Qg=null):void((yf!==Wg||Ef!==Qg)&&((jg!==Kn||Xg!==Kn)&&(rg.blendEquation(32774),jg=Kn,Xg=Kn),Ef?yf===Yn?rg.blendFuncSeparate(1,771,1,771):yf===Xn?rg.blendFunc(1,1):yf===Zn?rg.blendFuncSeparate(0,0,769,771):yf===Jn?rg.blendFuncSeparate(0,768,0,770):console.error('THREE.WebGLState: Invalid blending: ',yf):yf===Yn?rg.blendFuncSeparate(770,771,1,771):yf===Xn?rg.blendFunc(770,1):yf===Zn?rg.blendFunc(0,769):yf===Jn?rg.blendFunc(0,768):console.error('THREE.WebGLState: Invalid blending: ',yf),qg=null,Yg=null,Zg=null,Jg=null,Wg=yf,Qg=Ef)))}function _g(yf){Kg!==yf&&(yf?rg.frontFace(2304):rg.frontFace(2305),Kg=yf)}function bg(yf){yf===0?fg(2884):(gg(2884),yf!==$g&&(yf===Bn?rg.cullFace(1029):yf===2?rg.cullFace(1028):rg.cullFace(1032))),$g=yf}function Mg(yf,xf,vf){yf?(gg(32823),(tf!==xf||rf!==vf)&&(rg.polygonOffset(xf,vf),tf=xf,rf=vf)):fg(32823)}function Eg(yf){void 0===yf&&(yf=33984+of-1),mf!==yf&&(rg.activeTexture(yf),mf=yf)}var zg=new function(){var yf=!1,xf=new D,vf=null,_f=new D(0,0,0,0);return{setMask:function(Sf){vf===Sf||yf||(rg.colorMask(Sf,Sf,Sf,Sf),vf=Sf)},setLocked:function(Sf){yf=Sf},setClear:function(Sf,Mf,Tf,Ef,wf){!0===wf&&(Sf*=Ef,Mf*=Ef,Tf*=Ef),xf.set(Sf,Mf,Tf,Ef),!1===_f.equals(xf)&&(rg.clearColor(Sf,Mf,Tf,Ef),_f.copy(xf))},reset:function(){yf=!1,vf=null,_f.set(-1,0,0,0)}}},Dg=new function(){var yf=!1,xf=null,vf=null,_f=null;return{setTest:function(Sf){Sf?gg(2929):fg(2929)},setMask:function(Sf){xf===Sf||yf||(rg.depthMask(Sf),xf=Sf)},setFunc:function(Sf){vf!==Sf&&(Sf?Sf===0?rg.depthFunc(512):Sf===1?rg.depthFunc(519):Sf===2?rg.depthFunc(513):Sf===xs?rg.depthFunc(515):Sf===4?rg.depthFunc(514):Sf===5?rg.depthFunc(518):Sf===6?rg.depthFunc(516):Sf===7?rg.depthFunc(517):rg.depthFunc(515):rg.depthFunc(515),vf=Sf)},setLocked:function(Sf){yf=Sf},setClear:function(Sf){_f!==Sf&&(rg.clearDepth(Sf),_f=Sf)},reset:function(){yf=!1,xf=null,vf=null,_f=null}}},Bg=new function(){var yf=!1,xf=null,vf=null,_f=null,Sf=null,Mf=null,Tf=null,Ef=null,wf=null;return{setTest:function(Lf){Lf?gg(2960):fg(2960)},setMask:function(Lf){xf===Lf||yf||(rg.stencilMask(Lf),xf=Lf)},setFunc:function(Lf,Pf,Af){(vf!==Lf||_f!==Pf||Sf!==Af)&&(rg.stencilFunc(Lf,Pf,Af),vf=Lf,_f=Pf,Sf=Af)},setOp:function(Lf,Pf,Af){(Mf!==Lf||Tf!==Pf||Ef!==Af)&&(rg.stencilOp(Lf,Pf,Af),Mf=Lf,Tf=Pf,Ef=Af)},setLocked:function(Lf){yf=Lf},setClear:function(Lf){wf!==Lf&&(rg.clearStencil(Lf),wf=Lf)},reset:function(){yf=!1,xf=null,vf=null,_f=null,Sf=null,Mf=null,Tf=null,Ef=null,wf=null}}},Ng=rg.getParameter(34921),Ug=new Uint8Array(Ng),Gg=new Uint8Array(Ng),Og=new Uint8Array(Ng),Fg={},Hg=null,Vg=null,kg=null,Wg=null,jg=null,qg=null,Yg=null,Xg=null,Zg=null,Jg=null,Qg=!1,Kg=null,$g=null,ef=null,tf=null,rf=null,of=rg.getParameter(35661),nf=!1,lf=0,pf=rg.getParameter(7938);-1===pf.indexOf('WebGL')?-1!==pf.indexOf('OpenGL ES')&&(lf=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(pf)[1]),nf=2<=lf):(lf=parseFloat(/^WebGL\ ([0-9])/.exec(pf)[1]),nf=1<=lf);var mf=null,uf={},gf=new D,ff=new D,hf={};return hf[3553]=pg(3553,3553,1),hf[34067]=pg(34067,34069,6),zg.setClear(0,0,0,1),Dg.setClear(1),Bg.setClear(0),gg(2929),Dg.setFunc(xs),_g(!1),bg(Bn),gg(2884),xg(qn),{buffers:{color:zg,depth:Dg,stencil:Bg},initAttributes:function(){for(var yf=0,xf=Ug.length;yf<xf;yf++)Ug[yf]=0},enableAttribute:function(yf){mg(yf,0)},enableAttributeAndDivisor:mg,disableUnusedAttributes:function(){for(var yf=0,xf=Gg.length;yf!==xf;++yf)Gg[yf]!==Ug[yf]&&(rg.disableVertexAttribArray(yf),Gg[yf]=0)},enable:gg,disable:fg,getCompressedTextureFormats:function(){if(null===Hg&&(Hg=[],ag.get('WEBGL_compressed_texture_pvrtc')||ag.get('WEBGL_compressed_texture_s3tc')||ag.get('WEBGL_compressed_texture_etc1')||ag.get('WEBGL_compressed_texture_astc')))for(var yf=rg.getParameter(34467),xf=0;xf<yf.length;xf++)Hg.push(yf[xf]);return Hg},useProgram:function(yf){return Vg!==yf&&(rg.useProgram(yf),Vg=yf,!0)},setBlending:xg,setMaterial:function(yf,xf){yf.side===Hn?fg(2884):gg(2884);var vf=yf.side===Fn;xf&&(vf=!vf),_g(vf),yf.blending===Yn&&!1===yf.transparent?xg(qn):xg(yf.blending,yf.blendEquation,yf.blendSrc,yf.blendDst,yf.blendEquationAlpha,yf.blendSrcAlpha,yf.blendDstAlpha,yf.premultipliedAlpha),Dg.setFunc(yf.depthFunc),Dg.setTest(yf.depthTest),Dg.setMask(yf.depthWrite),zg.setMask(yf.colorWrite),Mg(yf.polygonOffset,yf.polygonOffsetFactor,yf.polygonOffsetUnits)},setFlipSided:_g,setCullFace:bg,setLineWidth:function(yf){yf!==ef&&(nf&&rg.lineWidth(yf),ef=yf)},setPolygonOffset:Mg,setScissorTest:function(yf){yf?gg(3089):fg(3089)},activeTexture:Eg,bindTexture:function(yf,xf){null===mf&&Eg();var vf=uf[mf];void 0===vf&&(vf={type:void 0,texture:void 0},uf[mf]=vf),(vf.type!==yf||vf.texture!==xf)&&(rg.bindTexture(yf,xf||hf[yf]),vf.type=yf,vf.texture=xf)},compressedTexImage2D:function(){try{rg.compressedTexImage2D.apply(rg,arguments)}catch(yf){console.error('THREE.WebGLState:',yf)}},texImage2D:function(){try{rg.texImage2D.apply(rg,arguments)}catch(yf){console.error('THREE.WebGLState:',yf)}},texImage3D:function(){try{rg.texImage3D.apply(rg,arguments)}catch(yf){console.error('THREE.WebGLState:',yf)}},scissor:function(yf){!1===gf.equals(yf)&&(rg.scissor(yf.x,yf.y,yf.z,yf.w),gf.copy(yf))},viewport:function(yf){!1===ff.equals(yf)&&(rg.viewport(yf.x,yf.y,yf.z,yf.w),ff.copy(yf))},reset:function(){for(var yf=0;yf<Gg.length;yf++)1===Gg[yf]&&(rg.disableVertexAttribArray(yf),Gg[yf]=0);Fg={},Hg=null,mf=null,uf={},Vg=null,Wg=null,Kg=null,$g=null,zg.reset(),Dg.reset(),Bg.reset()}}}function ar(rg,ag,og,ig,ng,sg,lg){function pg(Ng,Ug){if(Ng.width>Ug||Ng.height>Ug){if('data'in Ng)return void console.warn('THREE.WebGLRenderer: image in DataTexture is too big ('+Ng.width+'x'+Ng.height+').');var Gg=Ug/Math.max(Ng.width,Ng.height),Og=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');Og.width=Math.floor(Ng.width*Gg),Og.height=Math.floor(Ng.height*Gg);var Fg=Og.getContext('2d');return Fg.drawImage(Ng,0,0,Ng.width,Ng.height,0,0,Og.width,Og.height),console.warn('THREE.WebGLRenderer: image is too big ('+Ng.width+'x'+Ng.height+'). Resized to '+Og.width+'x'+Og.height),Og}return Ng}function dg(Ng){return Sp.isPowerOfTwo(Ng.width)&&Sp.isPowerOfTwo(Ng.height)}function cg(Ng){if(Ng instanceof HTMLImageElement||Ng instanceof HTMLCanvasElement||Ng instanceof ImageBitmap){void 0===Bg&&(Bg=document.createElementNS('http://www.w3.org/1999/xhtml','canvas')),Bg.width=Sp.floorPowerOfTwo(Ng.width),Bg.height=Sp.floorPowerOfTwo(Ng.height);var Ug=Bg.getContext('2d');return Ug.drawImage(Ng,0,0,Bg.width,Bg.height),console.warn('THREE.WebGLRenderer: image is not power of two ('+Ng.width+'x'+Ng.height+'). Resized to '+Bg.width+'x'+Bg.height),Bg}return Ng}function mg(Ng){return!ng.isWebGL2&&(Ng.wrapS!==Hs||Ng.wrapT!==Hs||Ng.minFilter!==ks&&Ng.minFilter!==qs)}function ug(Ng,Ug){return Ng.generateMipmaps&&Ug&&Ng.minFilter!==ks&&Ng.minFilter!==qs}function gg(Ng,Ug,Gg,Og){rg.generateMipmap(Ng);var Fg=ig.get(Ug);Fg.__maxMipLevel=Math.log(Math.max(Gg,Og))*Math.LOG2E}function fg(Ng,Ug){if(!ng.isWebGL2)return Ng;if(6403===Ng){if(5126===Ug)return 33326;if(5131===Ug)return 33325;if(5121===Ug)return 33321}if(6407===Ng){if(5126===Ug)return 34837;if(5131===Ug)return 34843;if(5121===Ug)return 32849}if(6408===Ng){if(5126===Ug)return 34836;if(5131===Ug)return 34842;if(5121===Ug)return 32856}return Ng}function hg(Ng){return Ng===ks||Ng===Ws||Ng===js?9728:9729}function yg(Ng){var Ug=Ng.target;Ug.removeEventListener('dispose',yg),vg(Ug),Ug.isVideoTexture&&delete Dg[Ug.id],lg.memory.textures--}function xg(Ng){var Ug=Ng.target;Ug.removeEventListener('dispose',xg),_g(Ug),lg.memory.textures--}function vg(Ng){var Ug=ig.get(Ng);if(Ng.image&&Ug.__image__webglTextureCube)rg.deleteTexture(Ug.__image__webglTextureCube);else{if(void 0===Ug.__webglInit)return;rg.deleteTexture(Ug.__webglTexture)}ig.remove(Ng)}function _g(Ng){var Ug=ig.get(Ng),Gg=ig.get(Ng.texture);if(Ng){if(void 0!==Gg.__webglTexture&&rg.deleteTexture(Gg.__webglTexture),Ng.depthTexture&&Ng.depthTexture.dispose(),Ng.isWebGLRenderTargetCube)for(var Og=0;6>Og;Og++)rg.deleteFramebuffer(Ug.__webglFramebuffer[Og]),Ug.__webglDepthbuffer&&rg.deleteRenderbuffer(Ug.__webglDepthbuffer[Og]);else rg.deleteFramebuffer(Ug.__webglFramebuffer),Ug.__webglDepthbuffer&&rg.deleteRenderbuffer(Ug.__webglDepthbuffer);ig.remove(Ng.texture),ig.remove(Ng)}}function bg(Ng,Ug){var Gg=ig.get(Ng);if(Ng.isVideoTexture&&zg(Ng),0<Ng.version&&Gg.__version!==Ng.version){var Og=Ng.image;if(void 0===Og)console.warn('THREE.WebGLRenderer: Texture marked for update but image is undefined');else if(!1===Og.complete)console.warn('THREE.WebGLRenderer: Texture marked for update but image is incomplete');else return void wg(Gg,Ng,Ug)}og.activeTexture(33984+Ug),og.bindTexture(3553,Gg.__webglTexture)}function Eg(Ng,Ug,Gg){var Og;if(Gg?(rg.texParameteri(Ng,10242,sg.convert(Ug.wrapS)),rg.texParameteri(Ng,10243,sg.convert(Ug.wrapT)),rg.texParameteri(Ng,10240,sg.convert(Ug.magFilter)),rg.texParameteri(Ng,10241,sg.convert(Ug.minFilter))):(rg.texParameteri(Ng,10242,33071),rg.texParameteri(Ng,10243,33071),(Ug.wrapS!==Hs||Ug.wrapT!==Hs)&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.'),rg.texParameteri(Ng,10240,hg(Ug.magFilter)),rg.texParameteri(Ng,10241,hg(Ug.minFilter)),Ug.minFilter!==ks&&Ug.minFilter!==qs&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.')),Og=ag.get('EXT_texture_filter_anisotropic'),Og){if(Ug.type===rl&&null===ag.get('OES_texture_float_linear'))return;if(Ug.type===al&&null===(ng.isWebGL2||ag.get('OES_texture_half_float_linear')))return;(1<Ug.anisotropy||ig.get(Ug).__currentAnisotropy)&&(rg.texParameterf(Ng,Og.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ug.anisotropy,ng.getMaxAnisotropy())),ig.get(Ug).__currentAnisotropy=Ug.anisotropy)}}function wg(Ng,Ug,Gg){var Og;Og=Ug.isDataTexture3D?32879:3553,void 0===Ng.__webglInit&&(Ng.__webglInit=!0,Ug.addEventListener('dispose',yg),Ng.__webglTexture=rg.createTexture(),lg.memory.textures++),og.activeTexture(33984+Gg),og.bindTexture(Og,Ng.__webglTexture),rg.pixelStorei(37440,Ug.flipY),rg.pixelStorei(37441,Ug.premultiplyAlpha),rg.pixelStorei(3317,Ug.unpackAlignment);var Fg=pg(Ug.image,ng.maxTextureSize);mg(Ug)&&!1===dg(Fg)&&(Fg=cg(Fg));var Hg=dg(Fg),Vg=sg.convert(Ug.format),kg=sg.convert(Ug.type),Wg=fg(Vg,kg);Eg(Og,Ug,Hg);var qg=Ug.mipmaps,jg;if(Ug.isDepthTexture){if(Wg=6402,Ug.type===rl){if(!ng.isWebGL2)throw new Error('Float Depth Texture only supported in WebGL2.0');Wg=36012}else ng.isWebGL2&&(Wg=33189);Ug.format===Sl&&6402===Wg&&Ug.type!==Ks&&Ug.type!==el&&(console.warn('THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.'),Ug.type=Ks,kg=sg.convert(Ug.type)),Ug.format===Ml&&(Wg=34041,Ug.type!==cl&&(console.warn('THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.'),Ug.type=cl,kg=sg.convert(Ug.type))),og.texImage2D(3553,0,Wg,Fg.width,Fg.height,0,Vg,kg,null)}else if(Ug.isDataTexture){if(0<qg.length&&Hg){for(var Yg=0,Xg=qg.length;Yg<Xg;Yg++)jg=qg[Yg],og.texImage2D(3553,Yg,Wg,jg.width,jg.height,0,Vg,kg,jg.data);Ug.generateMipmaps=!1,Ng.__maxMipLevel=qg.length-1}else og.texImage2D(3553,0,Wg,Fg.width,Fg.height,0,Vg,kg,Fg.data),Ng.__maxMipLevel=0;}else if(Ug.isCompressedTexture){for(var Yg=0,Xg=qg.length;Yg<Xg;Yg++)jg=qg[Yg],Ug.format!==xl&&Ug.format!==yl?-1<og.getCompressedTextureFormats().indexOf(Vg)?og.compressedTexImage2D(3553,Yg,Wg,jg.width,jg.height,0,jg.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()'):og.texImage2D(3553,Yg,Wg,jg.width,jg.height,0,Vg,kg,jg.data);Ng.__maxMipLevel=qg.length-1}else if(Ug.isDataTexture3D)og.texImage3D(32879,0,Wg,Fg.width,Fg.height,Fg.depth,0,Vg,kg,Fg.data),Ng.__maxMipLevel=0;else if(0<qg.length&&Hg){for(var Yg=0,Xg=qg.length;Yg<Xg;Yg++)jg=qg[Yg],og.texImage2D(3553,Yg,Wg,Vg,kg,jg);Ug.generateMipmaps=!1,Ng.__maxMipLevel=qg.length-1}else og.texImage2D(3553,0,Wg,Vg,kg,Fg),Ng.__maxMipLevel=0;ug(Ug,Hg)&&gg(3553,Ug,Fg.width,Fg.height),Ng.__version=Ug.version,Ug.onUpdate&&Ug.onUpdate(Ug)}function Lg(Ng,Ug,Gg,Og){var Fg=sg.convert(Ug.texture.format),Hg=sg.convert(Ug.texture.type),Vg=fg(Fg,Hg);og.texImage2D(Og,0,Vg,Ug.width,Ug.height,0,Fg,Hg,null),rg.bindFramebuffer(36160,Ng),rg.framebufferTexture2D(36160,Gg,Og,ig.get(Ug.texture).__webglTexture,0),rg.bindFramebuffer(36160,null)}function Pg(Ng,Ug){rg.bindRenderbuffer(36161,Ng),Ug.depthBuffer&&!Ug.stencilBuffer?(rg.renderbufferStorage(36161,33189,Ug.width,Ug.height),rg.framebufferRenderbuffer(36160,36096,36161,Ng)):Ug.depthBuffer&&Ug.stencilBuffer?(rg.renderbufferStorage(36161,34041,Ug.width,Ug.height),rg.framebufferRenderbuffer(36160,33306,36161,Ng)):rg.renderbufferStorage(36161,32854,Ug.width,Ug.height),rg.bindRenderbuffer(36161,null)}function Ag(Ng,Ug){var Gg=Ug&&Ug.isWebGLRenderTargetCube;if(Gg)throw new Error('Depth Texture with cube render targets is not supported');if(rg.bindFramebuffer(36160,Ng),!(Ug.depthTexture&&Ug.depthTexture.isDepthTexture))throw new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');ig.get(Ug.depthTexture).__webglTexture&&Ug.depthTexture.image.width===Ug.width&&Ug.depthTexture.image.height===Ug.height||(Ug.depthTexture.image.width=Ug.width,Ug.depthTexture.image.height=Ug.height,Ug.depthTexture.needsUpdate=!0),bg(Ug.depthTexture,0);var Og=ig.get(Ug.depthTexture).__webglTexture;if(Ug.depthTexture.format===Sl)rg.framebufferTexture2D(36160,36096,3553,Og,0);else if(Ug.depthTexture.format===Ml)rg.framebufferTexture2D(36160,33306,3553,Og,0);else throw new Error('Unknown depthTexture format')}function Cg(Ng){var Ug=ig.get(Ng),Gg=!0===Ng.isWebGLRenderTargetCube;if(Ng.depthTexture){if(Gg)throw new Error('target.depthTexture not supported in Cube render targets');Ag(Ug.__webglFramebuffer,Ng)}else if(Gg){Ug.__webglDepthbuffer=[];for(var Og=0;6>Og;Og++)rg.bindFramebuffer(36160,Ug.__webglFramebuffer[Og]),Ug.__webglDepthbuffer[Og]=rg.createRenderbuffer(),Pg(Ug.__webglDepthbuffer[Og],Ng)}else rg.bindFramebuffer(36160,Ug.__webglFramebuffer),Ug.__webglDepthbuffer=rg.createRenderbuffer(),Pg(Ug.__webglDepthbuffer,Ng);rg.bindFramebuffer(36160,null)}function zg(Ng){var Ug=Ng.id,Gg=lg.render.frame;Dg[Ug]!==Gg&&(Dg[Ug]=Gg,Ng.update())}var Dg={},Bg;this.setTexture2D=bg,this.setTexture3D=function(Ng,Ug){var Gg=ig.get(Ng);return 0<Ng.version&&Gg.__version!==Ng.version?void wg(Gg,Ng,Ug):void(og.activeTexture(33984+Ug),og.bindTexture(32879,Gg.__webglTexture))},this.setTextureCube=function(Ng,Ug){var Gg=ig.get(Ng);if(6===Ng.image.length)if(0<Ng.version&&Gg.__version!==Ng.version){Gg.__image__webglTextureCube||(Ng.addEventListener('dispose',yg),Gg.__image__webglTextureCube=rg.createTexture(),lg.memory.textures++),og.activeTexture(33984+Ug),og.bindTexture(34067,Gg.__image__webglTextureCube),rg.pixelStorei(37440,Ng.flipY);for(var Og=Ng&&Ng.isCompressedTexture,Fg=Ng.image[0]&&Ng.image[0].isDataTexture,Hg=[],Vg=0;6>Vg;Vg++)Hg[Vg]=Og||Fg?Fg?Ng.image[Vg].image:Ng.image[Vg]:pg(Ng.image[Vg],ng.maxCubemapSize);var kg=Hg[0],Wg=dg(kg),jg=sg.convert(Ng.format),qg=sg.convert(Ng.type),Yg=fg(jg,qg);Eg(34067,Ng,Wg);for(var Vg=0;6>Vg;Vg++)if(!Og)Fg?og.texImage2D(34069+Vg,0,Yg,Hg[Vg].width,Hg[Vg].height,0,jg,qg,Hg[Vg].data):og.texImage2D(34069+Vg,0,Yg,jg,qg,Hg[Vg]);else for(var Zg=Hg[Vg].mipmaps,Jg=0,Qg=Zg.length,Xg;Jg<Qg;Jg++)Xg=Zg[Jg],Ng.format!==xl&&Ng.format!==yl?-1<og.getCompressedTextureFormats().indexOf(jg)?og.compressedTexImage2D(34069+Vg,Jg,Yg,Xg.width,Xg.height,0,Xg.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()'):og.texImage2D(34069+Vg,Jg,Yg,Xg.width,Xg.height,0,jg,qg,Xg.data);Gg.__maxMipLevel=Og?Zg.length-1:0,ug(Ng,Wg)&&gg(34067,Ng,kg.width,kg.height),Gg.__version=Ng.version,Ng.onUpdate&&Ng.onUpdate(Ng)}else og.activeTexture(33984+Ug),og.bindTexture(34067,Gg.__image__webglTextureCube)},this.setTextureCubeDynamic=function(Ng,Ug){og.activeTexture(33984+Ug),og.bindTexture(34067,ig.get(Ng).__webglTexture)},this.setupRenderTarget=function(Ng){var Ug=ig.get(Ng),Gg=ig.get(Ng.texture);Ng.addEventListener('dispose',xg),Gg.__webglTexture=rg.createTexture(),lg.memory.textures++;var Og=!0===Ng.isWebGLRenderTargetCube,Fg=dg(Ng);if(Og){Ug.__webglFramebuffer=[];for(var Hg=0;6>Hg;Hg++)Ug.__webglFramebuffer[Hg]=rg.createFramebuffer()}else Ug.__webglFramebuffer=rg.createFramebuffer();if(Og){og.bindTexture(34067,Gg.__webglTexture),Eg(34067,Ng.texture,Fg);for(var Hg=0;6>Hg;Hg++)Lg(Ug.__webglFramebuffer[Hg],Ng,36064,34069+Hg);ug(Ng.texture,Fg)&&gg(34067,Ng.texture,Ng.width,Ng.height),og.bindTexture(34067,null)}else og.bindTexture(3553,Gg.__webglTexture),Eg(3553,Ng.texture,Fg),Lg(Ug.__webglFramebuffer,Ng,36064,3553),ug(Ng.texture,Fg)&&gg(3553,Ng.texture,Ng.width,Ng.height),og.bindTexture(3553,null);Ng.depthBuffer&&Cg(Ng)},this.updateRenderTargetMipmap=function(Ng){var Ug=Ng.texture,Gg=dg(Ng);if(ug(Ug,Gg)){var Og=Ng.isWebGLRenderTargetCube?34067:3553,Fg=ig.get(Ug).__webglTexture;og.bindTexture(Og,Fg),gg(Og,Ug,Ng.width,Ng.height),og.bindTexture(Og,null)}}}function or(rg,ag,og){return{convert:function(ng){var sg;if(ng===Fs)return 10497;if(ng===Hs)return 33071;if(ng===Vs)return 33648;if(ng===ks)return 9728;if(ng===Ws)return 9984;if(ng===js)return 9986;if(ng===qs)return 9729;if(ng===Ys)return 9985;if(ng===Xs)return 9987;if(ng===Zs)return 5121;if(ng===1017)return 32819;if(ng===1018)return 32820;if(ng===1019)return 33635;if(ng===1010)return 5120;if(ng===1011)return 5122;if(ng===Ks)return 5123;if(ng===1013)return 5124;if(ng===el)return 5125;if(ng===rl)return 5126;if(ng===al){if(og.isWebGL2)return 5131;if(sg=ag.get('OES_texture_half_float'),null!==sg)return sg.HALF_FLOAT_OES}if(ng===1021)return 6406;if(ng===yl)return 6407;if(ng===xl)return 6408;if(ng===1024)return 6409;if(ng===1025)return 6410;if(ng===Sl)return 6402;if(ng===Ml)return 34041;if(ng===1028)return 6403;if(ng===Kn)return 32774;if(ng===101)return 32778;if(ng===102)return 32779;if(ng===200)return 0;if(ng===201)return 1;if(ng===202)return 768;if(ng===203)return 769;if(ng===ss)return 770;if(ng===ls)return 771;if(ng===206)return 772;if(ng===207)return 773;if(ng===208)return 774;if(ng===209)return 775;if(ng===210)return 776;if((ng===El||ng===wl||ng===Ll||ng===Pl)&&(sg=ag.get('WEBGL_compressed_texture_s3tc'),null!==sg)){if(ng===El)return sg.COMPRESSED_RGB_S3TC_DXT1_EXT;if(ng===wl)return sg.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(ng===Ll)return sg.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(ng===Pl)return sg.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((ng===Al||ng===Cl||ng===Rl||ng===Il)&&(sg=ag.get('WEBGL_compressed_texture_pvrtc'),null!==sg)){if(ng===Al)return sg.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(ng===Cl)return sg.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(ng===Rl)return sg.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(ng===Il)return sg.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(ng===36196&&(sg=ag.get('WEBGL_compressed_texture_etc1'),null!==sg))return sg.COMPRESSED_RGB_ETC1_WEBGL;if((ng===37808||ng===37809||ng===37810||ng===37811||ng===37812||ng===37813||ng===37814||ng===37815||ng===37816||ng===37817||ng===37818||ng===37819||ng===37820||ng===37821)&&(sg=ag.get('WEBGL_compressed_texture_astc'),null!==sg))return ng;if(ng===ts||ng===rs){if(og.isWebGL2){if(ng===ts)return 32775;if(ng===rs)return 32776}if(sg=ag.get('EXT_blend_minmax'),null!==sg){if(ng===ts)return sg.MIN_EXT;if(ng===rs)return sg.MAX_EXT}}if(ng===cl){if(og.isWebGL2)return 34042;if(sg=ag.get('WEBGL_depth_texture'),null!==sg)return sg.UNSIGNED_INT_24_8_WEBGL}return 0}}}function ir(){ee.call(this),this.type='Group'}function nr(){ee.call(this),this.type='Camera',this.matrixWorldInverse=new L,this.projectionMatrix=new L,this.projectionMatrixInverse=new L}function sr(rg,ag,og,ig){nr.call(this),this.type='PerspectiveCamera',this.fov=void 0===rg?50:rg,this.zoom=1,this.near=void 0===og?0.1:og,this.far=void 0===ig?2e3:ig,this.focus=10,this.aspect=void 0===ag?1:ag,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function lr(rg){sr.call(this),this.cameras=rg||[]}function pr(rg,ag,og){lm.setFromMatrixPosition(ag.matrixWorld),pm.setFromMatrixPosition(og.matrixWorld);var ig=lm.distanceTo(pm),ng=ag.projectionMatrix.elements,sg=og.projectionMatrix.elements,lg=ng[14]/(ng[10]-1),pg=ng[14]/(ng[10]+1),dg=(ng[9]+1)/ng[5],cg=(ng[9]-1)/ng[5],mg=(ng[8]-1)/ng[0],ug=(sg[8]+1)/sg[0],hg=ig/(-mg+ug),yg=hg*-mg;ag.matrixWorld.decompose(rg.position,rg.quaternion,rg.scale),rg.translateX(yg),rg.translateZ(hg),rg.matrixWorld.compose(rg.position,rg.quaternion,rg.scale),rg.matrixWorldInverse.getInverse(rg.matrixWorld);var xg=lg+hg,vg=pg+hg;rg.projectionMatrix.makePerspective(lg*mg-yg,lg*ug+(ig-yg),dg*pg/vg*xg,cg*pg/vg*xg,xg,vg)}function dr(rg){function ag(){return null!==lg&&!0===lg.isPresenting}function og(){if(ag()){var wg=lg.getEyeParameters('left'),Lg=wg.renderWidth*gg,Pg=wg.renderHeight*gg;Mg=rg.getPixelRatio(),Sg=rg.getSize(),rg.setDrawingBufferSize(2*Lg,Pg,1),Eg.start()}else sg.enabled&&rg.setDrawingBufferSize(Sg.width,Sg.height,Mg),Eg.stop()}function ig(wg){for(var Lg=navigator.getGamepads&&navigator.getGamepads(),Pg=0,Ag=0,Cg=Lg.length,Rg;Pg<Cg;Pg++)if(Rg=Lg[Pg],Rg&&('Daydream Controller'===Rg.id||'Gear VR Controller'===Rg.id||'Oculus Go Controller'===Rg.id||'OpenVR Gamepad'===Rg.id||Rg.id.startsWith('Oculus Touch')||Rg.id.startsWith('Spatial Controller'))){if(Ag===wg)return Rg;Ag++}}function ng(){for(var wg=0;wg<cg.length;wg++){var Lg=cg[wg],Pg=ig(wg);if(void 0!==Pg&&void 0!==Pg.pose){if(null===Pg.pose)return;var Ag=Pg.pose;!1===Ag.hasPosition&&Lg.position.set(0.2,-0.6,-0.05),null!==Ag.position&&Lg.position.fromArray(Ag.position),null!==Ag.orientation&&Lg.quaternion.fromArray(Ag.orientation),Lg.matrix.compose(Lg.position,Lg.quaternion,Lg.scale),Lg.matrix.premultiply(mg),Lg.matrix.decompose(Lg.position,Lg.quaternion,Lg.scale),Lg.matrixWorldNeedsUpdate=!0,Lg.visible=!0;var Cg='Daydream Controller'===Pg.id?0:1;Tg[wg]!==Pg.buttons[Cg].pressed&&(Tg[wg]=Pg.buttons[Cg].pressed,!0===Tg[wg]?Lg.dispatchEvent({type:'selectstart'}):(Lg.dispatchEvent({type:'selectend'}),Lg.dispatchEvent({type:'select'})))}else Lg.visible=!1}}var sg=this,lg=null,pg=null,dg=null,cg=[],mg=new L,ug=new L,gg=1,fg='stage';'undefined'!=typeof window&&'VRFrameData'in window&&(pg=new window.VRFrameData,window.addEventListener('vrdisplaypresentchange',og,!1));var hg=new L,yg=new A,xg=new C,vg=new sr;vg.bounds=new D(0,0,0.5,1),vg.layers.enable(1);var _g=new sr;_g.bounds=new D(0.5,0,0.5,1),_g.layers.enable(2);var bg=new lr([vg,_g]);bg.layers.enable(1),bg.layers.enable(2);var Tg=[],Sg,Mg;this.enabled=!1,this.getController=function(wg){var Lg=cg[wg];return void 0===Lg&&(Lg=new ir,Lg.matrixAutoUpdate=!1,Lg.visible=!1,cg[wg]=Lg),Lg},this.getDevice=function(){return lg},this.setDevice=function(wg){void 0!==wg&&(lg=wg),Eg.setContext(wg)},this.setFramebufferScaleFactor=function(wg){gg=wg},this.setFrameOfReferenceType=function(wg){fg=wg},this.setPoseTarget=function(wg){void 0!==wg&&(dg=wg)},this.getCamera=function(wg){var Lg='stage'===fg?1.6:0;if(null===lg)return wg.position.set(0,Lg,0),wg;if(lg.depthNear=wg.near,lg.depthFar=wg.far,lg.getFrameData(pg),'stage'===fg){var Pg=lg.stageParameters;Pg?mg.fromArray(Pg.sittingToStandingTransform):mg.makeTranslation(0,Lg,0)}var Ag=pg.pose,Cg=null===dg?wg:dg;if(Cg.matrix.copy(mg),Cg.matrix.decompose(Cg.position,Cg.quaternion,Cg.scale),null!==Ag.orientation&&(yg.fromArray(Ag.orientation),Cg.quaternion.multiply(yg)),null!==Ag.position&&(yg.setFromRotationMatrix(mg),xg.fromArray(Ag.position),xg.applyQuaternion(yg),Cg.position.add(xg)),Cg.updateMatrixWorld(),!1===lg.isPresenting)return wg;vg.near=wg.near,_g.near=wg.near,vg.far=wg.far,_g.far=wg.far,vg.matrixWorldInverse.fromArray(pg.leftViewMatrix),_g.matrixWorldInverse.fromArray(pg.rightViewMatrix),ug.getInverse(mg),'stage'===fg&&(vg.matrixWorldInverse.multiply(ug),_g.matrixWorldInverse.multiply(ug));var Rg=Cg.parent;null!==Rg&&(hg.getInverse(Rg.matrixWorld),vg.matrixWorldInverse.multiply(hg),_g.matrixWorldInverse.multiply(hg)),vg.matrixWorld.getInverse(vg.matrixWorldInverse),_g.matrixWorld.getInverse(_g.matrixWorldInverse),vg.projectionMatrix.fromArray(pg.leftProjectionMatrix),_g.projectionMatrix.fromArray(pg.rightProjectionMatrix),pr(bg,vg,_g);var Ig=lg.getLayers();if(Ig.length){var zg=Ig[0];null!==zg.leftBounds&&4===zg.leftBounds.length&&vg.bounds.fromArray(zg.leftBounds),null!==zg.rightBounds&&4===zg.rightBounds.length&&_g.bounds.fromArray(zg.rightBounds)}return ng(),bg},this.getStandingMatrix=function(){return mg},this.isPresenting=ag;var Eg=new X;this.setAnimationLoop=function(wg){Eg.setAnimationLoop(wg)},this.submitFrame=function(){ag()&&lg.submitFrame()},this.dispose=function(){'undefined'!=typeof window&&window.removeEventListener('vrdisplaypresentchange',og)}}function cr(rg){function ag(){return null!==dg&&null!==mg}function og(Sg){var Mg=fg[hg.indexOf(Sg.inputSource)];Mg&&Mg.dispatchEvent({type:Sg.type})}function ig(){rg.setFramebuffer(null),bg.stop()}function ng(Sg,Mg){null===Mg?Sg.matrixWorld.copy(Sg.matrix):Sg.matrixWorld.multiplyMatrices(Mg.matrixWorld,Sg.matrix),Sg.matrixWorldInverse.getInverse(Sg.matrixWorld)}var lg=rg.context,pg=null,dg=null,cg=1,mg=null,ug='stage',gg=null,fg=[],hg=[],yg=new sr;yg.layers.enable(1),yg.viewport=new D;var xg=new sr;xg.layers.enable(2),xg.viewport=new D;var vg=new lr([yg,xg]);vg.layers.enable(1),vg.layers.enable(2),this.enabled=!1,this.getController=function(Sg){var Mg=fg[Sg];return void 0===Mg&&(Mg=new ir,Mg.matrixAutoUpdate=!1,Mg.visible=!1,fg[Sg]=Mg),Mg},this.getDevice=function(){return pg},this.setDevice=function(Sg){void 0!==Sg&&(pg=Sg),Sg instanceof XRDevice&&lg.setCompatibleXRDevice(Sg)},this.setFramebufferScaleFactor=function(Sg){cg=Sg},this.setFrameOfReferenceType=function(Sg){ug=Sg},this.setSession=function(Sg){dg=Sg,null!=dg&&(dg.addEventListener('select',og),dg.addEventListener('selectstart',og),dg.addEventListener('selectend',og),dg.addEventListener('end',ig),dg.baseLayer=new XRWebGLLayer(dg,lg,{framebufferScaleFactor:cg}),dg.requestFrameOfReference(ug).then(function(Mg){mg=Mg,rg.setFramebuffer(dg.baseLayer.framebuffer),bg.setContext(dg),bg.start()}),hg=dg.getInputSources(),dg.addEventListener('inputsourceschange',function(){hg=dg.getInputSources(),console.log(hg);for(var Mg=0,Tg;Mg<fg.length;Mg++)Tg=fg[Mg],Tg.userData.inputSource=hg[Mg]}))},this.getCamera=function(Sg){if(ag()){var Mg=Sg.parent,Tg=vg.cameras;ng(vg,Mg);for(var Eg=0;Eg<Tg.length;Eg++)ng(Tg[Eg],Mg);Sg.matrixWorld.copy(vg.matrixWorld);for(var wg=Sg.children,Eg=0,Lg=wg.length;Eg<Lg;Eg++)wg[Eg].updateMatrixWorld(!0);return pr(vg,yg,xg),vg}return Sg},this.isPresenting=ag;var _g=null,bg=new X;bg.setAnimationLoop(function(Sg,Mg){if(gg=Mg.getDevicePose(mg),null!==gg)for(var Tg=dg.baseLayer,Eg=Mg.views,wg=0;wg<Eg.length;wg++){var Lg=Eg[wg],Pg=Tg.getViewport(Lg),Ag=gg.getViewMatrix(Lg),Cg=vg.cameras[wg];Cg.matrix.fromArray(Ag).getInverse(Cg.matrix),Cg.projectionMatrix.fromArray(Lg.projectionMatrix),Cg.viewport.set(Pg.x,Pg.y,Pg.width,Pg.height),0===wg&&vg.matrix.copy(Cg.matrix)}for(var wg=0;wg<fg.length;wg++){var Rg=fg[wg],Ig=hg[wg];if(Ig){var zg=Mg.getInputPose(Ig,mg);if(null!==zg){'targetRay'in zg?Rg.matrix.elements=zg.targetRay.transformMatrix:'pointerMatrix'in zg&&(Rg.matrix.elements=zg.pointerMatrix),Rg.matrix.decompose(Rg.position,Rg.rotation,Rg.scale),Rg.visible=!0;continue}}Rg.visible=!1}_g&&_g(Sg)}),this.setAnimationLoop=function(Sg){_g=Sg},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn('THREE.WebXRManager: getStandingMatrix() is no longer needed.'),new THREE.Matrix4},this.submitFrame=function(){}}function mr(rg){function ag(){return null===Zg?mf:1}function og(){Ef=new Be(Mf),wf=new ze(Mf,Ef,rg),wf.isWebGL2||(Ef.get('WEBGL_depth_texture'),Ef.get('OES_texture_float'),Ef.get('OES_texture_half_float'),Ef.get('OES_texture_half_float_linear'),Ef.get('OES_standard_derivatives'),Ef.get('OES_element_index_uint'),Ef.get('ANGLE_instanced_arrays')),Ef.get('OES_texture_float_linear'),Hf=new or(Mf,Ef,wf),Lf=new rr(Mf,Ef,Hf,wf),Lf.scissor(rf.copy(gf).multiplyScalar(mf)),Lf.viewport(tf.copy(uf).multiplyScalar(mf)),Pf=new Ge(Mf),Af=new Wt,Cf=new ar(Mf,Ef,Lf,Af,wf,Hf,Pf),Rf=new Z(Mf),If=new Ne(Mf,Rf,Pf),zf=new He(If,Pf),Gf=new Fe(Mf),Df=new kt(qg,Ef,wf),Bf=new Xt,Nf=new Kt,Uf=new Re(qg,Lf,zf,Hg),Of=new Ie(Mf,Ef,Pf,wf),Ff=new Ue(Mf,Ef,Pf,wf),Pf.programs=Df.programs,qg.context=Mf,qg.capabilities=wf,qg.extensions=Ef,qg.properties=Af,qg.renderLists=Bf,qg.state=Lf,qg.info=Pf}function ig(qf){qf.preventDefault(),console.log('THREE.WebGLRenderer: Context Lost.'),Yg=!0}function ng(){console.log('THREE.WebGLRenderer: Context Restored.'),Yg=!1,og()}function sg(qf){var Yf=qf.target;Yf.removeEventListener('dispose',sg),lg(Yf)}function lg(qf){pg(qf),Af.remove(qf)}function pg(qf){var Yf=Af.get(qf).program;qf.program=void 0,void 0!==Yf&&Df.releaseProgram(Yf)}function dg(qf,Yf){qf.render(function(Xf){qg.renderBufferImmediate(Xf,Yf)})}function cg(qf,Yf,Xf){if(Xf&&Xf.isInstancedBufferGeometry&!wf.isWebGL2&&null===Ef.get('ANGLE_instanced_arrays'))return void console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');Lf.initAttributes();var Zf=Xf.attributes,Jf=Yf.getAttributes(),Qf=qf.defaultAttributeValues;for(var Kf in Jf){var $f=Jf[Kf];if(0<=$f){var eh=Zf[Kf];if(void 0!==eh){var th=eh.normalized,rh=eh.itemSize,ah=Rf.get(eh);if(void 0===ah)continue;var oh=ah.buffer,ih=ah.type,nh=ah.bytesPerElement;if(eh.isInterleavedBufferAttribute){var sh=eh.data,lh=sh.stride,ph=eh.offset;sh&&sh.isInstancedInterleavedBuffer?(Lf.enableAttributeAndDivisor($f,sh.meshPerAttribute),void 0===Xf.maxInstancedCount&&(Xf.maxInstancedCount=sh.meshPerAttribute*sh.count)):Lf.enableAttribute($f),Mf.bindBuffer(34962,oh),Mf.vertexAttribPointer($f,rh,ih,th,lh*nh,ph*nh)}else eh.isInstancedBufferAttribute?(Lf.enableAttributeAndDivisor($f,eh.meshPerAttribute),void 0===Xf.maxInstancedCount&&(Xf.maxInstancedCount=eh.meshPerAttribute*eh.count)):Lf.enableAttribute($f),Mf.bindBuffer(34962,oh),Mf.vertexAttribPointer($f,rh,ih,th,0,0)}else if(void 0!==Qf){var dh=Qf[Kf];if(void 0!==dh)switch(dh.length){case 2:Mf.vertexAttrib2fv($f,dh);break;case 3:Mf.vertexAttrib3fv($f,dh);break;case 4:Mf.vertexAttrib4fv($f,dh);break;default:Mf.vertexAttrib1fv($f,dh);}}}}Lf.disableUnusedAttributes()}function ug(qf,Yf,Xf){if(!1!==qf.visible){var Zf=qf.layers.test(Yf.layers);if(Zf)if(qf.isLight)jg.pushLight(qf),qf.castShadow&&jg.pushShadow(qf);else if(qf.isSprite){if(!qf.frustumCulled||hf.intersectsSprite(qf)){Xf&&Sf.setFromMatrixPosition(qf.matrixWorld).applyMatrix4(_f);var Jf=zf.update(qf),Qf=qf.material;Wg.push(qf,Jf,Qf,Sf.z,null)}}else if(qf.isImmediateRenderObject)Xf&&Sf.setFromMatrixPosition(qf.matrixWorld).applyMatrix4(_f),Wg.push(qf,null,qf.material,Sf.z,null);else if((qf.isMesh||qf.isLine||qf.isPoints)&&(qf.isSkinnedMesh&&qf.skeleton.update(),!qf.frustumCulled||hf.intersectsObject(qf))){Xf&&Sf.setFromMatrixPosition(qf.matrixWorld).applyMatrix4(_f);var Jf=zf.update(qf),Qf=qf.material;if(Array.isArray(Qf))for(var Kf=Jf.groups,$f=0,eh=Kf.length;$f<eh;$f++){var th=Kf[$f],rh=Qf[th.materialIndex];rh&&rh.visible&&Wg.push(qf,Jf,rh,Sf.z,th)}else Qf.visible&&Wg.push(qf,Jf,Qf,Sf.z,null)}for(var ah=qf.children,$f=0,eh=ah.length;$f<eh;$f++)ug(ah[$f],Yf,Xf)}}function gg(qf,Yf,Xf,Zf){for(var Jf=0,Qf=qf.length;Jf<Qf;Jf++){var Kf=qf[Jf],$f=Kf.object,eh=Kf.geometry,th=void 0===Zf?Kf.material:Zf,rh=Kf.group;if(Xf.isArrayCamera){ef=Xf;for(var ah=Xf.cameras,oh=0,ih=ah.length,nh;oh<ih;oh++)if(nh=ah[oh],$f.layers.test(nh.layers)){if('viewport'in nh)Lf.viewport(tf.copy(nh.viewport));else{var sh=nh.bounds,lh=sh.x*lf,ph=sh.y*pf,dh=sh.z*lf,ch=sh.w*pf;Lf.viewport(tf.set(lh,ph,dh,ch).multiplyScalar(mf))}jg.setupLights(nh),fg($f,Yf,nh,eh,th,rh)}}else ef=null,fg($f,Yf,Xf,eh,th,rh)}}function fg(qf,Yf,Xf,Zf,Jf,Qf){if(qf.onBeforeRender(qg,Yf,Xf,Zf,Jf,Qf),jg=Nf.get(Yf,ef||Xf),qf.modelViewMatrix.multiplyMatrices(Xf.matrixWorldInverse,qf.matrixWorld),qf.normalMatrix.getNormalMatrix(qf.modelViewMatrix),qf.isImmediateRenderObject){Lf.setMaterial(Jf);var Kf=yg(Xf,Yf.fog,Jf,qf);Kg.geometry=null,Kg.program=null,Kg.wireframe=!1,dg(qf,Kf)}else qg.renderBufferDirect(Xf,Yf.fog,Zf,Jf,qf,Qf);qf.onAfterRender(qg,Yf,Xf,Zf,Jf,Qf),jg=Nf.get(Yf,ef||Xf)}function hg(qf,Yf,Xf){var Zf=Af.get(qf),Jf=jg.state.lights,Qf=jg.state.shadowsArray,Kf=Zf.lightsHash,$f=Jf.state.hash,eh=Df.getParameters(qf,Jf.state,Qf,Yf,yf.numPlanes,yf.numIntersection,Xf),th=Df.getProgramCode(qf,eh),rh=Zf.program,ah=!0;if(void 0===rh)qf.addEventListener('dispose',sg);else if(rh.code!==th)pg(qf);else if(Kf.stateID!==$f.stateID||Kf.directionalLength!==$f.directionalLength||Kf.pointLength!==$f.pointLength||Kf.spotLength!==$f.spotLength||Kf.rectAreaLength!==$f.rectAreaLength||Kf.hemiLength!==$f.hemiLength||Kf.shadowsLength!==$f.shadowsLength)Kf.stateID=$f.stateID,Kf.directionalLength=$f.directionalLength,Kf.pointLength=$f.pointLength,Kf.spotLength=$f.spotLength,Kf.rectAreaLength=$f.rectAreaLength,Kf.hemiLength=$f.hemiLength,Kf.shadowsLength=$f.shadowsLength,ah=!1;else{if(void 0!==eh.shaderID)return;ah=!1}if(ah){if(eh.shaderID){var oh=qc[eh.shaderID];Zf.shader={name:qf.type,uniforms:kc.clone(oh.uniforms),vertexShader:oh.vertexShader,fragmentShader:oh.fragmentShader}}else Zf.shader={name:qf.type,uniforms:qf.uniforms,vertexShader:qf.vertexShader,fragmentShader:qf.fragmentShader};qf.onBeforeCompile(Zf.shader,qg),th=Df.getProgramCode(qf,eh),rh=Df.acquireProgram(qf,Zf.shader,eh,th),Zf.program=rh,qf.program=rh}var ih=rh.getAttributes();if(qf.morphTargets){qf.numSupportedMorphTargets=0;for(var nh=0;nh<qg.maxMorphTargets;nh++)0<=ih['morphTarget'+nh]&&qf.numSupportedMorphTargets++}if(qf.morphNormals){qf.numSupportedMorphNormals=0;for(var nh=0;nh<qg.maxMorphNormals;nh++)0<=ih['morphNormal'+nh]&&qf.numSupportedMorphNormals++}var sh=Zf.shader.uniforms;(qf.isShaderMaterial||qf.isRawShaderMaterial)&&!0!==qf.clipping||(Zf.numClippingPlanes=yf.numPlanes,Zf.numIntersection=yf.numIntersection,sh.clippingPlanes=yf.uniform),Zf.fog=Yf,void 0===Kf&&(Zf.lightsHash=Kf={}),Kf.stateID=$f.stateID,Kf.directionalLength=$f.directionalLength,Kf.pointLength=$f.pointLength,Kf.spotLength=$f.spotLength,Kf.rectAreaLength=$f.rectAreaLength,Kf.hemiLength=$f.hemiLength,Kf.shadowsLength=$f.shadowsLength,qf.lights&&(sh.ambientLightColor.value=Jf.state.ambient,sh.directionalLights.value=Jf.state.directional,sh.spotLights.value=Jf.state.spot,sh.rectAreaLights.value=Jf.state.rectArea,sh.pointLights.value=Jf.state.point,sh.hemisphereLights.value=Jf.state.hemi,sh.directionalShadowMap.value=Jf.state.directionalShadowMap,sh.directionalShadowMatrix.value=Jf.state.directionalShadowMatrix,sh.spotShadowMap.value=Jf.state.spotShadowMap,sh.spotShadowMatrix.value=Jf.state.spotShadowMatrix,sh.pointShadowMap.value=Jf.state.pointShadowMap,sh.pointShadowMatrix.value=Jf.state.pointShadowMatrix);var lh=Zf.program.getUniforms(),ph=Lt.seqWithValue(lh.seq,sh);Zf.uniformsList=ph}function yg(qf,Yf,Xf,Zf){nf=0;var Jf=Af.get(Xf),Qf=jg.state.lights,Kf=Jf.lightsHash,$f=Qf.state.hash;if(xf&&(vf||qf!==$g)){var eh=qf===$g&&Xf.id===Qg;yf.setState(Xf.clippingPlanes,Xf.clipIntersection,Xf.clipShadows,qf,Jf,eh)}!1===Xf.needsUpdate&&(void 0===Jf.program?Xf.needsUpdate=!0:Xf.fog&&Jf.fog!==Yf?Xf.needsUpdate=!0:Xf.lights&&(Kf.stateID!==$f.stateID||Kf.directionalLength!==$f.directionalLength||Kf.pointLength!==$f.pointLength||Kf.spotLength!==$f.spotLength||Kf.rectAreaLength!==$f.rectAreaLength||Kf.hemiLength!==$f.hemiLength||Kf.shadowsLength!==$f.shadowsLength)?Xf.needsUpdate=!0:void 0!==Jf.numClippingPlanes&&(Jf.numClippingPlanes!==yf.numPlanes||Jf.numIntersection!==yf.numIntersection)&&(Xf.needsUpdate=!0)),Xf.needsUpdate&&(hg(Xf,Yf,Zf),Xf.needsUpdate=!1);var th=!1,rh=!1,ah=!1,oh=Jf.program,ih=oh.getUniforms(),nh=Jf.shader.uniforms;if(Lf.useProgram(oh.program)&&(th=!0,rh=!0,ah=!0),Xf.id!==Qg&&(Qg=Xf.id,rh=!0),th||$g!==qf){if(ih.setValue(Mf,'projectionMatrix',qf.projectionMatrix),wf.logarithmicDepthBuffer&&ih.setValue(Mf,'logDepthBufFC',2/(Math.log(qf.far+1)/Math.LN2)),$g!==qf&&($g=qf,rh=!0,ah=!0),Xf.isShaderMaterial||Xf.isMeshPhongMaterial||Xf.isMeshStandardMaterial||Xf.envMap){var sh=ih.map.cameraPosition;void 0!==sh&&sh.setValue(Mf,Sf.setFromMatrixPosition(qf.matrixWorld))}(Xf.isMeshPhongMaterial||Xf.isMeshLambertMaterial||Xf.isMeshBasicMaterial||Xf.isMeshStandardMaterial||Xf.isShaderMaterial||Xf.skinning)&&ih.setValue(Mf,'viewMatrix',qf.matrixWorldInverse)}if(Xf.skinning){ih.setOptional(Mf,Zf,'bindMatrix'),ih.setOptional(Mf,Zf,'bindMatrixInverse');var lh=Zf.skeleton;if(lh){var ph=lh.bones;if(wf.floatVertexTextures){if(void 0===lh.boneTexture){var dh=Math.sqrt(4*ph.length);dh=Sp.ceilPowerOfTwo(dh),dh=Math.max(dh,4);var ch=new Float32Array(4*(dh*dh));ch.set(lh.boneMatrices);var mh=new O(ch,dh,dh,xl,rl);mh.needsUpdate=!0,lh.boneMatrices=ch,lh.boneTexture=mh,lh.boneTextureSize=dh}ih.setValue(Mf,'boneTexture',lh.boneTexture),ih.setValue(Mf,'boneTextureSize',lh.boneTextureSize)}else ih.setOptional(Mf,lh,'boneMatrices')}}return rh&&(ih.setValue(Mf,'toneMappingExposure',qg.toneMappingExposure),ih.setValue(Mf,'toneMappingWhitePoint',qg.toneMappingWhitePoint),Xf.lights&&zg(nh,ah),Yf&&Xf.fog&&Mg(nh,Yf),Xf.isMeshBasicMaterial?xg(nh,Xf):Xf.isMeshLambertMaterial?(xg(nh,Xf),Tg(nh,Xf)):Xf.isMeshPhongMaterial?(xg(nh,Xf),Xf.isMeshToonMaterial?wg(nh,Xf):Eg(nh,Xf)):Xf.isMeshStandardMaterial?(xg(nh,Xf),Xf.isMeshPhysicalMaterial?Pg(nh,Xf):Lg(nh,Xf)):Xf.isMeshMatcapMaterial?(xg(nh,Xf),Ag(nh,Xf)):Xf.isMeshDepthMaterial?(xg(nh,Xf),Cg(nh,Xf)):Xf.isMeshDistanceMaterial?(xg(nh,Xf),Rg(nh,Xf)):Xf.isMeshNormalMaterial?(xg(nh,Xf),Ig(nh,Xf)):Xf.isLineBasicMaterial?(vg(nh,Xf),Xf.isLineDashedMaterial&&_g(nh,Xf)):Xf.isPointsMaterial?bg(nh,Xf):Xf.isSpriteMaterial?Sg(nh,Xf):Xf.isShadowMaterial&&(nh.color.value=Xf.color,nh.opacity.value=Xf.opacity),void 0!==nh.ltc_1&&(nh.ltc_1.value=jc.LTC_1),void 0!==nh.ltc_2&&(nh.ltc_2.value=jc.LTC_2),Lt.upload(Mf,Jf.uniformsList,nh,qg)),Xf.isShaderMaterial&&!0===Xf.uniformsNeedUpdate&&(Lt.upload(Mf,Jf.uniformsList,nh,qg),Xf.uniformsNeedUpdate=!1),Xf.isSpriteMaterial&&ih.setValue(Mf,'center',Zf.center),ih.setValue(Mf,'modelViewMatrix',Zf.modelViewMatrix),ih.setValue(Mf,'normalMatrix',Zf.normalMatrix),ih.setValue(Mf,'modelMatrix',Zf.matrixWorld),oh}function xg(qf,Yf){qf.opacity.value=Yf.opacity,Yf.color&&(qf.diffuse.value=Yf.color),Yf.emissive&&qf.emissive.value.copy(Yf.emissive).multiplyScalar(Yf.emissiveIntensity),Yf.map&&(qf.map.value=Yf.map),Yf.alphaMap&&(qf.alphaMap.value=Yf.alphaMap),Yf.specularMap&&(qf.specularMap.value=Yf.specularMap),Yf.envMap&&(qf.envMap.value=Yf.envMap,qf.flipEnvMap.value=Yf.envMap&&Yf.envMap.isCubeTexture?-1:1,qf.reflectivity.value=Yf.reflectivity,qf.refractionRatio.value=Yf.refractionRatio,qf.maxMipLevel.value=Af.get(Yf.envMap).__maxMipLevel),Yf.lightMap&&(qf.lightMap.value=Yf.lightMap,qf.lightMapIntensity.value=Yf.lightMapIntensity),Yf.aoMap&&(qf.aoMap.value=Yf.aoMap,qf.aoMapIntensity.value=Yf.aoMapIntensity);var Xf;Yf.map?Xf=Yf.map:Yf.specularMap?Xf=Yf.specularMap:Yf.displacementMap?Xf=Yf.displacementMap:Yf.normalMap?Xf=Yf.normalMap:Yf.bumpMap?Xf=Yf.bumpMap:Yf.roughnessMap?Xf=Yf.roughnessMap:Yf.metalnessMap?Xf=Yf.metalnessMap:Yf.alphaMap?Xf=Yf.alphaMap:Yf.emissiveMap&&(Xf=Yf.emissiveMap),void 0!=Xf&&(Xf.isWebGLRenderTarget&&(Xf=Xf.texture),!0===Xf.matrixAutoUpdate&&Xf.updateMatrix(),qf.uvTransform.value.copy(Xf.matrix))}function vg(qf,Yf){qf.diffuse.value=Yf.color,qf.opacity.value=Yf.opacity}function _g(qf,Yf){qf.dashSize.value=Yf.dashSize,qf.totalSize.value=Yf.dashSize+Yf.gapSize,qf.scale.value=Yf.scale}function bg(qf,Yf){qf.diffuse.value=Yf.color,qf.opacity.value=Yf.opacity,qf.size.value=Yf.size*mf,qf.scale.value=0.5*pf,qf.map.value=Yf.map,null!==Yf.map&&(!0===Yf.map.matrixAutoUpdate&&Yf.map.updateMatrix(),qf.uvTransform.value.copy(Yf.map.matrix))}function Sg(qf,Yf){qf.diffuse.value=Yf.color,qf.opacity.value=Yf.opacity,qf.rotation.value=Yf.rotation,qf.map.value=Yf.map,null!==Yf.map&&(!0===Yf.map.matrixAutoUpdate&&Yf.map.updateMatrix(),qf.uvTransform.value.copy(Yf.map.matrix))}function Mg(qf,Yf){qf.fogColor.value=Yf.color,Yf.isFog?(qf.fogNear.value=Yf.near,qf.fogFar.value=Yf.far):Yf.isFogExp2&&(qf.fogDensity.value=Yf.density)}function Tg(qf,Yf){Yf.emissiveMap&&(qf.emissiveMap.value=Yf.emissiveMap)}function Eg(qf,Yf){qf.specular.value=Yf.specular,qf.shininess.value=Math.max(Yf.shininess,1e-4),Yf.emissiveMap&&(qf.emissiveMap.value=Yf.emissiveMap),Yf.bumpMap&&(qf.bumpMap.value=Yf.bumpMap,qf.bumpScale.value=Yf.bumpScale,Yf.side===Fn&&(qf.bumpScale.value*=-1)),Yf.normalMap&&(qf.normalMap.value=Yf.normalMap,qf.normalScale.value.copy(Yf.normalScale),Yf.side===Fn&&qf.normalScale.value.negate()),Yf.displacementMap&&(qf.displacementMap.value=Yf.displacementMap,qf.displacementScale.value=Yf.displacementScale,qf.displacementBias.value=Yf.displacementBias)}function wg(qf,Yf){Eg(qf,Yf),Yf.gradientMap&&(qf.gradientMap.value=Yf.gradientMap)}function Lg(qf,Yf){qf.roughness.value=Yf.roughness,qf.metalness.value=Yf.metalness,Yf.roughnessMap&&(qf.roughnessMap.value=Yf.roughnessMap),Yf.metalnessMap&&(qf.metalnessMap.value=Yf.metalnessMap),Yf.emissiveMap&&(qf.emissiveMap.value=Yf.emissiveMap),Yf.bumpMap&&(qf.bumpMap.value=Yf.bumpMap,qf.bumpScale.value=Yf.bumpScale,Yf.side===Fn&&(qf.bumpScale.value*=-1)),Yf.normalMap&&(qf.normalMap.value=Yf.normalMap,qf.normalScale.value.copy(Yf.normalScale),Yf.side===Fn&&qf.normalScale.value.negate()),Yf.displacementMap&&(qf.displacementMap.value=Yf.displacementMap,qf.displacementScale.value=Yf.displacementScale,qf.displacementBias.value=Yf.displacementBias),Yf.envMap&&(qf.envMapIntensity.value=Yf.envMapIntensity)}function Pg(qf,Yf){Lg(qf,Yf),qf.reflectivity.value=Yf.reflectivity,qf.clearCoat.value=Yf.clearCoat,qf.clearCoatRoughness.value=Yf.clearCoatRoughness}function Ag(qf,Yf){Yf.matcap&&(qf.matcap.value=Yf.matcap),Yf.bumpMap&&(qf.bumpMap.value=Yf.bumpMap,qf.bumpScale.value=Yf.bumpScale,Yf.side===Fn&&(qf.bumpScale.value*=-1)),Yf.normalMap&&(qf.normalMap.value=Yf.normalMap,qf.normalScale.value.copy(Yf.normalScale),Yf.side===Fn&&qf.normalScale.value.negate()),Yf.displacementMap&&(qf.displacementMap.value=Yf.displacementMap,qf.displacementScale.value=Yf.displacementScale,qf.displacementBias.value=Yf.displacementBias)}function Cg(qf,Yf){Yf.displacementMap&&(qf.displacementMap.value=Yf.displacementMap,qf.displacementScale.value=Yf.displacementScale,qf.displacementBias.value=Yf.displacementBias)}function Rg(qf,Yf){Yf.displacementMap&&(qf.displacementMap.value=Yf.displacementMap,qf.displacementScale.value=Yf.displacementScale,qf.displacementBias.value=Yf.displacementBias),qf.referencePosition.value.copy(Yf.referencePosition),qf.nearDistance.value=Yf.nearDistance,qf.farDistance.value=Yf.farDistance}function Ig(qf,Yf){Yf.bumpMap&&(qf.bumpMap.value=Yf.bumpMap,qf.bumpScale.value=Yf.bumpScale,Yf.side===Fn&&(qf.bumpScale.value*=-1)),Yf.normalMap&&(qf.normalMap.value=Yf.normalMap,qf.normalScale.value.copy(Yf.normalScale),Yf.side===Fn&&qf.normalScale.value.negate()),Yf.displacementMap&&(qf.displacementMap.value=Yf.displacementMap,qf.displacementScale.value=Yf.displacementScale,qf.displacementBias.value=Yf.displacementBias)}function zg(qf,Yf){qf.ambientLightColor.needsUpdate=Yf,qf.directionalLights.needsUpdate=Yf,qf.pointLights.needsUpdate=Yf,qf.spotLights.needsUpdate=Yf,qf.rectAreaLights.needsUpdate=Yf,qf.hemisphereLights.needsUpdate=Yf}console.log('THREE.WebGLRenderer','99dev'),rg=rg||{};var Bg=void 0===rg.canvas?document.createElementNS('http://www.w3.org/1999/xhtml','canvas'):rg.canvas,Ng=void 0===rg.context?null:rg.context,Ug=void 0!==rg.alpha&&rg.alpha,Gg=void 0===rg.depth||rg.depth,Og=void 0===rg.stencil||rg.stencil,Fg=void 0!==rg.antialias&&rg.antialias,Hg=void 0===rg.premultipliedAlpha||rg.premultipliedAlpha,Vg=void 0!==rg.preserveDrawingBuffer&&rg.preserveDrawingBuffer,kg=void 0===rg.powerPreference?'default':rg.powerPreference,Wg=null,jg=null;this.domElement=Bg,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Ps,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var qg=this,Yg=!1,Xg=null,Zg=null,Jg=null,Qg=-1,Kg={geometry:null,program:null,wireframe:!1},$g=null,ef=null,tf=new D,rf=new D,of=null,nf=0,lf=Bg.width,pf=Bg.height,mf=1,uf=new D(0,0,lf,pf),gf=new D(0,0,lf,pf),ff=!1,hf=new W,yf=new De,xf=!1,vf=!1,_f=new L,Sf=new C,Mf;try{var Tf={alpha:Ug,depth:Gg,stencil:Og,antialias:Fg,premultipliedAlpha:Hg,preserveDrawingBuffer:Vg,powerPreference:kg};if(Bg.addEventListener('webglcontextlost',ig,!1),Bg.addEventListener('webglcontextrestored',ng,!1),Mf=Ng||Bg.getContext('webgl',Tf)||Bg.getContext('experimental-webgl',Tf),null===Mf)if(null!==Bg.getContext('webgl'))throw new Error('Error creating WebGL context with your selected attributes.');else throw new Error('Error creating WebGL context.');void 0===Mf.getShaderPrecisionFormat&&(Mf.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(qf){console.error('THREE.WebGLRenderer: '+qf.message)}var Ef,wf,Lf,Pf,Af,Cf,Rf,If,zf,Df,Bf,Nf,Uf,Gf,Of,Ff,Hf;og();var Vf=null;'undefined'!=typeof navigator&&(Vf='xr'in navigator?new cr(qg):new dr(qg)),this.vr=Vf;var kf=new tr(qg,zf,wf.maxTextureSize);this.shadowMap=kf,this.getContext=function(){return Mf},this.getContextAttributes=function(){return Mf.getContextAttributes()},this.forceContextLoss=function(){var qf=Ef.get('WEBGL_lose_context');qf&&qf.loseContext()},this.forceContextRestore=function(){var qf=Ef.get('WEBGL_lose_context');qf&&qf.restoreContext()},this.getPixelRatio=function(){return mf},this.setPixelRatio=function(qf){void 0===qf||(mf=qf,this.setSize(lf,pf,!1))},this.getSize=function(){return{width:lf,height:pf}},this.setSize=function(qf,Yf,Xf){return Vf.isPresenting()?void console.warn('THREE.WebGLRenderer: Can\'t change size while VR device is presenting.'):void(lf=qf,pf=Yf,Bg.width=qf*mf,Bg.height=Yf*mf,!1!==Xf&&(Bg.style.width=qf+'px',Bg.style.height=Yf+'px'),this.setViewport(0,0,qf,Yf))},this.getDrawingBufferSize=function(){return{width:lf*mf,height:pf*mf}},this.setDrawingBufferSize=function(qf,Yf,Xf){lf=qf,pf=Yf,mf=Xf,Bg.width=qf*Xf,Bg.height=Yf*Xf,this.setViewport(0,0,qf,Yf)},this.getCurrentViewport=function(){return tf},this.setViewport=function(qf,Yf,Xf,Zf){uf.set(qf,pf-Yf-Zf,Xf,Zf),Lf.viewport(tf.copy(uf).multiplyScalar(mf))},this.setScissor=function(qf,Yf,Xf,Zf){gf.set(qf,pf-Yf-Zf,Xf,Zf),Lf.scissor(rf.copy(gf).multiplyScalar(mf))},this.setScissorTest=function(qf){Lf.setScissorTest(ff=qf)},this.getClearColor=function(){return Uf.getClearColor()},this.setClearColor=function(){Uf.setClearColor.apply(Uf,arguments)},this.getClearAlpha=function(){return Uf.getClearAlpha()},this.setClearAlpha=function(){Uf.setClearAlpha.apply(Uf,arguments)},this.clear=function(qf,Yf,Xf){var Zf=0;(void 0===qf||qf)&&(Zf|=16384),(void 0===Yf||Yf)&&(Zf|=256),(void 0===Xf||Xf)&&(Zf|=1024),Mf.clear(Zf)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){Bg.removeEventListener('webglcontextlost',ig,!1),Bg.removeEventListener('webglcontextrestored',ng,!1),Bf.dispose(),Nf.dispose(),Af.dispose(),zf.dispose(),Vf.dispose(),jf.stop()},this.renderBufferImmediate=function(qf,Yf){Lf.initAttributes();var Xf=Af.get(qf);qf.hasPositions&&!Xf.position&&(Xf.position=Mf.createBuffer()),qf.hasNormals&&!Xf.normal&&(Xf.normal=Mf.createBuffer()),qf.hasUvs&&!Xf.uv&&(Xf.uv=Mf.createBuffer()),qf.hasColors&&!Xf.color&&(Xf.color=Mf.createBuffer());var Zf=Yf.getAttributes();qf.hasPositions&&(Mf.bindBuffer(34962,Xf.position),Mf.bufferData(34962,qf.positionArray,35048),Lf.enableAttribute(Zf.position),Mf.vertexAttribPointer(Zf.position,3,5126,!1,0,0)),qf.hasNormals&&(Mf.bindBuffer(34962,Xf.normal),Mf.bufferData(34962,qf.normalArray,35048),Lf.enableAttribute(Zf.normal),Mf.vertexAttribPointer(Zf.normal,3,5126,!1,0,0)),qf.hasUvs&&(Mf.bindBuffer(34962,Xf.uv),Mf.bufferData(34962,qf.uvArray,35048),Lf.enableAttribute(Zf.uv),Mf.vertexAttribPointer(Zf.uv,2,5126,!1,0,0)),qf.hasColors&&(Mf.bindBuffer(34962,Xf.color),Mf.bufferData(34962,qf.colorArray,35048),Lf.enableAttribute(Zf.color),Mf.vertexAttribPointer(Zf.color,3,5126,!1,0,0)),Lf.disableUnusedAttributes(),Mf.drawArrays(4,0,qf.count),qf.count=0},this.renderBufferDirect=function(qf,Yf,Xf,Zf,Jf,Qf){var Kf=Jf.isMesh&&0>Jf.normalMatrix.determinant();Lf.setMaterial(Zf,Kf);var $f=yg(qf,Yf,Zf,Jf),eh=!1;(Kg.geometry!==Xf.id||Kg.program!==$f.id||Kg.wireframe!==(!0===Zf.wireframe))&&(Kg.geometry=Xf.id,Kg.program=$f.id,Kg.wireframe=!0===Zf.wireframe,eh=!0),Jf.morphTargetInfluences&&(Gf.update(Jf,Xf,Zf,$f),eh=!0);var th=Xf.index,rh=Xf.attributes.position,ah=1;!0===Zf.wireframe&&(th=If.getWireframeAttribute(Xf),ah=2);var ih=Of,oh;null!==th&&(oh=Rf.get(th),ih=Ff,ih.setIndex(oh)),eh&&(cg(Zf,$f,Xf),null!==th&&Mf.bindBuffer(34963,oh.buffer));var nh=Infinity;null===th?void 0!==rh&&(nh=rh.count):nh=th.count;var sh=Xf.drawRange.start*ah,lh=Xf.drawRange.count*ah,ph=null===Qf?0:Qf.start*ah,dh=null===Qf?Infinity:Qf.count*ah,ch=Math.max(sh,ph),mh=Math.min(nh,sh+lh,ph+dh)-1,uh=Math.max(0,mh-ch+1);if(0!==uh){if(Jf.isMesh){if(!0===Zf.wireframe)Lf.setLineWidth(Zf.wireframeLinewidth*ag()),ih.setMode(1);else switch(Jf.drawMode){case ip:ih.setMode(4);break;case 1:ih.setMode(5);break;case 2:ih.setMode(6);}}else if(Jf.isLine){var gh=Zf.linewidth;void 0===gh&&(gh=1),Lf.setLineWidth(gh*ag()),Jf.isLineSegments?ih.setMode(1):Jf.isLineLoop?ih.setMode(2):ih.setMode(3)}else Jf.isPoints?ih.setMode(0):Jf.isSprite&&ih.setMode(4);Xf&&Xf.isInstancedBufferGeometry?0<Xf.maxInstancedCount&&ih.renderInstances(Xf,ch,uh):ih.render(ch,uh)}},this.compile=function(qf,Yf){jg=Nf.get(qf,Yf),jg.init(),qf.traverse(function(Xf){Xf.isLight&&(jg.pushLight(Xf),Xf.castShadow&&jg.pushShadow(Xf))}),jg.setupLights(Yf),qf.traverse(function(Xf){if(Xf.material)if(Array.isArray(Xf.material))for(var Zf=0;Zf<Xf.material.length;Zf++)hg(Xf.material[Zf],qf.fog,Xf);else hg(Xf.material,qf.fog,Xf)})};var Wf=null,jf=new X;jf.setAnimationLoop(function(qf){Vf.isPresenting()||Wf&&Wf(qf)}),'undefined'!=typeof window&&jf.setContext(window),this.setAnimationLoop=function(qf){Wf=qf,Vf.setAnimationLoop(qf),jf.start()},this.render=function(qf,Yf,Xf,Zf){if(!(Yf&&Yf.isCamera))return void console.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');if(!Yg){Kg.geometry=null,Kg.program=null,Kg.wireframe=!1,Qg=-1,$g=null,!0===qf.autoUpdate&&qf.updateMatrixWorld(),null===Yf.parent&&Yf.updateMatrixWorld(),Vf.enabled&&(Yf=Vf.getCamera(Yf)),jg=Nf.get(qf,Yf),jg.init(),qf.onBeforeRender(qg,qf,Yf,Xf),_f.multiplyMatrices(Yf.projectionMatrix,Yf.matrixWorldInverse),hf.setFromMatrix(_f),vf=this.localClippingEnabled,xf=yf.init(this.clippingPlanes,vf,Yf),Wg=Bf.get(qf,Yf),Wg.init(),ug(qf,Yf,qg.sortObjects),!0===qg.sortObjects&&Wg.sort(),xf&&yf.beginShadows();var Jf=jg.state.shadowsArray;kf.render(Jf,qf,Yf),jg.setupLights(Yf),xf&&yf.endShadows(),this.info.autoReset&&this.info.reset(),void 0===Xf&&(Xf=null),this.setRenderTarget(Xf),Uf.render(Wg,qf,Yf,Zf);var Qf=Wg.opaque,Kf=Wg.transparent;if(qf.overrideMaterial){var $f=qf.overrideMaterial;Qf.length&&gg(Qf,qf,Yf,$f),Kf.length&&gg(Kf,qf,Yf,$f)}else Qf.length&&gg(Qf,qf,Yf),Kf.length&&gg(Kf,qf,Yf);Xf&&Cf.updateRenderTargetMipmap(Xf),Lf.buffers.depth.setTest(!0),Lf.buffers.depth.setMask(!0),Lf.buffers.color.setMask(!0),Lf.setPolygonOffset(!1),qf.onAfterRender(qg,qf,Yf),Vf.enabled&&Vf.submitFrame(),Wg=null,jg=null}},this.allocTextureUnit=function(){var qf=nf;return qf>=wf.maxTextures&&console.warn('THREE.WebGLRenderer: Trying to use '+qf+' texture units while this GPU supports only '+wf.maxTextures),nf+=1,qf},this.setTexture2D=function(){var qf=!1;return function(Xf,Zf){Xf&&Xf.isWebGLRenderTarget&&(!qf&&(console.warn('THREE.WebGLRenderer.setTexture2D: don\'t use render targets as textures. Use their .texture property instead.'),qf=!0),Xf=Xf.texture),Cf.setTexture2D(Xf,Zf)}}(),this.setTexture3D=function(){return function(Yf,Xf){Cf.setTexture3D(Yf,Xf)}}(),this.setTexture=function(){var qf=!1;return function(Xf,Zf){qf||(console.warn('THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.'),qf=!0),Cf.setTexture2D(Xf,Zf)}}(),this.setTextureCube=function(){var qf=!1;return function(Xf,Zf){Xf&&Xf.isWebGLRenderTargetCube&&(!qf&&(console.warn('THREE.WebGLRenderer.setTextureCube: don\'t use cube render targets as textures. Use their .texture property instead.'),qf=!0),Xf=Xf.texture),Xf&&Xf.isCubeTexture||Array.isArray(Xf.image)&&6===Xf.image.length?Cf.setTextureCube(Xf,Zf):Cf.setTextureCubeDynamic(Xf,Zf)}}(),this.setFramebuffer=function(qf){Xg=qf},this.getRenderTarget=function(){return Zg},this.setRenderTarget=function(qf){Zg=qf,qf&&void 0===Af.get(qf).__webglFramebuffer&&Cf.setupRenderTarget(qf);var Yf=Xg,Xf=!1;if(qf){var Zf=Af.get(qf).__webglFramebuffer;qf.isWebGLRenderTargetCube?(Yf=Zf[qf.activeCubeFace],Xf=!0):Yf=Zf,tf.copy(qf.viewport),rf.copy(qf.scissor),of=qf.scissorTest}else tf.copy(uf).multiplyScalar(mf),rf.copy(gf).multiplyScalar(mf),of=ff;if(Jg!==Yf&&(Mf.bindFramebuffer(36160,Yf),Jg=Yf),Lf.viewport(tf),Lf.scissor(rf),Lf.setScissorTest(of),Xf){var Jf=Af.get(qf.texture);Mf.framebufferTexture2D(36160,36064,34069+qf.activeCubeFace,Jf.__webglTexture,qf.activeMipMapLevel)}},this.readRenderTargetPixels=function(qf,Yf,Xf,Zf,Jf,Qf){if(!(qf&&qf.isWebGLRenderTarget))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');var Kf=Af.get(qf).__webglFramebuffer;if(Kf){var $f=!1;Kf!==Jg&&(Mf.bindFramebuffer(36160,Kf),$f=!0);try{var eh=qf.texture,th=eh.format,rh=eh.type;if(th!==xl&&Hf.convert(th)!==Mf.getParameter(35739))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.');if(rh!==Zs&&Hf.convert(rh)!==Mf.getParameter(35738)&&!(rh===rl&&(wf.isWebGL2||Ef.get('OES_texture_float')||Ef.get('WEBGL_color_buffer_float')))&&!(rh===al&&(wf.isWebGL2?Ef.get('EXT_color_buffer_float'):Ef.get('EXT_color_buffer_half_float'))))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.');36053===Mf.checkFramebufferStatus(36160)?0<=Yf&&Yf<=qf.width-Zf&&0<=Xf&&Xf<=qf.height-Jf&&Mf.readPixels(Yf,Xf,Zf,Jf,Hf.convert(th),Hf.convert(rh),Qf):console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.')}finally{$f&&Mf.bindFramebuffer(36160,Jg)}}},this.copyFramebufferToTexture=function(qf,Yf,Xf){var Zf=Yf.image.width,Jf=Yf.image.height,Qf=Hf.convert(Yf.format);this.setTexture2D(Yf,0),Mf.copyTexImage2D(3553,Xf||0,Qf,qf.x,qf.y,Zf,Jf,0)},this.copyTextureToTexture=function(qf,Yf,Xf,Zf){var Jf=Yf.image.width,Qf=Yf.image.height,Kf=Hf.convert(Xf.format),$f=Hf.convert(Xf.type);this.setTexture2D(Xf,0),Yf.isDataTexture?Mf.texSubImage2D(3553,Zf||0,qf.x,qf.y,Jf,Qf,Kf,$f,Yf.image.data):Mf.texSubImage2D(3553,Zf||0,qf.x,qf.y,Kf,$f,Yf.image)}}function ur(rg,ag){this.name='',this.color=new Y(rg),this.density=void 0===ag?2.5e-4:ag}function gr(rg,ag,og){this.name='',this.color=new Y(rg),this.near=void 0===ag?1:ag,this.far=void 0===og?1e3:og}function fr(){ee.call(this),this.type='Scene',this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function hr(rg,ag){this.array=rg,this.stride=ag,this.count=void 0===rg?0:rg.length/ag,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function yr(rg,ag,og,ig){this.data=rg,this.itemSize=ag,this.offset=og,this.normalized=!0===ig}function xr(rg){Ee.call(this),this.type='SpriteMaterial',this.color=new Y(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(rg)}function _r(rg){if(ee.call(this),this.type='Sprite',void 0===dm){dm=new ve;var ag=new Float32Array([-0.5,-0.5,0,0,0,0.5,-0.5,0,1,0,0.5,0.5,0,1,1,-0.5,0.5,0,0,1]),og=new hr(ag,5);dm.setIndex([0,1,2,0,2,3]),dm.addAttribute('position',new yr(og,3,0,!1)),dm.addAttribute('uv',new yr(og,2,3,!1))}this.geometry=dm,this.material=void 0===rg?new xr:rg,this.center=new E(0.5,0.5)}function br(){ee.call(this),this.type='LOD',Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Sr(rg,ag){if(rg=rg||[],this.bones=rg.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===ag)this.calculateInverses();else if(this.bones.length===ag.length)this.boneInverses=ag.slice(0);else{console.warn('THREE.Skeleton boneInverses is the wrong length.'),this.boneInverses=[];for(var og=0,ig=this.bones.length;og<ig;og++)this.boneInverses.push(new L)}}function Mr(){ee.call(this),this.type='Bone'}function Tr(rg,ag){Ce.call(this,rg,ag),this.type='SkinnedMesh',this.bindMode='attached',this.bindMatrix=new L,this.bindMatrixInverse=new L;var og=this.initBones(),ig=new Sr(og);this.bind(ig,this.matrixWorld),this.normalizeSkinWeights()}function Er(rg){Ee.call(this),this.type='LineBasicMaterial',this.color=new Y(16777215),this.linewidth=1,this.linecap='round',this.linejoin='round',this.lights=!1,this.setValues(rg)}function wr(rg,ag,og){1===og&&console.error('THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.'),ee.call(this),this.type='Line',this.geometry=void 0===rg?new ve:rg,this.material=void 0===ag?new Er({color:16777215*Math.random()}):ag}function Lr(rg,ag){wr.call(this,rg,ag),this.type='LineSegments'}function Pr(rg,ag){wr.call(this,rg,ag),this.type='LineLoop'}function Ar(rg){Ee.call(this),this.type='PointsMaterial',this.color=new Y(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(rg)}function Cr(rg,ag){ee.call(this),this.type='Points',this.geometry=void 0===rg?new ve:rg,this.material=void 0===ag?new Ar({color:16777215*Math.random()}):ag}function Rr(rg,ag,og,ig,ng,sg,lg,pg,dg){I.call(this,rg,ag,og,ig,ng,sg,lg,pg,dg),this.format=void 0===lg?yl:lg,this.minFilter=void 0===sg?qs:sg,this.magFilter=void 0===ng?qs:ng,this.generateMipmaps=!1}function Ir(rg,ag,og,ig,ng,sg,lg,pg,dg,cg,mg,ug){I.call(this,null,sg,lg,pg,dg,cg,ig,ng,mg,ug),this.image={width:ag,height:og},this.mipmaps=rg,this.flipY=!1,this.generateMipmaps=!1}function zr(rg,ag,og,ig,ng,sg,lg,pg,dg){I.call(this,rg,ag,og,ig,ng,sg,lg,pg,dg),this.needsUpdate=!0}function Dr(rg,ag,og,ig,ng,sg,lg,pg,dg,cg){if(cg=void 0===cg?Sl:cg,cg!==Sl&&cg!==Ml)throw new Error('DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat');void 0===og&&cg===Sl&&(og=Ks),void 0===og&&cg===Ml&&(og=cl),I.call(this,null,ig,ng,sg,lg,pg,cg,og,dg),this.image={width:rg,height:ag},this.magFilter=void 0===lg?ks:lg,this.minFilter=void 0===pg?ks:pg,this.flipY=!1,this.generateMipmaps=!1}function Br(rg){ve.call(this),this.type='WireframeGeometry';var ag=[],pg=[0,0],dg={},fg=['a','b','c'],og,ig,ng,sg,lg,cg,mg,ug,gg,hg;if(rg&&rg.isGeometry){var yg=rg.faces;for(og=0,ng=yg.length;og<ng;og++){var xg=yg[og];for(ig=0;3>ig;ig++)mg=xg[fg[ig]],ug=xg[fg[(ig+1)%3]],pg[0]=Math.min(mg,ug),pg[1]=Math.max(mg,ug),gg=pg[0]+','+pg[1],void 0===dg[gg]&&(dg[gg]={index1:pg[0],index2:pg[1]})}for(gg in dg)cg=dg[gg],hg=rg.vertices[cg.index1],ag.push(hg.x,hg.y,hg.z),hg=rg.vertices[cg.index2],ag.push(hg.x,hg.y,hg.z)}else if(rg&&rg.isBufferGeometry){var vg,_g,bg,Sg,Mg,Tg,Eg,wg;if(hg=new C,null!==rg.index){for(vg=rg.attributes.position,_g=rg.index,bg=rg.groups,0===bg.length&&(bg=[{start:0,count:_g.count,materialIndex:0}]),(sg=0,lg=bg.length);sg<lg;++sg)for(Sg=bg[sg],Mg=Sg.start,Tg=Sg.count,(og=Mg,ng=Mg+Tg);og<ng;og+=3)for(ig=0;3>ig;ig++)mg=_g.getX(og+ig),ug=_g.getX(og+(ig+1)%3),pg[0]=Math.min(mg,ug),pg[1]=Math.max(mg,ug),gg=pg[0]+','+pg[1],void 0===dg[gg]&&(dg[gg]={index1:pg[0],index2:pg[1]});for(gg in dg)cg=dg[gg],hg.fromBufferAttribute(vg,cg.index1),ag.push(hg.x,hg.y,hg.z),hg.fromBufferAttribute(vg,cg.index2),ag.push(hg.x,hg.y,hg.z)}else for(vg=rg.attributes.position,og=0,ng=vg.count/3;og<ng;og++)for(ig=0;3>ig;ig++)Eg=3*og+ig,hg.fromBufferAttribute(vg,Eg),ag.push(hg.x,hg.y,hg.z),wg=3*og+(ig+1)%3,hg.fromBufferAttribute(vg,wg),ag.push(hg.x,hg.y,hg.z)}this.addAttribute('position',new fe(ag,3))}function Nr(rg,ag,og){re.call(this),this.type='ParametricGeometry',this.parameters={func:rg,slices:ag,stacks:og},this.fromBufferGeometry(new Ur(rg,ag,og)),this.mergeVertices()}function Ur(rg,ag,og){ve.call(this),this.type='ParametricBufferGeometry',this.parameters={func:rg,slices:ag,stacks:og};var ig=[],ng=[],sg=[],lg=[],pg=1e-5,dg=new C,cg=new C,mg=new C,ug=new C,gg=new C,fg,hg;3>rg.length&&console.error('THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.');var yg=ag+1;for(fg=0;fg<=og;fg++){var xg=fg/og;for(hg=0;hg<=ag;hg++){var vg=hg/ag;rg(vg,xg,cg),ng.push(cg.x,cg.y,cg.z),0<=vg-pg?(rg(vg-pg,xg,mg),ug.subVectors(cg,mg)):(rg(vg+pg,xg,mg),ug.subVectors(mg,cg)),0<=xg-pg?(rg(vg,xg-pg,mg),gg.subVectors(cg,mg)):(rg(vg,xg+pg,mg),gg.subVectors(mg,cg)),dg.crossVectors(ug,gg).normalize(),sg.push(dg.x,dg.y,dg.z),lg.push(vg,xg)}}for(fg=0;fg<og;fg++)for(hg=0;hg<ag;hg++){var _g=fg*yg+hg,bg=fg*yg+hg+1,Sg=(fg+1)*yg+hg+1,Mg=(fg+1)*yg+hg;ig.push(_g,bg,Mg),ig.push(bg,Sg,Mg)}this.setIndex(ig),this.addAttribute('position',new fe(ng,3)),this.addAttribute('normal',new fe(sg,3)),this.addAttribute('uv',new fe(lg,2))}function Gr(rg,ag,og,ig){re.call(this),this.type='PolyhedronGeometry',this.parameters={vertices:rg,indices:ag,radius:og,detail:ig},this.fromBufferGeometry(new Or(rg,ag,og,ig)),this.mergeVertices()}function Or(rg,ag,og,ig){function sg(vg,_g,bg,Sg){var Mg=Math.pow(2,Sg),Tg=[],Eg,wg;for(Eg=0;Eg<=Mg;Eg++){Tg[Eg]=[];var Lg=vg.clone().lerp(bg,Eg/Mg),Pg=_g.clone().lerp(bg,Eg/Mg),Ag=Mg-Eg;for(wg=0;wg<=Ag;wg++)Tg[Eg][wg]=0===wg&&Eg===Mg?Lg:Lg.clone().lerp(Pg,wg/Ag)}for(Eg=0;Eg<Mg;Eg++)for(wg=0;wg<2*(Mg-Eg)-1;wg++){var Cg=Math.floor(wg/2);0==wg%2?(cg(Tg[Eg][Cg+1]),cg(Tg[Eg+1][Cg]),cg(Tg[Eg][Cg])):(cg(Tg[Eg][Cg+1]),cg(Tg[Eg+1][Cg+1]),cg(Tg[Eg+1][Cg]))}}function dg(){for(var vg=0;vg<xg.length;vg+=6){var _g=xg[vg+0],bg=xg[vg+2],Sg=xg[vg+4],Mg=Math.max(_g,bg,Sg),Tg=Math.min(_g,bg,Sg);0.9<Mg&&0.1>Tg&&(0.2>_g&&(xg[vg+0]+=1),0.2>bg&&(xg[vg+2]+=1),0.2>Sg&&(xg[vg+4]+=1))}}function cg(vg){yg.push(vg.x,vg.y,vg.z)}function mg(vg,_g){var bg=3*vg;_g.x=rg[bg+0],_g.y=rg[bg+1],_g.z=rg[bg+2]}function ug(){for(var vg=new C,_g=new C,bg=new C,Sg=new C,Mg=new E,Tg=new E,Eg=new E,wg=0,Lg=0;wg<yg.length;wg+=9,Lg+=6){vg.set(yg[wg+0],yg[wg+1],yg[wg+2]),_g.set(yg[wg+3],yg[wg+4],yg[wg+5]),bg.set(yg[wg+6],yg[wg+7],yg[wg+8]),Mg.set(xg[Lg+0],xg[Lg+1]),Tg.set(xg[Lg+2],xg[Lg+3]),Eg.set(xg[Lg+4],xg[Lg+5]),Sg.copy(vg).add(_g).add(bg).divideScalar(3);var Pg=fg(Sg);gg(Mg,Lg+0,vg,Pg),gg(Tg,Lg+2,_g,Pg),gg(Eg,Lg+4,bg,Pg)}}function gg(vg,_g,bg,Sg){0>Sg&&1===vg.x&&(xg[_g]=vg.x-1),0===bg.x&&0===bg.z&&(xg[_g]=Sg/2/Math.PI+0.5)}function fg(vg){return Math.atan2(vg.z,-vg.x)}function hg(vg){return Math.atan2(-vg.y,Math.sqrt(vg.x*vg.x+vg.z*vg.z))}ve.call(this),this.type='PolyhedronBufferGeometry',this.parameters={vertices:rg,indices:ag,radius:og,detail:ig},og=og||1,ig=ig||0;var yg=[],xg=[];(function(vg){for(var _g=new C,bg=new C,Sg=new C,Mg=0;Mg<ag.length;Mg+=3)mg(ag[Mg+0],_g),mg(ag[Mg+1],bg),mg(ag[Mg+2],Sg),sg(_g,bg,Sg,vg)})(ig),function(vg){for(var _g=new C,bg=0;bg<yg.length;bg+=3)_g.x=yg[bg+0],_g.y=yg[bg+1],_g.z=yg[bg+2],_g.normalize().multiplyScalar(vg),yg[bg+0]=_g.x,yg[bg+1]=_g.y,yg[bg+2]=_g.z}(og),function(){for(var vg=new C,_g=0;_g<yg.length;_g+=3){vg.x=yg[_g+0],vg.y=yg[_g+1],vg.z=yg[_g+2];var bg=fg(vg)/2/Math.PI+0.5,Sg=hg(vg)/Math.PI+0.5;xg.push(bg,1-Sg)}ug(),dg()}(),this.addAttribute('position',new fe(yg,3)),this.addAttribute('normal',new fe(yg.slice(),3)),this.addAttribute('uv',new fe(xg,2)),0===ig?this.computeVertexNormals():this.normalizeNormals()}function Fr(rg,ag){re.call(this),this.type='TetrahedronGeometry',this.parameters={radius:rg,detail:ag},this.fromBufferGeometry(new Hr(rg,ag)),this.mergeVertices()}function Hr(rg,ag){Or.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],rg,ag),this.type='TetrahedronBufferGeometry',this.parameters={radius:rg,detail:ag}}function Vr(rg,ag){re.call(this),this.type='OctahedronGeometry',this.parameters={radius:rg,detail:ag},this.fromBufferGeometry(new kr(rg,ag)),this.mergeVertices()}function kr(rg,ag){Or.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],rg,ag),this.type='OctahedronBufferGeometry',this.parameters={radius:rg,detail:ag}}function Wr(rg,ag){re.call(this),this.type='IcosahedronGeometry',this.parameters={radius:rg,detail:ag},this.fromBufferGeometry(new jr(rg,ag)),this.mergeVertices()}function jr(rg,ag){var og=(1+Math.sqrt(5))/2;Or.call(this,[-1,og,0,1,og,0,-1,-og,0,1,-og,0,0,-1,og,0,1,og,0,-1,-og,0,1,-og,og,0,-1,og,0,1,-og,0,-1,-og,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],rg,ag),this.type='IcosahedronBufferGeometry',this.parameters={radius:rg,detail:ag}}function qr(rg,ag){re.call(this),this.type='DodecahedronGeometry',this.parameters={radius:rg,detail:ag},this.fromBufferGeometry(new Yr(rg,ag)),this.mergeVertices()}function Yr(rg,ag){var og=(1+Math.sqrt(5))/2,ig=1/og;Or.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-ig,-og,0,-ig,og,0,ig,-og,0,ig,og,-ig,-og,0,-ig,og,0,ig,-og,0,ig,og,0,-og,0,-ig,og,0,-ig,-og,0,ig,og,0,ig],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],rg,ag),this.type='DodecahedronBufferGeometry',this.parameters={radius:rg,detail:ag}}function Xr(rg,ag,og,ig,ng,sg){re.call(this),this.type='TubeGeometry',this.parameters={path:rg,tubularSegments:ag,radius:og,radialSegments:ig,closed:ng},void 0!==sg&&console.warn('THREE.TubeGeometry: taper has been removed.');var lg=new Zr(rg,ag,og,ig,ng);this.tangents=lg.tangents,this.normals=lg.normals,this.binormals=lg.binormals,this.fromBufferGeometry(lg),this.mergeVertices()}function Zr(rg,ag,og,ig,ng){function lg(Sg){fg=rg.getPointAt(Sg/ag,fg);var Mg=cg.normals[Sg],Tg=cg.binormals[Sg];for(yg=0;yg<=ig;yg++){var Eg=2*(yg/ig*Math.PI),wg=Math.sin(Eg),Lg=-Math.cos(Eg);ug.x=Lg*Mg.x+wg*Tg.x,ug.y=Lg*Mg.y+wg*Tg.y,ug.z=Lg*Mg.z+wg*Tg.z,ug.normalize(),vg.push(ug.x,ug.y,ug.z),mg.x=fg.x+og*ug.x,mg.y=fg.y+og*ug.y,mg.z=fg.z+og*ug.z,xg.push(mg.x,mg.y,mg.z)}}function pg(){for(yg=1;yg<=ag;yg++)for(hg=1;hg<=ig;hg++){var Sg=(ig+1)*(yg-1)+(hg-1),Mg=(ig+1)*yg+(hg-1),Tg=(ig+1)*yg+hg,Eg=(ig+1)*(yg-1)+hg;bg.push(Sg,Mg,Eg),bg.push(Mg,Tg,Eg)}}function dg(){for(hg=0;hg<=ag;hg++)for(yg=0;yg<=ig;yg++)gg.x=hg/ag,gg.y=yg/ig,_g.push(gg.x,gg.y)}ve.call(this),this.type='TubeBufferGeometry',this.parameters={path:rg,tubularSegments:ag,radius:og,radialSegments:ig,closed:ng},ag=ag||64,og=og||1,ig=ig||8,ng=ng||!1;var cg=rg.computeFrenetFrames(ag,ng);this.tangents=cg.tangents,this.normals=cg.normals,this.binormals=cg.binormals;var mg=new C,ug=new C,gg=new E,fg=new C,xg=[],vg=[],_g=[],bg=[],hg,yg;(function(){for(hg=0;hg<ag;hg++)lg(hg);lg(!1===ng?ag:0),dg(),pg()})(),this.setIndex(bg),this.addAttribute('position',new fe(xg,3)),this.addAttribute('normal',new fe(vg,3)),this.addAttribute('uv',new fe(_g,2))}function Jr(rg,ag,og,ig,ng,sg,lg){re.call(this),this.type='TorusKnotGeometry',this.parameters={radius:rg,tube:ag,tubularSegments:og,radialSegments:ig,p:ng,q:sg},void 0!==lg&&console.warn('THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.'),this.fromBufferGeometry(new Qr(rg,ag,og,ig,ng,sg)),this.mergeVertices()}function Qr(rg,ag,og,ig,ng,sg){function lg(Cg,Rg,Ig,zg,Dg){var Bg=Math.cos(Cg),Ng=Math.sin(Cg),Ug=Ig/Rg*Cg,Gg=Math.cos(Ug);Dg.x=0.5*(zg*(2+Gg))*Bg,Dg.y=0.5*(zg*(2+Gg)*Ng),Dg.z=0.5*(zg*Math.sin(Ug))}ve.call(this),this.type='TorusKnotBufferGeometry',this.parameters={radius:rg,tube:ag,tubularSegments:og,radialSegments:ig,p:ng,q:sg},rg=rg||1,ag=ag||0.4,og=Math.floor(og)||64,ig=Math.floor(ig)||8,ng=ng||2,sg=sg||3;var pg=[],dg=[],cg=[],mg=[],fg=new C,hg=new C,yg=new C,xg=new C,vg=new C,_g=new C,bg=new C,ug,gg;for(ug=0;ug<=og;++ug){var Sg=2*(ug/og*ng*Math.PI);for(lg(Sg,ng,sg,rg,yg),lg(Sg+0.01,ng,sg,rg,xg),_g.subVectors(xg,yg),bg.addVectors(xg,yg),vg.crossVectors(_g,bg),bg.crossVectors(vg,_g),vg.normalize(),bg.normalize(),gg=0;gg<=ig;++gg){var Mg=2*(gg/ig*Math.PI),Tg=-ag*Math.cos(Mg),Eg=ag*Math.sin(Mg);fg.x=yg.x+(Tg*bg.x+Eg*vg.x),fg.y=yg.y+(Tg*bg.y+Eg*vg.y),fg.z=yg.z+(Tg*bg.z+Eg*vg.z),dg.push(fg.x,fg.y,fg.z),hg.subVectors(fg,yg).normalize(),cg.push(hg.x,hg.y,hg.z),mg.push(ug/og),mg.push(gg/ig)}}for(gg=1;gg<=og;gg++)for(ug=1;ug<=ig;ug++){var wg=(ig+1)*(gg-1)+(ug-1),Lg=(ig+1)*gg+(ug-1),Pg=(ig+1)*gg+ug,Ag=(ig+1)*(gg-1)+ug;pg.push(wg,Lg,Ag),pg.push(Lg,Pg,Ag)}this.setIndex(pg),this.addAttribute('position',new fe(dg,3)),this.addAttribute('normal',new fe(cg,3)),this.addAttribute('uv',new fe(mg,2))}function Kr(rg,ag,og,ig,ng){re.call(this),this.type='TorusGeometry',this.parameters={radius:rg,tube:ag,radialSegments:og,tubularSegments:ig,arc:ng},this.fromBufferGeometry(new $r(rg,ag,og,ig,ng)),this.mergeVertices()}function $r(rg,ag,og,ig,ng){ve.call(this),this.type='TorusBufferGeometry',this.parameters={radius:rg,tube:ag,radialSegments:og,tubularSegments:ig,arc:ng},rg=rg||1,ag=ag||0.4,og=Math.floor(og)||8,ig=Math.floor(ig)||6,ng=ng||2*Math.PI;var sg=[],lg=[],pg=[],dg=[],cg=new C,mg=new C,ug=new C,gg,fg;for(gg=0;gg<=og;gg++)for(fg=0;fg<=ig;fg++){var hg=fg/ig*ng,yg=2*(gg/og*Math.PI);mg.x=(rg+ag*Math.cos(yg))*Math.cos(hg),mg.y=(rg+ag*Math.cos(yg))*Math.sin(hg),mg.z=ag*Math.sin(yg),lg.push(mg.x,mg.y,mg.z),cg.x=rg*Math.cos(hg),cg.y=rg*Math.sin(hg),ug.subVectors(mg,cg).normalize(),pg.push(ug.x,ug.y,ug.z),dg.push(fg/ig),dg.push(gg/og)}for(gg=1;gg<=og;gg++)for(fg=1;fg<=ig;fg++){var xg=(ig+1)*gg+fg-1,vg=(ig+1)*(gg-1)+fg-1,_g=(ig+1)*(gg-1)+fg,bg=(ig+1)*gg+fg;sg.push(xg,vg,bg),sg.push(vg,_g,bg)}this.setIndex(sg),this.addAttribute('position',new fe(lg,3)),this.addAttribute('normal',new fe(pg,3)),this.addAttribute('uv',new fe(dg,2))}function ea(rg,ag,og,ig,ng){var sg,lg;if(ng===0<Pa(rg,ag,og,ig))for(sg=ag;sg<og;sg+=ig)lg=Ea(sg,rg[sg],rg[sg+1],lg);else for(sg=og-ig;sg>=ag;sg-=ig)lg=Ea(sg,rg[sg],rg[sg+1],lg);return lg&&xa(lg,lg.next)&&(wa(lg),lg=lg.next),lg}function ta(rg,ag){if(!rg)return rg;ag||(ag=rg);var og=rg,ig;do if(ig=!1,!og.steiner&&(xa(og,og.next)||0===ya(og.prev,og,og.next))){if(wa(og),og=ag=og.prev,og===og.next)break;ig=!0}else og=og.next;while(ig||og!==ag);return ag}function ra(rg,ag,og,ig,ng,sg,lg){if(rg){!lg&&sg&&ca(rg,ig,ng,sg);for(var pg=rg,dg,cg;rg.prev!==rg.next;){if(dg=rg.prev,cg=rg.next,sg?oa(rg,ig,ng,sg):aa(rg)){ag.push(dg.i/og),ag.push(rg.i/og),ag.push(cg.i/og),wa(rg),rg=cg.next,pg=cg.next;continue}if(rg=cg,rg===pg){lg?1===lg?(rg=ia(rg,ag,og),ra(rg,ag,og,ig,ng,sg,2)):2==lg&&na(rg,ag,og,ig,ng,sg):ra(ta(rg),ag,og,ig,ng,sg,1);break}}}}function aa(rg){var ag=rg.prev,og=rg,ig=rg.next;if(0<=ya(ag,og,ig))return!1;for(var ng=rg.next.next;ng!==rg.prev;){if(fa(ag.x,ag.y,og.x,og.y,ig.x,ig.y,ng.x,ng.y)&&0<=ya(ng.prev,ng,ng.next))return!1;ng=ng.next}return!0}function oa(rg,ag,og,ig){var ng=rg.prev,sg=rg,lg=rg.next;if(0<=ya(ng,sg,lg))return!1;for(var pg=ng.x<sg.x?ng.x<lg.x?ng.x:lg.x:sg.x<lg.x?sg.x:lg.x,dg=ng.y<sg.y?ng.y<lg.y?ng.y:lg.y:sg.y<lg.y?sg.y:lg.y,cg=ng.x>sg.x?ng.x>lg.x?ng.x:lg.x:sg.x>lg.x?sg.x:lg.x,mg=ng.y>sg.y?ng.y>lg.y?ng.y:lg.y:sg.y>lg.y?sg.y:lg.y,ug=ua(pg,dg,ag,og,ig),gg=ua(cg,mg,ag,og,ig),fg=rg.nextZ;fg&&fg.z<=gg;){if(fg!==rg.prev&&fg!==rg.next&&fa(ng.x,ng.y,sg.x,sg.y,lg.x,lg.y,fg.x,fg.y)&&0<=ya(fg.prev,fg,fg.next))return!1;fg=fg.nextZ}for(fg=rg.prevZ;fg&&fg.z>=ug;){if(fg!==rg.prev&&fg!==rg.next&&fa(ng.x,ng.y,sg.x,sg.y,lg.x,lg.y,fg.x,fg.y)&&0<=ya(fg.prev,fg,fg.next))return!1;fg=fg.prevZ}return!0}function ia(rg,ag,og){var ig=rg;do{var ng=ig.prev,sg=ig.next.next;!xa(ng,sg)&&_a(ng,ig,ig.next,sg)&&Sa(ng,sg)&&Sa(sg,ng)&&(ag.push(ng.i/og),ag.push(ig.i/og),ag.push(sg.i/og),wa(ig),wa(ig.next),ig=rg=sg),ig=ig.next}while(ig!==rg);return ig}function na(rg,ag,og,ig,ng,sg){var lg=rg;do{for(var pg=lg.next.next;pg!==lg.prev;){if(lg.i!==pg.i&&ha(lg,pg)){var dg=Ta(lg,pg);return lg=ta(lg,lg.next),dg=ta(dg,dg.next),ra(lg,ag,og,ig,ng,sg),void ra(dg,ag,og,ig,ng,sg)}pg=pg.next}lg=lg.next}while(lg!==rg)}function sa(rg,ag,og,ig){var ng=[],sg,lg,pg,dg,cg;for(sg=0,lg=ag.length;sg<lg;sg++)pg=ag[sg]*ig,dg=sg<lg-1?ag[sg+1]*ig:rg.length,cg=ea(rg,pg,dg,ig,!1),cg===cg.next&&(cg.steiner=!0),ng.push(ga(cg));for(ng.sort(la),sg=0;sg<ng.length;sg++)pa(ng[sg],og),og=ta(og,og.next);return og}function la(rg,ag){return rg.x-ag.x}function pa(rg,ag){if(ag=da(rg,ag),ag){var og=Ta(ag,rg);ta(og,og.next)}}function da(rg,ag){var og=ag,ig=rg.x,ng=rg.y,sg=-Infinity,lg;do{if(ng<=og.y&&ng>=og.next.y&&og.next.y!==og.y){var pg=og.x+(ng-og.y)*(og.next.x-og.x)/(og.next.y-og.y);if(pg<=ig&&pg>sg){if(sg=pg,pg===ig){if(ng===og.y)return og;if(ng===og.next.y)return og.next}lg=og.x<og.next.x?og:og.next}}og=og.next}while(og!==ag);if(!lg)return null;if(ig===sg)return lg.prev;var dg=lg,cg=lg.x,mg=lg.y,ug=Infinity,gg;for(og=lg.next;og!==dg;)ig>=og.x&&og.x>=cg&&ig!==og.x&&fa(ng<mg?ig:sg,ng,cg,mg,ng<mg?sg:ig,ng,og.x,og.y)&&(gg=Math.abs(ng-og.y)/(ig-og.x),(gg<ug||gg===ug&&og.x>lg.x)&&Sa(og,rg)&&(lg=og,ug=gg)),og=og.next;return lg}function ca(rg,ag,og,ig){var ng=rg;do null===ng.z&&(ng.z=ua(ng.x,ng.y,ag,og,ig)),ng.prevZ=ng.prev,ng.nextZ=ng.next,ng=ng.next;while(ng!==rg);ng.prevZ.nextZ=null,ng.prevZ=null,ma(ng)}function ma(rg){var cg=1,ag,og,ig,ng,sg,lg,pg,dg;do{for(og=rg,rg=null,sg=null,lg=0;og;){for(lg++,ig=og,pg=0,ag=0;ag<cg&&(pg++,ig=ig.nextZ,!!ig);ag++);for(dg=cg;0<pg||0<dg&&ig;)0!==pg&&(0===dg||!ig||og.z<=ig.z)?(ng=og,og=og.nextZ,pg--):(ng=ig,ig=ig.nextZ,dg--),sg?sg.nextZ=ng:rg=ng,ng.prevZ=sg,sg=ng;og=ig}sg.nextZ=null,cg*=2}while(1<lg);return rg}function ua(rg,ag,og,ig,ng){return rg=32767*(rg-og)*ng,ag=32767*(ag-ig)*ng,rg=16711935&(rg|rg<<8),rg=252645135&(rg|rg<<4),rg=858993459&(rg|rg<<2),rg=1431655765&(rg|rg<<1),ag=16711935&(ag|ag<<8),ag=252645135&(ag|ag<<4),ag=858993459&(ag|ag<<2),ag=1431655765&(ag|ag<<1),rg|ag<<1}function ga(rg){var ag=rg,og=rg;do ag.x<og.x&&(og=ag),ag=ag.next;while(ag!==rg);return og}function fa(rg,ag,og,ig,ng,sg,lg,pg){return 0<=(ng-lg)*(ag-pg)-(rg-lg)*(sg-pg)&&0<=(rg-lg)*(ig-pg)-(og-lg)*(ag-pg)&&0<=(og-lg)*(sg-pg)-(ng-lg)*(ig-pg)}function ha(rg,ag){return rg.next.i!==ag.i&&rg.prev.i!==ag.i&&!ba(rg,ag)&&Sa(rg,ag)&&Sa(ag,rg)&&Ma(rg,ag)}function ya(rg,ag,og){return(ag.y-rg.y)*(og.x-ag.x)-(ag.x-rg.x)*(og.y-ag.y)}function xa(rg,ag){return rg.x===ag.x&&rg.y===ag.y}function _a(rg,ag,og,ig){return xa(rg,ag)&&xa(og,ig)||xa(rg,ig)&&xa(og,ag)||0<ya(rg,ag,og)!=0<ya(rg,ag,ig)&&0<ya(og,ig,rg)!=0<ya(og,ig,ag)}function ba(rg,ag){var og=rg;do{if(og.i!==rg.i&&og.next.i!==rg.i&&og.i!==ag.i&&og.next.i!==ag.i&&_a(og,og.next,rg,ag))return!0;og=og.next}while(og!==rg);return!1}function Sa(rg,ag){return 0>ya(rg.prev,rg,rg.next)?0<=ya(rg,ag,rg.next)&&0<=ya(rg,rg.prev,ag):0>ya(rg,ag,rg.prev)||0>ya(rg,rg.next,ag)}function Ma(rg,ag){var og=rg,ig=!1,ng=(rg.x+ag.x)/2,sg=(rg.y+ag.y)/2;do og.y>sg!=og.next.y>sg&&og.next.y!==og.y&&ng<(og.next.x-og.x)*(sg-og.y)/(og.next.y-og.y)+og.x&&(ig=!ig),og=og.next;while(og!==rg);return ig}function Ta(rg,ag){var og=new La(rg.i,rg.x,rg.y),ig=new La(ag.i,ag.x,ag.y),ng=rg.next,sg=ag.prev;return rg.next=ag,ag.prev=rg,og.next=ng,ng.prev=og,ig.next=og,og.prev=ig,sg.next=ig,ig.prev=sg,ig}function Ea(rg,ag,og,ig){var ng=new La(rg,ag,og);return ig?(ng.next=ig.next,ng.prev=ig,ig.next.prev=ng,ig.next=ng):(ng.prev=ng,ng.next=ng),ng}function wa(rg){rg.next.prev=rg.prev,rg.prev.next=rg.next,rg.prevZ&&(rg.prevZ.nextZ=rg.nextZ),rg.nextZ&&(rg.nextZ.prevZ=rg.prevZ)}function La(rg,ag,og){this.i=rg,this.x=ag,this.y=og,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pa(rg,ag,og,ig){for(var ng=0,sg=ag,lg=og-ig;sg<og;sg+=ig)ng+=(rg[lg]-rg[sg])*(rg[sg+1]+rg[lg+1]),lg=sg;return ng}function Aa(rg){var ag=rg.length;2<ag&&rg[ag-1].equals(rg[0])&&rg.pop()}function Ca(rg,ag){for(var og=0;og<ag.length;og++)rg.push(ag[og].x),rg.push(ag[og].y)}function Ra(rg,ag){re.call(this),this.type='ExtrudeGeometry',this.parameters={shapes:rg,options:ag},this.fromBufferGeometry(new Ia(rg,ag)),this.mergeVertices()}function Ia(rg,ag){function og(cg){function mg(ff,hf,yf){return hf||console.error('THREE.ExtrudeGeometry: vec does not exist'),hf.clone().multiplyScalar(yf).add(ff)}function ug(ff,hf,yf){var Sf=ff.x-hf.x,Mf=ff.y-hf.y,Tf=yf.x-ff.x,Ef=yf.y-ff.y,wf=Sf*Sf+Mf*Mf,xf,vf,_f;if(Math.abs(Sf*Ef-Mf*Tf)>Number.EPSILON){var Pf=Math.sqrt(wf),Af=Math.sqrt(Tf*Tf+Ef*Ef),Cf=hf.x-Mf/Pf,Rf=hf.y+Sf/Pf,If=yf.x-Ef/Af,zf=yf.y+Tf/Af,Df=((If-Cf)*Ef-(zf-Rf)*Tf)/(Sf*Ef-Mf*Tf);xf=Cf+Sf*Df-ff.x,vf=Rf+Mf*Df-ff.y;var Bf=xf*xf+vf*vf;if(2>=Bf)return new E(xf,vf);_f=Math.sqrt(Bf/2)}else{var Nf=!1;Sf>Number.EPSILON?Tf>Number.EPSILON&&(Nf=!0):Sf<-Number.EPSILON?Tf<-Number.EPSILON&&(Nf=!0):Math.sign(Mf)===Math.sign(Ef)&&(Nf=!0),Nf?(xf=-Mf,vf=Sf,_f=Math.sqrt(wf)):(xf=Sf,vf=Mf,_f=Math.sqrt(wf/2))}return new E(xf/_f,vf/_f)}function hg(ff,hf){var yf,xf;for(rf=ff.length;0<=--rf;){yf=rf,xf=rf-1,0>xf&&(xf=ff.length-1);var vf=0,_f=Tg+2*Ag;for(vf=0;vf<_f;vf++){var Sf=Kg*vf,Mf=Kg*(vf+1),Tf=hf+yf+Sf,Ef=hf+xf+Sf,wf=hf+xf+Mf,Lf=hf+yf+Mf;vg(Tf,Ef,wf,Lf)}}}function yg(ff,hf,yf){Sg.push(ff),Sg.push(hf),Sg.push(yf)}function xg(ff,hf,yf){_g(ff),_g(hf),_g(yf);var xf=ng.length/3,vf=Rg.generateTopUV(ig,ng,xf-3,xf-2,xf-1);bg(vf[0]),bg(vf[1]),bg(vf[2])}function vg(ff,hf,yf,xf){_g(ff),_g(hf),_g(xf),_g(hf),_g(yf),_g(xf);var vf=ng.length/3,_f=Rg.generateSideWallUV(ig,ng,vf-6,vf-3,vf-2,vf-1);bg(_f[0]),bg(_f[1]),bg(_f[3]),bg(_f[1]),bg(_f[2]),bg(_f[3])}function _g(ff){ng.push(Sg[3*ff+0]),ng.push(Sg[3*ff+1]),ng.push(Sg[3*ff+2])}function bg(ff){sg.push(ff.x),sg.push(ff.y)}var Sg=[],Mg=void 0===ag.curveSegments?12:ag.curveSegments,Tg=void 0===ag.steps?1:ag.steps,Eg=void 0===ag.depth?100:ag.depth,wg=void 0===ag.bevelEnabled||ag.bevelEnabled,Lg=void 0===ag.bevelThickness?6:ag.bevelThickness,Pg=void 0===ag.bevelSize?Lg-2:ag.bevelSize,Ag=void 0===ag.bevelSegments?3:ag.bevelSegments,Cg=ag.extrudePath,Rg=void 0===ag.UVGenerator?um:ag.UVGenerator;void 0!==ag.amount&&(console.warn('THREE.ExtrudeBufferGeometry: amount has been renamed to depth.'),Eg=ag.amount);var zg=!1,Ig,Dg,Bg,Ng,Ug;Cg&&(Ig=Cg.getSpacedPoints(Tg),zg=!0,wg=!1,Dg=Cg.computeFrenetFrames(Tg,!1),Bg=new C,Ng=new C,Ug=new C),wg||(Ag=0,Lg=0,Pg=0);var Hg=cg.extractPoints(Mg),Vg=Hg.shape,kg=Hg.holes,Wg=!mm.isClockWise(Vg),Gg,Og,Fg;if(Wg)for(Vg=Vg.reverse(),Og=0,Fg=kg.length;Og<Fg;Og++)Gg=kg[Og],mm.isClockWise(Gg)&&(kg[Og]=Gg.reverse());var jg=mm.triangulateShape(Vg,kg),qg=Vg;for(Og=0,Fg=kg.length;Og<Fg;Og++)Gg=kg[Og],Vg=Vg.concat(Gg);for(var Kg=Vg.length,ef=jg.length,tf=[],rf=0,of=qg.length,nf=of-1,lf=rf+1,Yg,Xg,Zg,Jg,Qg,$g;rf<of;rf++,nf++,lf++)nf===of&&(nf=0),lf===of&&(lf=0),tf[rf]=ug(qg[rf],qg[nf],qg[lf]);var pf=[],uf=tf.concat(),mf;for(Og=0,Fg=kg.length;Og<Fg;Og++){for(Gg=kg[Og],mf=[],(rf=0,of=Gg.length,nf=of-1,lf=rf+1);rf<of;rf++,nf++,lf++)nf===of&&(nf=0),lf===of&&(lf=0),mf[rf]=ug(Gg[rf],Gg[nf],Gg[lf]);pf.push(mf),uf=uf.concat(mf)}for(Yg=0;Yg<Ag;Yg++){for(Zg=Yg/Ag,Jg=Lg*Math.cos(Zg*Math.PI/2),Xg=Pg*Math.sin(Zg*Math.PI/2),(rf=0,of=qg.length);rf<of;rf++)Qg=mg(qg[rf],tf[rf],Xg),yg(Qg.x,Qg.y,-Jg);for(Og=0,Fg=kg.length;Og<Fg;Og++)for(Gg=kg[Og],mf=pf[Og],(rf=0,of=Gg.length);rf<of;rf++)Qg=mg(Gg[rf],mf[rf],Xg),yg(Qg.x,Qg.y,-Jg)}for(Xg=Pg,rf=0;rf<Kg;rf++)Qg=wg?mg(Vg[rf],uf[rf],Xg):Vg[rf],zg?(Ng.copy(Dg.normals[0]).multiplyScalar(Qg.x),Bg.copy(Dg.binormals[0]).multiplyScalar(Qg.y),Ug.copy(Ig[0]).add(Ng).add(Bg),yg(Ug.x,Ug.y,Ug.z)):yg(Qg.x,Qg.y,0);var gf;for(gf=1;gf<=Tg;gf++)for(rf=0;rf<Kg;rf++)Qg=wg?mg(Vg[rf],uf[rf],Xg):Vg[rf],zg?(Ng.copy(Dg.normals[gf]).multiplyScalar(Qg.x),Bg.copy(Dg.binormals[gf]).multiplyScalar(Qg.y),Ug.copy(Ig[gf]).add(Ng).add(Bg),yg(Ug.x,Ug.y,Ug.z)):yg(Qg.x,Qg.y,Eg/Tg*gf);for(Yg=Ag-1;0<=Yg;Yg--){for(Zg=Yg/Ag,Jg=Lg*Math.cos(Zg*Math.PI/2),Xg=Pg*Math.sin(Zg*Math.PI/2),(rf=0,of=qg.length);rf<of;rf++)Qg=mg(qg[rf],tf[rf],Xg),yg(Qg.x,Qg.y,Eg+Jg);for(Og=0,Fg=kg.length;Og<Fg;Og++)for(Gg=kg[Og],mf=pf[Og],(rf=0,of=Gg.length);rf<of;rf++)Qg=mg(Gg[rf],mf[rf],Xg),zg?yg(Qg.x,Qg.y+Ig[Tg-1].y,Ig[Tg-1].x+Jg):yg(Qg.x,Qg.y,Eg+Jg)}(function(){var ff=ng.length/3;if(wg){var hf=0,yf=Kg*hf;for(rf=0;rf<ef;rf++)$g=jg[rf],xg($g[2]+yf,$g[1]+yf,$g[0]+yf);for(hf=Tg+2*Ag,yf=Kg*hf,rf=0;rf<ef;rf++)$g=jg[rf],xg($g[0]+yf,$g[1]+yf,$g[2]+yf)}else{for(rf=0;rf<ef;rf++)$g=jg[rf],xg($g[2],$g[1],$g[0]);for(rf=0;rf<ef;rf++)$g=jg[rf],xg($g[0]+Kg*Tg,$g[1]+Kg*Tg,$g[2]+Kg*Tg)}ig.addGroup(ff,ng.length/3-ff,0)})(),function(){var ff=ng.length/3,hf=0;for(hg(qg,hf),hf+=qg.length,(Og=0,Fg=kg.length);Og<Fg;Og++)Gg=kg[Og],hg(Gg,hf),hf+=Gg.length;ig.addGroup(ff,ng.length/3-ff,1)}()}ve.call(this),this.type='ExtrudeBufferGeometry',this.parameters={shapes:rg,options:ag},rg=Array.isArray(rg)?rg:[rg];for(var ig=this,ng=[],sg=[],lg=0,pg=rg.length,dg;lg<pg;lg++)dg=rg[lg],og(dg);this.addAttribute('position',new fe(ng,3)),this.addAttribute('uv',new fe(sg,2)),this.computeVertexNormals()}function za(rg,ag,og){if(og.shapes=[],Array.isArray(rg))for(var ig=0,ng=rg.length,sg;ig<ng;ig++)sg=rg[ig],og.shapes.push(sg.uuid);else og.shapes.push(rg.uuid);return void 0!==ag.extrudePath&&(og.options.extrudePath=ag.extrudePath.toJSON()),og}function Da(rg,ag){re.call(this),this.type='TextGeometry',this.parameters={text:rg,parameters:ag},this.fromBufferGeometry(new Ba(rg,ag)),this.mergeVertices()}function Ba(rg,ag){ag=ag||{};var og=ag.font;if(!(og&&og.isFont))return console.error('THREE.TextGeometry: font parameter is not an instance of THREE.Font.'),new re;var ig=og.generateShapes(rg,ag.size);ag.depth=void 0===ag.height?50:ag.height,void 0===ag.bevelThickness&&(ag.bevelThickness=10),void 0===ag.bevelSize&&(ag.bevelSize=8),void 0===ag.bevelEnabled&&(ag.bevelEnabled=!1),Ia.call(this,ig,ag),this.type='TextBufferGeometry'}function Na(rg,ag,og,ig,ng,sg,lg){re.call(this),this.type='SphereGeometry',this.parameters={radius:rg,widthSegments:ag,heightSegments:og,phiStart:ig,phiLength:ng,thetaStart:sg,thetaLength:lg},this.fromBufferGeometry(new Ua(rg,ag,og,ig,ng,sg,lg)),this.mergeVertices()}function Ua(rg,ag,og,ig,ng,sg,lg){ve.call(this),this.type='SphereBufferGeometry',this.parameters={radius:rg,widthSegments:ag,heightSegments:og,phiStart:ig,phiLength:ng,thetaStart:sg,thetaLength:lg},rg=rg||1,ag=Math.max(3,Math.floor(ag)||8),og=Math.max(2,Math.floor(og)||6),ig=void 0===ig?0:ig,ng=void 0===ng?2*Math.PI:ng,sg=void 0===sg?0:sg,lg=void 0===lg?Math.PI:lg;var pg=sg+lg,mg=0,ug=[],gg=new C,fg=new C,hg=[],yg=[],xg=[],vg=[],dg,cg;for(cg=0;cg<=og;cg++){var _g=[],bg=cg/og;for(dg=0;dg<=ag;dg++){var Sg=dg/ag;gg.x=-rg*Math.cos(ig+Sg*ng)*Math.sin(sg+bg*lg),gg.y=rg*Math.cos(sg+bg*lg),gg.z=rg*Math.sin(ig+Sg*ng)*Math.sin(sg+bg*lg),yg.push(gg.x,gg.y,gg.z),fg.set(gg.x,gg.y,gg.z).normalize(),xg.push(fg.x,fg.y,fg.z),vg.push(Sg,1-bg),_g.push(mg++)}ug.push(_g)}for(cg=0;cg<og;cg++)for(dg=0;dg<ag;dg++){var Mg=ug[cg][dg+1],Tg=ug[cg][dg],Eg=ug[cg+1][dg],wg=ug[cg+1][dg+1];(0!==cg||0<sg)&&hg.push(Mg,Tg,wg),(cg!==og-1||pg<Math.PI)&&hg.push(Tg,Eg,wg)}this.setIndex(hg),this.addAttribute('position',new fe(yg,3)),this.addAttribute('normal',new fe(xg,3)),this.addAttribute('uv',new fe(vg,2))}function Ga(rg,ag,og,ig,ng,sg){re.call(this),this.type='RingGeometry',this.parameters={innerRadius:rg,outerRadius:ag,thetaSegments:og,phiSegments:ig,thetaStart:ng,thetaLength:sg},this.fromBufferGeometry(new Oa(rg,ag,og,ig,ng,sg)),this.mergeVertices()}function Oa(rg,ag,og,ig,ng,sg){ve.call(this),this.type='RingBufferGeometry',this.parameters={innerRadius:rg,outerRadius:ag,thetaSegments:og,phiSegments:ig,thetaStart:ng,thetaLength:sg},rg=rg||0.5,ag=ag||1,ng=void 0===ng?0:ng,sg=void 0===sg?2*Math.PI:sg,og=void 0===og?8:Math.max(3,og),ig=void 0===ig?1:Math.max(1,ig);var lg=[],pg=[],dg=[],cg=[],ug=rg,gg=(ag-rg)/ig,fg=new C,hg=new E,mg,yg,xg;for(yg=0;yg<=ig;yg++){for(xg=0;xg<=og;xg++)mg=ng+xg/og*sg,fg.x=ug*Math.cos(mg),fg.y=ug*Math.sin(mg),pg.push(fg.x,fg.y,fg.z),dg.push(0,0,1),hg.x=(fg.x/ag+1)/2,hg.y=(fg.y/ag+1)/2,cg.push(hg.x,hg.y);ug+=gg}for(yg=0;yg<ig;yg++){var vg=yg*(og+1);for(xg=0;xg<og;xg++){mg=xg+vg;var _g=mg,bg=mg+og+1,Sg=mg+og+2,Mg=mg+1;lg.push(_g,bg,Mg),lg.push(bg,Sg,Mg)}}this.setIndex(lg),this.addAttribute('position',new fe(pg,3)),this.addAttribute('normal',new fe(dg,3)),this.addAttribute('uv',new fe(cg,2))}function Fa(rg,ag,og,ig){re.call(this),this.type='LatheGeometry',this.parameters={points:rg,segments:ag,phiStart:og,phiLength:ig},this.fromBufferGeometry(new Ha(rg,ag,og,ig)),this.mergeVertices()}function Ha(rg,ag,og,ig){ve.call(this),this.type='LatheBufferGeometry',this.parameters={points:rg,segments:ag,phiStart:og,phiLength:ig},ag=Math.floor(ag)||12,og=og||0,ig=ig||2*Math.PI,ig=Sp.clamp(ig,0,2*Math.PI);var ng=[],sg=[],lg=[],dg=1/ag,cg=new C,mg=new E,pg,ug,gg;for(ug=0;ug<=ag;ug++){var fg=og+ug*dg*ig,hg=Math.sin(fg),yg=Math.cos(fg);for(gg=0;gg<=rg.length-1;gg++)cg.x=rg[gg].x*hg,cg.y=rg[gg].y,cg.z=rg[gg].x*yg,sg.push(cg.x,cg.y,cg.z),mg.x=ug/ag,mg.y=gg/(rg.length-1),lg.push(mg.x,mg.y)}for(ug=0;ug<ag;ug++)for(gg=0;gg<rg.length-1;gg++){pg=gg+ug*rg.length;var xg=pg,vg=pg+rg.length,_g=pg+rg.length+1,bg=pg+1;ng.push(xg,vg,bg),ng.push(vg,_g,bg)}if(this.setIndex(ng),this.addAttribute('position',new fe(sg,3)),this.addAttribute('uv',new fe(lg,2)),this.computeVertexNormals(),ig===2*Math.PI){var Sg=this.attributes.normal.array,Mg=new C,Tg=new C,Eg=new C;for(pg=3*(ag*rg.length),ug=0,gg=0;ug<rg.length;ug++,gg+=3)Mg.x=Sg[gg+0],Mg.y=Sg[gg+1],Mg.z=Sg[gg+2],Tg.x=Sg[pg+gg+0],Tg.y=Sg[pg+gg+1],Tg.z=Sg[pg+gg+2],Eg.addVectors(Mg,Tg).normalize(),Sg[gg+0]=Sg[pg+gg+0]=Eg.x,Sg[gg+1]=Sg[pg+gg+1]=Eg.y,Sg[gg+2]=Sg[pg+gg+2]=Eg.z}}function Va(rg,ag){re.call(this),this.type='ShapeGeometry','object'==typeof ag&&(console.warn('THREE.ShapeGeometry: Options parameter has been removed.'),ag=ag.curveSegments),this.parameters={shapes:rg,curveSegments:ag},this.fromBufferGeometry(new ka(rg,ag)),this.mergeVertices()}function ka(rg,ag){function og(mg){var hg=ng.length/3,yg=mg.extractPoints(ag),xg=yg.shape,vg=yg.holes,ug,gg,fg;if(!1===mm.isClockWise(xg))for(xg=xg.reverse(),ug=0,gg=vg.length;ug<gg;ug++)fg=vg[ug],!0===mm.isClockWise(fg)&&(vg[ug]=fg.reverse());var _g=mm.triangulateShape(xg,vg);for(ug=0,gg=vg.length;ug<gg;ug++)fg=vg[ug],xg=xg.concat(fg);for(ug=0,gg=xg.length;ug<gg;ug++){var bg=xg[ug];ng.push(bg.x,bg.y,0),sg.push(0,0,1),lg.push(bg.x,bg.y)}for(ug=0,gg=_g.length;ug<gg;ug++){var Sg=_g[ug],Mg=Sg[0]+hg,Tg=Sg[1]+hg,Eg=Sg[2]+hg;ig.push(Mg,Tg,Eg),dg+=3}}ve.call(this),this.type='ShapeBufferGeometry',this.parameters={shapes:rg,curveSegments:ag},ag=ag||12;var ig=[],ng=[],sg=[],lg=[],pg=0,dg=0;if(!1===Array.isArray(rg))og(rg);else for(var cg=0;cg<rg.length;cg++)og(rg[cg]),this.addGroup(pg,dg,cg),pg+=dg,dg=0;this.setIndex(ig),this.addAttribute('position',new fe(ng,3)),this.addAttribute('normal',new fe(sg,3)),this.addAttribute('uv',new fe(lg,2))}function Wa(rg,ag){if(ag.shapes=[],Array.isArray(rg))for(var og=0,ig=rg.length,ng;og<ig;og++)ng=rg[og],ag.shapes.push(ng.uuid);else ag.shapes.push(rg.uuid);return ag}function ja(rg,ag){ve.call(this),this.type='EdgesGeometry',this.parameters={thresholdAngle:ag},ag=void 0===ag?1:ag;var og=[],ig=Math.cos(Sp.DEG2RAD*ag),ng=[0,0],sg={},cg=['a','b','c'],lg,pg,dg,mg;rg.isBufferGeometry?(mg=new re,mg.fromBufferGeometry(rg)):mg=rg.clone(),mg.mergeVertices(),mg.computeFaceNormals();for(var ug=mg.vertices,gg=mg.faces,fg=0,hg=gg.length,yg;fg<hg;fg++){yg=gg[fg];for(var xg=0;3>xg;xg++)lg=yg[cg[xg]],pg=yg[cg[(xg+1)%3]],ng[0]=Math.min(lg,pg),ng[1]=Math.max(lg,pg),dg=ng[0]+','+ng[1],void 0===sg[dg]?sg[dg]={index1:ng[0],index2:ng[1],face1:fg,face2:void 0}:sg[dg].face2=fg}for(dg in sg){var vg=sg[dg];if(void 0===vg.face2||gg[vg.face1].normal.dot(gg[vg.face2].normal)<=ig){var _g=ug[vg.index1];og.push(_g.x,_g.y,_g.z),_g=ug[vg.index2],og.push(_g.x,_g.y,_g.z)}}this.addAttribute('position',new fe(og,3))}function Ya(rg,ag,og,ig,ng,sg,lg,pg){re.call(this),this.type='CylinderGeometry',this.parameters={radiusTop:rg,radiusBottom:ag,height:og,radialSegments:ig,heightSegments:ng,openEnded:sg,thetaStart:lg,thetaLength:pg},this.fromBufferGeometry(new Xa(rg,ag,og,ig,ng,sg,lg,pg)),this.mergeVertices()}function Xa(rg,ag,og,ig,ng,sg,lg,pg){function cg(bg){var Eg=new E,wg=new C,Lg=0,Pg=!0===bg?rg:ag,Ag=!0===bg?1:-1,Sg,Mg,Tg;for(Mg=yg,Sg=1;Sg<=ig;Sg++)gg.push(0,vg*Ag,0),fg.push(0,Ag,0),hg.push(0.5,0.5),yg++;for(Tg=yg,Sg=0;Sg<=ig;Sg++){var Cg=Sg/ig,Rg=Cg*pg+lg,Ig=Math.cos(Rg),zg=Math.sin(Rg);wg.x=Pg*zg,wg.y=vg*Ag,wg.z=Pg*Ig,gg.push(wg.x,wg.y,wg.z),fg.push(0,Ag,0),Eg.x=0.5*Ig+0.5,Eg.y=0.5*zg*Ag+0.5,hg.push(Eg.x,Eg.y),yg++}for(Sg=0;Sg<ig;Sg++){var Dg=Mg+Sg,Bg=Tg+Sg;!0===bg?ug.push(Bg,Bg+1,Dg):ug.push(Bg+1,Bg,Dg),Lg+=3}mg.addGroup(_g,Lg,!0===bg?1:2),_g+=Lg}ve.call(this),this.type='CylinderBufferGeometry',this.parameters={radiusTop:rg,radiusBottom:ag,height:og,radialSegments:ig,heightSegments:ng,openEnded:sg,thetaStart:lg,thetaLength:pg};var mg=this;rg=void 0===rg?1:rg,ag=void 0===ag?1:ag,og=og||1,ig=Math.floor(ig)||8,ng=Math.floor(ng)||1,sg=void 0!==sg&&sg,lg=void 0===lg?0:lg,pg=void 0===pg?2*Math.PI:pg;var ug=[],gg=[],fg=[],hg=[],yg=0,xg=[],vg=og/2,_g=0;(function(){var Mg=new C,Tg=new C,Eg=0,wg=(ag-rg)/og,bg,Sg;for(Sg=0;Sg<=ng;Sg++){var Lg=[],Pg=Sg/ng,Ag=Pg*(ag-rg)+rg;for(bg=0;bg<=ig;bg++){var Cg=bg/ig,Rg=Cg*pg+lg,Ig=Math.sin(Rg),zg=Math.cos(Rg);Tg.x=Ag*Ig,Tg.y=-Pg*og+vg,Tg.z=Ag*zg,gg.push(Tg.x,Tg.y,Tg.z),Mg.set(Ig,wg,zg).normalize(),fg.push(Mg.x,Mg.y,Mg.z),hg.push(Cg,1-Pg),Lg.push(yg++)}xg.push(Lg)}for(bg=0;bg<ig;bg++)for(Sg=0;Sg<ng;Sg++){var Dg=xg[Sg][bg],Bg=xg[Sg+1][bg],Ng=xg[Sg+1][bg+1],Ug=xg[Sg][bg+1];ug.push(Dg,Bg,Ug),ug.push(Bg,Ng,Ug),Eg+=6}mg.addGroup(_g,Eg,0),_g+=Eg})(),!1===sg&&(0<rg&&cg(!0),0<ag&&cg(!1)),this.setIndex(ug),this.addAttribute('position',new fe(gg,3)),this.addAttribute('normal',new fe(fg,3)),this.addAttribute('uv',new fe(hg,2))}function Za(rg,ag,og,ig,ng,sg,lg){Ya.call(this,0,rg,ag,og,ig,ng,sg,lg),this.type='ConeGeometry',this.parameters={radius:rg,height:ag,radialSegments:og,heightSegments:ig,openEnded:ng,thetaStart:sg,thetaLength:lg}}function Ja(rg,ag,og,ig,ng,sg,lg){Xa.call(this,0,rg,ag,og,ig,ng,sg,lg),this.type='ConeBufferGeometry',this.parameters={radius:rg,height:ag,radialSegments:og,heightSegments:ig,openEnded:ng,thetaStart:sg,thetaLength:lg}}function Qa(rg,ag,og,ig){re.call(this),this.type='CircleGeometry',this.parameters={radius:rg,segments:ag,thetaStart:og,thetaLength:ig},this.fromBufferGeometry(new Ka(rg,ag,og,ig)),this.mergeVertices()}function Ka(rg,ag,og,ig){ve.call(this),this.type='CircleBufferGeometry',this.parameters={radius:rg,segments:ag,thetaStart:og,thetaLength:ig},rg=rg||1,ag=void 0===ag?8:Math.max(3,ag),og=void 0===og?0:og,ig=void 0===ig?2*Math.PI:ig;var ng=[],sg=[],lg=[],pg=[],mg=new C,ug=new E,dg,cg;for(sg.push(0,0,0),lg.push(0,0,1),pg.push(0.5,0.5),(cg=0,dg=3);cg<=ag;cg++,dg+=3){var gg=og+cg/ag*ig;mg.x=rg*Math.cos(gg),mg.y=rg*Math.sin(gg),sg.push(mg.x,mg.y,mg.z),lg.push(0,0,1),ug.x=(sg[dg]/rg+1)/2,ug.y=(sg[dg+1]/rg+1)/2,pg.push(ug.x,ug.y)}for(dg=1;dg<=ag;dg++)ng.push(dg,dg+1,0);this.setIndex(ng),this.addAttribute('position',new fe(sg,3)),this.addAttribute('normal',new fe(lg,3)),this.addAttribute('uv',new fe(pg,2))}function $a(rg){Ee.call(this),this.type='ShadowMaterial',this.color=new Y(0),this.transparent=!0,this.setValues(rg)}function eo(rg){we.call(this,rg),this.type='RawShaderMaterial'}function ro(rg){Ee.call(this),this.defines={STANDARD:''},this.type='MeshStandardMaterial',this.color=new Y(16777215),this.roughness=0.5,this.metalness=0.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vp,this.normalScale=new E(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(rg)}function ao(rg){ro.call(this),this.defines={PHYSICAL:''},this.type='MeshPhysicalMaterial',this.reflectivity=0.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(rg)}function oo(rg){Ee.call(this),this.type='MeshPhongMaterial',this.color=new Y(16777215),this.specular=new Y(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vp,this.normalScale=new E(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ts,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(rg)}function io(rg){oo.call(this),this.defines={TOON:''},this.type='MeshToonMaterial',this.gradientMap=null,this.setValues(rg)}function no(rg){Ee.call(this),this.type='MeshNormalMaterial',this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vp,this.normalScale=new E(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(rg)}function so(rg){Ee.call(this),this.type='MeshLambertMaterial',this.color=new Y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ts,this.reflectivity=1,this.refractionRatio=0.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(rg)}function lo(rg){if(Ee.call(this),this.defines={MATCAP:''},this.type='MeshMatcapMaterial',this.color=new Y(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vp,this.normalScale=new E(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(rg),null===this.matcap){var ag=document.createElement('canvas');ag.width=1,ag.height=1;var og=ag.getContext('2d');og.fillStyle='#fff',og.fillRect(0,0,1,1),this.matcap=new THREE.CanvasTexture(ag)}}function po(rg){Er.call(this),this.type='LineDashedMaterial',this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(rg)}function co(rg,ag,og,ig){this.parameterPositions=rg,this._cachedIndex=0,this.resultBuffer=void 0===ig?new ag.constructor(og):ig,this.sampleValues=ag,this.valueSize=og}function mo(rg,ag,og,ig){co.call(this,rg,ag,og,ig),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function uo(rg,ag,og,ig){co.call(this,rg,ag,og,ig)}function go(rg,ag,og,ig){co.call(this,rg,ag,og,ig)}function fo(rg,ag,og,ig){if(void 0===rg)throw new Error('THREE.KeyframeTrack: track name is undefined');if(void 0===ag||0===ag.length)throw new Error('THREE.KeyframeTrack: no keyframes in track named '+rg);this.name=rg,this.times=hm.convertArray(ag,this.TimeBufferType),this.values=hm.convertArray(og,this.ValueBufferType),this.setInterpolation(ig||this.DefaultInterpolation)}function yo(rg,ag,og){fo.call(this,rg,ag,og)}function xo(rg,ag,og,ig){fo.call(this,rg,ag,og,ig)}function vo(rg,ag,og,ig){fo.call(this,rg,ag,og,ig)}function _o(rg,ag,og,ig){co.call(this,rg,ag,og,ig)}function bo(rg,ag,og,ig){fo.call(this,rg,ag,og,ig)}function So(rg,ag,og,ig){fo.call(this,rg,ag,og,ig)}function Mo(rg,ag,og,ig){fo.call(this,rg,ag,og,ig)}function To(rg,ag,og){this.name=rg,this.tracks=og,this.duration=void 0===ag?-1:ag,this.uuid=Sp.generateUUID(),0>this.duration&&this.resetDuration()}function Eo(rg){switch(rg.toLowerCase()){case'scalar':case'double':case'float':case'number':case'integer':return vo;case'vector':case'vector2':case'vector3':case'vector4':return Mo;case'color':return xo;case'quaternion':return bo;case'bool':case'boolean':return yo;case'string':return So;}throw new Error('THREE.KeyframeTrack: Unsupported typeName: '+rg)}function wo(rg){if(void 0===rg.type)throw new Error('THREE.KeyframeTrack: track type undefined, can not parse');var ag=Eo(rg.type);if(void 0===rg.times){var og=[],ig=[];hm.flattenJSON(rg.keys,og,ig,'value'),rg.times=og,rg.values=ig}return void 0===ag.parse?new ag(rg.name,rg.times,rg.values,rg.interpolation):ag.parse(rg)}function Lo(rg,ag,og){var ig=this,ng=!1,sg=0,lg=0,pg;this.onStart=void 0,this.onLoad=rg,this.onProgress=ag,this.onError=og,this.itemStart=function(dg){lg++,!1==ng&&void 0!==ig.onStart&&ig.onStart(dg,sg,lg),ng=!0},this.itemEnd=function(dg){sg++,void 0!==ig.onProgress&&ig.onProgress(dg,sg,lg),sg==lg&&(ng=!1,void 0!==ig.onLoad&&ig.onLoad())},this.itemError=function(dg){void 0!==ig.onError&&ig.onError(dg)},this.resolveURL=function(dg){return pg?pg(dg):dg},this.setURLModifier=function(dg){return pg=dg,this}}function Po(rg){this.manager=void 0===rg?xm:rg}function Io(rg){this.manager=void 0===rg?xm:rg}function zo(rg){this.manager=void 0===rg?xm:rg}function Do(rg){this.manager=void 0===rg?xm:rg}function Bo(){this.type='Curve',this.arcLengthDivisions=200}function No(rg,ag,og,ig,ng,sg,lg,pg){Bo.call(this),this.type='EllipseCurve',this.aX=rg||0,this.aY=ag||0,this.xRadius=og||1,this.yRadius=ig||1,this.aStartAngle=ng||0,this.aEndAngle=sg||2*Math.PI,this.aClockwise=lg||!1,this.aRotation=pg||0}function Uo(rg,ag,og,ig,ng,sg){No.call(this,rg,ag,og,og,ig,ng,sg),this.type='ArcCurve'}function Go(){function rg(sg,lg,pg,dg){ag=sg,og=pg,ig=-3*sg+3*lg-2*pg-dg,ng=2*sg-2*lg+pg+dg}var ag=0,og=0,ig=0,ng=0;return{initCatmullRom:function(sg,lg,pg,dg,cg){rg(lg,pg,cg*(pg-sg),cg*(dg-lg))},initNonuniformCatmullRom:function(sg,lg,pg,dg,cg,mg,ug){var gg=(lg-sg)/cg-(pg-sg)/(cg+mg)+(pg-lg)/mg,fg=(pg-lg)/mg-(dg-lg)/(mg+ug)+(dg-pg)/ug;gg*=mg,fg*=mg,rg(lg,pg,gg,fg)},calc:function(sg){var lg=sg*sg;return ag+og*sg+ig*lg+ng*(lg*sg)}}}function Oo(rg,ag,og,ig){Bo.call(this),this.type='CatmullRomCurve3',this.points=rg||[],this.closed=ag||!1,this.curveType=og||'centripetal',this.tension=ig||0.5}function Fo(rg,ag,og,ig,ng){var sg=0.5*(ig-ag),lg=0.5*(ng-og),pg=rg*rg;return(2*og-2*ig+sg+lg)*(rg*pg)+(-3*og+3*ig-2*sg-lg)*pg+sg*rg+og}function Ho(rg,ag){var og=1-rg;return og*og*ag}function Vo(rg,ag){return 2*(1-rg)*rg*ag}function ko(rg,ag){return rg*rg*ag}function Wo(rg,ag,og,ig){return Ho(rg,ag)+Vo(rg,og)+ko(rg,ig)}function jo(rg,ag){var og=1-rg;return og*og*og*ag}function qo(rg,ag){var og=1-rg;return 3*og*og*rg*ag}function Yo(rg,ag){return 3*(1-rg)*rg*rg*ag}function Xo(rg,ag){return rg*rg*rg*ag}function Zo(rg,ag,og,ig,ng){return jo(rg,ag)+qo(rg,og)+Yo(rg,ig)+Xo(rg,ng)}function Jo(rg,ag,og,ig){Bo.call(this),this.type='CubicBezierCurve',this.v0=rg||new E,this.v1=ag||new E,this.v2=og||new E,this.v3=ig||new E}function Qo(rg,ag,og,ig){Bo.call(this),this.type='CubicBezierCurve3',this.v0=rg||new C,this.v1=ag||new C,this.v2=og||new C,this.v3=ig||new C}function Ko(rg,ag){Bo.call(this),this.type='LineCurve',this.v1=rg||new E,this.v2=ag||new E}function $o(rg,ag){Bo.call(this),this.type='LineCurve3',this.v1=rg||new C,this.v2=ag||new C}function ei(rg,ag,og){Bo.call(this),this.type='QuadraticBezierCurve',this.v0=rg||new E,this.v1=ag||new E,this.v2=og||new E}function ti(rg,ag,og){Bo.call(this),this.type='QuadraticBezierCurve3',this.v0=rg||new C,this.v1=ag||new C,this.v2=og||new C}function ri(rg){Bo.call(this),this.type='SplineCurve',this.points=rg||[]}function ai(){Bo.call(this),this.type='CurvePath',this.curves=[],this.autoClose=!1}function oi(rg){ai.call(this),this.type='Path',this.currentPoint=new E,rg&&this.setFromPoints(rg)}function ii(rg){oi.call(this,rg),this.uuid=Sp.generateUUID(),this.type='Shape',this.holes=[]}function ni(rg,ag){ee.call(this),this.type='Light',this.color=new Y(rg),this.intensity=void 0===ag?1:ag,this.receiveShadow=void 0}function si(rg,ag,og){ni.call(this,rg,og),this.type='HemisphereLight',this.castShadow=void 0,this.position.copy(ee.DefaultUp),this.updateMatrix(),this.groundColor=new Y(ag)}function li(rg){this.camera=rg,this.bias=0,this.radius=1,this.mapSize=new E(512,512),this.map=null,this.matrix=new L}function pi(){li.call(this,new sr(50,1,0.5,500))}function di(rg,ag,og,ig,ng,sg){ni.call(this,rg,ag),this.type='SpotLight',this.position.copy(ee.DefaultUp),this.updateMatrix(),this.target=new ee,Object.defineProperty(this,'power',{get:function(){return this.intensity*Math.PI},set:function(lg){this.intensity=lg/Math.PI}}),this.distance=void 0===og?0:og,this.angle=void 0===ig?Math.PI/3:ig,this.penumbra=void 0===ng?0:ng,this.decay=void 0===sg?1:sg,this.shadow=new pi}function ci(rg,ag,og,ig){ni.call(this,rg,ag),this.type='PointLight',Object.defineProperty(this,'power',{get:function(){return 4*this.intensity*Math.PI},set:function(ng){this.intensity=ng/(4*Math.PI)}}),this.distance=void 0===og?0:og,this.decay=void 0===ig?1:ig,this.shadow=new li(new sr(90,1,0.5,500))}function mi(rg,ag,og,ig,ng,sg){nr.call(this),this.type='OrthographicCamera',this.zoom=1,this.view=null,this.left=void 0===rg?-1:rg,this.right=void 0===ag?1:ag,this.top=void 0===og?1:og,this.bottom=void 0===ig?-1:ig,this.near=void 0===ng?0.1:ng,this.far=void 0===sg?2e3:sg,this.updateProjectionMatrix()}function ui(){li.call(this,new mi(-5,5,5,-5,0.5,500))}function gi(rg,ag){ni.call(this,rg,ag),this.type='DirectionalLight',this.position.copy(ee.DefaultUp),this.updateMatrix(),this.target=new ee,this.shadow=new ui}function hi(rg,ag){ni.call(this,rg,ag),this.type='AmbientLight',this.castShadow=void 0}function yi(rg,ag,og,ig){ni.call(this,rg,ag),this.type='RectAreaLight',this.width=void 0===og?10:og,this.height=void 0===ig?10:ig}function xi(rg){this.manager=void 0===rg?xm:rg,this.textures={}}function vi(rg){this.manager=void 0===rg?xm:rg}function _i(){}function bi(rg){'boolean'==typeof rg&&(console.warn('THREE.JSONLoader: showStatus parameter has been removed from constructor.'),rg=void 0),this.manager=void 0===rg?xm:rg,this.withCredentials=!1}function Si(rg){this.manager=void 0===rg?xm:rg,this.resourcePath=''}function Mi(){this.type='ShapePath',this.color=new Y,this.subPaths=[],this.currentPath=null}function Ti(rg){this.type='Font',this.data=rg}function Ei(rg,ag,og){for(var ig=Array.from?Array.from(rg):(rg+'').split(''),ng=ag/og.resolution,sg=(og.boundingBox.yMax-og.boundingBox.yMin+og.underlineThickness)*ng,lg=[],pg=0,dg=0,cg=0,mg;cg<ig.length;cg++)if(mg=ig[cg],'\n'===mg)pg=0,dg-=sg;else{var ug=wi(mg,ng,pg,dg,og);pg+=ug.offsetX,lg.push(ug.path)}return lg}function wi(rg,ag,og,ig,ng){var sg=ng.glyphs[rg]||ng.glyphs['?'];if(sg){var lg=new Mi,pg,dg,cg,mg,ug,gg,fg,hg;if(sg.o)for(var yg=sg._cachedOutline||(sg._cachedOutline=sg.o.split(' ')),xg=0,vg=yg.length,_g;xg<vg;)_g=yg[xg++],'m'===_g?(pg=yg[xg++]*ag+og,dg=yg[xg++]*ag+ig,lg.moveTo(pg,dg)):'l'===_g?(pg=yg[xg++]*ag+og,dg=yg[xg++]*ag+ig,lg.lineTo(pg,dg)):'q'===_g?(cg=yg[xg++]*ag+og,mg=yg[xg++]*ag+ig,ug=yg[xg++]*ag+og,gg=yg[xg++]*ag+ig,lg.quadraticCurveTo(ug,gg,cg,mg)):'b'===_g?(cg=yg[xg++]*ag+og,mg=yg[xg++]*ag+ig,ug=yg[xg++]*ag+og,gg=yg[xg++]*ag+ig,fg=yg[xg++]*ag+og,hg=yg[xg++]*ag+ig,lg.bezierCurveTo(ug,gg,fg,hg,cg,mg)):void 0;return{offsetX:sg.ha*ag,path:lg}}}function Pi(rg){this.manager=void 0===rg?xm:rg}function Ci(rg,ag,og,ig){ee.call(this),this.type='CubeCamera';var ng=90,sg=1,lg=new sr(ng,sg,rg,ag);lg.up.set(0,-1,0),lg.lookAt(new C(1,0,0)),this.add(lg);var pg=new sr(ng,sg,rg,ag);pg.up.set(0,-1,0),pg.lookAt(new C(-1,0,0)),this.add(pg);var dg=new sr(ng,sg,rg,ag);dg.up.set(0,0,1),dg.lookAt(new C(0,1,0)),this.add(dg);var cg=new sr(ng,sg,rg,ag);cg.up.set(0,0,-1),cg.lookAt(new C(0,-1,0)),this.add(cg);var mg=new sr(ng,sg,rg,ag);mg.up.set(0,-1,0),mg.lookAt(new C(0,0,1)),this.add(mg);var ug=new sr(ng,sg,rg,ag);ug.up.set(0,-1,0),ug.lookAt(new C(0,0,-1)),this.add(ug),ig=ig||{format:yl,magFilter:qs,minFilter:qs},this.renderTarget=new G(og,og,ig),this.renderTarget.texture.name='CubeCamera',this.update=function(gg,fg){null===this.parent&&this.updateMatrixWorld();var hg=this.renderTarget,yg=hg.texture.generateMipmaps;hg.texture.generateMipmaps=!1,hg.activeCubeFace=0,gg.render(fg,lg,hg),hg.activeCubeFace=1,gg.render(fg,pg,hg),hg.activeCubeFace=2,gg.render(fg,dg,hg),hg.activeCubeFace=3,gg.render(fg,cg,hg),hg.activeCubeFace=4,gg.render(fg,mg,hg),hg.texture.generateMipmaps=yg,hg.activeCubeFace=5,gg.render(fg,ug,hg),gg.setRenderTarget(null)},this.clear=function(gg,fg,hg,yg){for(var xg=this.renderTarget,vg=0;6>vg;vg++)xg.activeCubeFace=vg,gg.setRenderTarget(xg),gg.clear(fg,hg,yg);gg.setRenderTarget(null)}}function Ri(rg){this.autoStart=void 0===rg||rg,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ii(){ee.call(this),this.type='AudioListener',this.context=Rm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function zi(rg){ee.call(this),this.type='Audio',this.listener=rg,this.context=rg.context,this.gain=this.context.createGain(),this.gain.connect(rg.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType='empty',this.filters=[]}function Di(rg){zi.call(this,rg),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Bi(rg,ag){this.analyser=rg.context.createAnalyser(),this.analyser.fftSize=void 0===ag?2048:ag,this.data=new Uint8Array(this.analyser.frequencyBinCount),rg.getOutput().connect(this.analyser)}function Ni(rg,ag,og){this.binding=rg,this.valueSize=og;var ig=Float64Array,ng;'quaternion'===ag?ng=this._slerp:'string'===ag||'bool'===ag?(ig=Array,ng=this._select):ng=this._lerp,this.buffer=new ig(4*og),this._mixBufferRegion=ng,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Ui(rg,ag,og){var ig=og||Gi.parseTrackName(ag);this._targetGroup=rg,this._bindings=rg.subscribe_(ag,ig)}function Gi(rg,ag,og){this.path=ag,this.parsedPath=og||Gi.parseTrackName(ag),this.node=Gi.findNode(rg,this.parsedPath.nodeName)||rg,this.rootNode=rg}function Fi(rg,ag,og){this._mixer=rg,this._clip=ag,this._localRoot=og||null;for(var ig=ag.tracks,ng=ig.length,sg=Array(ng),lg={endingStart:rp,endingEnd:rp},pg=0,dg;pg!==ng;++pg)dg=ig[pg].createInterpolant(null),sg[pg]=dg,dg.settings=lg;this._interpolantSettings=lg,this._interpolants=sg,this._propertyBindings=Array(ng),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Hi(rg){this._root=rg,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Vi(rg){'string'==typeof rg&&(console.warn('THREE.Uniform: Type parameter is no longer needed.'),rg=arguments[1]),this.value=rg}function ki(){ve.call(this),this.type='InstancedBufferGeometry',this.maxInstancedCount=void 0}function Wi(rg,ag,og){hr.call(this,rg,ag),this.meshPerAttribute=og||1}function ji(rg,ag,og,ig){'number'==typeof og&&(ig=og,og=!1,console.error('THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.')),oe.call(this,rg,ag,og),this.meshPerAttribute=ig||1}function Yi(rg,ag){return rg.distance-ag.distance}function Xi(rg,ag,og,ig){if(!1!==rg.visible&&(rg.raycast(ag,og),!0===ig))for(var ng=rg.children,sg=0,lg=ng.length;sg<lg;sg++)Xi(ng[sg],ag,og,!0)}function Qi(rg,ag){this.min=void 0===rg?new E(+Infinity,+Infinity):rg,this.max=void 0===ag?new E(-Infinity,-Infinity):ag}function Ki(rg,ag){this.start=void 0===rg?new C:rg,this.end=void 0===ag?new C:ag}function $i(rg){ee.call(this),this.material=rg,this.render=function(){}}function en(rg,ag,og,ig){this.object=rg,this.size=void 0===ag?1:ag;var ng=void 0===og?16711680:og,sg=void 0===ig?1:ig,lg=0,pg=this.object.geometry;pg&&pg.isGeometry?lg=3*pg.faces.length:pg&&pg.isBufferGeometry&&(lg=pg.attributes.normal.count);var dg=new ve,cg=new fe(3*(2*lg),3);dg.addAttribute('position',cg),Lr.call(this,dg,new Er({color:ng,linewidth:sg})),this.matrixAutoUpdate=!1,this.update()}function tn(rg,ag){ee.call(this),this.light=rg,this.light.updateMatrixWorld(),this.matrix=rg.matrixWorld,this.matrixAutoUpdate=!1,this.color=ag;for(var og=new ve,ig=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],ng=0,sg=1,lg=32;ng<lg;ng++,sg++){var pg=2*(ng/lg*Math.PI),dg=2*(sg/lg*Math.PI);ig.push(Math.cos(pg),Math.sin(pg),1,Math.cos(dg),Math.sin(dg),1)}og.addAttribute('position',new fe(ig,3));var cg=new Er({fog:!1});this.cone=new Lr(og,cg),this.add(this.cone),this.update()}function rn(rg){var ag=[];rg&&rg.isBone&&ag.push(rg);for(var og=0;og<rg.children.length;og++)ag.push.apply(ag,rn(rg.children[og]));return ag}function on(rg){for(var ag=rn(rg),og=new ve,ig=[],ng=[],sg=new Y(0,0,1),lg=new Y(0,1,0),pg=0,dg;pg<ag.length;pg++)dg=ag[pg],dg.parent&&dg.parent.isBone&&(ig.push(0,0,0),ig.push(0,0,0),ng.push(sg.r,sg.g,sg.b),ng.push(lg.r,lg.g,lg.b));og.addAttribute('position',new fe(ig,3)),og.addAttribute('color',new fe(ng,3));var cg=new Er({vertexColors:jn,depthTest:!1,depthWrite:!1,transparent:!0});Lr.call(this,og,cg),this.root=rg,this.bones=ag,this.matrix=rg.matrixWorld,this.matrixAutoUpdate=!1}function nn(rg,ag,og){this.light=rg,this.light.updateMatrixWorld(),this.color=og;var ig=new Ua(ag,4,2),ng=new Ae({wireframe:!0,fog:!1});Ce.call(this,ig,ng),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function sn(rg,ag){ee.call(this),this.light=rg,this.light.updateMatrixWorld(),this.matrix=rg.matrixWorld,this.matrixAutoUpdate=!1,this.color=ag;var og=new Er({fog:!1}),ig=new ve;ig.addAttribute('position',new oe(new Float32Array(15),3)),this.line=new wr(ig,og),this.add(this.line),this.update()}function ln(rg,ag,og){ee.call(this),this.light=rg,this.light.updateMatrixWorld(),this.matrix=rg.matrixWorld,this.matrixAutoUpdate=!1,this.color=og;var ig=new kr(ag);ig.rotateY(0.5*Math.PI),this.material=new Ae({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=jn);var ng=ig.getAttribute('position'),sg=new Float32Array(3*ng.count);ig.addAttribute('color',new oe(sg,3)),this.add(new Ce(ig,this.material)),this.update()}function pn(rg,ag,og,ig){rg=rg||10,ag=ag||10,og=new Y(void 0===og?4473924:og),ig=new Y(void 0===ig?8947848:ig);for(var ng=ag/2,sg=rg/ag,lg=rg/2,pg=[],dg=[],cg=0,mg=0,ug=-lg;cg<=ag;cg++,ug+=sg){pg.push(-lg,0,ug,lg,0,ug),pg.push(ug,0,-lg,ug,0,lg);var gg=cg===ng?og:ig;gg.toArray(dg,mg),mg+=3,gg.toArray(dg,mg),mg+=3,gg.toArray(dg,mg),mg+=3,gg.toArray(dg,mg),mg+=3}var fg=new ve;fg.addAttribute('position',new fe(pg,3)),fg.addAttribute('color',new fe(dg,3));var hg=new Er({vertexColors:jn});Lr.call(this,fg,hg)}function dn(rg,ag,og,ig,ng,sg){rg=rg||10,ag=ag||16,og=og||8,ig=ig||64,ng=new Y(void 0===ng?4473924:ng),sg=new Y(void 0===sg?8947848:sg);var lg=[],pg=[],dg,cg,mg,ug,gg,fg,hg;for(ug=0;ug<=ag;ug++)mg=ug/ag*(2*Math.PI),dg=Math.sin(mg)*rg,cg=Math.cos(mg)*rg,lg.push(0,0,0),lg.push(dg,0,cg),hg=1&ug?ng:sg,pg.push(hg.r,hg.g,hg.b),pg.push(hg.r,hg.g,hg.b);for(ug=0;ug<=og;ug++)for(hg=1&ug?ng:sg,fg=rg-rg/og*ug,gg=0;gg<ig;gg++)mg=gg/ig*(2*Math.PI),dg=Math.sin(mg)*fg,cg=Math.cos(mg)*fg,lg.push(dg,0,cg),pg.push(hg.r,hg.g,hg.b),mg=(gg+1)/ig*(2*Math.PI),dg=Math.sin(mg)*fg,cg=Math.cos(mg)*fg,lg.push(dg,0,cg),pg.push(hg.r,hg.g,hg.b);var yg=new ve;yg.addAttribute('position',new fe(lg,3)),yg.addAttribute('color',new fe(pg,3));var xg=new Er({vertexColors:jn});Lr.call(this,yg,xg)}function cn(rg,ag,og,ig){this.object=rg,this.size=void 0===ag?1:ag;var ng=void 0===og?16776960:og,sg=void 0===ig?1:ig,lg=0,pg=this.object.geometry;pg&&pg.isGeometry?lg=pg.faces.length:console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');var dg=new ve,cg=new fe(3*(2*lg),3);dg.addAttribute('position',cg),Lr.call(this,dg,new Er({color:ng,linewidth:sg})),this.matrixAutoUpdate=!1,this.update()}function mn(rg,ag,og){ee.call(this),this.light=rg,this.light.updateMatrixWorld(),this.matrix=rg.matrixWorld,this.matrixAutoUpdate=!1,this.color=og,void 0===ag&&(ag=1);var ig=new ve;ig.addAttribute('position',new fe([-ag,ag,0,ag,ag,0,ag,-ag,0,-ag,-ag,0,-ag,ag,0],3));var ng=new Er({fog:!1});this.lightPlane=new wr(ig,ng),this.add(this.lightPlane),ig=new ve,ig.addAttribute('position',new fe([0,0,0,0,0,1],3)),this.targetLine=new wr(ig,ng),this.add(this.targetLine),this.update()}function un(rg){function ag(fg,hg,yg){og(fg,yg),og(hg,yg)}function og(fg,hg){sg.push(0,0,0),lg.push(hg.r,hg.g,hg.b),void 0===pg[fg]&&(pg[fg]=[]),pg[fg].push(sg.length/3-1)}var ig=new ve,ng=new Er({color:16777215,vertexColors:Wn}),sg=[],lg=[],pg={},dg=new Y(16755200),cg=new Y(16711680),mg=new Y(43775),ug=new Y(16777215),gg=new Y(3355443);ag('n1','n2',dg),ag('n2','n4',dg),ag('n4','n3',dg),ag('n3','n1',dg),ag('f1','f2',dg),ag('f2','f4',dg),ag('f4','f3',dg),ag('f3','f1',dg),ag('n1','f1',dg),ag('n2','f2',dg),ag('n3','f3',dg),ag('n4','f4',dg),ag('p','n1',cg),ag('p','n2',cg),ag('p','n3',cg),ag('p','n4',cg),ag('u1','u2',mg),ag('u2','u3',mg),ag('u3','u1',mg),ag('c','t',ug),ag('p','c',gg),ag('cn1','cn2',gg),ag('cn3','cn4',gg),ag('cf1','cf2',gg),ag('cf3','cf4',gg),ig.addAttribute('position',new fe(sg,3)),ig.addAttribute('color',new fe(lg,3)),Lr.call(this,ig,ng),this.camera=rg,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=rg.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=pg,this.update()}function gn(rg,ag){this.object=rg,void 0===ag&&(ag=16776960);var og=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ig=new Float32Array(24),ng=new ve;ng.setIndex(new oe(og,1)),ng.addAttribute('position',new oe(ig,3)),Lr.call(this,ng,new Er({color:ag})),this.matrixAutoUpdate=!1,this.update()}function fn(rg,ag){this.type='Box3Helper',this.box=rg;var og=void 0===ag?16776960:ag,ig=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),sg=new ve;sg.setIndex(new oe(ig,1)),sg.addAttribute('position',new fe([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Lr.call(this,sg,new Er({color:og})),this.geometry.computeBoundingSphere()}function hn(rg,ag,og){this.type='PlaneHelper',this.plane=rg,this.size=void 0===ag?1:ag;var ig=void 0===og?16776960:og,sg=new ve;sg.addAttribute('position',new fe([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),sg.computeBoundingSphere(),wr.call(this,sg,new Er({color:ig}));var pg=new ve;pg.addAttribute('position',new fe([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),pg.computeBoundingSphere(),this.add(new Ce(pg,new Ae({color:ig,opacity:0.2,transparent:!0,depthWrite:!1})))}function yn(rg,ag,og,ig,ng,sg){ee.call(this),void 0===rg&&(rg=new THREE.Vector3(0,0,1)),void 0===ag&&(ag=new THREE.Vector3(0,0,0)),void 0===og&&(og=1),void 0===ig&&(ig=16776960),void 0===ng&&(ng=0.2*og),void 0===sg&&(sg=0.2*ng),void 0===zm&&(zm=new ve,zm.addAttribute('position',new fe([0,0,0,0,1,0],3)),Dm=new Xa(0,0.5,1,5,1),Dm.translate(0,-0.5,0)),this.position.copy(ag),this.line=new wr(zm,new Er({color:ig})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ce(Dm,new Ae({color:ig})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(rg),this.setLength(og,ng,sg)}function xn(rg){rg=rg||1;var ag=[0,0,0,rg,0,0,0,0,0,0,rg,0,0,0,0,0,0,rg],ig=new ve;ig.addAttribute('position',new fe(ag,3)),ig.addAttribute('color',new fe([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3));var ng=new Er({vertexColors:jn});Lr.call(this,ig,ng)}function vn(rg){console.warn('THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.'),Oo.call(this,rg),this.type='catmullrom'}function _n(){ku=document.getElementById('centerdiv'),Wu=document.createElement('img'),Wu.setAttribute('src','../images/retry1.svg'),Wu.setAttribute('id','restartButton'),Wu.setAttribute('class','svg'),ju=document.getElementById('centerdiv'),qu=document.createElement('img'),qu.setAttribute('src','../images/play.svg'),qu.setAttribute('id','playButton'),qu.setAttribute('class','svg'),Yu=document.getElementById('topright'),Xu=document.createElement('img'),Xu.setAttribute('src','../images/pause.svg'),Xu.setAttribute('id','pauseButton'),Xu.setAttribute('class','svg inTopRight'),Zu=document.getElementById('bottomright'),Ju=document.createElement('img'),Ju.setAttribute('src','../images/info.svg'),Ju.setAttribute('id','infoButton'),Ju.setAttribute('class','svg inBottomRight'),Qu=document.createElement('img'),Qu.setAttribute('src','../images/sound.svg'),Qu.setAttribute('id','muteButton'),Qu.setAttribute('class','svg inTopRight'),Ku=document.createElement('img'),Ku.setAttribute('src','../images/mute.svg'),Ku.setAttribute('id','soundButton'),Ku.setAttribute('class','svg inTopRight'),$u=document.getElementById('topright')}function bn(){var rg=new XMLHttpRequest;rg.onreadystatechange=function(){4==this.readyState&&200==this.status&&(document.getElementById('highscores').innerHTML=this.responseText)},rg.open('GET','../server_side/getHighscore.php',!0),rg.send()}function Mn(){$(function(){$('img.svg').each(function(){var rg=$(this),ag=rg.attr('id'),og=rg.attr('class'),ig=rg.attr('src');$.get(ig,function(ng){var sg=$(ng).find('svg');'undefined'!=typeof ag&&(sg=sg.attr('id',ag)),'undefined'!=typeof og&&(sg=sg.attr('class',og+' replaced-svg')),sg=sg.removeAttr('xmlns:a'),rg.replaceWith(sg),'playButton'==ag?sg.click(function(){Tn(Fu),Ou.started=!0,tg.play()}):'pauseButton'==ag?sg.click(function(){In()}):'restartButton'==ag?sg.click(function(){window.location.reload()}):'soundButton'==ag||'muteButton'==ag?sg.click(function(){Pn()}):'infoButton'==ag&&sg.click(function(){'/desktop/game.php'==document.location.pathname?window.location.replace('credits.php'):window.location.replace('credits_mobile.php')})},'xml')})})}function Tn(rg){rg==Hu?(console.log('PAUSE'),wn()):rg==Fu?(console.log('PLAY'),En()):rg==Vu&&(console.log('DEAD'),Ln())}function En(){void 0!=document.getElementById('infoButton')&&(Ju=document.getElementById('infoButton'),Zu=Ju.parentNode,Zu.removeChild(Ju)),void 0!=document.getElementById('playButton')&&(qu=document.getElementById('playButton'),ju=qu.parentNode,ju.removeChild(qu)),void 0==document.getElementById('pauseButton')&&(Yu.appendChild(Xu),'true'==eg?(void 0!=document.getElementById('muteButton')&&Yu.removeChild(document.getElementById('muteButton')),void 0==document.getElementById('soundButton')&&Yu.appendChild(Qu)):(void 0!=document.getElementById('soundButton')&&Yu.removeChild(document.getElementById('soundButton')),void 0==document.getElementById('muteButton')&&Yu.appendChild(Ku))),void 0!=document.getElementById('restartButton')&&(Wu=document.getElementById('restartButton'),ku=Wu.parentNode,ku.removeChild(document.getElementById('restartButton'))),void 0!=document.getElementById('infoButton')&&(Ju=document.getElementById('infoButton'),Zu=Ju.parentNode,Zu.removeChild(Ju)),Mn()}function wn(){void 0==document.getElementById('playButton')&&ju.appendChild(qu),void 0!=document.getElementById('pauseButton')&&(Xu=document.getElementById('pauseButton'),Yu=Xu.parentNode,Yu.removeChild(Xu)),void 0!=document.getElementById('restartButton')&&(Wu=document.getElementById('restartButton'),ku=Wu.parentNode,ku.removeChild(document.getElementById('restartButton'))),void 0!=document.getElementById('infoButton')&&(Ju=document.getElementById('infoButton'),Zu=Ju.parentNode,Zu.removeChild(Ju)),Mn()}function Ln(){void 0==document.getElementById('infoButton')&&Zu.appendChild(Ju),void 0!=document.getElementById('playButton')&&(qu=document.getElementById('playButton'),ju=qu.parentNode,ju.removeChild(qu)),void 0!=document.getElementById('pauseButton')&&(Xu=document.getElementById('pauseButton'),Yu=Xu.parentNode,Yu.removeChild(Xu)),void 0==document.getElementById('restartButton')&&ku.appendChild(Wu),Mn()}function Pn(){if(console.log(eg),'true'==eg){console.log('\xE8 attivo');let rg=document.getElementById('muteButton');void 0!=rg&&$u.removeChild(rg);let ag=document.getElementById('soundButton');void 0==ag&&$u.appendChild(Ku),eg='false',sessionStorage.setItem('isSoundActive','false')}else{console.log('non \xE8 attivo');let rg=document.getElementById('soundButton');void 0!=rg&&$u.removeChild(rg);let ag=document.getElementById('muteButton');void 0==ag&&$u.appendChild(Qu),eg='true',sessionStorage.setItem('isSoundActive','true')}Cn(),console.log(eg),Mn()}function An(){tg=document.getElementById('gameMusic')}function Cn(){tg.muted='true'!=eg}function Rn(){An(),Cn(),tg.play()}function In(){Tn(Hu),Ou.started=!1,tg.pause()}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(rg){return'number'==typeof rg&&isFinite(rg)&&Math.floor(rg)===rg}),void 0===Math.sign&&(Math.sign=function(rg){return 0>rg?-1:0<rg?1:+rg}),!1=='name'in Function.prototype&&Object.defineProperty(Function.prototype,'name',{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(rg){if(void 0===rg||null===rg)throw new TypeError('Cannot convert undefined or null to object');for(var ag=Object(rg),og=1,ig;og<arguments.length;og++)if(ig=arguments[og],void 0!==ig&&null!==ig)for(var ng in ig)Object.prototype.hasOwnProperty.call(ig,ng)&&(ag[ng]=ig[ng]);return ag}}(),Object.assign(M.prototype,{addEventListener:function(rg,ag){void 0===this._listeners&&(this._listeners={});var og=this._listeners;void 0===og[rg]&&(og[rg]=[]),-1===og[rg].indexOf(ag)&&og[rg].push(ag)},hasEventListener:function(rg,ag){if(void 0===this._listeners)return!1;var og=this._listeners;return void 0!==og[rg]&&-1!==og[rg].indexOf(ag)},removeEventListener:function(rg,ag){if(void 0!==this._listeners){var og=this._listeners,ig=og[rg];if(void 0!==ig){var ng=ig.indexOf(ag);-1!==ng&&ig.splice(ng,1)}}},dispatchEvent:function(rg){if(void 0!==this._listeners){var ag=this._listeners,og=ag[rg.type];if(void 0!==og){rg.target=this;for(var ig=og.slice(0),ng=0,sg=ig.length;ng<sg;ng++)ig[ng].call(this,rg)}}}});var Bn=1,Un=1,On=0,Fn=1,Hn=2,Vn=1,kn=0,Wn=1,jn=2,qn=0,Yn=1,Xn=2,Zn=3,Jn=4,Qn=5,Kn=100,ts=103,rs=104,ss=204,ls=205,xs=3,Ts=0,Ls=0,Ps=1,Is=300,zs=301,Ds=302,Bs=303,Ns=304,Us=305,Gs=306,Os=307,Fs=1e3,Hs=1001,Vs=1002,ks=1003,Ws=1004,js=1005,qs=1006,Ys=1007,Xs=1008,Zs=1009,Ks=1012,el=1014,rl=1015,al=1016,cl=1020,yl=1022,xl=1023,Sl=1026,Ml=1027,El=33776,wl=33777,Ll=33778,Pl=33779,Al=35840,Cl=35841,Rl=35842,Il=35843,$l=2300,ep=2301,tp=2302,rp=2400,ap=2401,op=2402,ip=0,lp=3e3,cp=3007,vp=0,Sp={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var rg=[],ag=0;256>ag;ag++)rg[ag]=(16>ag?'0':'')+ag.toString(16);return function(){var ig=0|4294967295*Math.random(),ng=0|4294967295*Math.random(),sg=0|4294967295*Math.random(),lg=0|4294967295*Math.random(),pg=rg[255&ig]+rg[255&ig>>8]+rg[255&ig>>16]+rg[255&ig>>24]+'-'+rg[255&ng]+rg[255&ng>>8]+'-'+rg[64|15&ng>>16]+rg[255&ng>>24]+'-'+rg[128|63&sg]+rg[255&sg>>8]+'-'+rg[255&sg>>16]+rg[255&sg>>24]+rg[255&lg]+rg[255&lg>>8]+rg[255&lg>>16]+rg[255&lg>>24];return pg.toUpperCase()}}(),clamp:function(rg,ag,og){return Math.max(ag,Math.min(og,rg))},euclideanModulo:function(rg,ag){return(rg%ag+ag)%ag},mapLinear:function(rg,ag,og,ig,ng){return ig+(rg-ag)*(ng-ig)/(og-ag)},lerp:function(rg,ag,og){return(1-og)*rg+og*ag},smoothstep:function(rg,ag,og){return rg<=ag?0:rg>=og?1:(rg=(rg-ag)/(og-ag),rg*rg*(3-2*rg))},smootherstep:function(rg,ag,og){return rg<=ag?0:rg>=og?1:(rg=(rg-ag)/(og-ag),rg*rg*rg*(rg*(6*rg-15)+10))},randInt:function(rg,ag){return rg+Math.floor(Math.random()*(ag-rg+1))},randFloat:function(rg,ag){return rg+Math.random()*(ag-rg)},randFloatSpread:function(rg){return rg*(0.5-Math.random())},degToRad:function(rg){return rg*Sp.DEG2RAD},radToDeg:function(rg){return rg*Sp.RAD2DEG},isPowerOfTwo:function(rg){return 0==(rg&rg-1)&&0!==rg},ceilPowerOfTwo:function(rg){return Math.pow(2,Math.ceil(Math.log(rg)/Math.LN2))},floorPowerOfTwo:function(rg){return Math.pow(2,Math.floor(Math.log(rg)/Math.LN2))}};Object.defineProperties(E.prototype,{width:{get:function(){return this.x},set:function(rg){this.x=rg}},height:{get:function(){return this.y},set:function(rg){this.y=rg}}}),Object.assign(E.prototype,{isVector2:!0,set:function(rg,ag){return this.x=rg,this.y=ag,this},setScalar:function(rg){return this.x=rg,this.y=rg,this},setX:function(rg){return this.x=rg,this},setY:function(rg){return this.y=rg,this},setComponent:function(rg,ag){switch(rg){case 0:this.x=ag;break;case 1:this.y=ag;break;default:throw new Error('index is out of range: '+rg);}return this},getComponent:function(rg){switch(rg){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+rg);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(rg){return this.x=rg.x,this.y=rg.y,this},add:function(rg,ag){return void 0===ag?(this.x+=rg.x,this.y+=rg.y,this):(console.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(rg,ag))},addScalar:function(rg){return this.x+=rg,this.y+=rg,this},addVectors:function(rg,ag){return this.x=rg.x+ag.x,this.y=rg.y+ag.y,this},addScaledVector:function(rg,ag){return this.x+=rg.x*ag,this.y+=rg.y*ag,this},sub:function(rg,ag){return void 0===ag?(this.x-=rg.x,this.y-=rg.y,this):(console.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(rg,ag))},subScalar:function(rg){return this.x-=rg,this.y-=rg,this},subVectors:function(rg,ag){return this.x=rg.x-ag.x,this.y=rg.y-ag.y,this},multiply:function(rg){return this.x*=rg.x,this.y*=rg.y,this},multiplyScalar:function(rg){return this.x*=rg,this.y*=rg,this},divide:function(rg){return this.x/=rg.x,this.y/=rg.y,this},divideScalar:function(rg){return this.multiplyScalar(1/rg)},applyMatrix3:function(rg){var ag=this.x,og=this.y,ig=rg.elements;return this.x=ig[0]*ag+ig[3]*og+ig[6],this.y=ig[1]*ag+ig[4]*og+ig[7],this},min:function(rg){return this.x=Math.min(this.x,rg.x),this.y=Math.min(this.y,rg.y),this},max:function(rg){return this.x=Math.max(this.x,rg.x),this.y=Math.max(this.y,rg.y),this},clamp:function(rg,ag){return this.x=Math.max(rg.x,Math.min(ag.x,this.x)),this.y=Math.max(rg.y,Math.min(ag.y,this.y)),this},clampScalar:function(){var rg=new E,ag=new E;return function(ig,ng){return rg.set(ig,ig),ag.set(ng,ng),this.clamp(rg,ag)}}(),clampLength:function(rg,ag){var og=this.length();return this.divideScalar(og||1).multiplyScalar(Math.max(rg,Math.min(ag,og)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(rg){return this.x*rg.x+this.y*rg.y},cross:function(rg){return this.x*rg.y-this.y*rg.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var rg=Math.atan2(this.y,this.x);return 0>rg&&(rg+=2*Math.PI),rg},distanceTo:function(rg){return Math.sqrt(this.distanceToSquared(rg))},distanceToSquared:function(rg){var ag=this.x-rg.x,og=this.y-rg.y;return ag*ag+og*og},manhattanDistanceTo:function(rg){return Math.abs(this.x-rg.x)+Math.abs(this.y-rg.y)},setLength:function(rg){return this.normalize().multiplyScalar(rg)},lerp:function(rg,ag){return this.x+=(rg.x-this.x)*ag,this.y+=(rg.y-this.y)*ag,this},lerpVectors:function(rg,ag,og){return this.subVectors(ag,rg).multiplyScalar(og).add(rg)},equals:function(rg){return rg.x===this.x&&rg.y===this.y},fromArray:function(rg,ag){return void 0===ag&&(ag=0),this.x=rg[ag],this.y=rg[ag+1],this},toArray:function(rg,ag){return void 0===rg&&(rg=[]),void 0===ag&&(ag=0),rg[ag]=this.x,rg[ag+1]=this.y,rg},fromBufferAttribute:function(rg,ag,og){return void 0!==og&&console.warn('THREE.Vector2: offset has been removed from .fromBufferAttribute().'),this.x=rg.getX(ag),this.y=rg.getY(ag),this},rotateAround:function(rg,ag){var og=Math.cos(ag),ig=Math.sin(ag),ng=this.x-rg.x,sg=this.y-rg.y;return this.x=ng*og-sg*ig+rg.x,this.y=ng*ig+sg*og+rg.y,this}}),Object.assign(L.prototype,{isMatrix4:!0,set:function(rg,ag,og,ig,ng,sg,lg,pg,dg,cg,mg,ug,gg,fg,hg,yg){var xg=this.elements;return xg[0]=rg,xg[4]=ag,xg[8]=og,xg[12]=ig,xg[1]=ng,xg[5]=sg,xg[9]=lg,xg[13]=pg,xg[2]=dg,xg[6]=cg,xg[10]=mg,xg[14]=ug,xg[3]=gg,xg[7]=fg,xg[11]=hg,xg[15]=yg,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new L().fromArray(this.elements)},copy:function(rg){var ag=this.elements,og=rg.elements;return ag[0]=og[0],ag[1]=og[1],ag[2]=og[2],ag[3]=og[3],ag[4]=og[4],ag[5]=og[5],ag[6]=og[6],ag[7]=og[7],ag[8]=og[8],ag[9]=og[9],ag[10]=og[10],ag[11]=og[11],ag[12]=og[12],ag[13]=og[13],ag[14]=og[14],ag[15]=og[15],this},copyPosition:function(rg){var ag=this.elements,og=rg.elements;return ag[12]=og[12],ag[13]=og[13],ag[14]=og[14],this},extractBasis:function(rg,ag,og){return rg.setFromMatrixColumn(this,0),ag.setFromMatrixColumn(this,1),og.setFromMatrixColumn(this,2),this},makeBasis:function(rg,ag,og){return this.set(rg.x,ag.x,og.x,0,rg.y,ag.y,og.y,0,rg.z,ag.z,og.z,0,0,0,0,1),this},extractRotation:function(){var rg=new C;return function(og){var ig=this.elements,ng=og.elements,sg=1/rg.setFromMatrixColumn(og,0).length(),lg=1/rg.setFromMatrixColumn(og,1).length(),pg=1/rg.setFromMatrixColumn(og,2).length();return ig[0]=ng[0]*sg,ig[1]=ng[1]*sg,ig[2]=ng[2]*sg,ig[3]=0,ig[4]=ng[4]*lg,ig[5]=ng[5]*lg,ig[6]=ng[6]*lg,ig[7]=0,ig[8]=ng[8]*pg,ig[9]=ng[9]*pg,ig[10]=ng[10]*pg,ig[11]=0,ig[12]=0,ig[13]=0,ig[14]=0,ig[15]=1,this}}(),makeRotationFromEuler:function(rg){rg&&rg.isEuler||console.error('THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');var ag=this.elements,og=rg.x,ig=rg.y,ng=rg.z,sg=Math.cos(og),lg=Math.sin(og),pg=Math.cos(ig),dg=Math.sin(ig),cg=Math.cos(ng),mg=Math.sin(ng);if('XYZ'===rg.order){var ug=sg*cg,gg=sg*mg,fg=lg*cg,hg=lg*mg;ag[0]=pg*cg,ag[4]=-pg*mg,ag[8]=dg,ag[1]=gg+fg*dg,ag[5]=ug-hg*dg,ag[9]=-lg*pg,ag[2]=hg-ug*dg,ag[6]=fg+gg*dg,ag[10]=sg*pg}else if('YXZ'===rg.order){var yg=pg*cg,xg=pg*mg,vg=dg*cg,_g=dg*mg;ag[0]=yg+_g*lg,ag[4]=vg*lg-xg,ag[8]=sg*dg,ag[1]=sg*mg,ag[5]=sg*cg,ag[9]=-lg,ag[2]=xg*lg-vg,ag[6]=_g+yg*lg,ag[10]=sg*pg}else if('ZXY'===rg.order){var yg=pg*cg,xg=pg*mg,vg=dg*cg,_g=dg*mg;ag[0]=yg-_g*lg,ag[4]=-sg*mg,ag[8]=vg+xg*lg,ag[1]=xg+vg*lg,ag[5]=sg*cg,ag[9]=_g-yg*lg,ag[2]=-sg*dg,ag[6]=lg,ag[10]=sg*pg}else if('ZYX'===rg.order){var ug=sg*cg,gg=sg*mg,fg=lg*cg,hg=lg*mg;ag[0]=pg*cg,ag[4]=fg*dg-gg,ag[8]=ug*dg+hg,ag[1]=pg*mg,ag[5]=hg*dg+ug,ag[9]=gg*dg-fg,ag[2]=-dg,ag[6]=lg*pg,ag[10]=sg*pg}else if('YZX'===rg.order){var bg=sg*pg,Sg=sg*dg,Mg=lg*pg,Tg=lg*dg;ag[0]=pg*cg,ag[4]=Tg-bg*mg,ag[8]=Mg*mg+Sg,ag[1]=mg,ag[5]=sg*cg,ag[9]=-lg*cg,ag[2]=-dg*cg,ag[6]=Sg*mg+Mg,ag[10]=bg-Tg*mg}else if('XZY'===rg.order){var bg=sg*pg,Sg=sg*dg,Mg=lg*pg,Tg=lg*dg;ag[0]=pg*cg,ag[4]=-mg,ag[8]=dg*cg,ag[1]=bg*mg+Tg,ag[5]=sg*cg,ag[9]=Sg*mg-Mg,ag[2]=Mg*mg-Sg,ag[6]=lg*cg,ag[10]=Tg*mg+bg}return ag[3]=0,ag[7]=0,ag[11]=0,ag[12]=0,ag[13]=0,ag[14]=0,ag[15]=1,this},makeRotationFromQuaternion:function(){var rg=new C(0,0,0),ag=new C(1,1,1);return function(ig){return this.compose(rg,ig,ag)}}(),lookAt:function(){var rg=new C,ag=new C,og=new C;return function(ng,sg,lg){var pg=this.elements;return og.subVectors(ng,sg),0===og.lengthSq()&&(og.z=1),og.normalize(),rg.crossVectors(lg,og),0===rg.lengthSq()&&(1===Math.abs(lg.z)?og.x+=1e-4:og.z+=1e-4,og.normalize(),rg.crossVectors(lg,og)),rg.normalize(),ag.crossVectors(og,rg),pg[0]=rg.x,pg[4]=ag.x,pg[8]=og.x,pg[1]=rg.y,pg[5]=ag.y,pg[9]=og.y,pg[2]=rg.z,pg[6]=ag.z,pg[10]=og.z,this}}(),multiply:function(rg,ag){return void 0===ag?this.multiplyMatrices(this,rg):(console.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.'),this.multiplyMatrices(rg,ag))},premultiply:function(rg){return this.multiplyMatrices(rg,this)},multiplyMatrices:function(rg,ag){var og=rg.elements,ig=ag.elements,ng=this.elements,sg=og[0],lg=og[4],pg=og[8],dg=og[12],cg=og[1],mg=og[5],ug=og[9],gg=og[13],fg=og[2],hg=og[6],yg=og[10],xg=og[14],vg=og[3],_g=og[7],bg=og[11],Sg=og[15],Mg=ig[0],Tg=ig[4],Eg=ig[8],wg=ig[12],Lg=ig[1],Pg=ig[5],Ag=ig[9],Cg=ig[13],Rg=ig[2],Ig=ig[6],zg=ig[10],Dg=ig[14],Bg=ig[3],Ng=ig[7],Ug=ig[11],Gg=ig[15];return ng[0]=sg*Mg+lg*Lg+pg*Rg+dg*Bg,ng[4]=sg*Tg+lg*Pg+pg*Ig+dg*Ng,ng[8]=sg*Eg+lg*Ag+pg*zg+dg*Ug,ng[12]=sg*wg+lg*Cg+pg*Dg+dg*Gg,ng[1]=cg*Mg+mg*Lg+ug*Rg+gg*Bg,ng[5]=cg*Tg+mg*Pg+ug*Ig+gg*Ng,ng[9]=cg*Eg+mg*Ag+ug*zg+gg*Ug,ng[13]=cg*wg+mg*Cg+ug*Dg+gg*Gg,ng[2]=fg*Mg+hg*Lg+yg*Rg+xg*Bg,ng[6]=fg*Tg+hg*Pg+yg*Ig+xg*Ng,ng[10]=fg*Eg+hg*Ag+yg*zg+xg*Ug,ng[14]=fg*wg+hg*Cg+yg*Dg+xg*Gg,ng[3]=vg*Mg+_g*Lg+bg*Rg+Sg*Bg,ng[7]=vg*Tg+_g*Pg+bg*Ig+Sg*Ng,ng[11]=vg*Eg+_g*Ag+bg*zg+Sg*Ug,ng[15]=vg*wg+_g*Cg+bg*Dg+Sg*Gg,this},multiplyScalar:function(rg){var ag=this.elements;return ag[0]*=rg,ag[4]*=rg,ag[8]*=rg,ag[12]*=rg,ag[1]*=rg,ag[5]*=rg,ag[9]*=rg,ag[13]*=rg,ag[2]*=rg,ag[6]*=rg,ag[10]*=rg,ag[14]*=rg,ag[3]*=rg,ag[7]*=rg,ag[11]*=rg,ag[15]*=rg,this},applyToBufferAttribute:function(){var rg=new C;return function(og){for(var ig=0,ng=og.count;ig<ng;ig++)rg.x=og.getX(ig),rg.y=og.getY(ig),rg.z=og.getZ(ig),rg.applyMatrix4(this),og.setXYZ(ig,rg.x,rg.y,rg.z);return og}}(),determinant:function(){var rg=this.elements,ag=rg[0],og=rg[4],ig=rg[8],ng=rg[12],sg=rg[1],lg=rg[5],pg=rg[9],dg=rg[13],cg=rg[2],mg=rg[6],ug=rg[10],gg=rg[14],fg=rg[3],hg=rg[7],yg=rg[11],xg=rg[15];return fg*(+ng*pg*mg-ig*dg*mg-ng*lg*ug+og*dg*ug+ig*lg*gg-og*pg*gg)+hg*(+ag*pg*gg-ag*dg*ug+ng*sg*ug-ig*sg*gg+ig*dg*cg-ng*pg*cg)+yg*(+ag*dg*mg-ag*lg*gg-ng*sg*mg+og*sg*gg+ng*lg*cg-og*dg*cg)+xg*(-ig*lg*cg-ag*pg*mg+ag*lg*ug+ig*sg*mg-og*sg*ug+og*pg*cg)},transpose:function(){var rg=this.elements,ag;return ag=rg[1],rg[1]=rg[4],rg[4]=ag,ag=rg[2],rg[2]=rg[8],rg[8]=ag,ag=rg[6],rg[6]=rg[9],rg[9]=ag,ag=rg[3],rg[3]=rg[12],rg[12]=ag,ag=rg[7],rg[7]=rg[13],rg[13]=ag,ag=rg[11],rg[11]=rg[14],rg[14]=ag,this},setPosition:function(rg){var ag=this.elements;return ag[12]=rg.x,ag[13]=rg.y,ag[14]=rg.z,this},getInverse:function(rg,ag){var og=this.elements,ig=rg.elements,ng=ig[0],sg=ig[1],lg=ig[2],pg=ig[3],dg=ig[4],cg=ig[5],mg=ig[6],ug=ig[7],gg=ig[8],fg=ig[9],hg=ig[10],yg=ig[11],xg=ig[12],vg=ig[13],_g=ig[14],bg=ig[15],Sg=fg*_g*ug-vg*hg*ug+vg*mg*yg-cg*_g*yg-fg*mg*bg+cg*hg*bg,Mg=xg*hg*ug-gg*_g*ug-xg*mg*yg+dg*_g*yg+gg*mg*bg-dg*hg*bg,Tg=gg*vg*ug-xg*fg*ug+xg*cg*yg-dg*vg*yg-gg*cg*bg+dg*fg*bg,Eg=xg*fg*mg-gg*vg*mg-xg*cg*hg+dg*vg*hg+gg*cg*_g-dg*fg*_g,wg=ng*Sg+sg*Mg+lg*Tg+pg*Eg;if(0==wg){var Lg='THREE.Matrix4: .getInverse() can\'t invert matrix, determinant is 0';if(!0===ag)throw new Error(Lg);else console.warn(Lg);return this.identity()}var Pg=1/wg;return og[0]=Sg*Pg,og[1]=(vg*hg*pg-fg*_g*pg-vg*lg*yg+sg*_g*yg+fg*lg*bg-sg*hg*bg)*Pg,og[2]=(cg*_g*pg-vg*mg*pg+vg*lg*ug-sg*_g*ug-cg*lg*bg+sg*mg*bg)*Pg,og[3]=(fg*mg*pg-cg*hg*pg-fg*lg*ug+sg*hg*ug+cg*lg*yg-sg*mg*yg)*Pg,og[4]=Mg*Pg,og[5]=(gg*_g*pg-xg*hg*pg+xg*lg*yg-ng*_g*yg-gg*lg*bg+ng*hg*bg)*Pg,og[6]=(xg*mg*pg-dg*_g*pg-xg*lg*ug+ng*_g*ug+dg*lg*bg-ng*mg*bg)*Pg,og[7]=(dg*hg*pg-gg*mg*pg+gg*lg*ug-ng*hg*ug-dg*lg*yg+ng*mg*yg)*Pg,og[8]=Tg*Pg,og[9]=(xg*fg*pg-gg*vg*pg-xg*sg*yg+ng*vg*yg+gg*sg*bg-ng*fg*bg)*Pg,og[10]=(dg*vg*pg-xg*cg*pg+xg*sg*ug-ng*vg*ug-dg*sg*bg+ng*cg*bg)*Pg,og[11]=(gg*cg*pg-dg*fg*pg-gg*sg*ug+ng*fg*ug+dg*sg*yg-ng*cg*yg)*Pg,og[12]=Eg*Pg,og[13]=(gg*vg*lg-xg*fg*lg+xg*sg*hg-ng*vg*hg-gg*sg*_g+ng*fg*_g)*Pg,og[14]=(xg*cg*lg-dg*vg*lg-xg*sg*mg+ng*vg*mg+dg*sg*_g-ng*cg*_g)*Pg,og[15]=(dg*fg*lg-gg*cg*lg+gg*sg*mg-ng*fg*mg-dg*sg*hg+ng*cg*hg)*Pg,this},scale:function(rg){var ag=this.elements,og=rg.x,ig=rg.y,ng=rg.z;return ag[0]*=og,ag[4]*=ig,ag[8]*=ng,ag[1]*=og,ag[5]*=ig,ag[9]*=ng,ag[2]*=og,ag[6]*=ig,ag[10]*=ng,ag[3]*=og,ag[7]*=ig,ag[11]*=ng,this},getMaxScaleOnAxis:function(){var rg=this.elements,ag=rg[0]*rg[0]+rg[1]*rg[1]+rg[2]*rg[2],og=rg[4]*rg[4]+rg[5]*rg[5]+rg[6]*rg[6],ig=rg[8]*rg[8]+rg[9]*rg[9]+rg[10]*rg[10];return Math.sqrt(Math.max(ag,og,ig))},makeTranslation:function(rg,ag,og){return this.set(1,0,0,rg,0,1,0,ag,0,0,1,og,0,0,0,1),this},makeRotationX:function(rg){var ag=Math.cos(rg),og=Math.sin(rg);return this.set(1,0,0,0,0,ag,-og,0,0,og,ag,0,0,0,0,1),this},makeRotationY:function(rg){var ag=Math.cos(rg),og=Math.sin(rg);return this.set(ag,0,og,0,0,1,0,0,-og,0,ag,0,0,0,0,1),this},makeRotationZ:function(rg){var ag=Math.cos(rg),og=Math.sin(rg);return this.set(ag,-og,0,0,og,ag,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(rg,ag){var og=Math.cos(ag),ig=Math.sin(ag),ng=1-og,sg=rg.x,lg=rg.y,pg=rg.z,dg=ng*sg,cg=ng*lg;return this.set(dg*sg+og,dg*lg-ig*pg,dg*pg+ig*lg,0,dg*lg+ig*pg,cg*lg+og,cg*pg-ig*sg,0,dg*pg-ig*lg,cg*pg+ig*sg,ng*pg*pg+og,0,0,0,0,1),this},makeScale:function(rg,ag,og){return this.set(rg,0,0,0,0,ag,0,0,0,0,og,0,0,0,0,1),this},makeShear:function(rg,ag,og){return this.set(1,ag,og,0,rg,1,og,0,rg,ag,1,0,0,0,0,1),this},compose:function(rg,ag,og){var ig=this.elements,ng=ag._x,sg=ag._y,lg=ag._z,pg=ag._w,dg=ng+ng,cg=sg+sg,mg=lg+lg,ug=ng*dg,gg=ng*cg,fg=ng*mg,hg=sg*cg,yg=sg*mg,xg=lg*mg,vg=pg*dg,_g=pg*cg,bg=pg*mg,Sg=og.x,Mg=og.y,Tg=og.z;return ig[0]=(1-(hg+xg))*Sg,ig[1]=(gg+bg)*Sg,ig[2]=(fg-_g)*Sg,ig[3]=0,ig[4]=(gg-bg)*Mg,ig[5]=(1-(ug+xg))*Mg,ig[6]=(yg+vg)*Mg,ig[7]=0,ig[8]=(fg+_g)*Tg,ig[9]=(yg-vg)*Tg,ig[10]=(1-(ug+hg))*Tg,ig[11]=0,ig[12]=rg.x,ig[13]=rg.y,ig[14]=rg.z,ig[15]=1,this},decompose:function(){var rg=new C,ag=new L;return function(ig,ng,sg){var lg=this.elements,pg=rg.set(lg[0],lg[1],lg[2]).length(),dg=rg.set(lg[4],lg[5],lg[6]).length(),cg=rg.set(lg[8],lg[9],lg[10]).length(),mg=this.determinant();0>mg&&(pg=-pg),ig.x=lg[12],ig.y=lg[13],ig.z=lg[14],ag.copy(this);var ug=1/pg,gg=1/dg,fg=1/cg;return ag.elements[0]*=ug,ag.elements[1]*=ug,ag.elements[2]*=ug,ag.elements[4]*=gg,ag.elements[5]*=gg,ag.elements[6]*=gg,ag.elements[8]*=fg,ag.elements[9]*=fg,ag.elements[10]*=fg,ng.setFromRotationMatrix(ag),sg.x=pg,sg.y=dg,sg.z=cg,this}}(),makePerspective:function(rg,ag,og,ig,ng,sg){void 0===sg&&console.warn('THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.');var lg=this.elements;return lg[0]=2*ng/(ag-rg),lg[4]=0,lg[8]=(ag+rg)/(ag-rg),lg[12]=0,lg[1]=0,lg[5]=2*ng/(og-ig),lg[9]=(og+ig)/(og-ig),lg[13]=0,lg[2]=0,lg[6]=0,lg[10]=-(sg+ng)/(sg-ng),lg[14]=-2*sg*ng/(sg-ng),lg[3]=0,lg[7]=0,lg[11]=-1,lg[15]=0,this},makeOrthographic:function(rg,ag,og,ig,ng,sg){var lg=this.elements,pg=1/(ag-rg),dg=1/(og-ig),cg=1/(sg-ng);return lg[0]=2*pg,lg[4]=0,lg[8]=0,lg[12]=-((ag+rg)*pg),lg[1]=0,lg[5]=2*dg,lg[9]=0,lg[13]=-((og+ig)*dg),lg[2]=0,lg[6]=0,lg[10]=-2*cg,lg[14]=-((sg+ng)*cg),lg[3]=0,lg[7]=0,lg[11]=0,lg[15]=1,this},equals:function(rg){for(var ag=this.elements,og=rg.elements,ig=0;16>ig;ig++)if(ag[ig]!==og[ig])return!1;return!0},fromArray:function(rg,ag){void 0===ag&&(ag=0);for(var og=0;16>og;og++)this.elements[og]=rg[og+ag];return this},toArray:function(rg,ag){void 0===rg&&(rg=[]),void 0===ag&&(ag=0);var og=this.elements;return rg[ag]=og[0],rg[ag+1]=og[1],rg[ag+2]=og[2],rg[ag+3]=og[3],rg[ag+4]=og[4],rg[ag+5]=og[5],rg[ag+6]=og[6],rg[ag+7]=og[7],rg[ag+8]=og[8],rg[ag+9]=og[9],rg[ag+10]=og[10],rg[ag+11]=og[11],rg[ag+12]=og[12],rg[ag+13]=og[13],rg[ag+14]=og[14],rg[ag+15]=og[15],rg}}),Object.assign(A,{slerp:function(rg,ag,og,ig){return og.copy(rg).slerp(ag,ig)},slerpFlat:function(rg,ag,og,ig,ng,sg,lg){var pg=og[ig+0],dg=og[ig+1],cg=og[ig+2],mg=og[ig+3],ug=ng[sg+0],gg=ng[sg+1],fg=ng[sg+2],hg=ng[sg+3];if(mg!==hg||pg!==ug||dg!==gg||cg!==fg){var yg=1-lg,xg=pg*ug+dg*gg+cg*fg+mg*hg,vg=0<=xg?1:-1,_g=1-xg*xg;if(_g>Number.EPSILON){var bg=Math.sqrt(_g),Sg=Math.atan2(bg,xg*vg);yg=Math.sin(yg*Sg)/bg,lg=Math.sin(lg*Sg)/bg}var Mg=lg*vg;if(pg=pg*yg+ug*Mg,dg=dg*yg+gg*Mg,cg=cg*yg+fg*Mg,mg=mg*yg+hg*Mg,yg==1-lg){var Tg=1/Math.sqrt(pg*pg+dg*dg+cg*cg+mg*mg);pg*=Tg,dg*=Tg,cg*=Tg,mg*=Tg}}rg[ag]=pg,rg[ag+1]=dg,rg[ag+2]=cg,rg[ag+3]=mg}}),Object.defineProperties(A.prototype,{x:{get:function(){return this._x},set:function(rg){this._x=rg,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(rg){this._y=rg,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(rg){this._z=rg,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(rg){this._w=rg,this.onChangeCallback()}}}),Object.assign(A.prototype,{isQuaternion:!0,set:function(rg,ag,og,ig){return this._x=rg,this._y=ag,this._z=og,this._w=ig,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(rg){return this._x=rg.x,this._y=rg.y,this._z=rg.z,this._w=rg.w,this.onChangeCallback(),this},setFromEuler:function(rg,ag){if(!(rg&&rg.isEuler))throw new Error('THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');var og=rg._x,ig=rg._y,ng=rg._z,sg=rg.order,lg=Math.cos,pg=Math.sin,dg=lg(og/2),cg=lg(ig/2),mg=lg(ng/2),ug=pg(og/2),gg=pg(ig/2),fg=pg(ng/2);return'XYZ'===sg?(this._x=ug*cg*mg+dg*gg*fg,this._y=dg*gg*mg-ug*cg*fg,this._z=dg*cg*fg+ug*gg*mg,this._w=dg*cg*mg-ug*gg*fg):'YXZ'===sg?(this._x=ug*cg*mg+dg*gg*fg,this._y=dg*gg*mg-ug*cg*fg,this._z=dg*cg*fg-ug*gg*mg,this._w=dg*cg*mg+ug*gg*fg):'ZXY'===sg?(this._x=ug*cg*mg-dg*gg*fg,this._y=dg*gg*mg+ug*cg*fg,this._z=dg*cg*fg+ug*gg*mg,this._w=dg*cg*mg-ug*gg*fg):'ZYX'===sg?(this._x=ug*cg*mg-dg*gg*fg,this._y=dg*gg*mg+ug*cg*fg,this._z=dg*cg*fg-ug*gg*mg,this._w=dg*cg*mg+ug*gg*fg):'YZX'===sg?(this._x=ug*cg*mg+dg*gg*fg,this._y=dg*gg*mg+ug*cg*fg,this._z=dg*cg*fg-ug*gg*mg,this._w=dg*cg*mg-ug*gg*fg):'XZY'===sg&&(this._x=ug*cg*mg-dg*gg*fg,this._y=dg*gg*mg-ug*cg*fg,this._z=dg*cg*fg+ug*gg*mg,this._w=dg*cg*mg+ug*gg*fg),!1!==ag&&this.onChangeCallback(),this},setFromAxisAngle:function(rg,ag){var og=ag/2,ig=Math.sin(og);return this._x=rg.x*ig,this._y=rg.y*ig,this._z=rg.z*ig,this._w=Math.cos(og),this.onChangeCallback(),this},setFromRotationMatrix:function(rg){var ag=rg.elements,og=ag[0],ig=ag[4],ng=ag[8],sg=ag[1],lg=ag[5],pg=ag[9],dg=ag[2],cg=ag[6],mg=ag[10],ug=og+lg+mg,gg;return 0<ug?(gg=0.5/Math.sqrt(ug+1),this._w=0.25/gg,this._x=(cg-pg)*gg,this._y=(ng-dg)*gg,this._z=(sg-ig)*gg):og>lg&&og>mg?(gg=2*Math.sqrt(1+og-lg-mg),this._w=(cg-pg)/gg,this._x=0.25*gg,this._y=(ig+sg)/gg,this._z=(ng+dg)/gg):lg>mg?(gg=2*Math.sqrt(1+lg-og-mg),this._w=(ng-dg)/gg,this._x=(ig+sg)/gg,this._y=0.25*gg,this._z=(pg+cg)/gg):(gg=2*Math.sqrt(1+mg-og-lg),this._w=(sg-ig)/gg,this._x=(ng+dg)/gg,this._y=(pg+cg)/gg,this._z=0.25*gg),this.onChangeCallback(),this},setFromUnitVectors:function(){var rg=new C,ag;return function(ng,sg){return void 0===rg&&(rg=new C),ag=ng.dot(sg)+1,ag<1e-6?(ag=0,Math.abs(ng.x)>Math.abs(ng.z)?rg.set(-ng.y,ng.x,0):rg.set(0,-ng.z,ng.y)):rg.crossVectors(ng,sg),this._x=rg.x,this._y=rg.y,this._z=rg.z,this._w=ag,this.normalize()}}(),angleTo:function(rg){return 2*Math.acos(Math.abs(Sp.clamp(this.dot(rg),-1,1)))},rotateTowards:function(rg,ag){var og=this.angleTo(rg);if(0===og)return this;var ig=Math.min(1,ag/og);return this.slerp(rg,ig),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(rg){return this._x*rg._x+this._y*rg._y+this._z*rg._z+this._w*rg._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var rg=this.length();return 0===rg?(this._x=0,this._y=0,this._z=0,this._w=1):(rg=1/rg,this._x*=rg,this._y*=rg,this._z*=rg,this._w*=rg),this.onChangeCallback(),this},multiply:function(rg,ag){return void 0===ag?this.multiplyQuaternions(this,rg):(console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.'),this.multiplyQuaternions(rg,ag))},premultiply:function(rg){return this.multiplyQuaternions(rg,this)},multiplyQuaternions:function(rg,ag){var og=rg._x,ig=rg._y,ng=rg._z,sg=rg._w,lg=ag._x,pg=ag._y,dg=ag._z,cg=ag._w;return this._x=og*cg+sg*lg+ig*dg-ng*pg,this._y=ig*cg+sg*pg+ng*lg-og*dg,this._z=ng*cg+sg*dg+og*pg-ig*lg,this._w=sg*cg-og*lg-ig*pg-ng*dg,this.onChangeCallback(),this},slerp:function(rg,ag){if(0===ag)return this;if(1===ag)return this.copy(rg);var og=this._x,ig=this._y,ng=this._z,sg=this._w,lg=sg*rg._w+og*rg._x+ig*rg._y+ng*rg._z;if(0>lg?(this._w=-rg._w,this._x=-rg._x,this._y=-rg._y,this._z=-rg._z,lg=-lg):this.copy(rg),1<=lg)return this._w=sg,this._x=og,this._y=ig,this._z=ng,this;var pg=1-lg*lg;if(pg<=Number.EPSILON){var dg=1-ag;return this._w=dg*sg+ag*this._w,this._x=dg*og+ag*this._x,this._y=dg*ig+ag*this._y,this._z=dg*ng+ag*this._z,this.normalize()}var cg=Math.sqrt(pg),mg=Math.atan2(cg,lg),ug=Math.sin((1-ag)*mg)/cg,gg=Math.sin(ag*mg)/cg;return this._w=sg*ug+this._w*gg,this._x=og*ug+this._x*gg,this._y=ig*ug+this._y*gg,this._z=ng*ug+this._z*gg,this.onChangeCallback(),this},equals:function(rg){return rg._x===this._x&&rg._y===this._y&&rg._z===this._z&&rg._w===this._w},fromArray:function(rg,ag){return void 0===ag&&(ag=0),this._x=rg[ag],this._y=rg[ag+1],this._z=rg[ag+2],this._w=rg[ag+3],this.onChangeCallback(),this},toArray:function(rg,ag){return void 0===rg&&(rg=[]),void 0===ag&&(ag=0),rg[ag]=this._x,rg[ag+1]=this._y,rg[ag+2]=this._z,rg[ag+3]=this._w,rg},onChange:function(rg){return this.onChangeCallback=rg,this},onChangeCallback:function(){}}),Object.assign(C.prototype,{isVector3:!0,set:function(rg,ag,og){return this.x=rg,this.y=ag,this.z=og,this},setScalar:function(rg){return this.x=rg,this.y=rg,this.z=rg,this},setX:function(rg){return this.x=rg,this},setY:function(rg){return this.y=rg,this},setZ:function(rg){return this.z=rg,this},setComponent:function(rg,ag){switch(rg){case 0:this.x=ag;break;case 1:this.y=ag;break;case 2:this.z=ag;break;default:throw new Error('index is out of range: '+rg);}return this},getComponent:function(rg){switch(rg){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+rg);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(rg){return this.x=rg.x,this.y=rg.y,this.z=rg.z,this},add:function(rg,ag){return void 0===ag?(this.x+=rg.x,this.y+=rg.y,this.z+=rg.z,this):(console.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(rg,ag))},addScalar:function(rg){return this.x+=rg,this.y+=rg,this.z+=rg,this},addVectors:function(rg,ag){return this.x=rg.x+ag.x,this.y=rg.y+ag.y,this.z=rg.z+ag.z,this},addScaledVector:function(rg,ag){return this.x+=rg.x*ag,this.y+=rg.y*ag,this.z+=rg.z*ag,this},sub:function(rg,ag){return void 0===ag?(this.x-=rg.x,this.y-=rg.y,this.z-=rg.z,this):(console.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(rg,ag))},subScalar:function(rg){return this.x-=rg,this.y-=rg,this.z-=rg,this},subVectors:function(rg,ag){return this.x=rg.x-ag.x,this.y=rg.y-ag.y,this.z=rg.z-ag.z,this},multiply:function(rg,ag){return void 0===ag?(this.x*=rg.x,this.y*=rg.y,this.z*=rg.z,this):(console.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.'),this.multiplyVectors(rg,ag))},multiplyScalar:function(rg){return this.x*=rg,this.y*=rg,this.z*=rg,this},multiplyVectors:function(rg,ag){return this.x=rg.x*ag.x,this.y=rg.y*ag.y,this.z=rg.z*ag.z,this},applyEuler:function(){var rg=new A;return function(og){return og&&og.isEuler||console.error('THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.'),this.applyQuaternion(rg.setFromEuler(og))}}(),applyAxisAngle:function(){var rg=new A;return function(og,ig){return this.applyQuaternion(rg.setFromAxisAngle(og,ig))}}(),applyMatrix3:function(rg){var ag=this.x,og=this.y,ig=this.z,ng=rg.elements;return this.x=ng[0]*ag+ng[3]*og+ng[6]*ig,this.y=ng[1]*ag+ng[4]*og+ng[7]*ig,this.z=ng[2]*ag+ng[5]*og+ng[8]*ig,this},applyMatrix4:function(rg){var ag=this.x,og=this.y,ig=this.z,ng=rg.elements,sg=1/(ng[3]*ag+ng[7]*og+ng[11]*ig+ng[15]);return this.x=(ng[0]*ag+ng[4]*og+ng[8]*ig+ng[12])*sg,this.y=(ng[1]*ag+ng[5]*og+ng[9]*ig+ng[13])*sg,this.z=(ng[2]*ag+ng[6]*og+ng[10]*ig+ng[14])*sg,this},applyQuaternion:function(rg){var ag=this.x,og=this.y,ig=this.z,ng=rg.x,sg=rg.y,lg=rg.z,pg=rg.w,dg=pg*ag+sg*ig-lg*og,cg=pg*og+lg*ag-ng*ig,mg=pg*ig+ng*og-sg*ag,ug=-ng*ag-sg*og-lg*ig;return this.x=dg*pg+ug*-ng+cg*-lg-mg*-sg,this.y=cg*pg+ug*-sg+mg*-ng-dg*-lg,this.z=mg*pg+ug*-lg+dg*-sg-cg*-ng,this},project:function(rg){return this.applyMatrix4(rg.matrixWorldInverse).applyMatrix4(rg.projectionMatrix)},unproject:function(){var rg=new L;return function(og){return this.applyMatrix4(rg.getInverse(og.projectionMatrix)).applyMatrix4(og.matrixWorld)}}(),transformDirection:function(rg){var ag=this.x,og=this.y,ig=this.z,ng=rg.elements;return this.x=ng[0]*ag+ng[4]*og+ng[8]*ig,this.y=ng[1]*ag+ng[5]*og+ng[9]*ig,this.z=ng[2]*ag+ng[6]*og+ng[10]*ig,this.normalize()},divide:function(rg){return this.x/=rg.x,this.y/=rg.y,this.z/=rg.z,this},divideScalar:function(rg){return this.multiplyScalar(1/rg)},min:function(rg){return this.x=Math.min(this.x,rg.x),this.y=Math.min(this.y,rg.y),this.z=Math.min(this.z,rg.z),this},max:function(rg){return this.x=Math.max(this.x,rg.x),this.y=Math.max(this.y,rg.y),this.z=Math.max(this.z,rg.z),this},clamp:function(rg,ag){return this.x=Math.max(rg.x,Math.min(ag.x,this.x)),this.y=Math.max(rg.y,Math.min(ag.y,this.y)),this.z=Math.max(rg.z,Math.min(ag.z,this.z)),this},clampScalar:function(){var rg=new C,ag=new C;return function(ig,ng){return rg.set(ig,ig,ig),ag.set(ng,ng,ng),this.clamp(rg,ag)}}(),clampLength:function(rg,ag){var og=this.length();return this.divideScalar(og||1).multiplyScalar(Math.max(rg,Math.min(ag,og)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(rg){return this.x*rg.x+this.y*rg.y+this.z*rg.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(rg){return this.normalize().multiplyScalar(rg)},lerp:function(rg,ag){return this.x+=(rg.x-this.x)*ag,this.y+=(rg.y-this.y)*ag,this.z+=(rg.z-this.z)*ag,this},lerpVectors:function(rg,ag,og){return this.subVectors(ag,rg).multiplyScalar(og).add(rg)},cross:function(rg,ag){return void 0===ag?this.crossVectors(this,rg):(console.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.'),this.crossVectors(rg,ag))},crossVectors:function(rg,ag){var og=rg.x,ig=rg.y,ng=rg.z,sg=ag.x,lg=ag.y,pg=ag.z;return this.x=ig*pg-ng*lg,this.y=ng*sg-og*pg,this.z=og*lg-ig*sg,this},projectOnVector:function(rg){var ag=rg.dot(this)/rg.lengthSq();return this.copy(rg).multiplyScalar(ag)},projectOnPlane:function(){var rg=new C;return function(og){return rg.copy(this).projectOnVector(og),this.sub(rg)}}(),reflect:function(){var rg=new C;return function(og){return this.sub(rg.copy(og).multiplyScalar(2*this.dot(og)))}}(),angleTo:function(rg){var ag=this.dot(rg)/Math.sqrt(this.lengthSq()*rg.lengthSq());return Math.acos(Sp.clamp(ag,-1,1))},distanceTo:function(rg){return Math.sqrt(this.distanceToSquared(rg))},distanceToSquared:function(rg){var ag=this.x-rg.x,og=this.y-rg.y,ig=this.z-rg.z;return ag*ag+og*og+ig*ig},manhattanDistanceTo:function(rg){return Math.abs(this.x-rg.x)+Math.abs(this.y-rg.y)+Math.abs(this.z-rg.z)},setFromSpherical:function(rg){return this.setFromSphericalCoords(rg.radius,rg.phi,rg.theta)},setFromSphericalCoords:function(rg,ag,og){var ig=Math.sin(ag)*rg;return this.x=ig*Math.sin(og),this.y=Math.cos(ag)*rg,this.z=ig*Math.cos(og),this},setFromCylindrical:function(rg){return this.setFromCylindricalCoords(rg.radius,rg.theta,rg.y)},setFromCylindricalCoords:function(rg,ag,og){return this.x=rg*Math.sin(ag),this.y=og,this.z=rg*Math.cos(ag),this},setFromMatrixPosition:function(rg){var ag=rg.elements;return this.x=ag[12],this.y=ag[13],this.z=ag[14],this},setFromMatrixScale:function(rg){var ag=this.setFromMatrixColumn(rg,0).length(),og=this.setFromMatrixColumn(rg,1).length(),ig=this.setFromMatrixColumn(rg,2).length();return this.x=ag,this.y=og,this.z=ig,this},setFromMatrixColumn:function(rg,ag){return this.fromArray(rg.elements,4*ag)},equals:function(rg){return rg.x===this.x&&rg.y===this.y&&rg.z===this.z},fromArray:function(rg,ag){return void 0===ag&&(ag=0),this.x=rg[ag],this.y=rg[ag+1],this.z=rg[ag+2],this},toArray:function(rg,ag){return void 0===rg&&(rg=[]),void 0===ag&&(ag=0),rg[ag]=this.x,rg[ag+1]=this.y,rg[ag+2]=this.z,rg},fromBufferAttribute:function(rg,ag,og){return void 0!==og&&console.warn('THREE.Vector3: offset has been removed from .fromBufferAttribute().'),this.x=rg.getX(ag),this.y=rg.getY(ag),this.z=rg.getZ(ag),this}}),Object.assign(R.prototype,{isMatrix3:!0,set:function(rg,ag,og,ig,ng,sg,lg,pg,dg){var cg=this.elements;return cg[0]=rg,cg[1]=ig,cg[2]=lg,cg[3]=ag,cg[4]=ng,cg[5]=pg,cg[6]=og,cg[7]=sg,cg[8]=dg,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(rg){var ag=this.elements,og=rg.elements;return ag[0]=og[0],ag[1]=og[1],ag[2]=og[2],ag[3]=og[3],ag[4]=og[4],ag[5]=og[5],ag[6]=og[6],ag[7]=og[7],ag[8]=og[8],this},setFromMatrix4:function(rg){var ag=rg.elements;return this.set(ag[0],ag[4],ag[8],ag[1],ag[5],ag[9],ag[2],ag[6],ag[10]),this},applyToBufferAttribute:function(){var rg=new C;return function(og){for(var ig=0,ng=og.count;ig<ng;ig++)rg.x=og.getX(ig),rg.y=og.getY(ig),rg.z=og.getZ(ig),rg.applyMatrix3(this),og.setXYZ(ig,rg.x,rg.y,rg.z);return og}}(),multiply:function(rg){return this.multiplyMatrices(this,rg)},premultiply:function(rg){return this.multiplyMatrices(rg,this)},multiplyMatrices:function(rg,ag){var og=rg.elements,ig=ag.elements,ng=this.elements,sg=og[0],lg=og[3],pg=og[6],dg=og[1],cg=og[4],mg=og[7],ug=og[2],gg=og[5],fg=og[8],hg=ig[0],yg=ig[3],xg=ig[6],vg=ig[1],_g=ig[4],bg=ig[7],Sg=ig[2],Mg=ig[5],Tg=ig[8];return ng[0]=sg*hg+lg*vg+pg*Sg,ng[3]=sg*yg+lg*_g+pg*Mg,ng[6]=sg*xg+lg*bg+pg*Tg,ng[1]=dg*hg+cg*vg+mg*Sg,ng[4]=dg*yg+cg*_g+mg*Mg,ng[7]=dg*xg+cg*bg+mg*Tg,ng[2]=ug*hg+gg*vg+fg*Sg,ng[5]=ug*yg+gg*_g+fg*Mg,ng[8]=ug*xg+gg*bg+fg*Tg,this},multiplyScalar:function(rg){var ag=this.elements;return ag[0]*=rg,ag[3]*=rg,ag[6]*=rg,ag[1]*=rg,ag[4]*=rg,ag[7]*=rg,ag[2]*=rg,ag[5]*=rg,ag[8]*=rg,this},determinant:function(){var rg=this.elements,ag=rg[0],og=rg[1],ig=rg[2],ng=rg[3],sg=rg[4],lg=rg[5],pg=rg[6],dg=rg[7],cg=rg[8];return ag*sg*cg-ag*lg*dg-og*ng*cg+og*lg*pg+ig*ng*dg-ig*sg*pg},getInverse:function(rg,ag){rg&&rg.isMatrix4&&console.error('THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.');var og=rg.elements,ig=this.elements,ng=og[0],sg=og[1],lg=og[2],pg=og[3],dg=og[4],cg=og[5],mg=og[6],ug=og[7],gg=og[8],fg=gg*dg-cg*ug,hg=cg*mg-gg*pg,yg=ug*pg-dg*mg,xg=ng*fg+sg*hg+lg*yg;if(0==xg){var vg='THREE.Matrix3: .getInverse() can\'t invert matrix, determinant is 0';if(!0===ag)throw new Error(vg);else console.warn(vg);return this.identity()}var _g=1/xg;return ig[0]=fg*_g,ig[1]=(lg*ug-gg*sg)*_g,ig[2]=(cg*sg-lg*dg)*_g,ig[3]=hg*_g,ig[4]=(gg*ng-lg*mg)*_g,ig[5]=(lg*pg-cg*ng)*_g,ig[6]=yg*_g,ig[7]=(sg*mg-ug*ng)*_g,ig[8]=(dg*ng-sg*pg)*_g,this},transpose:function(){var ag=this.elements,rg;return rg=ag[1],ag[1]=ag[3],ag[3]=rg,rg=ag[2],ag[2]=ag[6],ag[6]=rg,rg=ag[5],ag[5]=ag[7],ag[7]=rg,this},getNormalMatrix:function(rg){return this.setFromMatrix4(rg).getInverse(this).transpose()},transposeIntoArray:function(rg){var ag=this.elements;return rg[0]=ag[0],rg[1]=ag[3],rg[2]=ag[6],rg[3]=ag[1],rg[4]=ag[4],rg[5]=ag[7],rg[6]=ag[2],rg[7]=ag[5],rg[8]=ag[8],this},setUvTransform:function(rg,ag,og,ig,ng,sg,lg){var pg=Math.cos(ng),dg=Math.sin(ng);this.set(og*pg,og*dg,-og*(pg*sg+dg*lg)+sg+rg,-ig*dg,ig*pg,-ig*(-dg*sg+pg*lg)+lg+ag,0,0,1)},scale:function(rg,ag){var og=this.elements;return og[0]*=rg,og[3]*=rg,og[6]*=rg,og[1]*=ag,og[4]*=ag,og[7]*=ag,this},rotate:function(rg){var ag=Math.cos(rg),og=Math.sin(rg),ig=this.elements,ng=ig[0],sg=ig[3],lg=ig[6],pg=ig[1],dg=ig[4],cg=ig[7];return ig[0]=ag*ng+og*pg,ig[3]=ag*sg+og*dg,ig[6]=ag*lg+og*cg,ig[1]=-og*ng+ag*pg,ig[4]=-og*sg+ag*dg,ig[7]=-og*lg+ag*cg,this},translate:function(rg,ag){var og=this.elements;return og[0]+=rg*og[2],og[3]+=rg*og[5],og[6]+=rg*og[8],og[1]+=ag*og[2],og[4]+=ag*og[5],og[7]+=ag*og[8],this},equals:function(rg){for(var ag=this.elements,og=rg.elements,ig=0;9>ig;ig++)if(ag[ig]!==og[ig])return!1;return!0},fromArray:function(rg,ag){void 0===ag&&(ag=0);for(var og=0;9>og;og++)this.elements[og]=rg[og+ag];return this},toArray:function(rg,ag){void 0===rg&&(rg=[]),void 0===ag&&(ag=0);var og=this.elements;return rg[ag]=og[0],rg[ag+1]=og[1],rg[ag+2]=og[2],rg[ag+3]=og[3],rg[ag+4]=og[4],rg[ag+5]=og[5],rg[ag+6]=og[6],rg[ag+7]=og[7],rg[ag+8]=og[8],rg}});var Mp={getDataURL:function(rg){var ag;if('undefined'==typeof HTMLCanvasElement)return rg.src;if(rg instanceof HTMLCanvasElement)ag=rg;else{ag=document.createElementNS('http://www.w3.org/1999/xhtml','canvas'),ag.width=rg.width,ag.height=rg.height;var og=ag.getContext('2d');rg instanceof ImageData?og.putImageData(rg,0,0):og.drawImage(rg,0,0,rg.width,rg.height)}return 2048<ag.width||2048<ag.height?ag.toDataURL('image/jpeg',0.6):ag.toDataURL('image/png')}},Tp=0;I.DEFAULT_IMAGE=void 0,I.DEFAULT_MAPPING=Is,I.prototype=Object.assign(Object.create(M.prototype),{constructor:I,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.name=rg.name,this.image=rg.image,this.mipmaps=rg.mipmaps.slice(0),this.mapping=rg.mapping,this.wrapS=rg.wrapS,this.wrapT=rg.wrapT,this.magFilter=rg.magFilter,this.minFilter=rg.minFilter,this.anisotropy=rg.anisotropy,this.format=rg.format,this.type=rg.type,this.offset.copy(rg.offset),this.repeat.copy(rg.repeat),this.center.copy(rg.center),this.rotation=rg.rotation,this.matrixAutoUpdate=rg.matrixAutoUpdate,this.matrix.copy(rg.matrix),this.generateMipmaps=rg.generateMipmaps,this.premultiplyAlpha=rg.premultiplyAlpha,this.flipY=rg.flipY,this.unpackAlignment=rg.unpackAlignment,this.encoding=rg.encoding,this},toJSON:function(rg){var ag=void 0===rg||'string'==typeof rg;if(!ag&&void 0!==rg.textures[this.uuid])return rg.textures[this.uuid];var og={metadata:{version:4.5,type:'Texture',generator:'Texture.toJSON'},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var ig=this.image;if(void 0===ig.uuid&&(ig.uuid=Sp.generateUUID()),!ag&&void 0===rg.images[ig.uuid]){var ng;if(Array.isArray(ig)){ng=[];for(var sg=0,lg=ig.length;sg<lg;sg++)ng.push(Mp.getDataURL(ig[sg]))}else ng=Mp.getDataURL(ig);rg.images[ig.uuid]={uuid:ig.uuid,url:ng}}og.image=ig.uuid}return ag||(rg.textures[this.uuid]=og),og},dispose:function(){this.dispatchEvent({type:'dispose'})},transformUv:function(rg){if(this.mapping!==Is)return rg;if(rg.applyMatrix3(this.matrix),0>rg.x||1<rg.x)switch(this.wrapS){case Fs:rg.x-=Math.floor(rg.x);break;case Hs:rg.x=0>rg.x?0:1;break;case Vs:1===Math.abs(Math.floor(rg.x)%2)?rg.x=Math.ceil(rg.x)-rg.x:rg.x-=Math.floor(rg.x);}if(0>rg.y||1<rg.y)switch(this.wrapT){case Fs:rg.y-=Math.floor(rg.y);break;case Hs:rg.y=0>rg.y?0:1;break;case Vs:1===Math.abs(Math.floor(rg.y)%2)?rg.y=Math.ceil(rg.y)-rg.y:rg.y-=Math.floor(rg.y);}return this.flipY&&(rg.y=1-rg.y),rg}}),Object.defineProperty(I.prototype,'needsUpdate',{set:function(rg){!0===rg&&this.version++}}),Object.assign(D.prototype,{isVector4:!0,set:function(rg,ag,og,ig){return this.x=rg,this.y=ag,this.z=og,this.w=ig,this},setScalar:function(rg){return this.x=rg,this.y=rg,this.z=rg,this.w=rg,this},setX:function(rg){return this.x=rg,this},setY:function(rg){return this.y=rg,this},setZ:function(rg){return this.z=rg,this},setW:function(rg){return this.w=rg,this},setComponent:function(rg,ag){switch(rg){case 0:this.x=ag;break;case 1:this.y=ag;break;case 2:this.z=ag;break;case 3:this.w=ag;break;default:throw new Error('index is out of range: '+rg);}return this},getComponent:function(rg){switch(rg){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+rg);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(rg){return this.x=rg.x,this.y=rg.y,this.z=rg.z,this.w=void 0===rg.w?1:rg.w,this},add:function(rg,ag){return void 0===ag?(this.x+=rg.x,this.y+=rg.y,this.z+=rg.z,this.w+=rg.w,this):(console.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(rg,ag))},addScalar:function(rg){return this.x+=rg,this.y+=rg,this.z+=rg,this.w+=rg,this},addVectors:function(rg,ag){return this.x=rg.x+ag.x,this.y=rg.y+ag.y,this.z=rg.z+ag.z,this.w=rg.w+ag.w,this},addScaledVector:function(rg,ag){return this.x+=rg.x*ag,this.y+=rg.y*ag,this.z+=rg.z*ag,this.w+=rg.w*ag,this},sub:function(rg,ag){return void 0===ag?(this.x-=rg.x,this.y-=rg.y,this.z-=rg.z,this.w-=rg.w,this):(console.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(rg,ag))},subScalar:function(rg){return this.x-=rg,this.y-=rg,this.z-=rg,this.w-=rg,this},subVectors:function(rg,ag){return this.x=rg.x-ag.x,this.y=rg.y-ag.y,this.z=rg.z-ag.z,this.w=rg.w-ag.w,this},multiplyScalar:function(rg){return this.x*=rg,this.y*=rg,this.z*=rg,this.w*=rg,this},applyMatrix4:function(rg){var ag=this.x,og=this.y,ig=this.z,ng=this.w,sg=rg.elements;return this.x=sg[0]*ag+sg[4]*og+sg[8]*ig+sg[12]*ng,this.y=sg[1]*ag+sg[5]*og+sg[9]*ig+sg[13]*ng,this.z=sg[2]*ag+sg[6]*og+sg[10]*ig+sg[14]*ng,this.w=sg[3]*ag+sg[7]*og+sg[11]*ig+sg[15]*ng,this},divideScalar:function(rg){return this.multiplyScalar(1/rg)},setAxisAngleFromQuaternion:function(rg){this.w=2*Math.acos(rg.w);var ag=Math.sqrt(1-rg.w*rg.w);return 1e-4>ag?(this.x=1,this.y=0,this.z=0):(this.x=rg.x/ag,this.y=rg.y/ag,this.z=rg.z/ag),this},setAxisAngleFromRotationMatrix:function(rg){var sg=0.01,lg=0.1,pg=rg.elements,dg=pg[0],cg=pg[4],mg=pg[8],ug=pg[1],gg=pg[5],fg=pg[9],hg=pg[2],yg=pg[6],xg=pg[10],ag,og,ig,ng;if(Math.abs(cg-ug)<sg&&Math.abs(mg-hg)<sg&&Math.abs(fg-yg)<sg){if(Math.abs(cg+ug)<lg&&Math.abs(mg+hg)<lg&&Math.abs(fg+yg)<lg&&Math.abs(dg+gg+xg-3)<lg)return this.set(1,0,0,0),this;ag=Math.PI;var vg=(dg+1)/2,_g=(gg+1)/2,bg=(xg+1)/2,Sg=(cg+ug)/4,Mg=(mg+hg)/4,Tg=(fg+yg)/4;return vg>_g&&vg>bg?vg<sg?(og=0,ig=0.707106781,ng=0.707106781):(og=Math.sqrt(vg),ig=Sg/og,ng=Mg/og):_g>bg?_g<sg?(og=0.707106781,ig=0,ng=0.707106781):(ig=Math.sqrt(_g),og=Sg/ig,ng=Tg/ig):bg<sg?(og=0.707106781,ig=0.707106781,ng=0):(ng=Math.sqrt(bg),og=Mg/ng,ig=Tg/ng),this.set(og,ig,ng,ag),this}var Eg=Math.sqrt((yg-fg)*(yg-fg)+(mg-hg)*(mg-hg)+(ug-cg)*(ug-cg));return 1e-3>Math.abs(Eg)&&(Eg=1),this.x=(yg-fg)/Eg,this.y=(mg-hg)/Eg,this.z=(ug-cg)/Eg,this.w=Math.acos((dg+gg+xg-1)/2),this},min:function(rg){return this.x=Math.min(this.x,rg.x),this.y=Math.min(this.y,rg.y),this.z=Math.min(this.z,rg.z),this.w=Math.min(this.w,rg.w),this},max:function(rg){return this.x=Math.max(this.x,rg.x),this.y=Math.max(this.y,rg.y),this.z=Math.max(this.z,rg.z),this.w=Math.max(this.w,rg.w),this},clamp:function(rg,ag){return this.x=Math.max(rg.x,Math.min(ag.x,this.x)),this.y=Math.max(rg.y,Math.min(ag.y,this.y)),this.z=Math.max(rg.z,Math.min(ag.z,this.z)),this.w=Math.max(rg.w,Math.min(ag.w,this.w)),this},clampScalar:function(){var rg,ag;return function(ig,ng){return void 0==rg&&(rg=new D,ag=new D),rg.set(ig,ig,ig,ig),ag.set(ng,ng,ng,ng),this.clamp(rg,ag)}}(),clampLength:function(rg,ag){var og=this.length();return this.divideScalar(og||1).multiplyScalar(Math.max(rg,Math.min(ag,og)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(rg){return this.x*rg.x+this.y*rg.y+this.z*rg.z+this.w*rg.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(rg){return this.normalize().multiplyScalar(rg)},lerp:function(rg,ag){return this.x+=(rg.x-this.x)*ag,this.y+=(rg.y-this.y)*ag,this.z+=(rg.z-this.z)*ag,this.w+=(rg.w-this.w)*ag,this},lerpVectors:function(rg,ag,og){return this.subVectors(ag,rg).multiplyScalar(og).add(rg)},equals:function(rg){return rg.x===this.x&&rg.y===this.y&&rg.z===this.z&&rg.w===this.w},fromArray:function(rg,ag){return void 0===ag&&(ag=0),this.x=rg[ag],this.y=rg[ag+1],this.z=rg[ag+2],this.w=rg[ag+3],this},toArray:function(rg,ag){return void 0===rg&&(rg=[]),void 0===ag&&(ag=0),rg[ag]=this.x,rg[ag+1]=this.y,rg[ag+2]=this.z,rg[ag+3]=this.w,rg},fromBufferAttribute:function(rg,ag,og){return void 0!==og&&console.warn('THREE.Vector4: offset has been removed from .fromBufferAttribute().'),this.x=rg.getX(ag),this.y=rg.getY(ag),this.z=rg.getZ(ag),this.w=rg.getW(ag),this}}),U.prototype=Object.assign(Object.create(M.prototype),{constructor:U,isWebGLRenderTarget:!0,setSize:function(rg,ag){(this.width!==rg||this.height!==ag)&&(this.width=rg,this.height=ag,this.dispose()),this.viewport.set(0,0,rg,ag),this.scissor.set(0,0,rg,ag)},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.width=rg.width,this.height=rg.height,this.viewport.copy(rg.viewport),this.texture=rg.texture.clone(),this.depthBuffer=rg.depthBuffer,this.stencilBuffer=rg.stencilBuffer,this.depthTexture=rg.depthTexture,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),G.prototype=Object.create(U.prototype),G.prototype.constructor=G,G.prototype.isWebGLRenderTargetCube=!0,O.prototype=Object.create(I.prototype),O.prototype.constructor=O,O.prototype.isDataTexture=!0,Object.assign(F.prototype,{isBox3:!0,set:function(rg,ag){return this.min.copy(rg),this.max.copy(ag),this},setFromArray:function(rg){for(var ag=+Infinity,og=+Infinity,ig=+Infinity,ng=-Infinity,sg=-Infinity,lg=-Infinity,pg=0,dg=rg.length;pg<dg;pg+=3){var cg=rg[pg],mg=rg[pg+1],ug=rg[pg+2];cg<ag&&(ag=cg),mg<og&&(og=mg),ug<ig&&(ig=ug),cg>ng&&(ng=cg),mg>sg&&(sg=mg),ug>lg&&(lg=ug)}return this.min.set(ag,og,ig),this.max.set(ng,sg,lg),this},setFromBufferAttribute:function(rg){for(var ag=+Infinity,og=+Infinity,ig=+Infinity,ng=-Infinity,sg=-Infinity,lg=-Infinity,pg=0,dg=rg.count;pg<dg;pg++){var cg=rg.getX(pg),mg=rg.getY(pg),ug=rg.getZ(pg);cg<ag&&(ag=cg),mg<og&&(og=mg),ug<ig&&(ig=ug),cg>ng&&(ng=cg),mg>sg&&(sg=mg),ug>lg&&(lg=ug)}return this.min.set(ag,og,ig),this.max.set(ng,sg,lg),this},setFromPoints:function(rg){this.makeEmpty();for(var ag=0,og=rg.length;ag<og;ag++)this.expandByPoint(rg[ag]);return this},setFromCenterAndSize:function(){var rg=new C;return function(og,ig){var ng=rg.copy(ig).multiplyScalar(0.5);return this.min.copy(og).sub(ng),this.max.copy(og).add(ng),this}}(),setFromObject:function(rg){return this.makeEmpty(),this.expandByObject(rg)},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.min.copy(rg.min),this.max.copy(rg.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(rg){return void 0===rg&&(console.warn('THREE.Box3: .getCenter() target is now required'),rg=new C),this.isEmpty()?rg.set(0,0,0):rg.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(rg){return void 0===rg&&(console.warn('THREE.Box3: .getSize() target is now required'),rg=new C),this.isEmpty()?rg.set(0,0,0):rg.subVectors(this.max,this.min)},expandByPoint:function(rg){return this.min.min(rg),this.max.max(rg),this},expandByVector:function(rg){return this.min.sub(rg),this.max.add(rg),this},expandByScalar:function(rg){return this.min.addScalar(-rg),this.max.addScalar(rg),this},expandByObject:function(){function rg(sg){var lg=sg.geometry;if(void 0!==lg)if(lg.isGeometry){var pg=lg.vertices;for(og=0,ig=pg.length;og<ig;og++)ng.copy(pg[og]),ng.applyMatrix4(sg.matrixWorld),ag.expandByPoint(ng)}else if(lg.isBufferGeometry){var dg=lg.attributes.position;if(void 0!==dg)for(og=0,ig=dg.count;og<ig;og++)ng.fromBufferAttribute(dg,og).applyMatrix4(sg.matrixWorld),ag.expandByPoint(ng)}}var ng=new C,ag,og,ig;return function(lg){return ag=this,lg.updateMatrixWorld(!0),lg.traverse(rg),this}}(),containsPoint:function(rg){return rg.x<this.min.x||rg.x>this.max.x||rg.y<this.min.y||rg.y>this.max.y||rg.z<this.min.z||rg.z>this.max.z?!1:!0},containsBox:function(rg){return this.min.x<=rg.min.x&&rg.max.x<=this.max.x&&this.min.y<=rg.min.y&&rg.max.y<=this.max.y&&this.min.z<=rg.min.z&&rg.max.z<=this.max.z},getParameter:function(rg,ag){return void 0===ag&&(console.warn('THREE.Box3: .getParameter() target is now required'),ag=new C),ag.set((rg.x-this.min.x)/(this.max.x-this.min.x),(rg.y-this.min.y)/(this.max.y-this.min.y),(rg.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(rg){return rg.max.x<this.min.x||rg.min.x>this.max.x||rg.max.y<this.min.y||rg.min.y>this.max.y||rg.max.z<this.min.z||rg.min.z>this.max.z?!1:!0},intersectsSphere:function(){var rg=new C;return function(og){return this.clampPoint(og.center,rg),rg.distanceToSquared(og.center)<=og.radius*og.radius}}(),intersectsPlane:function(rg){var ag,og;return 0<rg.normal.x?(ag=rg.normal.x*this.min.x,og=rg.normal.x*this.max.x):(ag=rg.normal.x*this.max.x,og=rg.normal.x*this.min.x),0<rg.normal.y?(ag+=rg.normal.y*this.min.y,og+=rg.normal.y*this.max.y):(ag+=rg.normal.y*this.max.y,og+=rg.normal.y*this.min.y),0<rg.normal.z?(ag+=rg.normal.z*this.min.z,og+=rg.normal.z*this.max.z):(ag+=rg.normal.z*this.max.z,og+=rg.normal.z*this.min.z),ag<=-rg.constant&&og>=-rg.constant},intersectsTriangle:function(){function rg(ug){var gg,fg;for(gg=0,fg=ug.length-3;gg<=fg;gg+=3){pg.fromArray(ug,gg);var hg=cg.x*Math.abs(pg.x)+cg.y*Math.abs(pg.y)+cg.z*Math.abs(pg.z),yg=ag.dot(pg),xg=og.dot(pg),vg=ig.dot(pg);if(Math.max(-Math.max(yg,xg,vg),Math.min(yg,xg,vg))>hg)return!1}return!0}var ag=new C,og=new C,ig=new C,ng=new C,sg=new C,lg=new C,pg=new C,dg=new C,cg=new C,mg=new C;return function(gg){if(this.isEmpty())return!1;this.getCenter(dg),cg.subVectors(this.max,dg),ag.subVectors(gg.a,dg),og.subVectors(gg.b,dg),ig.subVectors(gg.c,dg),ng.subVectors(og,ag),sg.subVectors(ig,og),lg.subVectors(ag,ig);var fg=[0,-ng.z,ng.y,0,-sg.z,sg.y,0,-lg.z,lg.y,ng.z,0,-ng.x,sg.z,0,-sg.x,lg.z,0,-lg.x,-ng.y,ng.x,0,-sg.y,sg.x,0,-lg.y,lg.x,0];return!!rg(fg)&&(fg=[1,0,0,0,1,0,0,0,1],!!rg(fg))&&(mg.crossVectors(ng,sg),fg=[mg.x,mg.y,mg.z],rg(fg))}}(),clampPoint:function(rg,ag){return void 0===ag&&(console.warn('THREE.Box3: .clampPoint() target is now required'),ag=new C),ag.copy(rg).clamp(this.min,this.max)},distanceToPoint:function(){var rg=new C;return function(og){var ig=rg.copy(og).clamp(this.min,this.max);return ig.sub(og).length()}}(),getBoundingSphere:function(){var rg=new C;return function(og){return void 0===og&&(console.warn('THREE.Box3: .getBoundingSphere() target is now required'),og=new H),this.getCenter(og.center),og.radius=0.5*this.getSize(rg).length(),og}}(),intersect:function(rg){return this.min.max(rg.min),this.max.min(rg.max),this.isEmpty()&&this.makeEmpty(),this},union:function(rg){return this.min.min(rg.min),this.max.max(rg.max),this},applyMatrix4:function(){var rg=[new C,new C,new C,new C,new C,new C,new C,new C];return function(og){return this.isEmpty()?this:(rg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(og),rg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(og),rg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(og),rg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(og),rg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(og),rg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(og),rg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(og),rg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(og),this.setFromPoints(rg),this)}}(),translate:function(rg){return this.min.add(rg),this.max.add(rg),this},equals:function(rg){return rg.min.equals(this.min)&&rg.max.equals(this.max)}}),Object.assign(H.prototype,{set:function(rg,ag){return this.center.copy(rg),this.radius=ag,this},setFromPoints:function(){var rg=new F;return function(og,ig){var ng=this.center;void 0===ig?rg.setFromPoints(og).getCenter(ng):ng.copy(ig);for(var sg=0,lg=0,pg=og.length;lg<pg;lg++)sg=Math.max(sg,ng.distanceToSquared(og[lg]));return this.radius=Math.sqrt(sg),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.center.copy(rg.center),this.radius=rg.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(rg){return rg.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(rg){return rg.distanceTo(this.center)-this.radius},intersectsSphere:function(rg){var ag=this.radius+rg.radius;return rg.center.distanceToSquared(this.center)<=ag*ag},intersectsBox:function(rg){return rg.intersectsSphere(this)},intersectsPlane:function(rg){return Math.abs(rg.distanceToPoint(this.center))<=this.radius},clampPoint:function(rg,ag){var og=this.center.distanceToSquared(rg);return void 0===ag&&(console.warn('THREE.Sphere: .clampPoint() target is now required'),ag=new C),ag.copy(rg),og>this.radius*this.radius&&(ag.sub(this.center).normalize(),ag.multiplyScalar(this.radius).add(this.center)),ag},getBoundingBox:function(rg){return void 0===rg&&(console.warn('THREE.Sphere: .getBoundingBox() target is now required'),rg=new F),rg.set(this.center,this.center),rg.expandByScalar(this.radius),rg},applyMatrix4:function(rg){return this.center.applyMatrix4(rg),this.radius*=rg.getMaxScaleOnAxis(),this},translate:function(rg){return this.center.add(rg),this},equals:function(rg){return rg.center.equals(this.center)&&rg.radius===this.radius}}),Object.assign(V.prototype,{set:function(rg,ag){return this.normal.copy(rg),this.constant=ag,this},setComponents:function(rg,ag,og,ig){return this.normal.set(rg,ag,og),this.constant=ig,this},setFromNormalAndCoplanarPoint:function(rg,ag){return this.normal.copy(rg),this.constant=-ag.dot(this.normal),this},setFromCoplanarPoints:function(){var rg=new C,ag=new C;return function(ig,ng,sg){var lg=rg.subVectors(sg,ng).cross(ag.subVectors(ig,ng)).normalize();return this.setFromNormalAndCoplanarPoint(lg,ig),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.normal.copy(rg.normal),this.constant=rg.constant,this},normalize:function(){var rg=1/this.normal.length();return this.normal.multiplyScalar(rg),this.constant*=rg,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(rg){return this.normal.dot(rg)+this.constant},distanceToSphere:function(rg){return this.distanceToPoint(rg.center)-rg.radius},projectPoint:function(rg,ag){return void 0===ag&&(console.warn('THREE.Plane: .projectPoint() target is now required'),ag=new C),ag.copy(this.normal).multiplyScalar(-this.distanceToPoint(rg)).add(rg)},intersectLine:function(){var rg=new C;return function(og,ig){void 0===ig&&(console.warn('THREE.Plane: .intersectLine() target is now required'),ig=new C);var ng=og.delta(rg),sg=this.normal.dot(ng);if(0===sg)return 0===this.distanceToPoint(og.start)?ig.copy(og.start):void 0;var lg=-(og.start.dot(this.normal)+this.constant)/sg;return 0>lg||1<lg?void 0:ig.copy(ng).multiplyScalar(lg).add(og.start)}}(),intersectsLine:function(rg){var ag=this.distanceToPoint(rg.start),og=this.distanceToPoint(rg.end);return 0>ag&&0<og||0>og&&0<ag},intersectsBox:function(rg){return rg.intersectsPlane(this)},intersectsSphere:function(rg){return rg.intersectsPlane(this)},coplanarPoint:function(rg){return void 0===rg&&(console.warn('THREE.Plane: .coplanarPoint() target is now required'),rg=new C),rg.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var rg=new C,ag=new R;return function(ig,ng){var sg=ng||ag.getNormalMatrix(ig),lg=this.coplanarPoint(rg).applyMatrix4(ig),pg=this.normal.applyMatrix3(sg).normalize();return this.constant=-lg.dot(pg),this}}(),translate:function(rg){return this.constant-=rg.dot(this.normal),this},equals:function(rg){return rg.normal.equals(this.normal)&&rg.constant===this.constant}}),Object.assign(W.prototype,{set:function(rg,ag,og,ig,ng,sg){var lg=this.planes;return lg[0].copy(rg),lg[1].copy(ag),lg[2].copy(og),lg[3].copy(ig),lg[4].copy(ng),lg[5].copy(sg),this},clone:function(){return new this.constructor().copy(this)},copy:function(rg){for(var ag=this.planes,og=0;6>og;og++)ag[og].copy(rg.planes[og]);return this},setFromMatrix:function(rg){var ag=this.planes,og=rg.elements,ig=og[0],ng=og[1],sg=og[2],lg=og[3],pg=og[4],dg=og[5],cg=og[6],mg=og[7],ug=og[8],gg=og[9],fg=og[10],hg=og[11],yg=og[12],xg=og[13],vg=og[14],_g=og[15];return ag[0].setComponents(lg-ig,mg-pg,hg-ug,_g-yg).normalize(),ag[1].setComponents(lg+ig,mg+pg,hg+ug,_g+yg).normalize(),ag[2].setComponents(lg+ng,mg+dg,hg+gg,_g+xg).normalize(),ag[3].setComponents(lg-ng,mg-dg,hg-gg,_g-xg).normalize(),ag[4].setComponents(lg-sg,mg-cg,hg-fg,_g-vg).normalize(),ag[5].setComponents(lg+sg,mg+cg,hg+fg,_g+vg).normalize(),this},intersectsObject:function(){var rg=new H;return function(og){var ig=og.geometry;return null===ig.boundingSphere&&ig.computeBoundingSphere(),rg.copy(ig.boundingSphere).applyMatrix4(og.matrixWorld),this.intersectsSphere(rg)}}(),intersectsSprite:function(){var rg=new H;return function(og){return rg.center.set(0,0,0),rg.radius=0.7071067811865476,rg.applyMatrix4(og.matrixWorld),this.intersectsSphere(rg)}}(),intersectsSphere:function(rg){for(var ag=this.planes,og=rg.center,ig=-rg.radius,ng=0,sg;6>ng;ng++)if(sg=ag[ng].distanceToPoint(og),sg<ig)return!1;return!0},intersectsBox:function(){var rg=new C;return function(og){for(var ig=this.planes,ng=0,sg;6>ng;ng++)if(sg=ig[ng],rg.x=0<sg.normal.x?og.max.x:og.min.x,rg.y=0<sg.normal.y?og.max.y:og.min.y,rg.z=0<sg.normal.z?og.max.z:og.min.z,0>sg.distanceToPoint(rg))return!1;return!0}}(),containsPoint:function(rg){for(var ag=this.planes,og=0;6>og;og++)if(0>ag[og].distanceToPoint(rg))return!1;return!0}});var Vc={alphamap_fragment:'#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n',alphamap_pars_fragment:'#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n',alphatest_fragment:'#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n',aomap_fragment:'#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n',aomap_pars_fragment:'#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif',begin_vertex:'\nvec3 transformed = vec3( position );\n',beginnormal_vertex:'\nvec3 objectNormal = vec3( normal );\n',bsdfs:'float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',bumpmap_pars_fragment:'#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n',clipping_planes_fragment:'#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n',clipping_planes_pars_fragment:'#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n',clipping_planes_pars_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n',clipping_planes_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n',color_fragment:'#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif',color_pars_fragment:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n',color_pars_vertex:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif',color_vertex:'#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif',common:'#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n',cube_uv_reflection_fragment:'#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n',defaultnormal_vertex:'vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n',displacementmap_pars_vertex:'#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n',displacementmap_vertex:'#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n',emissivemap_fragment:'#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n',emissivemap_pars_fragment:'#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n',encodings_fragment:'  gl_FragColor = linearToOutputTexel( gl_FragColor );\n',encodings_pars_fragment:'\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n',envmap_fragment:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n',envmap_pars_fragment:'#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n',envmap_pars_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n',envmap_physical_pars_fragment:'#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n',envmap_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n',fog_vertex:'#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif\n',fog_pars_vertex:'#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif\n',fog_fragment:'#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n',fog_pars_fragment:'#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n',gradientmap_pars_fragment:'#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n',lightmap_fragment:'#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n',lightmap_pars_fragment:'#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif',lights_lambert_vertex:'vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n',lights_pars_begin:'uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n',lights_phong_fragment:'BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n',lights_phong_pars_fragment:'varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n',lights_physical_fragment:'PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n',lights_physical_pars_fragment:'struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n',lights_fragment_begin:'\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n',lights_fragment_maps:'#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n',lights_fragment_end:'#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n',logdepthbuf_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif',logdepthbuf_pars_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif\n',logdepthbuf_pars_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif\n',logdepthbuf_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n',map_fragment:'#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n',map_pars_fragment:'#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n',map_particle_fragment:'#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n',map_particle_pars_fragment:'#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n',metalnessmap_fragment:'float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n',metalnessmap_pars_fragment:'#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif',morphnormal_vertex:'#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n',morphtarget_pars_vertex:'#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif',morphtarget_vertex:'#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n',normal_fragment_begin:'#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n',normal_fragment_maps:'#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n',normalmap_pars_fragment:'#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n',packing:'vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n',premultiplied_alpha_fragment:'#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n',project_vertex:'vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n',dithering_fragment:'#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n',dithering_pars_fragment:'#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n',roughnessmap_fragment:'float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n',roughnessmap_pars_fragment:'#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif',shadowmap_pars_fragment:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n',shadowmap_pars_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n',shadowmap_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n',shadowmask_pars_fragment:'float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n',skinbase_vertex:'#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif',skinning_pars_vertex:'#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n',skinning_vertex:'#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n',skinnormal_vertex:'#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n',specularmap_fragment:'float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif',specularmap_pars_fragment:'#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif',tonemapping_fragment:'#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n',tonemapping_pars_fragment:'#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n',uv_pars_fragment:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif',uv_pars_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n',uv_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif',uv2_pars_fragment:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif',uv2_pars_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif',uv2_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif',worldpos_vertex:'#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n',background_frag:'uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}\n',background_vert:'varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}\n',cube_frag:'uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = envMapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}\n',cube_vert:'varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n',depth_frag:'#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n',depth_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',distanceRGBA_frag:'#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n',distanceRGBA_vert:'#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n',equirect_frag:'uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n',equirect_vert:'varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n',linedashed_frag:'uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',linedashed_vert:'uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n',meshbasic_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshbasic_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n',meshlambert_frag:'uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshlambert_vert:'#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshmatcap_frag:'#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\tvec4 matcapColor = texture2D( matcap, uv );\n\tmatcapColor = matcapTexelToLinear( matcapColor );\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshmatcap_vert:'#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}\n',meshphong_frag:'#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphong_vert:'#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshphysical_frag:'#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphysical_vert:'#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',normal_frag:'#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n',normal_vert:'#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n',points_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',points_vert:'uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n',shadow_frag:'uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n',shadow_vert:'#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',sprite_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',sprite_vert:'uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n'},kc={merge:function(rg){for(var ag={},og=0,ig;og<rg.length;og++)for(var ng in ig=this.clone(rg[og]),ig)ag[ng]=ig[ng];return ag},clone:function(rg){var ag={};for(var og in rg)for(var ig in ag[og]={},rg[og]){var ng=rg[og][ig];ag[og][ig]=ng&&(ng.isColor||ng.isMatrix3||ng.isMatrix4||ng.isVector2||ng.isVector3||ng.isVector4||ng.isTexture)?ng.clone():Array.isArray(ng)?ng.slice():ng}return ag}},Wc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(Y.prototype,{isColor:!0,r:1,g:1,b:1,set:function(rg){return rg&&rg.isColor?this.copy(rg):'number'==typeof rg?this.setHex(rg):'string'==typeof rg&&this.setStyle(rg),this},setScalar:function(rg){return this.r=rg,this.g=rg,this.b=rg,this},setHex:function(rg){return rg=Math.floor(rg),this.r=(255&rg>>16)/255,this.g=(255&rg>>8)/255,this.b=(255&rg)/255,this},setRGB:function(rg,ag,og){return this.r=rg,this.g=ag,this.b=og,this},setHSL:function(){function rg(ag,og,ig){return 0>ig&&(ig+=1),1<ig&&(ig-=1),ig<1/6?ag+6*(og-ag)*ig:ig<1/2?og:ig<2/3?ag+6*(og-ag)*(2/3-ig):ag}return function(og,ig,ng){if(og=Sp.euclideanModulo(og,1),ig=Sp.clamp(ig,0,1),ng=Sp.clamp(ng,0,1),0===ig)this.r=this.g=this.b=ng;else{var sg=0.5>=ng?ng*(1+ig):ng+ig-ng*ig,lg=2*ng-sg;this.r=rg(lg,sg,og+1/3),this.g=rg(lg,sg,og),this.b=rg(lg,sg,og-1/3)}return this}}(),setStyle:function(rg){function ag(ug){void 0===ug||1>parseFloat(ug)&&console.warn('THREE.Color: Alpha component of '+rg+' will be ignored.')}var og;if(og=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(rg)){var ng=og[1],sg=og[2],ig;switch(ng){case'rgb':case'rgba':if(ig=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(sg))return this.r=Math.min(255,parseInt(ig[1],10))/255,this.g=Math.min(255,parseInt(ig[2],10))/255,this.b=Math.min(255,parseInt(ig[3],10))/255,ag(ig[5]),this;if(ig=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(sg))return this.r=Math.min(100,parseInt(ig[1],10))/100,this.g=Math.min(100,parseInt(ig[2],10))/100,this.b=Math.min(100,parseInt(ig[3],10))/100,ag(ig[5]),this;break;case'hsl':case'hsla':if(ig=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(sg)){var lg=parseFloat(ig[1])/360,pg=parseInt(ig[2],10)/100,dg=parseInt(ig[3],10)/100;return ag(ig[5]),this.setHSL(lg,pg,dg)}}}else if(og=/^\#([A-Fa-f0-9]+)$/.exec(rg)){var cg=og[1],mg=cg.length;if(3===mg)return this.r=parseInt(cg.charAt(0)+cg.charAt(0),16)/255,this.g=parseInt(cg.charAt(1)+cg.charAt(1),16)/255,this.b=parseInt(cg.charAt(2)+cg.charAt(2),16)/255,this;if(6===mg)return this.r=parseInt(cg.charAt(0)+cg.charAt(1),16)/255,this.g=parseInt(cg.charAt(2)+cg.charAt(3),16)/255,this.b=parseInt(cg.charAt(4)+cg.charAt(5),16)/255,this}if(rg&&0<rg.length){var cg=Wc[rg];void 0===cg?console.warn('THREE.Color: Unknown color '+rg):this.setHex(cg)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(rg){return this.r=rg.r,this.g=rg.g,this.b=rg.b,this},copyGammaToLinear:function(rg,ag){return void 0===ag&&(ag=2),this.r=Math.pow(rg.r,ag),this.g=Math.pow(rg.g,ag),this.b=Math.pow(rg.b,ag),this},copyLinearToGamma:function(rg,ag){void 0===ag&&(ag=2);var og=0<ag?1/ag:1;return this.r=Math.pow(rg.r,og),this.g=Math.pow(rg.g,og),this.b=Math.pow(rg.b,og),this},convertGammaToLinear:function(rg){return this.copyGammaToLinear(this,rg),this},convertLinearToGamma:function(rg){return this.copyLinearToGamma(this,rg),this},copySRGBToLinear:function(){function rg(ag){return 0.04045>ag?0.0773993808*ag:Math.pow(0.9478672986*ag+0.0521327014,2.4)}return function(og){return this.r=rg(og.r),this.g=rg(og.g),this.b=rg(og.b),this}}(),copyLinearToSRGB:function(){function rg(ag){return 0.0031308>ag?12.92*ag:1.055*Math.pow(ag,0.41666)-0.055}return function(og){return this.r=rg(og.r),this.g=rg(og.g),this.b=rg(og.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function(rg){void 0===rg&&(console.warn('THREE.Color: .getHSL() target is now required'),rg={h:0,s:0,l:0});var ag=this.r,og=this.g,ig=this.b,ng=Math.max(ag,og,ig),sg=Math.min(ag,og,ig),dg=(sg+ng)/2,lg,pg;if(sg===ng)lg=0,pg=0;else{var cg=ng-sg;pg=0.5>=dg?cg/(ng+sg):cg/(2-ng-sg),ng===ag?lg=(og-ig)/cg+(og<ig?6:0):ng===og?lg=(ig-ag)/cg+2:ng===ig?lg=(ag-og)/cg+4:void 0,lg/=6}return rg.h=lg,rg.s=pg,rg.l=dg,rg},getStyle:function(){return'rgb('+(0|255*this.r)+','+(0|255*this.g)+','+(0|255*this.b)+')'},offsetHSL:function(){var rg={};return function(ag,og,ig){return this.getHSL(rg),rg.h+=ag,rg.s+=og,rg.l+=ig,this.setHSL(rg.h,rg.s,rg.l),this}}(),add:function(rg){return this.r+=rg.r,this.g+=rg.g,this.b+=rg.b,this},addColors:function(rg,ag){return this.r=rg.r+ag.r,this.g=rg.g+ag.g,this.b=rg.b+ag.b,this},addScalar:function(rg){return this.r+=rg,this.g+=rg,this.b+=rg,this},sub:function(rg){return this.r=Math.max(0,this.r-rg.r),this.g=Math.max(0,this.g-rg.g),this.b=Math.max(0,this.b-rg.b),this},multiply:function(rg){return this.r*=rg.r,this.g*=rg.g,this.b*=rg.b,this},multiplyScalar:function(rg){return this.r*=rg,this.g*=rg,this.b*=rg,this},lerp:function(rg,ag){return this.r+=(rg.r-this.r)*ag,this.g+=(rg.g-this.g)*ag,this.b+=(rg.b-this.b)*ag,this},lerpHSL:function(){var rg={h:0,s:0,l:0},ag={h:0,s:0,l:0};return function(ig,ng){this.getHSL(rg),ig.getHSL(ag);var sg=Sp.lerp(rg.h,ag.h,ng),lg=Sp.lerp(rg.s,ag.s,ng),pg=Sp.lerp(rg.l,ag.l,ng);return this.setHSL(sg,lg,pg),this}}(),equals:function(rg){return rg.r===this.r&&rg.g===this.g&&rg.b===this.b},fromArray:function(rg,ag){return void 0===ag&&(ag=0),this.r=rg[ag],this.g=rg[ag+1],this.b=rg[ag+2],this},toArray:function(rg,ag){return void 0===rg&&(rg=[]),void 0===ag&&(ag=0),rg[ag]=this.r,rg[ag+1]=this.g,rg[ag+2]=this.b,rg},toJSON:function(){return this.getHex()}});var jc={common:{diffuse:{value:new Y(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new R},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:0.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new E(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5e-4},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Y(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Y(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new R}},sprite:{diffuse:{value:new Y(15658734)},opacity:{value:1},center:{value:new E(0.5,0.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new R}}},qc={basic:{uniforms:kc.merge([jc.common,jc.specularmap,jc.envmap,jc.aomap,jc.lightmap,jc.fog]),vertexShader:Vc.meshbasic_vert,fragmentShader:Vc.meshbasic_frag},lambert:{uniforms:kc.merge([jc.common,jc.specularmap,jc.envmap,jc.aomap,jc.lightmap,jc.emissivemap,jc.fog,jc.lights,{emissive:{value:new Y(0)}}]),vertexShader:Vc.meshlambert_vert,fragmentShader:Vc.meshlambert_frag},phong:{uniforms:kc.merge([jc.common,jc.specularmap,jc.envmap,jc.aomap,jc.lightmap,jc.emissivemap,jc.bumpmap,jc.normalmap,jc.displacementmap,jc.gradientmap,jc.fog,jc.lights,{emissive:{value:new Y(0)},specular:{value:new Y(1118481)},shininess:{value:30}}]),vertexShader:Vc.meshphong_vert,fragmentShader:Vc.meshphong_frag},standard:{uniforms:kc.merge([jc.common,jc.envmap,jc.aomap,jc.lightmap,jc.emissivemap,jc.bumpmap,jc.normalmap,jc.displacementmap,jc.roughnessmap,jc.metalnessmap,jc.fog,jc.lights,{emissive:{value:new Y(0)},roughness:{value:0.5},metalness:{value:0.5},envMapIntensity:{value:1}}]),vertexShader:Vc.meshphysical_vert,fragmentShader:Vc.meshphysical_frag},matcap:{uniforms:kc.merge([jc.common,jc.bumpmap,jc.normalmap,jc.displacementmap,jc.fog,{matcap:{value:null}}]),vertexShader:Vc.meshmatcap_vert,fragmentShader:Vc.meshmatcap_frag},points:{uniforms:kc.merge([jc.points,jc.fog]),vertexShader:Vc.points_vert,fragmentShader:Vc.points_frag},dashed:{uniforms:kc.merge([jc.common,jc.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vc.linedashed_vert,fragmentShader:Vc.linedashed_frag},depth:{uniforms:kc.merge([jc.common,jc.displacementmap]),vertexShader:Vc.depth_vert,fragmentShader:Vc.depth_frag},normal:{uniforms:kc.merge([jc.common,jc.bumpmap,jc.normalmap,jc.displacementmap,{opacity:{value:1}}]),vertexShader:Vc.normal_vert,fragmentShader:Vc.normal_frag},sprite:{uniforms:kc.merge([jc.sprite,jc.fog]),vertexShader:Vc.sprite_vert,fragmentShader:Vc.sprite_frag},background:{uniforms:{uvTransform:{value:new R},t2D:{value:null}},vertexShader:Vc.background_vert,fragmentShader:Vc.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Vc.cube_vert,fragmentShader:Vc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vc.equirect_vert,fragmentShader:Vc.equirect_frag},distanceRGBA:{uniforms:kc.merge([jc.common,jc.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vc.distanceRGBA_vert,fragmentShader:Vc.distanceRGBA_frag},shadow:{uniforms:kc.merge([jc.lights,jc.fog,{color:{value:new Y(0)},opacity:{value:1}}]),vertexShader:Vc.shadow_vert,fragmentShader:Vc.shadow_frag}};qc.physical={uniforms:kc.merge([qc.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Vc.meshphysical_vert,fragmentShader:Vc.meshphysical_frag},Object.assign(J.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(rg){this.a=rg.a,this.b=rg.b,this.c=rg.c,this.normal.copy(rg.normal),this.color.copy(rg.color),this.materialIndex=rg.materialIndex;for(var ag=0,og=rg.vertexNormals.length;ag<og;ag++)this.vertexNormals[ag]=rg.vertexNormals[ag].clone();for(var ag=0,og=rg.vertexColors.length;ag<og;ag++)this.vertexColors[ag]=rg.vertexColors[ag].clone();return this}}),Q.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],Q.DefaultOrder='XYZ',Object.defineProperties(Q.prototype,{x:{get:function(){return this._x},set:function(rg){this._x=rg,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(rg){this._y=rg,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(rg){this._z=rg,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(rg){this._order=rg,this.onChangeCallback()}}}),Object.assign(Q.prototype,{isEuler:!0,set:function(rg,ag,og,ig){return this._x=rg,this._y=ag,this._z=og,this._order=ig||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(rg){return this._x=rg._x,this._y=rg._y,this._z=rg._z,this._order=rg._order,this.onChangeCallback(),this},setFromRotationMatrix:function(rg,ag,og){var ig=Sp.clamp,ng=rg.elements,sg=ng[0],lg=ng[4],pg=ng[8],dg=ng[1],cg=ng[5],mg=ng[9],ug=ng[2],gg=ng[6],fg=ng[10];return ag=ag||this._order,'XYZ'===ag?(this._y=Math.asin(ig(pg,-1,1)),0.99999>Math.abs(pg)?(this._x=Math.atan2(-mg,fg),this._z=Math.atan2(-lg,sg)):(this._x=Math.atan2(gg,cg),this._z=0)):'YXZ'===ag?(this._x=Math.asin(-ig(mg,-1,1)),0.99999>Math.abs(mg)?(this._y=Math.atan2(pg,fg),this._z=Math.atan2(dg,cg)):(this._y=Math.atan2(-ug,sg),this._z=0)):'ZXY'===ag?(this._x=Math.asin(ig(gg,-1,1)),0.99999>Math.abs(gg)?(this._y=Math.atan2(-ug,fg),this._z=Math.atan2(-lg,cg)):(this._y=0,this._z=Math.atan2(dg,sg))):'ZYX'===ag?(this._y=Math.asin(-ig(ug,-1,1)),0.99999>Math.abs(ug)?(this._x=Math.atan2(gg,fg),this._z=Math.atan2(dg,sg)):(this._x=0,this._z=Math.atan2(-lg,cg))):'YZX'===ag?(this._z=Math.asin(ig(dg,-1,1)),0.99999>Math.abs(dg)?(this._x=Math.atan2(-mg,cg),this._y=Math.atan2(-ug,sg)):(this._x=0,this._y=Math.atan2(pg,fg))):'XZY'===ag?(this._z=Math.asin(-ig(lg,-1,1)),0.99999>Math.abs(lg)?(this._x=Math.atan2(gg,cg),this._y=Math.atan2(pg,sg)):(this._x=Math.atan2(-mg,fg),this._y=0)):console.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: '+ag),this._order=ag,!1!==og&&this.onChangeCallback(),this},setFromQuaternion:function(){var rg=new L;return function(og,ig,ng){return rg.makeRotationFromQuaternion(og),this.setFromRotationMatrix(rg,ig,ng)}}(),setFromVector3:function(rg,ag){return this.set(rg.x,rg.y,rg.z,ag||this._order)},reorder:function(){var rg=new A;return function(og){return rg.setFromEuler(this),this.setFromQuaternion(rg,og)}}(),equals:function(rg){return rg._x===this._x&&rg._y===this._y&&rg._z===this._z&&rg._order===this._order},fromArray:function(rg){return this._x=rg[0],this._y=rg[1],this._z=rg[2],void 0!==rg[3]&&(this._order=rg[3]),this.onChangeCallback(),this},toArray:function(rg,ag){return void 0===rg&&(rg=[]),void 0===ag&&(ag=0),rg[ag]=this._x,rg[ag+1]=this._y,rg[ag+2]=this._z,rg[ag+3]=this._order,rg},toVector3:function(rg){return rg?rg.set(this._x,this._y,this._z):new C(this._x,this._y,this._z)},onChange:function(rg){return this.onChangeCallback=rg,this},onChangeCallback:function(){}}),Object.assign(K.prototype,{set:function(rg){this.mask=0|1<<rg},enable:function(rg){this.mask|=0|1<<rg},toggle:function(rg){this.mask^=0|1<<rg},disable:function(rg){this.mask&=~(0|1<<rg)},test:function(rg){return 0!=(this.mask&rg.mask)}});var Yc=0;ee.DefaultUp=new C(0,1,0),ee.DefaultMatrixAutoUpdate=!0,ee.prototype=Object.assign(Object.create(M.prototype),{constructor:ee,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(rg){this.matrix.multiplyMatrices(rg,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(rg){return this.quaternion.premultiply(rg),this},setRotationFromAxisAngle:function(rg,ag){this.quaternion.setFromAxisAngle(rg,ag)},setRotationFromEuler:function(rg){this.quaternion.setFromEuler(rg,!0)},setRotationFromMatrix:function(rg){this.quaternion.setFromRotationMatrix(rg)},setRotationFromQuaternion:function(rg){this.quaternion.copy(rg)},rotateOnAxis:function(){var rg=new A;return function(og,ig){return rg.setFromAxisAngle(og,ig),this.quaternion.multiply(rg),this}}(),rotateOnWorldAxis:function(){var rg=new A;return function(og,ig){return rg.setFromAxisAngle(og,ig),this.quaternion.premultiply(rg),this}}(),rotateX:function(){var rg=new C(1,0,0);return function(og){return this.rotateOnAxis(rg,og)}}(),rotateY:function(){var rg=new C(0,1,0);return function(og){return this.rotateOnAxis(rg,og)}}(),rotateZ:function(){var rg=new C(0,0,1);return function(og){return this.rotateOnAxis(rg,og)}}(),translateOnAxis:function(){var rg=new C;return function(og,ig){return rg.copy(og).applyQuaternion(this.quaternion),this.position.add(rg.multiplyScalar(ig)),this}}(),translateX:function(){var rg=new C(1,0,0);return function(og){return this.translateOnAxis(rg,og)}}(),translateY:function(){var rg=new C(0,1,0);return function(og){return this.translateOnAxis(rg,og)}}(),translateZ:function(){var rg=new C(0,0,1);return function(og){return this.translateOnAxis(rg,og)}}(),localToWorld:function(rg){return rg.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var rg=new L;return function(og){return og.applyMatrix4(rg.getInverse(this.matrixWorld))}}(),lookAt:function(){var rg=new A,ag=new L,og=new C,ig=new C;return function(sg,lg,pg){sg.isVector3?og.copy(sg):og.set(sg,lg,pg);var dg=this.parent;this.updateWorldMatrix(!0,!1),ig.setFromMatrixPosition(this.matrixWorld),this.isCamera?ag.lookAt(ig,og,this.up):ag.lookAt(og,ig,this.up),this.quaternion.setFromRotationMatrix(ag),dg&&(ag.extractRotation(dg.matrixWorld),rg.setFromRotationMatrix(ag),this.quaternion.premultiply(rg.inverse()))}}(),add:function(rg){if(1<arguments.length){for(var ag=0;ag<arguments.length;ag++)this.add(arguments[ag]);return this}return rg===this?(console.error('THREE.Object3D.add: object can\'t be added as a child of itself.',rg),this):(rg&&rg.isObject3D?(null!==rg.parent&&rg.parent.remove(rg),rg.parent=this,rg.dispatchEvent({type:'added'}),this.children.push(rg)):console.error('THREE.Object3D.add: object not an instance of THREE.Object3D.',rg),this)},remove:function(rg){if(1<arguments.length){for(var ag=0;ag<arguments.length;ag++)this.remove(arguments[ag]);return this}var og=this.children.indexOf(rg);return-1!==og&&(rg.parent=null,rg.dispatchEvent({type:'removed'}),this.children.splice(og,1)),this},getObjectById:function(rg){return this.getObjectByProperty('id',rg)},getObjectByName:function(rg){return this.getObjectByProperty('name',rg)},getObjectByProperty:function(rg,ag){if(this[rg]===ag)return this;for(var og=0,ig=this.children.length;og<ig;og++){var ng=this.children[og],sg=ng.getObjectByProperty(rg,ag);if(void 0!==sg)return sg}},getWorldPosition:function(rg){return void 0===rg&&(console.warn('THREE.Object3D: .getWorldPosition() target is now required'),rg=new C),this.updateMatrixWorld(!0),rg.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var rg=new C,ag=new C;return function(ig){return void 0===ig&&(console.warn('THREE.Object3D: .getWorldQuaternion() target is now required'),ig=new A),this.updateMatrixWorld(!0),this.matrixWorld.decompose(rg,ig,ag),ig}}(),getWorldScale:function(){var rg=new C,ag=new A;return function(ig){return void 0===ig&&(console.warn('THREE.Object3D: .getWorldScale() target is now required'),ig=new C),this.updateMatrixWorld(!0),this.matrixWorld.decompose(rg,ag,ig),ig}}(),getWorldDirection:function(rg){void 0===rg&&(console.warn('THREE.Object3D: .getWorldDirection() target is now required'),rg=new C),this.updateMatrixWorld(!0);var ag=this.matrixWorld.elements;return rg.set(ag[8],ag[9],ag[10]).normalize()},raycast:function(){},traverse:function(rg){rg(this);for(var ag=this.children,og=0,ig=ag.length;og<ig;og++)ag[og].traverse(rg)},traverseVisible:function(rg){if(!1!==this.visible){rg(this);for(var ag=this.children,og=0,ig=ag.length;og<ig;og++)ag[og].traverseVisible(rg)}},traverseAncestors:function(rg){var ag=this.parent;null!==ag&&(rg(ag),ag.traverseAncestors(rg))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(rg){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||rg)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,rg=!0);for(var ag=this.children,og=0,ig=ag.length;og<ig;og++)ag[og].updateMatrixWorld(rg)},updateWorldMatrix:function(rg,ag){var og=this.parent;if(!0===rg&&null!==og&&og.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===ag)for(var ig=this.children,ng=0,sg=ig.length;ng<sg;ng++)ig[ng].updateWorldMatrix(!1,!0)},toJSON:function(rg){function ag(xg,vg){return void 0===xg[vg.uuid]&&(xg[vg.uuid]=vg.toJSON(rg)),vg.uuid}function og(xg){var vg=[];for(var _g in xg){var bg=xg[_g];delete bg.metadata,vg.push(bg)}return vg}var ig=void 0===rg||'string'==typeof rg,ng={};ig&&(rg={geometries:{},materials:{},textures:{},images:{},shapes:{}},ng.metadata={version:4.5,type:'Object',generator:'Object3D.toJSON'});var sg={};if(sg.uuid=this.uuid,sg.type=this.type,''!==this.name&&(sg.name=this.name),!0===this.castShadow&&(sg.castShadow=!0),!0===this.receiveShadow&&(sg.receiveShadow=!0),!1===this.visible&&(sg.visible=!1),!1===this.frustumCulled&&(sg.frustumCulled=!1),0!==this.renderOrder&&(sg.renderOrder=this.renderOrder),'{}'!==JSON.stringify(this.userData)&&(sg.userData=this.userData),sg.layers=this.layers.mask,sg.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(sg.matrixAutoUpdate=!1),this.isMesh||this.isLine||this.isPoints){sg.geometry=ag(rg.geometries,this.geometry);var lg=this.geometry.parameters;if(void 0!==lg&&void 0!==lg.shapes){var pg=lg.shapes;if(Array.isArray(pg))for(var dg=0,cg=pg.length,mg;dg<cg;dg++)mg=pg[dg],ag(rg.shapes,mg);else ag(rg.shapes,pg)}}if(void 0!==this.material)if(Array.isArray(this.material)){for(var ug=[],dg=0,cg=this.material.length;dg<cg;dg++)ug.push(ag(rg.materials,this.material[dg]));sg.material=ug}else sg.material=ag(rg.materials,this.material);if(0<this.children.length){sg.children=[];for(var dg=0;dg<this.children.length;dg++)sg.children.push(this.children[dg].toJSON(rg).object)}if(ig){var gg=og(rg.geometries),fg=og(rg.materials),hg=og(rg.textures),yg=og(rg.images),pg=og(rg.shapes);0<gg.length&&(ng.geometries=gg),0<fg.length&&(ng.materials=fg),0<hg.length&&(ng.textures=hg),0<yg.length&&(ng.images=yg),0<pg.length&&(ng.shapes=pg)}return ng.object=sg,ng},clone:function(rg){return new this.constructor().copy(this,rg)},copy:function(rg,ag){if(void 0===ag&&(ag=!0),this.name=rg.name,this.up.copy(rg.up),this.position.copy(rg.position),this.quaternion.copy(rg.quaternion),this.scale.copy(rg.scale),this.matrix.copy(rg.matrix),this.matrixWorld.copy(rg.matrixWorld),this.matrixAutoUpdate=rg.matrixAutoUpdate,this.matrixWorldNeedsUpdate=rg.matrixWorldNeedsUpdate,this.layers.mask=rg.layers.mask,this.visible=rg.visible,this.castShadow=rg.castShadow,this.receiveShadow=rg.receiveShadow,this.frustumCulled=rg.frustumCulled,this.renderOrder=rg.renderOrder,this.userData=JSON.parse(JSON.stringify(rg.userData)),!0===ag)for(var og=0,ig;og<rg.children.length;og++)ig=rg.children[og],this.add(ig.clone());return this}});var Xc=0;re.prototype=Object.assign(Object.create(M.prototype),{constructor:re,isGeometry:!0,applyMatrix:function(rg){for(var ag=new R().getNormalMatrix(rg),og=0,ig=this.vertices.length,ng;og<ig;og++)ng=this.vertices[og],ng.applyMatrix4(rg);for(var og=0,ig=this.faces.length,sg;og<ig;og++){sg=this.faces[og],sg.normal.applyMatrix3(ag).normalize();for(var lg=0,pg=sg.vertexNormals.length;lg<pg;lg++)sg.vertexNormals[lg].applyMatrix3(ag).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var rg=new L;return function(og){return rg.makeRotationX(og),this.applyMatrix(rg),this}}(),rotateY:function(){var rg=new L;return function(og){return rg.makeRotationY(og),this.applyMatrix(rg),this}}(),rotateZ:function(){var rg=new L;return function(og){return rg.makeRotationZ(og),this.applyMatrix(rg),this}}(),translate:function(){var rg=new L;return function(og,ig,ng){return rg.makeTranslation(og,ig,ng),this.applyMatrix(rg),this}}(),scale:function(){var rg=new L;return function(og,ig,ng){return rg.makeScale(og,ig,ng),this.applyMatrix(rg),this}}(),lookAt:function(){var rg=new ee;return function(og){rg.lookAt(og),rg.updateMatrix(),this.applyMatrix(rg.matrix)}}(),fromBufferGeometry:function(rg){function ag(vg,_g,bg,Sg){var Mg=void 0===pg?[]:[og.colors[vg].clone(),og.colors[_g].clone(),og.colors[bg].clone()],Tg=void 0===lg?[]:[new C().fromArray(lg,3*vg),new C().fromArray(lg,3*_g),new C().fromArray(lg,3*bg)],Eg=new J(vg,_g,bg,Tg,Mg,Sg);og.faces.push(Eg),void 0!==dg&&og.faceVertexUvs[0].push([new E().fromArray(dg,2*vg),new E().fromArray(dg,2*_g),new E().fromArray(dg,2*bg)]),void 0!==cg&&og.faceVertexUvs[1].push([new E().fromArray(cg,2*vg),new E().fromArray(cg,2*_g),new E().fromArray(cg,2*bg)])}var og=this,ig=null===rg.index?void 0:rg.index.array,ng=rg.attributes,sg=ng.position.array,lg=void 0===ng.normal?void 0:ng.normal.array,pg=void 0===ng.color?void 0:ng.color.array,dg=void 0===ng.uv?void 0:ng.uv.array,cg=void 0===ng.uv2?void 0:ng.uv2.array;void 0!==cg&&(this.faceVertexUvs[1]=[]);for(var mg=0,ug=0;mg<sg.length;mg+=3,ug+=2)og.vertices.push(new C().fromArray(sg,mg)),void 0!==pg&&og.colors.push(new Y().fromArray(pg,mg));var gg=rg.groups;if(0<gg.length)for(var mg=0;mg<gg.length;mg++)for(var fg=gg[mg],hg=fg.start,yg=fg.count,ug=hg;ug<hg+yg;ug+=3)void 0===ig?ag(ug,ug+1,ug+2,fg.materialIndex):ag(ig[ug],ig[ug+1],ig[ug+2],fg.materialIndex);else if(void 0!==ig)for(var mg=0;mg<ig.length;mg+=3)ag(ig[mg],ig[mg+1],ig[mg+2]);else for(var mg=0;mg<sg.length/3;mg+=3)ag(mg,mg+1,mg+2);return this.computeFaceNormals(),null!==rg.boundingBox&&(this.boundingBox=rg.boundingBox.clone()),null!==rg.boundingSphere&&(this.boundingSphere=rg.boundingSphere.clone()),this},center:function(){var rg=new C;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(rg).negate(),this.translate(rg.x,rg.y,rg.z),this}}(),normalize:function(){this.computeBoundingSphere();var rg=this.boundingSphere.center,ag=this.boundingSphere.radius,og=0===ag?1:1/ag,ig=new L;return ig.set(og,0,0,-og*rg.x,0,og,0,-og*rg.y,0,0,og,-og*rg.z,0,0,0,1),this.applyMatrix(ig),this},computeFaceNormals:function(){for(var rg=new C,ag=new C,og=0,ig=this.faces.length;og<ig;og++){var ng=this.faces[og],sg=this.vertices[ng.a],lg=this.vertices[ng.b],pg=this.vertices[ng.c];rg.subVectors(pg,lg),ag.subVectors(sg,lg),rg.cross(ag),rg.normalize(),ng.normal.copy(rg)}},computeVertexNormals:function(rg){void 0===rg&&(rg=!0);var ag,og,ig,ng,sg,lg;for(lg=Array(this.vertices.length),ag=0,og=this.vertices.length;ag<og;ag++)lg[ag]=new C;if(rg){var mg=new C,ug=new C,pg,dg,cg;for(ig=0,ng=this.faces.length;ig<ng;ig++)sg=this.faces[ig],pg=this.vertices[sg.a],dg=this.vertices[sg.b],cg=this.vertices[sg.c],mg.subVectors(cg,dg),ug.subVectors(pg,dg),mg.cross(ug),lg[sg.a].add(mg),lg[sg.b].add(mg),lg[sg.c].add(mg)}else for(this.computeFaceNormals(),ig=0,ng=this.faces.length;ig<ng;ig++)sg=this.faces[ig],lg[sg.a].add(sg.normal),lg[sg.b].add(sg.normal),lg[sg.c].add(sg.normal);for(ag=0,og=this.vertices.length;ag<og;ag++)lg[ag].normalize();for(ig=0,ng=this.faces.length;ig<ng;ig++){sg=this.faces[ig];var gg=sg.vertexNormals;3===gg.length?(gg[0].copy(lg[sg.a]),gg[1].copy(lg[sg.b]),gg[2].copy(lg[sg.c])):(gg[0]=lg[sg.a].clone(),gg[1]=lg[sg.b].clone(),gg[2]=lg[sg.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var rg,ag,og;for(this.computeFaceNormals(),rg=0,ag=this.faces.length;rg<ag;rg++){og=this.faces[rg];var ig=og.vertexNormals;3===ig.length?(ig[0].copy(og.normal),ig[1].copy(og.normal),ig[2].copy(og.normal)):(ig[0]=og.normal.clone(),ig[1]=og.normal.clone(),ig[2]=og.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var rg,ag,og,ig,ng;for(og=0,ig=this.faces.length;og<ig;og++)for(ng=this.faces[og],ng.__originalFaceNormal?ng.__originalFaceNormal.copy(ng.normal):ng.__originalFaceNormal=ng.normal.clone(),ng.__originalVertexNormals||(ng.__originalVertexNormals=[]),(rg=0,ag=ng.vertexNormals.length);rg<ag;rg++)ng.__originalVertexNormals[rg]?ng.__originalVertexNormals[rg].copy(ng.vertexNormals[rg]):ng.__originalVertexNormals[rg]=ng.vertexNormals[rg].clone();var sg=new re;for(sg.faces=this.faces,rg=0,ag=this.morphTargets.length;rg<ag;rg++){if(!this.morphNormals[rg]){this.morphNormals[rg]={},this.morphNormals[rg].faceNormals=[],this.morphNormals[rg].vertexNormals=[];var lg=this.morphNormals[rg].faceNormals,pg=this.morphNormals[rg].vertexNormals,dg,cg;for(og=0,ig=this.faces.length;og<ig;og++)dg=new C,cg={a:new C,b:new C,c:new C},lg.push(dg),pg.push(cg)}var mg=this.morphNormals[rg];sg.vertices=this.morphTargets[rg].vertices,sg.computeFaceNormals(),sg.computeVertexNormals();var dg,cg;for(og=0,ig=this.faces.length;og<ig;og++)ng=this.faces[og],dg=mg.faceNormals[og],cg=mg.vertexNormals[og],dg.copy(ng.normal),cg.a.copy(ng.vertexNormals[0]),cg.b.copy(ng.vertexNormals[1]),cg.c.copy(ng.vertexNormals[2])}for(og=0,ig=this.faces.length;og<ig;og++)ng=this.faces[og],ng.normal=ng.__originalFaceNormal,ng.vertexNormals=ng.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new F),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new H),this.boundingSphere.setFromPoints(this.vertices)},merge:function(rg,ag,og){if(!(rg&&rg.isGeometry))return void console.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.',rg);var ng=this.vertices.length,sg=this.vertices,lg=rg.vertices,pg=this.faces,dg=rg.faces,cg=this.faceVertexUvs[0],mg=rg.faceVertexUvs[0],ug=this.colors,gg=rg.colors,ig;void 0===og&&(og=0),void 0!==ag&&(ig=new R().getNormalMatrix(ag));for(var fg=0,hg=lg.length;fg<hg;fg++){var yg=lg[fg],xg=yg.clone();void 0!==ag&&xg.applyMatrix4(ag),sg.push(xg)}for(var fg=0,hg=gg.length;fg<hg;fg++)ug.push(gg[fg].clone());for(fg=0,hg=dg.length;fg<hg;fg++){var vg=dg[fg],Mg=vg.vertexNormals,Tg=vg.vertexColors,_g,bg,Sg;_g=new J(vg.a+ng,vg.b+ng,vg.c+ng),_g.normal.copy(vg.normal),void 0!=ig&&_g.normal.applyMatrix3(ig).normalize();for(var Eg=0,wg=Mg.length;Eg<wg;Eg++)bg=Mg[Eg].clone(),void 0!=ig&&bg.applyMatrix3(ig).normalize(),_g.vertexNormals.push(bg);_g.color.copy(vg.color);for(var Eg=0,wg=Tg.length;Eg<wg;Eg++)Sg=Tg[Eg],_g.vertexColors.push(Sg.clone());_g.materialIndex=vg.materialIndex+og,pg.push(_g)}for(fg=0,hg=mg.length;fg<hg;fg++){var Lg=mg[fg],Pg=[];if(void 0!==Lg){for(var Eg=0,wg=Lg.length;Eg<wg;Eg++)Pg.push(Lg[Eg].clone());cg.push(Pg)}}},mergeMesh:function(rg){return rg&&rg.isMesh?void(rg.matrixAutoUpdate&&rg.updateMatrix(),this.merge(rg.geometry,rg.matrix)):void console.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.',rg)},mergeVertices:function(){var rg={},ag=[],og=[],lg=Math.pow(10,4),ig,ng,pg,dg,cg,mg,ug,gg;for(pg=0,dg=this.vertices.length;pg<dg;pg++)ig=this.vertices[pg],ng=Math.round(ig.x*lg)+'_'+Math.round(ig.y*lg)+'_'+Math.round(ig.z*lg),void 0===rg[ng]?(rg[ng]=pg,ag.push(this.vertices[pg]),og[pg]=ag.length-1):og[pg]=og[rg[ng]];var fg=[];for(pg=0,dg=this.faces.length;pg<dg;pg++){cg=this.faces[pg],cg.a=og[cg.a],cg.b=og[cg.b],cg.c=og[cg.c],mg=[cg.a,cg.b,cg.c];for(var hg=0;3>hg;hg++)if(mg[hg]===mg[(hg+1)%3]){fg.push(pg);break}}for(pg=fg.length-1;0<=pg;pg--){var yg=fg[pg];for(this.faces.splice(yg,1),ug=0,gg=this.faceVertexUvs.length;ug<gg;ug++)this.faceVertexUvs[ug].splice(yg,1)}var xg=this.vertices.length-ag.length;return this.vertices=ag,xg},setFromPoints:function(rg){this.vertices=[];for(var ag=0,og=rg.length,ig;ag<og;ag++)ig=rg[ag],this.vertices.push(new C(ig.x,ig.y,ig.z||0));return this},sortFacesByMaterialIndex:function(){for(var ag=this.faces,og=ag.length,ig=0;ig<og;ig++)ag[ig]._id=ig;ag.sort(function(cg,mg){return cg.materialIndex-mg.materialIndex});var ng=this.faceVertexUvs[0],sg=this.faceVertexUvs[1],lg,pg;ng&&ng.length===og&&(lg=[]),sg&&sg.length===og&&(pg=[]);for(var ig=0,dg;ig<og;ig++)dg=ag[ig]._id,lg&&lg.push(ng[dg]),pg&&pg.push(sg[dg]);lg&&(this.faceVertexUvs[0]=lg),pg&&(this.faceVertexUvs[1]=pg)},toJSON:function(){function rg(Rg,Ig,zg){return zg?Rg|1<<Ig:Rg&~(1<<Ig)}function ag(Rg){var Ig=Rg.x.toString()+Rg.y.toString()+Rg.z.toString();return void 0===gg[Ig]?(gg[Ig]=ug.length/3,ug.push(Rg.x,Rg.y,Rg.z),gg[Ig]):gg[Ig]}function og(Rg){var Ig=Rg.r.toString()+Rg.g.toString()+Rg.b.toString();return void 0===hg[Ig]?(hg[Ig]=fg.length,fg.push(Rg.getHex()),hg[Ig]):hg[Ig]}function ig(Rg){var Ig=Rg.x.toString()+Rg.y.toString();return void 0===xg[Ig]?(xg[Ig]=yg.length/2,yg.push(Rg.x,Rg.y),xg[Ig]):xg[Ig]}var ng={metadata:{version:4.5,type:'Geometry',generator:'Geometry.toJSON'}};if(ng.uuid=this.uuid,ng.type=this.type,''!==this.name&&(ng.name=this.name),void 0!==this.parameters){var sg=this.parameters;for(var lg in sg)void 0!==sg[lg]&&(ng[lg]=sg[lg]);return ng}for(var pg=[],dg=0,cg;dg<this.vertices.length;dg++)cg=this.vertices[dg],pg.push(cg.x,cg.y,cg.z);for(var mg=[],ug=[],gg={},fg=[],hg={},yg=[],xg={},dg=0;dg<this.faces.length;dg++){var vg=this.faces[dg],Sg=void 0!==this.faceVertexUvs[0][dg],Mg=0<vg.normal.length(),Tg=0<vg.vertexNormals.length,Eg=1!==vg.color.r||1!==vg.color.g||1!==vg.color.b,wg=0<vg.vertexColors.length,Lg=0;if(Lg=rg(Lg,0,0),Lg=rg(Lg,1,!0),Lg=rg(Lg,2,!1),Lg=rg(Lg,3,Sg),Lg=rg(Lg,4,Mg),Lg=rg(Lg,5,Tg),Lg=rg(Lg,6,Eg),Lg=rg(Lg,7,wg),mg.push(Lg),mg.push(vg.a,vg.b,vg.c),mg.push(vg.materialIndex),Sg){var Pg=this.faceVertexUvs[0][dg];mg.push(ig(Pg[0]),ig(Pg[1]),ig(Pg[2]))}if(Mg&&mg.push(ag(vg.normal)),Tg){var Ag=vg.vertexNormals;mg.push(ag(Ag[0]),ag(Ag[1]),ag(Ag[2]))}if(Eg&&mg.push(og(vg.color)),wg){var Cg=vg.vertexColors;mg.push(og(Cg[0]),og(Cg[1]),og(Cg[2]))}}return ng.data={},ng.data.vertices=pg,ng.data.normals=ug,0<fg.length&&(ng.data.colors=fg),0<yg.length&&(ng.data.uvs=[yg]),ng.data.faces=mg,ng},clone:function(){return new re().copy(this)},copy:function(rg){var ag,og,ig,ng,sg,lg;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=rg.name;var pg=rg.vertices;for(ag=0,og=pg.length;ag<og;ag++)this.vertices.push(pg[ag].clone());var dg=rg.colors;for(ag=0,og=dg.length;ag<og;ag++)this.colors.push(dg[ag].clone());var cg=rg.faces;for(ag=0,og=cg.length;ag<og;ag++)this.faces.push(cg[ag].clone());for(ag=0,og=rg.faceVertexUvs.length;ag<og;ag++){var mg=rg.faceVertexUvs[ag];for(void 0===this.faceVertexUvs[ag]&&(this.faceVertexUvs[ag]=[]),ig=0,ng=mg.length;ig<ng;ig++){var ug=mg[ig],gg=[];for(sg=0,lg=ug.length;sg<lg;sg++){var fg=ug[sg];gg.push(fg.clone())}this.faceVertexUvs[ag].push(gg)}}var hg=rg.morphTargets;for(ag=0,og=hg.length;ag<og;ag++){var yg={name:hg[ag].name};if(void 0!==hg[ag].vertices)for(yg.vertices=[],ig=0,ng=hg[ag].vertices.length;ig<ng;ig++)yg.vertices.push(hg[ag].vertices[ig].clone());if(void 0!==hg[ag].normals)for(yg.normals=[],ig=0,ng=hg[ag].normals.length;ig<ng;ig++)yg.normals.push(hg[ag].normals[ig].clone());this.morphTargets.push(yg)}var xg=rg.morphNormals;for(ag=0,og=xg.length;ag<og;ag++){var vg={};if(void 0!==xg[ag].vertexNormals)for(vg.vertexNormals=[],ig=0,ng=xg[ag].vertexNormals.length;ig<ng;ig++){var _g=xg[ag].vertexNormals[ig],bg={};bg.a=_g.a.clone(),bg.b=_g.b.clone(),bg.c=_g.c.clone(),vg.vertexNormals.push(bg)}if(void 0!==xg[ag].faceNormals)for(vg.faceNormals=[],ig=0,ng=xg[ag].faceNormals.length;ig<ng;ig++)vg.faceNormals.push(xg[ag].faceNormals[ig].clone());this.morphNormals.push(vg)}var Sg=rg.skinWeights;for(ag=0,og=Sg.length;ag<og;ag++)this.skinWeights.push(Sg[ag].clone());var Mg=rg.skinIndices;for(ag=0,og=Mg.length;ag<og;ag++)this.skinIndices.push(Mg[ag].clone());var Tg=rg.lineDistances;for(ag=0,og=Tg.length;ag<og;ag++)this.lineDistances.push(Tg[ag]);var Eg=rg.boundingBox;null!==Eg&&(this.boundingBox=Eg.clone());var wg=rg.boundingSphere;return null!==wg&&(this.boundingSphere=wg.clone()),this.elementsNeedUpdate=rg.elementsNeedUpdate,this.verticesNeedUpdate=rg.verticesNeedUpdate,this.uvsNeedUpdate=rg.uvsNeedUpdate,this.normalsNeedUpdate=rg.normalsNeedUpdate,this.colorsNeedUpdate=rg.colorsNeedUpdate,this.lineDistancesNeedUpdate=rg.lineDistancesNeedUpdate,this.groupsNeedUpdate=rg.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),Object.defineProperty(oe.prototype,'needsUpdate',{set:function(rg){!0===rg&&this.version++}}),Object.assign(oe.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(rg){if(Array.isArray(rg))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');return this.count=void 0===rg?0:rg.length/this.itemSize,this.array=rg,this},setDynamic:function(rg){return this.dynamic=rg,this},copy:function(rg){return this.name=rg.name,this.array=new rg.array.constructor(rg.array),this.itemSize=rg.itemSize,this.count=rg.count,this.normalized=rg.normalized,this.dynamic=rg.dynamic,this},copyAt:function(rg,ag,og){rg*=this.itemSize,og*=ag.itemSize;for(var ig=0,ng=this.itemSize;ig<ng;ig++)this.array[rg+ig]=ag.array[og+ig];return this},copyArray:function(rg){return this.array.set(rg),this},copyColorsArray:function(rg){for(var ag=this.array,og=0,ig=0,ng=rg.length,sg;ig<ng;ig++)sg=rg[ig],void 0===sg&&(console.warn('THREE.BufferAttribute.copyColorsArray(): color is undefined',ig),sg=new Y),ag[og++]=sg.r,ag[og++]=sg.g,ag[og++]=sg.b;return this},copyVector2sArray:function(rg){for(var ag=this.array,og=0,ig=0,ng=rg.length,sg;ig<ng;ig++)sg=rg[ig],void 0===sg&&(console.warn('THREE.BufferAttribute.copyVector2sArray(): vector is undefined',ig),sg=new E),ag[og++]=sg.x,ag[og++]=sg.y;return this},copyVector3sArray:function(rg){for(var ag=this.array,og=0,ig=0,ng=rg.length,sg;ig<ng;ig++)sg=rg[ig],void 0===sg&&(console.warn('THREE.BufferAttribute.copyVector3sArray(): vector is undefined',ig),sg=new C),ag[og++]=sg.x,ag[og++]=sg.y,ag[og++]=sg.z;return this},copyVector4sArray:function(rg){for(var ag=this.array,og=0,ig=0,ng=rg.length,sg;ig<ng;ig++)sg=rg[ig],void 0===sg&&(console.warn('THREE.BufferAttribute.copyVector4sArray(): vector is undefined',ig),sg=new D),ag[og++]=sg.x,ag[og++]=sg.y,ag[og++]=sg.z,ag[og++]=sg.w;return this},set:function(rg,ag){return void 0===ag&&(ag=0),this.array.set(rg,ag),this},getX:function(rg){return this.array[rg*this.itemSize]},setX:function(rg,ag){return this.array[rg*this.itemSize]=ag,this},getY:function(rg){return this.array[rg*this.itemSize+1]},setY:function(rg,ag){return this.array[rg*this.itemSize+1]=ag,this},getZ:function(rg){return this.array[rg*this.itemSize+2]},setZ:function(rg,ag){return this.array[rg*this.itemSize+2]=ag,this},getW:function(rg){return this.array[rg*this.itemSize+3]},setW:function(rg,ag){return this.array[rg*this.itemSize+3]=ag,this},setXY:function(rg,ag,og){return rg*=this.itemSize,this.array[rg+0]=ag,this.array[rg+1]=og,this},setXYZ:function(rg,ag,og,ig){return rg*=this.itemSize,this.array[rg+0]=ag,this.array[rg+1]=og,this.array[rg+2]=ig,this},setXYZW:function(rg,ag,og,ig,ng){return rg*=this.itemSize,this.array[rg+0]=ag,this.array[rg+1]=og,this.array[rg+2]=ig,this.array[rg+3]=ng,this},onUpload:function(rg){return this.onUploadCallback=rg,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),ie.prototype=Object.create(oe.prototype),ie.prototype.constructor=ie,ne.prototype=Object.create(oe.prototype),ne.prototype.constructor=ne,se.prototype=Object.create(oe.prototype),se.prototype.constructor=se,le.prototype=Object.create(oe.prototype),le.prototype.constructor=le,pe.prototype=Object.create(oe.prototype),pe.prototype.constructor=pe,ue.prototype=Object.create(oe.prototype),ue.prototype.constructor=ue,ge.prototype=Object.create(oe.prototype),ge.prototype.constructor=ge,fe.prototype=Object.create(oe.prototype),fe.prototype.constructor=fe,he.prototype=Object.create(oe.prototype),he.prototype.constructor=he,Object.assign(ye.prototype,{computeGroups:function(rg){for(var og=[],ig=void 0,ng=rg.faces,sg=0,ag,lg;sg<ng.length;sg++)lg=ng[sg],lg.materialIndex!==ig&&(ig=lg.materialIndex,void 0!=ag&&(ag.count=3*sg-ag.start,og.push(ag)),ag={start:3*sg,materialIndex:ig});void 0!==ag&&(ag.count=3*sg-ag.start,og.push(ag)),this.groups=og},fromGeometry:function(rg){var ag=rg.faces,og=rg.vertices,ig=rg.faceVertexUvs,ng=ig[0]&&0<ig[0].length,sg=ig[1]&&0<ig[1].length,lg=rg.morphTargets,pg=lg.length,dg;if(0<pg){dg=[];for(var cg=0;cg<pg;cg++)dg[cg]={name:lg[cg].name,data:[]};this.morphTargets.position=dg}var mg=rg.morphNormals,ug=mg.length,gg;if(0<ug){gg=[];for(var cg=0;cg<ug;cg++)gg[cg]={name:mg[cg].name,data:[]};this.morphTargets.normal=gg}var fg=rg.skinIndices,hg=rg.skinWeights,yg=fg.length===og.length,xg=hg.length===og.length;0<og.length&&0===ag.length&&console.error('THREE.DirectGeometry: Faceless geometries are not supported.');for(var cg=0,vg;cg<ag.length;cg++){vg=ag[cg],this.vertices.push(og[vg.a],og[vg.b],og[vg.c]);var _g=vg.vertexNormals;if(3===_g.length)this.normals.push(_g[0],_g[1],_g[2]);else{var bg=vg.normal;this.normals.push(bg,bg,bg)}var Sg=vg.vertexColors;if(3===Sg.length)this.colors.push(Sg[0],Sg[1],Sg[2]);else{var Mg=vg.color;this.colors.push(Mg,Mg,Mg)}if(!0===ng){var Tg=ig[0][cg];void 0===Tg?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ',cg),this.uvs.push(new E,new E,new E)):this.uvs.push(Tg[0],Tg[1],Tg[2])}if(!0===sg){var Tg=ig[1][cg];void 0===Tg?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ',cg),this.uvs2.push(new E,new E,new E)):this.uvs2.push(Tg[0],Tg[1],Tg[2])}for(var Eg=0,wg;Eg<pg;Eg++)wg=lg[Eg].vertices,dg[Eg].data.push(wg[vg.a],wg[vg.b],wg[vg.c]);for(var Eg=0,Lg;Eg<ug;Eg++)Lg=mg[Eg].vertexNormals[cg],gg[Eg].data.push(Lg.a,Lg.b,Lg.c);yg&&this.skinIndices.push(fg[vg.a],fg[vg.b],fg[vg.c]),xg&&this.skinWeights.push(hg[vg.a],hg[vg.b],hg[vg.c])}return this.computeGroups(rg),this.verticesNeedUpdate=rg.verticesNeedUpdate,this.normalsNeedUpdate=rg.normalsNeedUpdate,this.colorsNeedUpdate=rg.colorsNeedUpdate,this.uvsNeedUpdate=rg.uvsNeedUpdate,this.groupsNeedUpdate=rg.groupsNeedUpdate,this}});var Zc=1;ve.prototype=Object.assign(Object.create(M.prototype),{constructor:ve,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(rg){this.index=Array.isArray(rg)?new(65535<xe(rg)?ge:pe)(rg,1):rg},addAttribute:function(rg,ag){return ag&&ag.isBufferAttribute||ag&&ag.isInterleavedBufferAttribute?'index'===rg?(console.warn('THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.'),this.setIndex(ag),this):(this.attributes[rg]=ag,this):(console.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).'),this.addAttribute(rg,new oe(arguments[1],arguments[2])))},getAttribute:function(rg){return this.attributes[rg]},removeAttribute:function(rg){return delete this.attributes[rg],this},addGroup:function(rg,ag,og){this.groups.push({start:rg,count:ag,materialIndex:void 0===og?0:og})},clearGroups:function(){this.groups=[]},setDrawRange:function(rg,ag){this.drawRange.start=rg,this.drawRange.count=ag},applyMatrix:function(rg){var ag=this.attributes.position;void 0!==ag&&(rg.applyToBufferAttribute(ag),ag.needsUpdate=!0);var og=this.attributes.normal;if(void 0!==og){var ig=new R().getNormalMatrix(rg);ig.applyToBufferAttribute(og),og.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var rg=new L;return function(og){return rg.makeRotationX(og),this.applyMatrix(rg),this}}(),rotateY:function(){var rg=new L;return function(og){return rg.makeRotationY(og),this.applyMatrix(rg),this}}(),rotateZ:function(){var rg=new L;return function(og){return rg.makeRotationZ(og),this.applyMatrix(rg),this}}(),translate:function(){var rg=new L;return function(og,ig,ng){return rg.makeTranslation(og,ig,ng),this.applyMatrix(rg),this}}(),scale:function(){var rg=new L;return function(og,ig,ng){return rg.makeScale(og,ig,ng),this.applyMatrix(rg),this}}(),lookAt:function(){var rg=new ee;return function(og){rg.lookAt(og),rg.updateMatrix(),this.applyMatrix(rg.matrix)}}(),center:function(){var rg=new C;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(rg).negate(),this.translate(rg.x,rg.y,rg.z),this}}(),setFromObject:function(rg){var ag=rg.geometry;if(rg.isPoints||rg.isLine){var og=new fe(3*ag.vertices.length,3),ig=new fe(3*ag.colors.length,3);if(this.addAttribute('position',og.copyVector3sArray(ag.vertices)),this.addAttribute('color',ig.copyColorsArray(ag.colors)),ag.lineDistances&&ag.lineDistances.length===ag.vertices.length){var ng=new fe(ag.lineDistances.length,1);this.addAttribute('lineDistance',ng.copyArray(ag.lineDistances))}null!==ag.boundingSphere&&(this.boundingSphere=ag.boundingSphere.clone()),null!==ag.boundingBox&&(this.boundingBox=ag.boundingBox.clone())}else rg.isMesh&&ag&&ag.isGeometry&&this.fromGeometry(ag);return this},setFromPoints:function(rg){for(var ag=[],og=0,ig=rg.length,ng;og<ig;og++)ng=rg[og],ag.push(ng.x,ng.y,ng.z||0);return this.addAttribute('position',new fe(ag,3)),this},updateFromObject:function(rg){var ag=rg.geometry;if(rg.isMesh){var og=ag.__directGeometry;if(!0===ag.elementsNeedUpdate&&(og=void 0,ag.elementsNeedUpdate=!1),void 0===og)return this.fromGeometry(ag);og.verticesNeedUpdate=ag.verticesNeedUpdate,og.normalsNeedUpdate=ag.normalsNeedUpdate,og.colorsNeedUpdate=ag.colorsNeedUpdate,og.uvsNeedUpdate=ag.uvsNeedUpdate,og.groupsNeedUpdate=ag.groupsNeedUpdate,ag.verticesNeedUpdate=!1,ag.normalsNeedUpdate=!1,ag.colorsNeedUpdate=!1,ag.uvsNeedUpdate=!1,ag.groupsNeedUpdate=!1,ag=og}var ig;return!0===ag.verticesNeedUpdate&&(ig=this.attributes.position,void 0!=ig&&(ig.copyVector3sArray(ag.vertices),ig.needsUpdate=!0),ag.verticesNeedUpdate=!1),!0===ag.normalsNeedUpdate&&(ig=this.attributes.normal,void 0!=ig&&(ig.copyVector3sArray(ag.normals),ig.needsUpdate=!0),ag.normalsNeedUpdate=!1),!0===ag.colorsNeedUpdate&&(ig=this.attributes.color,void 0!=ig&&(ig.copyColorsArray(ag.colors),ig.needsUpdate=!0),ag.colorsNeedUpdate=!1),ag.uvsNeedUpdate&&(ig=this.attributes.uv,void 0!=ig&&(ig.copyVector2sArray(ag.uvs),ig.needsUpdate=!0),ag.uvsNeedUpdate=!1),ag.lineDistancesNeedUpdate&&(ig=this.attributes.lineDistance,void 0!=ig&&(ig.copyArray(ag.lineDistances),ig.needsUpdate=!0),ag.lineDistancesNeedUpdate=!1),ag.groupsNeedUpdate&&(ag.computeGroups(rg.geometry),this.groups=ag.groups,ag.groupsNeedUpdate=!1),this},fromGeometry:function(rg){return rg.__directGeometry=new ye().fromGeometry(rg),this.fromDirectGeometry(rg.__directGeometry)},fromDirectGeometry:function(rg){var ag=new Float32Array(3*rg.vertices.length);if(this.addAttribute('position',new oe(ag,3).copyVector3sArray(rg.vertices)),0<rg.normals.length){var og=new Float32Array(3*rg.normals.length);this.addAttribute('normal',new oe(og,3).copyVector3sArray(rg.normals))}if(0<rg.colors.length){var ig=new Float32Array(3*rg.colors.length);this.addAttribute('color',new oe(ig,3).copyColorsArray(rg.colors))}if(0<rg.uvs.length){var ng=new Float32Array(2*rg.uvs.length);this.addAttribute('uv',new oe(ng,2).copyVector2sArray(rg.uvs))}if(0<rg.uvs2.length){var sg=new Float32Array(2*rg.uvs2.length);this.addAttribute('uv2',new oe(sg,2).copyVector2sArray(rg.uvs2))}for(var lg in this.groups=rg.groups,rg.morphTargets){for(var pg=[],dg=rg.morphTargets[lg],cg=0,mg=dg.length;cg<mg;cg++){var ug=dg[cg],gg=new fe(3*ug.data.length,3);gg.name=ug.name,pg.push(gg.copyVector3sArray(ug.data))}this.morphAttributes[lg]=pg}if(0<rg.skinIndices.length){var fg=new fe(4*rg.skinIndices.length,4);this.addAttribute('skinIndex',fg.copyVector4sArray(rg.skinIndices))}if(0<rg.skinWeights.length){var hg=new fe(4*rg.skinWeights.length,4);this.addAttribute('skinWeight',hg.copyVector4sArray(rg.skinWeights))}return null!==rg.boundingSphere&&(this.boundingSphere=rg.boundingSphere.clone()),null!==rg.boundingBox&&(this.boundingBox=rg.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new F);var rg=this.attributes.position;void 0===rg?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(rg),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var rg=new F,ag=new C;return function(){null===this.boundingSphere&&(this.boundingSphere=new H);var ig=this.attributes.position;if(ig){var ng=this.boundingSphere.center;rg.setFromBufferAttribute(ig),rg.getCenter(ng);for(var sg=0,lg=0,pg=ig.count;lg<pg;lg++)ag.x=ig.getX(lg),ag.y=ig.getY(lg),ag.z=ig.getZ(lg),sg=Math.max(sg,ng.distanceToSquared(ag));this.boundingSphere.radius=Math.sqrt(sg),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var rg=this.index,ag=this.attributes;if(ag.position){var og=ag.position.array;if(void 0===ag.normal)this.addAttribute('normal',new oe(new Float32Array(og.length),3));else for(var ig=ag.normal.array,ng=0,sg=ig.length;ng<sg;ng++)ig[ng]=0;var lg=ag.normal.array,mg=new C,ug=new C,gg=new C,fg=new C,hg=new C,pg,dg,cg;if(rg)for(var yg=rg.array,ng=0,sg=rg.count;ng<sg;ng+=3)pg=3*yg[ng+0],dg=3*yg[ng+1],cg=3*yg[ng+2],mg.fromArray(og,pg),ug.fromArray(og,dg),gg.fromArray(og,cg),fg.subVectors(gg,ug),hg.subVectors(mg,ug),fg.cross(hg),lg[pg]+=fg.x,lg[pg+1]+=fg.y,lg[pg+2]+=fg.z,lg[dg]+=fg.x,lg[dg+1]+=fg.y,lg[dg+2]+=fg.z,lg[cg]+=fg.x,lg[cg+1]+=fg.y,lg[cg+2]+=fg.z;else for(var ng=0,sg=og.length;ng<sg;ng+=9)mg.fromArray(og,ng),ug.fromArray(og,ng+3),gg.fromArray(og,ng+6),fg.subVectors(gg,ug),hg.subVectors(mg,ug),fg.cross(hg),lg[ng]=fg.x,lg[ng+1]=fg.y,lg[ng+2]=fg.z,lg[ng+3]=fg.x,lg[ng+4]=fg.y,lg[ng+5]=fg.z,lg[ng+6]=fg.x,lg[ng+7]=fg.y,lg[ng+8]=fg.z;this.normalizeNormals(),ag.normal.needsUpdate=!0}},merge:function(rg,ag){if(!(rg&&rg.isBufferGeometry))return void console.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.',rg);void 0===ag&&(ag=0,console.warn('THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'));var og=this.attributes;for(var ig in og)if(void 0!==rg.attributes[ig])for(var ng=og[ig],sg=ng.array,lg=rg.attributes[ig],pg=lg.array,dg=lg.itemSize,cg=0,mg=dg*ag;cg<pg.length;cg++,mg++)sg[mg]=pg[cg];return this},normalizeNormals:function(){var rg=new C;return function(){for(var og=this.attributes.normal,ig=0,ng=og.count;ig<ng;ig++)rg.x=og.getX(ig),rg.y=og.getY(ig),rg.z=og.getZ(ig),rg.normalize(),og.setXYZ(ig,rg.x,rg.y,rg.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn('THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.'),this;var rg=new ve,ag=this.index.array,og=this.attributes;for(var ig in og){for(var ng=og[ig],sg=ng.array,lg=ng.itemSize,pg=new sg.constructor(ag.length*lg),dg=0,cg=0,mg=0,ug=ag.length;mg<ug;mg++){dg=ag[mg]*lg;for(var gg=0;gg<lg;gg++)pg[cg++]=sg[dg++]}rg.addAttribute(ig,new oe(pg,lg))}for(var fg=this.groups,mg=0,ug=fg.length,hg;mg<ug;mg++)hg=fg[mg],rg.addGroup(hg.start,hg.count,hg.materialIndex);return rg},toJSON:function(){var rg={metadata:{version:4.5,type:'BufferGeometry',generator:'BufferGeometry.toJSON'}};if(rg.uuid=this.uuid,rg.type=this.type,''!==this.name&&(rg.name=this.name),0<Object.keys(this.userData).length&&(rg.userData=this.userData),void 0!==this.parameters){var ag=this.parameters;for(var og in ag)void 0!==ag[og]&&(rg[og]=ag[og]);return rg}rg.data={attributes:{}};var ig=this.index;if(null!==ig){var ng=Array.prototype.slice.call(ig.array);rg.data.index={type:ig.array.constructor.name,array:ng}}var sg=this.attributes;for(var og in sg){var lg=sg[og],ng=Array.prototype.slice.call(lg.array);rg.data.attributes[og]={itemSize:lg.itemSize,type:lg.array.constructor.name,array:ng,normalized:lg.normalized}}var pg=this.groups;0<pg.length&&(rg.data.groups=JSON.parse(JSON.stringify(pg)));var dg=this.boundingSphere;return null!==dg&&(rg.data.boundingSphere={center:dg.center.toArray(),radius:dg.radius}),rg},clone:function(){return new ve().copy(this)},copy:function(rg){var ag,og,ig;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=rg.name;var ng=rg.index;null!==ng&&this.setIndex(ng.clone());var sg=rg.attributes;for(ag in sg){var lg=sg[ag];this.addAttribute(ag,lg.clone())}var pg=rg.morphAttributes;for(ag in pg){var dg=[],cg=pg[ag];for(og=0,ig=cg.length;og<ig;og++)dg.push(cg[og].clone());this.morphAttributes[ag]=dg}var mg=rg.groups;for(og=0,ig=mg.length;og<ig;og++){var ug=mg[og];this.addGroup(ug.start,ug.count,ug.materialIndex)}var gg=rg.boundingBox;null!==gg&&(this.boundingBox=gg.clone());var fg=rg.boundingSphere;return null!==fg&&(this.boundingSphere=fg.clone()),this.drawRange.start=rg.drawRange.start,this.drawRange.count=rg.drawRange.count,this.userData=rg.userData,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),_e.prototype=Object.create(re.prototype),_e.prototype.constructor=_e,Se.prototype=Object.create(ve.prototype),Se.prototype.constructor=Se,Me.prototype=Object.create(re.prototype),Me.prototype.constructor=Me,Te.prototype=Object.create(ve.prototype),Te.prototype.constructor=Te;var Jc=0;Ee.prototype=Object.assign(Object.create(M.prototype),{constructor:Ee,isMaterial:!0,onBeforeCompile:function(){},setValues:function(rg){if(void 0!==rg)for(var ag in rg){var og=rg[ag];if(void 0===og){console.warn('THREE.Material: \''+ag+'\' parameter is undefined.');continue}if('shading'==ag){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=og===Vn;continue}var ig=this[ag];if(void 0===ig){console.warn('THREE.'+this.type+': \''+ag+'\' is not a property of this material.');continue}ig&&ig.isColor?ig.set(og):ig&&ig.isVector3&&og&&og.isVector3?ig.copy(og):this[ag]=og}},toJSON:function(rg){function ag(lg){var pg=[];for(var dg in lg){var cg=lg[dg];delete cg.metadata,pg.push(cg)}return pg}var og=void 0===rg||'string'==typeof rg;og&&(rg={textures:{},images:{}});var ig={metadata:{version:4.5,type:'Material',generator:'Material.toJSON'}};if(ig.uuid=this.uuid,ig.type=this.type,''!==this.name&&(ig.name=this.name),this.color&&this.color.isColor&&(ig.color=this.color.getHex()),void 0!==this.roughness&&(ig.roughness=this.roughness),void 0!==this.metalness&&(ig.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(ig.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(ig.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(ig.specular=this.specular.getHex()),void 0!==this.shininess&&(ig.shininess=this.shininess),void 0!==this.clearCoat&&(ig.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(ig.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(ig.map=this.map.toJSON(rg).uuid),this.alphaMap&&this.alphaMap.isTexture&&(ig.alphaMap=this.alphaMap.toJSON(rg).uuid),this.lightMap&&this.lightMap.isTexture&&(ig.lightMap=this.lightMap.toJSON(rg).uuid),this.aoMap&&this.aoMap.isTexture&&(ig.aoMap=this.aoMap.toJSON(rg).uuid,ig.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(ig.bumpMap=this.bumpMap.toJSON(rg).uuid,ig.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(ig.normalMap=this.normalMap.toJSON(rg).uuid,ig.normalMapType=this.normalMapType,ig.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(ig.displacementMap=this.displacementMap.toJSON(rg).uuid,ig.displacementScale=this.displacementScale,ig.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(ig.roughnessMap=this.roughnessMap.toJSON(rg).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(ig.metalnessMap=this.metalnessMap.toJSON(rg).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(ig.emissiveMap=this.emissiveMap.toJSON(rg).uuid),this.specularMap&&this.specularMap.isTexture&&(ig.specularMap=this.specularMap.toJSON(rg).uuid),this.envMap&&this.envMap.isTexture&&(ig.envMap=this.envMap.toJSON(rg).uuid,ig.reflectivity=this.reflectivity,void 0!==this.combine&&(ig.combine=this.combine),void 0!==this.envMapIntensity&&(ig.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(ig.gradientMap=this.gradientMap.toJSON(rg).uuid),void 0!==this.size&&(ig.size=this.size),void 0!==this.sizeAttenuation&&(ig.sizeAttenuation=this.sizeAttenuation),this.blending!==Yn&&(ig.blending=this.blending),!0===this.flatShading&&(ig.flatShading=this.flatShading),this.side!==On&&(ig.side=this.side),this.vertexColors!==kn&&(ig.vertexColors=this.vertexColors),1>this.opacity&&(ig.opacity=this.opacity),!0===this.transparent&&(ig.transparent=this.transparent),ig.depthFunc=this.depthFunc,ig.depthTest=this.depthTest,ig.depthWrite=this.depthWrite,0!==this.rotation&&(ig.rotation=this.rotation),!0===this.polygonOffset&&(ig.polygonOffset=!0),0!==this.polygonOffsetFactor&&(ig.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(ig.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(ig.linewidth=this.linewidth),void 0!==this.dashSize&&(ig.dashSize=this.dashSize),void 0!==this.gapSize&&(ig.gapSize=this.gapSize),void 0!==this.scale&&(ig.scale=this.scale),!0===this.dithering&&(ig.dithering=!0),0<this.alphaTest&&(ig.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(ig.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(ig.wireframe=this.wireframe),1<this.wireframeLinewidth&&(ig.wireframeLinewidth=this.wireframeLinewidth),'round'!==this.wireframeLinecap&&(ig.wireframeLinecap=this.wireframeLinecap),'round'!==this.wireframeLinejoin&&(ig.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(ig.morphTargets=!0),!0===this.skinning&&(ig.skinning=!0),!1===this.visible&&(ig.visible=!1),'{}'!==JSON.stringify(this.userData)&&(ig.userData=this.userData),og){var ng=ag(rg.textures),sg=ag(rg.images);0<ng.length&&(ig.textures=ng),0<sg.length&&(ig.images=sg)}return ig},clone:function(){return new this.constructor().copy(this)},copy:function(rg){this.name=rg.name,this.fog=rg.fog,this.lights=rg.lights,this.blending=rg.blending,this.side=rg.side,this.flatShading=rg.flatShading,this.vertexColors=rg.vertexColors,this.opacity=rg.opacity,this.transparent=rg.transparent,this.blendSrc=rg.blendSrc,this.blendDst=rg.blendDst,this.blendEquation=rg.blendEquation,this.blendSrcAlpha=rg.blendSrcAlpha,this.blendDstAlpha=rg.blendDstAlpha,this.blendEquationAlpha=rg.blendEquationAlpha,this.depthFunc=rg.depthFunc,this.depthTest=rg.depthTest,this.depthWrite=rg.depthWrite,this.colorWrite=rg.colorWrite,this.precision=rg.precision,this.polygonOffset=rg.polygonOffset,this.polygonOffsetFactor=rg.polygonOffsetFactor,this.polygonOffsetUnits=rg.polygonOffsetUnits,this.dithering=rg.dithering,this.alphaTest=rg.alphaTest,this.premultipliedAlpha=rg.premultipliedAlpha,this.visible=rg.visible,this.userData=JSON.parse(JSON.stringify(rg.userData)),this.clipShadows=rg.clipShadows,this.clipIntersection=rg.clipIntersection;var ag=rg.clippingPlanes,og=null;if(null!==ag){var ig=ag.length;og=Array(ig);for(var ng=0;ng!==ig;++ng)og[ng]=ag[ng].clone()}return this.clippingPlanes=og,this.shadowSide=rg.shadowSide,this},dispose:function(){this.dispatchEvent({type:'dispose'})}}),we.prototype=Object.create(Ee.prototype),we.prototype.constructor=we,we.prototype.isShaderMaterial=!0,we.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.fragmentShader=rg.fragmentShader,this.vertexShader=rg.vertexShader,this.uniforms=kc.clone(rg.uniforms),this.defines=Object.assign({},rg.defines),this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this.lights=rg.lights,this.clipping=rg.clipping,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.morphNormals=rg.morphNormals,this.extensions=rg.extensions,this},we.prototype.toJSON=function(rg){var ag=Ee.prototype.toJSON.call(this,rg);for(var og in ag.uniforms={},this.uniforms){var ig=this.uniforms[og],ng=ig.value;ag.uniforms[og]=ng.isTexture?{type:'t',value:ng.toJSON(rg).uuid}:ng.isColor?{type:'c',value:ng.getHex()}:ng.isVector2?{type:'v2',value:ng.toArray()}:ng.isVector3?{type:'v3',value:ng.toArray()}:ng.isVector4?{type:'v4',value:ng.toArray()}:ng.isMatrix4?{type:'m4',value:ng.toArray()}:{value:ng}}return 0<Object.keys(this.defines).length&&(ag.defines=this.defines),ag.vertexShader=this.vertexShader,ag.fragmentShader=this.fragmentShader,ag},Object.assign(Le.prototype,{set:function(rg,ag){return this.origin.copy(rg),this.direction.copy(ag),this},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.origin.copy(rg.origin),this.direction.copy(rg.direction),this},at:function(rg,ag){return void 0===ag&&(console.warn('THREE.Ray: .at() target is now required'),ag=new C),ag.copy(this.direction).multiplyScalar(rg).add(this.origin)},lookAt:function(rg){return this.direction.copy(rg).sub(this.origin).normalize(),this},recast:function(){var rg=new C;return function(og){return this.origin.copy(this.at(og,rg)),this}}(),closestPointToPoint:function(rg,ag){void 0===ag&&(console.warn('THREE.Ray: .closestPointToPoint() target is now required'),ag=new C),ag.subVectors(rg,this.origin);var og=ag.dot(this.direction);return 0>og?ag.copy(this.origin):ag.copy(this.direction).multiplyScalar(og).add(this.origin)},distanceToPoint:function(rg){return Math.sqrt(this.distanceSqToPoint(rg))},distanceSqToPoint:function(){var rg=new C;return function(og){var ig=rg.subVectors(og,this.origin).dot(this.direction);return 0>ig?this.origin.distanceToSquared(og):(rg.copy(this.direction).multiplyScalar(ig).add(this.origin),rg.distanceToSquared(og))}}(),distanceSqToSegment:function(){var rg=new C,ag=new C,og=new C;return function(ng,sg,lg,pg){rg.copy(ng).add(sg).multiplyScalar(0.5),ag.copy(sg).sub(ng).normalize(),og.copy(this.origin).sub(rg);var dg=0.5*ng.distanceTo(sg),cg=-this.direction.dot(ag),mg=og.dot(this.direction),ug=-og.dot(ag),gg=og.lengthSq(),fg=Math.abs(1-cg*cg),hg,yg,xg,vg;if(!(0<fg))yg=0<cg?-dg:dg,hg=Math.max(0,-(cg*yg+mg)),xg=-hg*hg+yg*(yg+2*ug)+gg;else if(hg=cg*ug-mg,yg=cg*mg-ug,vg=dg*fg,!(0<=hg))yg<=-vg?(hg=Math.max(0,-(-cg*dg+mg)),yg=0<hg?-dg:Math.min(Math.max(-dg,-ug),dg),xg=-hg*hg+yg*(yg+2*ug)+gg):yg<=vg?(hg=0,yg=Math.min(Math.max(-dg,-ug),dg),xg=yg*(yg+2*ug)+gg):(hg=Math.max(0,-(cg*dg+mg)),yg=0<hg?dg:Math.min(Math.max(-dg,-ug),dg),xg=-hg*hg+yg*(yg+2*ug)+gg);else if(!(yg>=-vg))yg=-dg,hg=Math.max(0,-(cg*yg+mg)),xg=-hg*hg+yg*(yg+2*ug)+gg;else if(yg<=vg){var _g=1/fg;hg*=_g,yg*=_g,xg=hg*(hg+cg*yg+2*mg)+yg*(cg*hg+yg+2*ug)+gg}else yg=dg,hg=Math.max(0,-(cg*yg+mg)),xg=-hg*hg+yg*(yg+2*ug)+gg;return lg&&lg.copy(this.direction).multiplyScalar(hg).add(this.origin),pg&&pg.copy(ag).multiplyScalar(yg).add(rg),xg}}(),intersectSphere:function(){var rg=new C;return function(og,ig){rg.subVectors(og.center,this.origin);var ng=rg.dot(this.direction),sg=rg.dot(rg)-ng*ng,lg=og.radius*og.radius;if(sg>lg)return null;var pg=Math.sqrt(lg-sg),dg=ng-pg,cg=ng+pg;return 0>dg&&0>cg?null:0>dg?this.at(cg,ig):this.at(dg,ig)}}(),intersectsSphere:function(rg){return this.distanceSqToPoint(rg.center)<=rg.radius*rg.radius},distanceToPlane:function(rg){var ag=rg.normal.dot(this.direction);if(0===ag)return 0===rg.distanceToPoint(this.origin)?0:null;var og=-(this.origin.dot(rg.normal)+rg.constant)/ag;return 0<=og?og:null},intersectPlane:function(rg,ag){var og=this.distanceToPlane(rg);return null===og?null:this.at(og,ag)},intersectsPlane:function(rg){var ag=rg.distanceToPoint(this.origin);if(0===ag)return!0;var og=rg.normal.dot(this.direction);return!!(0>og*ag)},intersectBox:function(rg,ag){var dg=1/this.direction.x,cg=1/this.direction.y,mg=1/this.direction.z,ug=this.origin,og,ig,ng,sg,lg,pg;return(0<=dg?(og=(rg.min.x-ug.x)*dg,ig=(rg.max.x-ug.x)*dg):(og=(rg.max.x-ug.x)*dg,ig=(rg.min.x-ug.x)*dg),0<=cg?(ng=(rg.min.y-ug.y)*cg,sg=(rg.max.y-ug.y)*cg):(ng=(rg.max.y-ug.y)*cg,sg=(rg.min.y-ug.y)*cg),og>sg||ng>ig)?null:((ng>og||og!=og)&&(og=ng),(sg<ig||ig!=ig)&&(ig=sg),0<=mg?(lg=(rg.min.z-ug.z)*mg,pg=(rg.max.z-ug.z)*mg):(lg=(rg.max.z-ug.z)*mg,pg=(rg.min.z-ug.z)*mg),og>pg||lg>ig)?null:((lg>og||og!=og)&&(og=lg),(pg<ig||ig!=ig)&&(ig=pg),0>ig?null:this.at(0<=og?og:ig,ag))},intersectsBox:function(){var rg=new C;return function(og){return null!==this.intersectBox(og,rg)}}(),intersectTriangle:function(){var rg=new C,ag=new C,og=new C,ig=new C;return function(sg,lg,pg,dg,cg){ag.subVectors(lg,sg),og.subVectors(pg,sg),ig.crossVectors(ag,og);var mg=this.direction.dot(ig),ug;if(0<mg){if(dg)return null;ug=1}else if(0>mg)ug=-1,mg=-mg;else return null;rg.subVectors(this.origin,sg);var gg=ug*this.direction.dot(og.crossVectors(rg,og));if(0>gg)return null;var fg=ug*this.direction.dot(ag.cross(rg));if(0>fg)return null;if(gg+fg>mg)return null;var hg=-ug*rg.dot(ig);return 0>hg?null:this.at(hg/mg,cg)}}(),applyMatrix4:function(rg){return this.origin.applyMatrix4(rg),this.direction.transformDirection(rg),this},equals:function(rg){return rg.origin.equals(this.origin)&&rg.direction.equals(this.direction)}}),Object.assign(Pe,{getNormal:function(){var rg=new C;return function(og,ig,ng,sg){void 0===sg&&(console.warn('THREE.Triangle: .getNormal() target is now required'),sg=new C),sg.subVectors(ng,ig),rg.subVectors(og,ig),sg.cross(rg);var lg=sg.lengthSq();return 0<lg?sg.multiplyScalar(1/Math.sqrt(lg)):sg.set(0,0,0)}}(),getBarycoord:function(){var rg=new C,ag=new C,og=new C;return function(ng,sg,lg,pg,dg){rg.subVectors(pg,sg),ag.subVectors(lg,sg),og.subVectors(ng,sg);var cg=rg.dot(rg),mg=rg.dot(ag),ug=rg.dot(og),gg=ag.dot(ag),fg=ag.dot(og),hg=cg*gg-mg*mg;if(void 0===dg&&(console.warn('THREE.Triangle: .getBarycoord() target is now required'),dg=new C),0==hg)return dg.set(-2,-1,-1);var yg=1/hg,xg=(gg*ug-mg*fg)*yg,vg=(cg*fg-mg*ug)*yg;return dg.set(1-xg-vg,vg,xg)}}(),containsPoint:function(){var rg=new C;return function(og,ig,ng,sg){return Pe.getBarycoord(og,ig,ng,sg,rg),0<=rg.x&&0<=rg.y&&1>=rg.x+rg.y}}(),getUV:function(){var rg=new C;return function(og,ig,ng,sg,lg,pg,dg,cg){return this.getBarycoord(og,ig,ng,sg,rg),cg.set(0,0),cg.addScaledVector(lg,rg.x),cg.addScaledVector(pg,rg.y),cg.addScaledVector(dg,rg.z),cg}}()}),Object.assign(Pe.prototype,{set:function(rg,ag,og){return this.a.copy(rg),this.b.copy(ag),this.c.copy(og),this},setFromPointsAndIndices:function(rg,ag,og,ig){return this.a.copy(rg[ag]),this.b.copy(rg[og]),this.c.copy(rg[ig]),this},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.a.copy(rg.a),this.b.copy(rg.b),this.c.copy(rg.c),this},getArea:function(){var rg=new C,ag=new C;return function(){return rg.subVectors(this.c,this.b),ag.subVectors(this.a,this.b),0.5*rg.cross(ag).length()}}(),getMidpoint:function(rg){return void 0===rg&&(console.warn('THREE.Triangle: .getMidpoint() target is now required'),rg=new C),rg.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(rg){return Pe.getNormal(this.a,this.b,this.c,rg)},getPlane:function(rg){return void 0===rg&&(console.warn('THREE.Triangle: .getPlane() target is now required'),rg=new C),rg.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(rg,ag){return Pe.getBarycoord(rg,this.a,this.b,this.c,ag)},containsPoint:function(rg){return Pe.containsPoint(rg,this.a,this.b,this.c)},getUV:function(rg,ag,og,ig,ng){return Pe.getUV(rg,this.a,this.b,this.c,ag,og,ig,ng)},intersectsBox:function(rg){return rg.intersectsTriangle(this)},closestPointToPoint:function(){var rg=new C,ag=new C,og=new C,ig=new C,ng=new C,sg=new C;return function(pg,dg){void 0===dg&&(console.warn('THREE.Triangle: .closestPointToPoint() target is now required'),dg=new C);var cg=this.a,mg=this.b,ug=this.c,gg,fg;rg.subVectors(mg,cg),ag.subVectors(ug,cg),ig.subVectors(pg,cg);var hg=rg.dot(ig),yg=ag.dot(ig);if(0>=hg&&0>=yg)return dg.copy(cg);ng.subVectors(pg,mg);var xg=rg.dot(ng),vg=ag.dot(ng);if(0<=xg&&vg<=xg)return dg.copy(mg);var _g=hg*vg-xg*yg;if(0>=_g&&0<=hg&&0>=xg)return gg=hg/(hg-xg),dg.copy(cg).addScaledVector(rg,gg);sg.subVectors(pg,ug);var bg=rg.dot(sg),Sg=ag.dot(sg);if(0<=Sg&&bg<=Sg)return dg.copy(ug);var Mg=bg*yg-hg*Sg;if(0>=Mg&&0<=yg&&0>=Sg)return fg=yg/(yg-Sg),dg.copy(cg).addScaledVector(ag,fg);var Tg=xg*Sg-bg*vg;if(0>=Tg&&0<=vg-xg&&0<=bg-Sg)return og.subVectors(ug,mg),fg=(vg-xg)/(vg-xg+(bg-Sg)),dg.copy(mg).addScaledVector(og,fg);var Eg=1/(Tg+Mg+_g);return gg=Mg*Eg,fg=_g*Eg,dg.copy(cg).addScaledVector(rg,gg).addScaledVector(ag,fg)}}(),equals:function(rg){return rg.a.equals(this.a)&&rg.b.equals(this.b)&&rg.c.equals(this.c)}}),Ae.prototype=Object.create(Ee.prototype),Ae.prototype.constructor=Ae,Ae.prototype.isMeshBasicMaterial=!0,Ae.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.map=rg.map,this.lightMap=rg.lightMap,this.lightMapIntensity=rg.lightMapIntensity,this.aoMap=rg.aoMap,this.aoMapIntensity=rg.aoMapIntensity,this.specularMap=rg.specularMap,this.alphaMap=rg.alphaMap,this.envMap=rg.envMap,this.combine=rg.combine,this.reflectivity=rg.reflectivity,this.refractionRatio=rg.refractionRatio,this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this.wireframeLinecap=rg.wireframeLinecap,this.wireframeLinejoin=rg.wireframeLinejoin,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this},Ce.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ce,isMesh:!0,setDrawMode:function(rg){this.drawMode=rg},copy:function(rg){return ee.prototype.copy.call(this,rg),this.drawMode=rg.drawMode,void 0!==rg.morphTargetInfluences&&(this.morphTargetInfluences=rg.morphTargetInfluences.slice()),void 0!==rg.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},rg.morphTargetDictionary)),this},updateMorphTargets:function(){var rg=this.geometry,ag,og,ig;if(rg.isBufferGeometry){var ng=rg.morphAttributes,sg=Object.keys(ng);if(0<sg.length){var lg=ng[sg[0]];if(void 0!==lg)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},(ag=0,og=lg.length);ag<og;ag++)ig=lg[ag].name||ag+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[ig]=ag}}else{var pg=rg.morphTargets;if(void 0!==pg&&0<pg.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},(ag=0,og=pg.length);ag<og;ag++)ig=pg[ag].name||ag+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[ig]=ag}},raycast:function(){function rg(xg,vg,_g,bg,Sg,Mg,Tg,Eg){var wg;if(wg=vg.side===Fn?bg.intersectTriangle(Tg,Mg,Sg,!0,Eg):bg.intersectTriangle(Sg,Mg,Tg,vg.side!==Hn,Eg),null===wg)return null;yg.copy(Eg),yg.applyMatrix4(xg.matrixWorld);var Lg=_g.ray.origin.distanceTo(yg);return Lg<_g.near||Lg>_g.far?null:{distance:Lg,point:yg.clone(),object:xg}}function ag(xg,vg,_g,bg,Sg,Mg,Tg,Eg,wg){sg.fromBufferAttribute(Sg,Tg),lg.fromBufferAttribute(Sg,Eg),pg.fromBufferAttribute(Sg,wg);var Lg=rg(xg,vg,_g,bg,sg,lg,pg,hg);if(Lg){Mg&&(ug.fromBufferAttribute(Mg,Tg),gg.fromBufferAttribute(Mg,Eg),fg.fromBufferAttribute(Mg,wg),Lg.uv=Pe.getUV(hg,sg,lg,pg,ug,gg,fg,new E));var Pg=new J(Tg,Eg,wg);Pe.getNormal(sg,lg,pg,Pg.normal),Lg.face=Pg}return Lg}var og=new L,ig=new Le,ng=new H,sg=new C,lg=new C,pg=new C,dg=new C,cg=new C,mg=new C,ug=new E,gg=new E,fg=new E,hg=new C,yg=new C;return function(vg,_g){var bg=this.geometry,Sg=this.material,Mg=this.matrixWorld;if(void 0!==Sg&&(null===bg.boundingSphere&&bg.computeBoundingSphere(),ng.copy(bg.boundingSphere),ng.applyMatrix4(Mg),!1!==vg.ray.intersectsSphere(ng))&&(og.getInverse(Mg),ig.copy(vg.ray).applyMatrix4(og),null===bg.boundingBox||!1!==ig.intersectsBox(bg.boundingBox))){var Tg;if(bg.isBufferGeometry){var Pg=bg.index,Ag=bg.attributes.position,Cg=bg.attributes.uv,Rg=bg.groups,Ig=bg.drawRange,Eg,wg,Lg,zg,Dg,Bg,Ng,Ug,Gg,Og,Fg;if(null!==Pg){if(Array.isArray(Sg))for(zg=0,Bg=Rg.length;zg<Bg;zg++)for(Ug=Rg[zg],Gg=Sg[Ug.materialIndex],Og=Math.max(Ug.start,Ig.start),Fg=Math.min(Ug.start+Ug.count,Ig.start+Ig.count),(Dg=Og,Ng=Fg);Dg<Ng;Dg+=3)Eg=Pg.getX(Dg),wg=Pg.getX(Dg+1),Lg=Pg.getX(Dg+2),Tg=ag(this,Gg,vg,ig,Ag,Cg,Eg,wg,Lg),Tg&&(Tg.faceIndex=Math.floor(Dg/3),_g.push(Tg));else for(Og=Math.max(0,Ig.start),Fg=Math.min(Pg.count,Ig.start+Ig.count),(zg=Og,Bg=Fg);zg<Bg;zg+=3)Eg=Pg.getX(zg),wg=Pg.getX(zg+1),Lg=Pg.getX(zg+2),Tg=ag(this,Sg,vg,ig,Ag,Cg,Eg,wg,Lg),Tg&&(Tg.faceIndex=Math.floor(zg/3),_g.push(Tg));}else if(void 0!==Ag)if(Array.isArray(Sg))for(zg=0,Bg=Rg.length;zg<Bg;zg++)for(Ug=Rg[zg],Gg=Sg[Ug.materialIndex],Og=Math.max(Ug.start,Ig.start),Fg=Math.min(Ug.start+Ug.count,Ig.start+Ig.count),(Dg=Og,Ng=Fg);Dg<Ng;Dg+=3)Eg=Dg,wg=Dg+1,Lg=Dg+2,Tg=ag(this,Gg,vg,ig,Ag,Cg,Eg,wg,Lg),Tg&&(Tg.faceIndex=Math.floor(Dg/3),_g.push(Tg));else for(Og=Math.max(0,Ig.start),Fg=Math.min(Ag.count,Ig.start+Ig.count),(zg=Og,Bg=Fg);zg<Bg;zg+=3)Eg=zg,wg=zg+1,Lg=zg+2,Tg=ag(this,Sg,vg,ig,Ag,Cg,Eg,wg,Lg),Tg&&(Tg.faceIndex=Math.floor(zg/3),_g.push(Tg))}else if(bg.isGeometry){var Wg=Array.isArray(Sg),jg=bg.vertices,qg=bg.faces,Xg=bg.faceVertexUvs[0],Hg,Vg,kg,Yg;0<Xg.length&&(Yg=Xg);for(var Zg=0,Jg=qg.length;Zg<Jg;Zg++){var Qg=qg[Zg],Kg=Wg?Sg[Qg.materialIndex]:Sg;if(void 0!==Kg){if(Hg=jg[Qg.a],Vg=jg[Qg.b],kg=jg[Qg.c],!0===Kg.morphTargets){var $g=bg.morphTargets,ef=this.morphTargetInfluences;sg.set(0,0,0),lg.set(0,0,0),pg.set(0,0,0);for(var tf=0,rf=$g.length,of;tf<rf;tf++)if(of=ef[tf],0!==of){var nf=$g[tf].vertices;sg.addScaledVector(dg.subVectors(nf[Qg.a],Hg),of),lg.addScaledVector(cg.subVectors(nf[Qg.b],Vg),of),pg.addScaledVector(mg.subVectors(nf[Qg.c],kg),of)}sg.add(Hg),lg.add(Vg),pg.add(kg),Hg=sg,Vg=lg,kg=pg}if(Tg=rg(this,Kg,vg,ig,Hg,Vg,kg,hg),Tg){if(Yg&&Yg[Zg]){var lf=Yg[Zg];ug.copy(lf[0]),gg.copy(lf[1]),fg.copy(lf[2]),Tg.uv=Pe.getUV(hg,Hg,Vg,kg,ug,gg,fg,new E)}Tg.face=Qg,Tg.faceIndex=Zg,_g.push(Tg)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ve.prototype=Object.create(I.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isCubeTexture=!0,Object.defineProperty(Ve.prototype,'images',{get:function(){return this.image},set:function(rg){this.image=rg}}),ke.prototype=Object.create(I.prototype),ke.prototype.constructor=ke,ke.prototype.isDataTexture3D=!0;var Qc=new I,Kc=new ke,$c=new Ve,em=[],tm=[],rm=new Float32Array(16),am=new Float32Array(9),om=new Float32Array(4);Mt.prototype.updateCache=function(rg){var ag=this.cache;rg instanceof Float32Array&&ag.length!==rg.length&&(this.cache=new Float32Array(rg.length)),Ye(ag,rg)},Tt.prototype.setValue=function(rg,ag,og){for(var ig=this.seq,ng=0,sg=ig.length,lg;ng!==sg;++ng)lg=ig[ng],lg.setValue(rg,ag[lg.id],og)};var im=/([\w\d_]+)(\])?(\[|\.)?/g;Lt.prototype.setValue=function(rg,ag,og){var ig=this.map[ag];void 0!==ig&&ig.setValue(rg,og,this.renderer)},Lt.prototype.setOptional=function(rg,ag,og){var ig=ag[og];void 0!==ig&&this.setValue(rg,og,ig)},Lt.upload=function(rg,ag,og,ig){for(var ng=0,sg=ag.length;ng!==sg;++ng){var lg=ag[ng],pg=og[lg.id];!1!==pg.needsUpdate&&lg.setValue(rg,pg.value,ig)}},Lt.seqWithValue=function(rg,ag){for(var og=[],ig=0,ng=rg.length,sg;ig!==ng;++ig)sg=rg[ig],sg.id in ag&&og.push(sg);return og};var nm=0,sm=0;$t.prototype=Object.create(Ee.prototype),$t.prototype.constructor=$t,$t.prototype.isMeshDepthMaterial=!0,$t.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.depthPacking=rg.depthPacking,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.map=rg.map,this.alphaMap=rg.alphaMap,this.displacementMap=rg.displacementMap,this.displacementScale=rg.displacementScale,this.displacementBias=rg.displacementBias,this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this},er.prototype=Object.create(Ee.prototype),er.prototype.constructor=er,er.prototype.isMeshDistanceMaterial=!0,er.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.referencePosition.copy(rg.referencePosition),this.nearDistance=rg.nearDistance,this.farDistance=rg.farDistance,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.map=rg.map,this.alphaMap=rg.alphaMap,this.displacementMap=rg.displacementMap,this.displacementScale=rg.displacementScale,this.displacementBias=rg.displacementBias,this},ir.prototype=Object.assign(Object.create(ee.prototype),{constructor:ir,isGroup:!0}),nr.prototype=Object.assign(Object.create(ee.prototype),{constructor:nr,isCamera:!0,copy:function(rg,ag){return ee.prototype.copy.call(this,rg,ag),this.matrixWorldInverse.copy(rg.matrixWorldInverse),this.projectionMatrix.copy(rg.projectionMatrix),this.projectionMatrixInverse.copy(rg.projectionMatrixInverse),this},getWorldDirection:function(rg){void 0===rg&&(console.warn('THREE.Camera: .getWorldDirection() target is now required'),rg=new C),this.updateMatrixWorld(!0);var ag=this.matrixWorld.elements;return rg.set(-ag[8],-ag[9],-ag[10]).normalize()},updateMatrixWorld:function(rg){ee.prototype.updateMatrixWorld.call(this,rg),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),sr.prototype=Object.assign(Object.create(nr.prototype),{constructor:sr,isPerspectiveCamera:!0,copy:function(rg,ag){return nr.prototype.copy.call(this,rg,ag),this.fov=rg.fov,this.zoom=rg.zoom,this.near=rg.near,this.far=rg.far,this.focus=rg.focus,this.aspect=rg.aspect,this.view=null===rg.view?null:Object.assign({},rg.view),this.filmGauge=rg.filmGauge,this.filmOffset=rg.filmOffset,this},setFocalLength:function(rg){var ag=0.5*this.getFilmHeight()/rg;this.fov=2*Sp.RAD2DEG*Math.atan(ag),this.updateProjectionMatrix()},getFocalLength:function(){var rg=Math.tan(0.5*Sp.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/rg},getEffectiveFOV:function(){return 2*Sp.RAD2DEG*Math.atan(Math.tan(0.5*Sp.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(rg,ag,og,ig,ng,sg){this.aspect=rg/ag,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=rg,this.view.fullHeight=ag,this.view.offsetX=og,this.view.offsetY=ig,this.view.width=ng,this.view.height=sg,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var rg=this.near,ag=rg*Math.tan(0.5*Sp.DEG2RAD*this.fov)/this.zoom,og=2*ag,ig=this.aspect*og,ng=-0.5*ig,sg=this.view;if(null!==this.view&&this.view.enabled){var lg=sg.fullWidth,pg=sg.fullHeight;ng+=sg.offsetX*ig/lg,ag-=sg.offsetY*og/pg,ig*=sg.width/lg,og*=sg.height/pg}var dg=this.filmOffset;0!==dg&&(ng+=rg*dg/this.getFilmWidth()),this.projectionMatrix.makePerspective(ng,ng+ig,ag,ag-og,rg,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(rg){var ag=ee.prototype.toJSON.call(this,rg);return ag.object.fov=this.fov,ag.object.zoom=this.zoom,ag.object.near=this.near,ag.object.far=this.far,ag.object.focus=this.focus,ag.object.aspect=this.aspect,null!==this.view&&(ag.object.view=Object.assign({},this.view)),ag.object.filmGauge=this.filmGauge,ag.object.filmOffset=this.filmOffset,ag}}),lr.prototype=Object.assign(Object.create(sr.prototype),{constructor:lr,isArrayCamera:!0});var lm=new C,pm=new C;ur.prototype.isFogExp2=!0,ur.prototype.clone=function(){return new ur(this.color,this.density)},ur.prototype.toJSON=function(){return{type:'FogExp2',color:this.color.getHex(),density:this.density}},gr.prototype.isFog=!0,gr.prototype.clone=function(){return new gr(this.color,this.near,this.far)},gr.prototype.toJSON=function(){return{type:'Fog',color:this.color.getHex(),near:this.near,far:this.far}},fr.prototype=Object.assign(Object.create(ee.prototype),{constructor:fr,copy:function(rg,ag){return ee.prototype.copy.call(this,rg,ag),null!==rg.background&&(this.background=rg.background.clone()),null!==rg.fog&&(this.fog=rg.fog.clone()),null!==rg.overrideMaterial&&(this.overrideMaterial=rg.overrideMaterial.clone()),this.autoUpdate=rg.autoUpdate,this.matrixAutoUpdate=rg.matrixAutoUpdate,this},toJSON:function(rg){var ag=ee.prototype.toJSON.call(this,rg);return null!==this.background&&(ag.object.background=this.background.toJSON(rg)),null!==this.fog&&(ag.object.fog=this.fog.toJSON()),ag}}),Object.defineProperty(hr.prototype,'needsUpdate',{set:function(rg){!0===rg&&this.version++}}),Object.assign(hr.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(rg){if(Array.isArray(rg))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');return this.count=void 0===rg?0:rg.length/this.stride,this.array=rg,this},setDynamic:function(rg){return this.dynamic=rg,this},copy:function(rg){return this.array=new rg.array.constructor(rg.array),this.count=rg.count,this.stride=rg.stride,this.dynamic=rg.dynamic,this},copyAt:function(rg,ag,og){rg*=this.stride,og*=ag.stride;for(var ig=0,ng=this.stride;ig<ng;ig++)this.array[rg+ig]=ag.array[og+ig];return this},set:function(rg,ag){return void 0===ag&&(ag=0),this.array.set(rg,ag),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(rg){return this.onUploadCallback=rg,this}}),Object.defineProperties(yr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(yr.prototype,{isInterleavedBufferAttribute:!0,setX:function(rg,ag){return this.data.array[rg*this.data.stride+this.offset]=ag,this},setY:function(rg,ag){return this.data.array[rg*this.data.stride+this.offset+1]=ag,this},setZ:function(rg,ag){return this.data.array[rg*this.data.stride+this.offset+2]=ag,this},setW:function(rg,ag){return this.data.array[rg*this.data.stride+this.offset+3]=ag,this},getX:function(rg){return this.data.array[rg*this.data.stride+this.offset]},getY:function(rg){return this.data.array[rg*this.data.stride+this.offset+1]},getZ:function(rg){return this.data.array[rg*this.data.stride+this.offset+2]},getW:function(rg){return this.data.array[rg*this.data.stride+this.offset+3]},setXY:function(rg,ag,og){return rg=rg*this.data.stride+this.offset,this.data.array[rg+0]=ag,this.data.array[rg+1]=og,this},setXYZ:function(rg,ag,og,ig){return rg=rg*this.data.stride+this.offset,this.data.array[rg+0]=ag,this.data.array[rg+1]=og,this.data.array[rg+2]=ig,this},setXYZW:function(rg,ag,og,ig,ng){return rg=rg*this.data.stride+this.offset,this.data.array[rg+0]=ag,this.data.array[rg+1]=og,this.data.array[rg+2]=ig,this.data.array[rg+3]=ng,this}}),xr.prototype=Object.create(Ee.prototype),xr.prototype.constructor=xr,xr.prototype.isSpriteMaterial=!0,xr.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.map=rg.map,this.rotation=rg.rotation,this.sizeAttenuation=rg.sizeAttenuation,this};var dm;_r.prototype=Object.assign(Object.create(ee.prototype),{constructor:_r,isSprite:!0,raycast:function(){function rg(fg,hg,yg,xg,vg,_g){ng.subVectors(fg,yg).addScalar(0.5).multiply(xg),void 0===vg?sg.copy(ng):(sg.x=_g*ng.x-vg*ng.y,sg.y=vg*ng.x+_g*ng.y),fg.copy(hg),fg.x+=sg.x,fg.y+=sg.y,fg.applyMatrix4(lg)}var ag=new C,og=new C,ig=new C,ng=new E,sg=new E,lg=new L,pg=new C,dg=new C,cg=new C,mg=new E,ug=new E,gg=new E;return function(hg,yg){og.setFromMatrixScale(this.matrixWorld),lg.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),ig.setFromMatrixPosition(this.modelViewMatrix);var xg=this.material.rotation,vg,_g;0!==xg&&(_g=Math.cos(xg),vg=Math.sin(xg));var bg=this.center;rg(pg.set(-0.5,-0.5,0),ig,bg,og,vg,_g),rg(dg.set(0.5,-0.5,0),ig,bg,og,vg,_g),rg(cg.set(0.5,0.5,0),ig,bg,og,vg,_g),mg.set(0,0),ug.set(1,0),gg.set(1,1);var Sg=hg.ray.intersectTriangle(pg,dg,cg,!1,ag);if(!(null===Sg&&(rg(dg.set(-0.5,0.5,0),ig,bg,og,vg,_g),ug.set(0,1),Sg=hg.ray.intersectTriangle(pg,cg,dg,!1,ag),null===Sg))){var Mg=hg.ray.origin.distanceTo(ag);Mg<hg.near||Mg>hg.far||yg.push({distance:Mg,point:ag.clone(),uv:Pe.getUV(ag,pg,dg,cg,mg,ug,gg,new E),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(rg){return ee.prototype.copy.call(this,rg),void 0!==rg.center&&this.center.copy(rg.center),this}}),br.prototype=Object.assign(Object.create(ee.prototype),{constructor:br,copy:function(rg){ee.prototype.copy.call(this,rg,!1);for(var ag=rg.levels,og=0,ig=ag.length,ng;og<ig;og++)ng=ag[og],this.addLevel(ng.object.clone(),ng.distance);return this},addLevel:function(rg,ag){void 0===ag&&(ag=0),ag=Math.abs(ag);for(var og=this.levels,ig=0;ig<og.length&&!(ag<og[ig].distance);ig++);og.splice(ig,0,{distance:ag,object:rg}),this.add(rg)},getObjectForDistance:function(rg){for(var ag=this.levels,og=1,ig=ag.length;og<ig&&!(rg<ag[og].distance);og++);return ag[og-1].object},raycast:function(){var rg=new C;return function(og,ig){rg.setFromMatrixPosition(this.matrixWorld);var ng=og.ray.origin.distanceTo(rg);this.getObjectForDistance(ng).raycast(og,ig)}}(),update:function(){var rg=new C,ag=new C;return function(ig){var ng=this.levels;if(1<ng.length){rg.setFromMatrixPosition(ig.matrixWorld),ag.setFromMatrixPosition(this.matrixWorld);var sg=rg.distanceTo(ag);ng[0].object.visible=!0;for(var lg=1,pg=ng.length;lg<pg&&sg>=ng[lg].distance;lg++)ng[lg-1].object.visible=!1,ng[lg].object.visible=!0;for(;lg<pg;lg++)ng[lg].object.visible=!1}}}(),toJSON:function(rg){var ag=ee.prototype.toJSON.call(this,rg);ag.object.levels=[];for(var og=this.levels,ig=0,ng=og.length,sg;ig<ng;ig++)sg=og[ig],ag.object.levels.push({object:sg.object.uuid,distance:sg.distance});return ag}}),Object.assign(Sr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var rg=0,ag=this.bones.length,og;rg<ag;rg++)og=new L,this.bones[rg]&&og.getInverse(this.bones[rg].matrixWorld),this.boneInverses.push(og)},pose:function(){var rg,ag,og;for(ag=0,og=this.bones.length;ag<og;ag++)rg=this.bones[ag],rg&&rg.matrixWorld.getInverse(this.boneInverses[ag]);for(ag=0,og=this.bones.length;ag<og;ag++)rg=this.bones[ag],rg&&(rg.parent&&rg.parent.isBone?(rg.matrix.getInverse(rg.parent.matrixWorld),rg.matrix.multiply(rg.matrixWorld)):rg.matrix.copy(rg.matrixWorld),rg.matrix.decompose(rg.position,rg.quaternion,rg.scale))},update:function(){var rg=new L,ag=new L;return function(){for(var ig=this.bones,ng=this.boneInverses,sg=this.boneMatrices,lg=this.boneTexture,pg=0,dg=ig.length,cg;pg<dg;pg++)cg=ig[pg]?ig[pg].matrixWorld:ag,rg.multiplyMatrices(cg,ng[pg]),rg.toArray(sg,16*pg);void 0!==lg&&(lg.needsUpdate=!0)}}(),clone:function(){return new Sr(this.bones,this.boneInverses)},getBoneByName:function(rg){for(var ag=0,og=this.bones.length,ig;ag<og;ag++)if(ig=this.bones[ag],ig.name===rg)return ig}}),Mr.prototype=Object.assign(Object.create(ee.prototype),{constructor:Mr,isBone:!0}),Tr.prototype=Object.assign(Object.create(Ce.prototype),{constructor:Tr,isSkinnedMesh:!0,initBones:function(){var rg=[],ag,og,ig,ng;if(this.geometry&&void 0!==this.geometry.bones){for(ig=0,ng=this.geometry.bones.length;ig<ng;ig++)og=this.geometry.bones[ig],ag=new Mr,rg.push(ag),ag.name=og.name,ag.position.fromArray(og.pos),ag.quaternion.fromArray(og.rotq),void 0!==og.scl&&ag.scale.fromArray(og.scl);for(ig=0,ng=this.geometry.bones.length;ig<ng;ig++)og=this.geometry.bones[ig],-1!==og.parent&&null!==og.parent&&void 0!==rg[og.parent]?rg[og.parent].add(rg[ig]):this.add(rg[ig])}return this.updateMatrixWorld(!0),rg},bind:function(rg,ag){this.skeleton=rg,void 0===ag&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),ag=this.matrixWorld),this.bindMatrix.copy(ag),this.bindMatrixInverse.getInverse(ag)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var rg,ag;if(this.geometry&&this.geometry.isGeometry)for(ag=0;ag<this.geometry.skinWeights.length;ag++){var og=this.geometry.skinWeights[ag];rg=1/og.manhattanLength(),rg===Infinity?og.set(1,0,0,0):og.multiplyScalar(rg)}else if(this.geometry&&this.geometry.isBufferGeometry){var ig=new D,ng=this.geometry.attributes.skinWeight;for(ag=0;ag<ng.count;ag++)ig.x=ng.getX(ag),ig.y=ng.getY(ag),ig.z=ng.getZ(ag),ig.w=ng.getW(ag),rg=1/ig.manhattanLength(),rg===Infinity?ig.set(1,0,0,0):ig.multiplyScalar(rg),ng.setXYZW(ag,ig.x,ig.y,ig.z,ig.w)}},updateMatrixWorld:function(rg){Ce.prototype.updateMatrixWorld.call(this,rg),'attached'===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):'detached'===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn('THREE.SkinnedMesh: Unrecognized bindMode: '+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Er.prototype=Object.create(Ee.prototype),Er.prototype.constructor=Er,Er.prototype.isLineBasicMaterial=!0,Er.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.linewidth=rg.linewidth,this.linecap=rg.linecap,this.linejoin=rg.linejoin,this},wr.prototype=Object.assign(Object.create(ee.prototype),{constructor:wr,isLine:!0,computeLineDistances:function(){var rg=new C,ag=new C;return function(){var ig=this.geometry;if(ig.isBufferGeometry){if(null===ig.index){for(var ng=ig.attributes.position,sg=[0],lg=1,pg=ng.count;lg<pg;lg++)rg.fromBufferAttribute(ng,lg-1),ag.fromBufferAttribute(ng,lg),sg[lg]=sg[lg-1],sg[lg]+=rg.distanceTo(ag);ig.addAttribute('lineDistance',new fe(sg,1))}else console.warn('THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.');}else if(ig.isGeometry){var dg=ig.vertices,sg=ig.lineDistances;sg[0]=0;for(var lg=1,pg=dg.length;lg<pg;lg++)sg[lg]=sg[lg-1],sg[lg]+=dg[lg-1].distanceTo(dg[lg])}return this}}(),raycast:function(){var rg=new L,ag=new Le,og=new H;return function(ng,sg){var lg=ng.linePrecision,pg=this.geometry,dg=this.matrixWorld;if(null===pg.boundingSphere&&pg.computeBoundingSphere(),og.copy(pg.boundingSphere),og.applyMatrix4(dg),og.radius+=lg,!1!==ng.ray.intersectsSphere(og)){rg.getInverse(dg),ag.copy(ng.ray).applyMatrix4(rg);var cg=lg/((this.scale.x+this.scale.y+this.scale.z)/3),mg=cg*cg,ug=new C,gg=new C,fg=new C,hg=new C,yg=this&&this.isLineSegments?2:1;if(pg.isBufferGeometry){var xg=pg.index,vg=pg.attributes,_g=vg.position.array;if(null!==xg)for(var bg=xg.array,Sg=0,Mg=bg.length-1;Sg<Mg;Sg+=yg){var Tg=bg[Sg],Eg=bg[Sg+1];ug.fromArray(_g,3*Tg),gg.fromArray(_g,3*Eg);var wg=ag.distanceSqToSegment(ug,gg,hg,fg);if(!(wg>mg)){hg.applyMatrix4(this.matrixWorld);var Lg=ng.ray.origin.distanceTo(hg);Lg<ng.near||Lg>ng.far||sg.push({distance:Lg,point:fg.clone().applyMatrix4(this.matrixWorld),index:Sg,face:null,faceIndex:null,object:this})}}else for(var Sg=0,Mg=_g.length/3-1;Sg<Mg;Sg+=yg){ug.fromArray(_g,3*Sg),gg.fromArray(_g,3*Sg+3);var wg=ag.distanceSqToSegment(ug,gg,hg,fg);if(!(wg>mg)){hg.applyMatrix4(this.matrixWorld);var Lg=ng.ray.origin.distanceTo(hg);Lg<ng.near||Lg>ng.far||sg.push({distance:Lg,point:fg.clone().applyMatrix4(this.matrixWorld),index:Sg,face:null,faceIndex:null,object:this})}}}else if(pg.isGeometry)for(var Pg=pg.vertices,Ag=Pg.length,Sg=0,wg;Sg<Ag-1;Sg+=yg)if(wg=ag.distanceSqToSegment(Pg[Sg],Pg[Sg+1],hg,fg),!(wg>mg)){hg.applyMatrix4(this.matrixWorld);var Lg=ng.ray.origin.distanceTo(hg);Lg<ng.near||Lg>ng.far||sg.push({distance:Lg,point:fg.clone().applyMatrix4(this.matrixWorld),index:Sg,face:null,faceIndex:null,object:this})}}}}(),copy:function(rg){return ee.prototype.copy.call(this,rg),this.geometry.copy(rg.geometry),this.material.copy(rg.material),this},clone:function(){return new this.constructor().copy(this)}}),Lr.prototype=Object.assign(Object.create(wr.prototype),{constructor:Lr,isLineSegments:!0,computeLineDistances:function(){var rg=new C,ag=new C;return function(){var ig=this.geometry;if(ig.isBufferGeometry){if(null===ig.index){for(var ng=ig.attributes.position,sg=[],lg=0,pg=ng.count;lg<pg;lg+=2)rg.fromBufferAttribute(ng,lg),ag.fromBufferAttribute(ng,lg+1),sg[lg]=0==lg?0:sg[lg-1],sg[lg+1]=sg[lg]+rg.distanceTo(ag);ig.addAttribute('lineDistance',new fe(sg,1))}else console.warn('THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.');}else if(ig.isGeometry)for(var dg=ig.vertices,sg=ig.lineDistances,lg=0,pg=dg.length;lg<pg;lg+=2)rg.copy(dg[lg]),ag.copy(dg[lg+1]),sg[lg]=0==lg?0:sg[lg-1],sg[lg+1]=sg[lg]+rg.distanceTo(ag);return this}}()}),Pr.prototype=Object.assign(Object.create(wr.prototype),{constructor:Pr,isLineLoop:!0}),Ar.prototype=Object.create(Ee.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isPointsMaterial=!0,Ar.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.map=rg.map,this.size=rg.size,this.sizeAttenuation=rg.sizeAttenuation,this.morphTargets=rg.morphTargets,this},Cr.prototype=Object.assign(Object.create(ee.prototype),{constructor:Cr,isPoints:!0,raycast:function(){var rg=new L,ag=new Le,og=new H;return function(ng,sg){function lg(wg,Lg){var Pg=ag.distanceSqToPoint(wg);if(Pg<gg){ag.closestPointToPoint(wg,hg),hg.applyMatrix4(cg);var Ag=ng.ray.origin.distanceTo(hg);if(Ag<ng.near||Ag>ng.far)return;sg.push({distance:Ag,distanceToRay:Math.sqrt(Pg),point:hg.clone(),index:Lg,face:null,object:pg})}}var pg=this,dg=this.geometry,cg=this.matrixWorld,mg=ng.params.Points.threshold;if(null===dg.boundingSphere&&dg.computeBoundingSphere(),og.copy(dg.boundingSphere),og.applyMatrix4(cg),og.radius+=mg,!1!==ng.ray.intersectsSphere(og)){rg.getInverse(cg),ag.copy(ng.ray).applyMatrix4(rg);var ug=mg/((this.scale.x+this.scale.y+this.scale.z)/3),gg=ug*ug,fg=new C,hg=new C;if(dg.isBufferGeometry){var yg=dg.index,xg=dg.attributes,vg=xg.position.array;if(null!==yg)for(var _g=yg.array,bg=0,Sg=_g.length,Mg;bg<Sg;bg++)Mg=_g[bg],fg.fromArray(vg,3*Mg),lg(fg,Mg);else for(var bg=0,Tg=vg.length/3;bg<Tg;bg++)fg.fromArray(vg,3*bg),lg(fg,bg)}else for(var Eg=dg.vertices,bg=0,Tg=Eg.length;bg<Tg;bg++)lg(Eg[bg],bg)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Rr.prototype=Object.assign(Object.create(I.prototype),{constructor:Rr,isVideoTexture:!0,update:function(){var rg=this.image;rg.readyState>=rg.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ir.prototype=Object.create(I.prototype),Ir.prototype.constructor=Ir,Ir.prototype.isCompressedTexture=!0,zr.prototype=Object.create(I.prototype),zr.prototype.constructor=zr,zr.prototype.isCanvasTexture=!0,Dr.prototype=Object.create(I.prototype),Dr.prototype.constructor=Dr,Dr.prototype.isDepthTexture=!0,Br.prototype=Object.create(ve.prototype),Br.prototype.constructor=Br,Nr.prototype=Object.create(re.prototype),Nr.prototype.constructor=Nr,Ur.prototype=Object.create(ve.prototype),Ur.prototype.constructor=Ur,Gr.prototype=Object.create(re.prototype),Gr.prototype.constructor=Gr,Or.prototype=Object.create(ve.prototype),Or.prototype.constructor=Or,Fr.prototype=Object.create(re.prototype),Fr.prototype.constructor=Fr,Hr.prototype=Object.create(Or.prototype),Hr.prototype.constructor=Hr,Vr.prototype=Object.create(re.prototype),Vr.prototype.constructor=Vr,kr.prototype=Object.create(Or.prototype),kr.prototype.constructor=kr,Wr.prototype=Object.create(re.prototype),Wr.prototype.constructor=Wr,jr.prototype=Object.create(Or.prototype),jr.prototype.constructor=jr,qr.prototype=Object.create(re.prototype),qr.prototype.constructor=qr,Yr.prototype=Object.create(Or.prototype),Yr.prototype.constructor=Yr,Xr.prototype=Object.create(re.prototype),Xr.prototype.constructor=Xr,Zr.prototype=Object.create(ve.prototype),Zr.prototype.constructor=Zr,Jr.prototype=Object.create(re.prototype),Jr.prototype.constructor=Jr,Qr.prototype=Object.create(ve.prototype),Qr.prototype.constructor=Qr,Kr.prototype=Object.create(re.prototype),Kr.prototype.constructor=Kr,$r.prototype=Object.create(ve.prototype),$r.prototype.constructor=$r;var cm={triangulate:function(rg,ag,og){og=og||2;var ig=ag&&ag.length,ng=ig?ag[0]*og:rg.length,sg=ea(rg,0,ng,og,!0),lg=[];if(!sg)return lg;var pg,dg,cg,mg,ug,gg,fg;if(ig&&(sg=sa(rg,ag,sg,og)),rg.length>80*og){pg=cg=rg[0],dg=mg=rg[1];for(var hg=og;hg<ng;hg+=og)ug=rg[hg],gg=rg[hg+1],ug<pg&&(pg=ug),gg<dg&&(dg=gg),ug>cg&&(cg=ug),gg>mg&&(mg=gg);fg=Math.max(cg-pg,mg-dg),fg=0===fg?0:1/fg}return ra(sg,lg,og,pg,dg,fg),lg}},mm={area:function(rg){for(var ag=rg.length,og=0,ig=ag-1,ng=0;ng<ag;ig=ng++)og+=rg[ig].x*rg[ng].y-rg[ng].x*rg[ig].y;return 0.5*og},isClockWise:function(rg){return 0>mm.area(rg)},triangulateShape:function(rg,ag){var og=[],ig=[],ng=[];Aa(rg),Ca(og,rg);var sg=rg.length;ag.forEach(Aa);for(var lg=0;lg<ag.length;lg++)ig.push(sg),sg+=ag[lg].length,Ca(og,ag[lg]);for(var pg=cm.triangulate(og,ig),lg=0;lg<pg.length;lg+=3)ng.push(pg.slice(lg,lg+3));return ng}};Ra.prototype=Object.create(re.prototype),Ra.prototype.constructor=Ra,Ra.prototype.toJSON=function(){var rg=re.prototype.toJSON.call(this),ag=this.parameters.shapes,og=this.parameters.options;return za(ag,og,rg)},Ia.prototype=Object.create(ve.prototype),Ia.prototype.constructor=Ia,Ia.prototype.toJSON=function(){var rg=ve.prototype.toJSON.call(this),ag=this.parameters.shapes,og=this.parameters.options;return za(ag,og,rg)};var um={generateTopUV:function(rg,ag,og,ig,ng){var sg=ag[3*og],lg=ag[3*og+1],pg=ag[3*ig],dg=ag[3*ig+1],cg=ag[3*ng],mg=ag[3*ng+1];return[new E(sg,lg),new E(pg,dg),new E(cg,mg)]},generateSideWallUV:function(rg,ag,og,ig,ng,sg){var lg=ag[3*og],pg=ag[3*og+1],dg=ag[3*og+2],cg=ag[3*ig],mg=ag[3*ig+1],ug=ag[3*ig+2],gg=ag[3*ng],fg=ag[3*ng+1],hg=ag[3*ng+2],yg=ag[3*sg],xg=ag[3*sg+1],vg=ag[3*sg+2];return 0.01>Math.abs(pg-mg)?[new E(lg,1-dg),new E(cg,1-ug),new E(gg,1-hg),new E(yg,1-vg)]:[new E(pg,1-dg),new E(mg,1-ug),new E(fg,1-hg),new E(xg,1-vg)]}};Da.prototype=Object.create(re.prototype),Da.prototype.constructor=Da,Ba.prototype=Object.create(Ia.prototype),Ba.prototype.constructor=Ba,Na.prototype=Object.create(re.prototype),Na.prototype.constructor=Na,Ua.prototype=Object.create(ve.prototype),Ua.prototype.constructor=Ua,Ga.prototype=Object.create(re.prototype),Ga.prototype.constructor=Ga,Oa.prototype=Object.create(ve.prototype),Oa.prototype.constructor=Oa,Fa.prototype=Object.create(re.prototype),Fa.prototype.constructor=Fa,Ha.prototype=Object.create(ve.prototype),Ha.prototype.constructor=Ha,Va.prototype=Object.create(re.prototype),Va.prototype.constructor=Va,Va.prototype.toJSON=function(){var rg=re.prototype.toJSON.call(this),ag=this.parameters.shapes;return Wa(ag,rg)},ka.prototype=Object.create(ve.prototype),ka.prototype.constructor=ka,ka.prototype.toJSON=function(){var rg=ve.prototype.toJSON.call(this),ag=this.parameters.shapes;return Wa(ag,rg)},ja.prototype=Object.create(ve.prototype),ja.prototype.constructor=ja,Ya.prototype=Object.create(re.prototype),Ya.prototype.constructor=Ya,Xa.prototype=Object.create(ve.prototype),Xa.prototype.constructor=Xa,Za.prototype=Object.create(Ya.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(Xa.prototype),Ja.prototype.constructor=Ja,Qa.prototype=Object.create(re.prototype),Qa.prototype.constructor=Qa,Ka.prototype=Object.create(ve.prototype),Ka.prototype.constructor=Ka;var gm=Object.freeze({WireframeGeometry:Br,ParametricGeometry:Nr,ParametricBufferGeometry:Ur,TetrahedronGeometry:Fr,TetrahedronBufferGeometry:Hr,OctahedronGeometry:Vr,OctahedronBufferGeometry:kr,IcosahedronGeometry:Wr,IcosahedronBufferGeometry:jr,DodecahedronGeometry:qr,DodecahedronBufferGeometry:Yr,PolyhedronGeometry:Gr,PolyhedronBufferGeometry:Or,TubeGeometry:Xr,TubeBufferGeometry:Zr,TorusKnotGeometry:Jr,TorusKnotBufferGeometry:Qr,TorusGeometry:Kr,TorusBufferGeometry:$r,TextGeometry:Da,TextBufferGeometry:Ba,SphereGeometry:Na,SphereBufferGeometry:Ua,RingGeometry:Ga,RingBufferGeometry:Oa,PlaneGeometry:Me,PlaneBufferGeometry:Te,LatheGeometry:Fa,LatheBufferGeometry:Ha,ShapeGeometry:Va,ShapeBufferGeometry:ka,ExtrudeGeometry:Ra,ExtrudeBufferGeometry:Ia,EdgesGeometry:ja,ConeGeometry:Za,ConeBufferGeometry:Ja,CylinderGeometry:Ya,CylinderBufferGeometry:Xa,CircleGeometry:Qa,CircleBufferGeometry:Ka,BoxGeometry:_e,BoxBufferGeometry:Se});$a.prototype=Object.create(Ee.prototype),$a.prototype.constructor=$a,$a.prototype.isShadowMaterial=!0,$a.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this},eo.prototype=Object.create(we.prototype),eo.prototype.constructor=eo,eo.prototype.isRawShaderMaterial=!0,ro.prototype=Object.create(Ee.prototype),ro.prototype.constructor=ro,ro.prototype.isMeshStandardMaterial=!0,ro.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.defines={STANDARD:''},this.color.copy(rg.color),this.roughness=rg.roughness,this.metalness=rg.metalness,this.map=rg.map,this.lightMap=rg.lightMap,this.lightMapIntensity=rg.lightMapIntensity,this.aoMap=rg.aoMap,this.aoMapIntensity=rg.aoMapIntensity,this.emissive.copy(rg.emissive),this.emissiveMap=rg.emissiveMap,this.emissiveIntensity=rg.emissiveIntensity,this.bumpMap=rg.bumpMap,this.bumpScale=rg.bumpScale,this.normalMap=rg.normalMap,this.normalMapType=rg.normalMapType,this.normalScale.copy(rg.normalScale),this.displacementMap=rg.displacementMap,this.displacementScale=rg.displacementScale,this.displacementBias=rg.displacementBias,this.roughnessMap=rg.roughnessMap,this.metalnessMap=rg.metalnessMap,this.alphaMap=rg.alphaMap,this.envMap=rg.envMap,this.envMapIntensity=rg.envMapIntensity,this.refractionRatio=rg.refractionRatio,this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this.wireframeLinecap=rg.wireframeLinecap,this.wireframeLinejoin=rg.wireframeLinejoin,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.morphNormals=rg.morphNormals,this},ao.prototype=Object.create(ro.prototype),ao.prototype.constructor=ao,ao.prototype.isMeshPhysicalMaterial=!0,ao.prototype.copy=function(rg){return ro.prototype.copy.call(this,rg),this.defines={PHYSICAL:''},this.reflectivity=rg.reflectivity,this.clearCoat=rg.clearCoat,this.clearCoatRoughness=rg.clearCoatRoughness,this},oo.prototype=Object.create(Ee.prototype),oo.prototype.constructor=oo,oo.prototype.isMeshPhongMaterial=!0,oo.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.specular.copy(rg.specular),this.shininess=rg.shininess,this.map=rg.map,this.lightMap=rg.lightMap,this.lightMapIntensity=rg.lightMapIntensity,this.aoMap=rg.aoMap,this.aoMapIntensity=rg.aoMapIntensity,this.emissive.copy(rg.emissive),this.emissiveMap=rg.emissiveMap,this.emissiveIntensity=rg.emissiveIntensity,this.bumpMap=rg.bumpMap,this.bumpScale=rg.bumpScale,this.normalMap=rg.normalMap,this.normalMapType=rg.normalMapType,this.normalScale.copy(rg.normalScale),this.displacementMap=rg.displacementMap,this.displacementScale=rg.displacementScale,this.displacementBias=rg.displacementBias,this.specularMap=rg.specularMap,this.alphaMap=rg.alphaMap,this.envMap=rg.envMap,this.combine=rg.combine,this.reflectivity=rg.reflectivity,this.refractionRatio=rg.refractionRatio,this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this.wireframeLinecap=rg.wireframeLinecap,this.wireframeLinejoin=rg.wireframeLinejoin,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.morphNormals=rg.morphNormals,this},io.prototype=Object.create(oo.prototype),io.prototype.constructor=io,io.prototype.isMeshToonMaterial=!0,io.prototype.copy=function(rg){return oo.prototype.copy.call(this,rg),this.gradientMap=rg.gradientMap,this},no.prototype=Object.create(Ee.prototype),no.prototype.constructor=no,no.prototype.isMeshNormalMaterial=!0,no.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.bumpMap=rg.bumpMap,this.bumpScale=rg.bumpScale,this.normalMap=rg.normalMap,this.normalMapType=rg.normalMapType,this.normalScale.copy(rg.normalScale),this.displacementMap=rg.displacementMap,this.displacementScale=rg.displacementScale,this.displacementBias=rg.displacementBias,this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.morphNormals=rg.morphNormals,this},so.prototype=Object.create(Ee.prototype),so.prototype.constructor=so,so.prototype.isMeshLambertMaterial=!0,so.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.map=rg.map,this.lightMap=rg.lightMap,this.lightMapIntensity=rg.lightMapIntensity,this.aoMap=rg.aoMap,this.aoMapIntensity=rg.aoMapIntensity,this.emissive.copy(rg.emissive),this.emissiveMap=rg.emissiveMap,this.emissiveIntensity=rg.emissiveIntensity,this.specularMap=rg.specularMap,this.alphaMap=rg.alphaMap,this.envMap=rg.envMap,this.combine=rg.combine,this.reflectivity=rg.reflectivity,this.refractionRatio=rg.refractionRatio,this.wireframe=rg.wireframe,this.wireframeLinewidth=rg.wireframeLinewidth,this.wireframeLinecap=rg.wireframeLinecap,this.wireframeLinejoin=rg.wireframeLinejoin,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.morphNormals=rg.morphNormals,this},lo.prototype=Object.create(Ee.prototype),lo.prototype.constructor=lo,lo.prototype.isMeshMatcapMaterial=!0,lo.prototype.copy=function(rg){return Ee.prototype.copy.call(this,rg),this.defines={MATCAP:''},this.color.copy(rg.color),this.matcap=rg.matcap,this.map=rg.map,this.bumpMap=rg.bumpMap,this.bumpScale=rg.bumpScale,this.normalMap=rg.normalMap,this.normalMapType=rg.normalMapType,this.normalScale.copy(rg.normalScale),this.displacementMap=rg.displacementMap,this.displacementScale=rg.displacementScale,this.displacementBias=rg.displacementBias,this.alphaMap=rg.alphaMap,this.skinning=rg.skinning,this.morphTargets=rg.morphTargets,this.morphNormals=rg.morphNormals,this},po.prototype=Object.create(Er.prototype),po.prototype.constructor=po,po.prototype.isLineDashedMaterial=!0,po.prototype.copy=function(rg){return Er.prototype.copy.call(this,rg),this.scale=rg.scale,this.dashSize=rg.dashSize,this.gapSize=rg.gapSize,this};var fm=Object.freeze({ShadowMaterial:$a,SpriteMaterial:xr,RawShaderMaterial:eo,ShaderMaterial:we,PointsMaterial:Ar,MeshPhysicalMaterial:ao,MeshStandardMaterial:ro,MeshPhongMaterial:oo,MeshToonMaterial:io,MeshNormalMaterial:no,MeshLambertMaterial:so,MeshDepthMaterial:$t,MeshDistanceMaterial:er,MeshBasicMaterial:Ae,MeshMatcapMaterial:lo,LineDashedMaterial:po,LineBasicMaterial:Er,Material:Ee}),hm={arraySlice:function(rg,ag,og){return hm.isTypedArray(rg)?new rg.constructor(rg.subarray(ag,void 0===og?rg.length:og)):rg.slice(ag,og)},convertArray:function(rg,ag,og){return rg&&(og||rg.constructor!==ag)?'number'==typeof ag.BYTES_PER_ELEMENT?new ag(rg):Array.prototype.slice.call(rg):rg},isTypedArray:function(rg){return ArrayBuffer.isView(rg)&&!(rg instanceof DataView)},getKeyframeOrder:function(rg){for(var og=rg.length,ig=Array(og),ng=0;ng!==og;++ng)ig[ng]=ng;return ig.sort(function(sg,lg){return rg[sg]-rg[lg]}),ig},sortedArray:function(rg,ag,og){for(var ig=rg.length,ng=new rg.constructor(ig),sg=0,lg=0,pg;lg!==ig;++sg){pg=og[sg]*ag;for(var dg=0;dg!==ag;++dg)ng[lg++]=rg[pg+dg]}return ng},flattenJSON:function(rg,ag,og,ig){for(var ng=1,sg=rg[0];void 0!==sg&&void 0===sg[ig];)sg=rg[ng++];if(void 0!==sg){var lg=sg[ig];if(void 0!==lg)if(Array.isArray(lg))do lg=sg[ig],void 0!==lg&&(ag.push(sg.time),og.push.apply(og,lg)),sg=rg[ng++];while(void 0!==sg);else if(void 0!==lg.toArray)do lg=sg[ig],void 0!==lg&&(ag.push(sg.time),lg.toArray(og,og.length)),sg=rg[ng++];while(void 0!==sg);else do lg=sg[ig],void 0!==lg&&(ag.push(sg.time),og.push(lg)),sg=rg[ng++];while(void 0!==sg)}}};Object.assign(co.prototype,{evaluate:function(rg){var ag=this.parameterPositions,og=this._cachedIndex,ig=ag[og],ng=ag[og-1];validate_interval:{seek:{var sg;linear_scan:{forward_scan:if(!(rg<ig)){for(var lg=og+2;;){if(void 0===ig){if(rg<ng)break forward_scan;return og=ag.length,this._cachedIndex=og,this.afterEnd_(og-1,rg,ng)}if(og===lg)break;if(ng=ig,ig=ag[++og],rg<ig)break seek}sg=ag.length;break linear_scan}if(!(rg>=ng)){var pg=ag[1];rg<pg&&(og=2,ng=pg);for(var lg=og-2;;){if(void 0===ng)return this._cachedIndex=0,this.beforeStart_(0,rg,ig);if(og===lg)break;if(ig=ng,ng=ag[--og-1],rg>=ng)break seek}sg=og,og=0;break linear_scan}break validate_interval}for(;og<sg;){var dg=og+sg>>>1;rg<ag[dg]?sg=dg:og=dg+1}if(ig=ag[og],ng=ag[og-1],void 0===ng)return this._cachedIndex=0,this.beforeStart_(0,rg,ig);if(void 0===ig)return og=ag.length,this._cachedIndex=og,this.afterEnd_(og-1,ng,rg)}this._cachedIndex=og,this.intervalChanged_(og,ng,ig)}return this.interpolate_(og,ng,rg,ig)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(rg){for(var ag=this.resultBuffer,og=this.sampleValues,ig=this.valueSize,sg=0;sg!==ig;++sg)ag[sg]=og[rg*ig+sg];return ag},interpolate_:function(){throw new Error('call to abstract method')},intervalChanged_:function(){}}),Object.assign(co.prototype,{beforeStart_:co.prototype.copySampleValue_,afterEnd_:co.prototype.copySampleValue_}),mo.prototype=Object.assign(Object.create(co.prototype),{constructor:mo,DefaultSettings_:{endingStart:rp,endingEnd:rp},intervalChanged_:function(rg,ag,og){var ig=this.parameterPositions,ng=rg-2,sg=rg+1,lg=ig[ng],pg=ig[sg];if(void 0===lg)switch(this.getSettings_().endingStart){case ap:ng=rg,lg=2*ag-og;break;case op:ng=ig.length-2,lg=ag+ig[ng]-ig[ng+1];break;default:ng=rg,lg=og;}if(void 0===pg)switch(this.getSettings_().endingEnd){case ap:sg=rg,pg=2*og-ag;break;case op:sg=1,pg=og+ig[1]-ig[0];break;default:sg=rg-1,pg=ag;}var dg=0.5*(og-ag),cg=this.valueSize;this._weightPrev=dg/(ag-lg),this._weightNext=dg/(pg-og),this._offsetPrev=ng*cg,this._offsetNext=sg*cg},interpolate_:function(rg,ag,og,ig){for(var ng=this.resultBuffer,sg=this.sampleValues,lg=this.valueSize,pg=rg*lg,cg=this._offsetPrev,mg=this._offsetNext,ug=this._weightPrev,gg=this._weightNext,fg=(og-ag)/(ig-ag),hg=fg*fg,yg=hg*fg,Sg=0;Sg!==lg;++Sg)ng[Sg]=(-ug*yg+2*ug*hg-ug*fg)*sg[cg+Sg]+((1+ug)*yg+(-1.5-2*ug)*hg+(-0.5+ug)*fg+1)*sg[pg-lg+Sg]+((-1-gg)*yg+(1.5+gg)*hg+0.5*fg)*sg[pg+Sg]+(gg*yg-gg*hg)*sg[mg+Sg];return ng}}),uo.prototype=Object.assign(Object.create(co.prototype),{constructor:uo,interpolate_:function(rg,ag,og,ig){for(var ng=this.resultBuffer,sg=this.sampleValues,lg=this.valueSize,pg=rg*lg,cg=(og-ag)/(ig-ag),ug=0;ug!==lg;++ug)ng[ug]=sg[pg-lg+ug]*(1-cg)+sg[pg+ug]*cg;return ng}}),go.prototype=Object.assign(Object.create(co.prototype),{constructor:go,interpolate_:function(rg){return this.copySampleValue_(rg-1)}}),Object.assign(fo,{toJSON:function(rg){var ag=rg.constructor,og;if(void 0!==ag.toJSON)og=ag.toJSON(rg);else{og={name:rg.name,times:hm.convertArray(rg.times,Array),values:hm.convertArray(rg.values,Array)};var ig=rg.getInterpolation();ig!==rg.DefaultInterpolation&&(og.interpolation=ig)}return og.type=rg.ValueTypeName,og}}),Object.assign(fo.prototype,{constructor:fo,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ep,InterpolantFactoryMethodDiscrete:function(rg){return new go(this.times,this.values,this.getValueSize(),rg)},InterpolantFactoryMethodLinear:function(rg){return new uo(this.times,this.values,this.getValueSize(),rg)},InterpolantFactoryMethodSmooth:function(rg){return new mo(this.times,this.values,this.getValueSize(),rg)},setInterpolation:function(rg){var ag;if(rg===$l?ag=this.InterpolantFactoryMethodDiscrete:rg===ep?ag=this.InterpolantFactoryMethodLinear:rg===tp?ag=this.InterpolantFactoryMethodSmooth:void 0,void 0===ag){var og='unsupported interpolation for '+this.ValueTypeName+' keyframe track named '+this.name;if(void 0===this.createInterpolant)if(rg!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(og);return console.warn('THREE.KeyframeTrack:',og),this}return this.createInterpolant=ag,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $l;case this.InterpolantFactoryMethodLinear:return ep;case this.InterpolantFactoryMethodSmooth:return tp;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(rg){if(0!==rg)for(var ag=this.times,og=0,ig=ag.length;og!==ig;++og)ag[og]+=rg;return this},scale:function(rg){if(1!==rg)for(var ag=this.times,og=0,ig=ag.length;og!==ig;++og)ag[og]*=rg;return this},trim:function(rg,ag){for(var og=this.times,ig=og.length,ng=0,sg=ig-1;ng!==ig&&og[ng]<rg;)++ng;for(;-1!=sg&&og[sg]>ag;)--sg;if(++sg,0!==ng||sg!==ig){ng>=sg&&(sg=Math.max(sg,1),ng=sg-1);var lg=this.getValueSize();this.times=hm.arraySlice(og,ng,sg),this.values=hm.arraySlice(this.values,ng*lg,sg*lg)}return this},validate:function(){var rg=!0,ag=this.getValueSize();0!=ag-Math.floor(ag)&&(console.error('THREE.KeyframeTrack: Invalid value size in track.',this),rg=!1);var og=this.times,ig=this.values,ng=og.length;0===ng&&(console.error('THREE.KeyframeTrack: Track is empty.',this),rg=!1);for(var sg=null,lg=0,pg;lg!==ng;lg++){if(pg=og[lg],'number'==typeof pg&&isNaN(pg)){console.error('THREE.KeyframeTrack: Time is not a valid number.',this,lg,pg),rg=!1;break}if(null!=sg&&sg>pg){console.error('THREE.KeyframeTrack: Out of order keys.',this,lg,pg,sg),rg=!1;break}sg=pg}if(void 0!==ig&&hm.isTypedArray(ig))for(var lg=0,dg=ig.length,cg;lg!==dg;++lg)if(cg=ig[lg],isNaN(cg)){console.error('THREE.KeyframeTrack: Value is not a valid number.',this,lg,cg),rg=!1;break}return rg},optimize:function(){for(var rg=this.times,ag=this.values,og=this.getValueSize(),ig=this.getInterpolation()===tp,ng=1,sg=rg.length-1,lg=1;lg<sg;++lg){var pg=!1,dg=rg[lg],cg=rg[lg+1];if(dg!==cg&&(1!==lg||dg!==dg[0]))if(!ig){for(var mg=lg*og,fg=0,hg;fg!==og;++fg)if(hg=ag[mg+fg],hg!==ag[mg-og+fg]||hg!==ag[mg+og+fg]){pg=!0;break}}else pg=!0;if(pg){if(lg!==ng){rg[ng]=rg[lg];for(var yg=lg*og,xg=ng*og,fg=0;fg!==og;++fg)ag[xg+fg]=ag[yg+fg]}++ng}}if(0<sg){rg[ng]=rg[sg];for(var yg=sg*og,xg=ng*og,fg=0;fg!==og;++fg)ag[xg+fg]=ag[yg+fg];++ng}return ng!==rg.length&&(this.times=hm.arraySlice(rg,0,ng),this.values=hm.arraySlice(ag,0,ng*og)),this}}),yo.prototype=Object.assign(Object.create(fo.prototype),{constructor:yo,ValueTypeName:'bool',ValueBufferType:Array,DefaultInterpolation:$l,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),xo.prototype=Object.assign(Object.create(fo.prototype),{constructor:xo,ValueTypeName:'color'}),vo.prototype=Object.assign(Object.create(fo.prototype),{constructor:vo,ValueTypeName:'number'}),_o.prototype=Object.assign(Object.create(co.prototype),{constructor:_o,interpolate_:function(rg,ag,og,ig){for(var ng=this.resultBuffer,sg=this.sampleValues,lg=this.valueSize,pg=rg*lg,cg=pg+lg;pg!==cg;pg+=4)A.slerpFlat(ng,0,sg,pg-lg,sg,pg,(og-ag)/(ig-ag));return ng}}),bo.prototype=Object.assign(Object.create(fo.prototype),{constructor:bo,ValueTypeName:'quaternion',DefaultInterpolation:ep,InterpolantFactoryMethodLinear:function(rg){return new _o(this.times,this.values,this.getValueSize(),rg)},InterpolantFactoryMethodSmooth:void 0}),So.prototype=Object.assign(Object.create(fo.prototype),{constructor:So,ValueTypeName:'string',ValueBufferType:Array,DefaultInterpolation:$l,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Mo.prototype=Object.assign(Object.create(fo.prototype),{constructor:Mo,ValueTypeName:'vector'}),Object.assign(To,{parse:function(rg){for(var ag=[],og=rg.tracks,ig=1/(rg.fps||1),ng=0,sg=og.length;ng!==sg;++ng)ag.push(wo(og[ng]).scale(ig));return new To(rg.name,rg.duration,ag)},toJSON:function(rg){for(var ag=[],og=rg.tracks,ig={name:rg.name,duration:rg.duration,tracks:ag,uuid:rg.uuid},ng=0,sg=og.length;ng!==sg;++ng)ag.push(fo.toJSON(og[ng]));return ig},CreateFromMorphTargetSequence:function(rg,ag,og,ig){for(var ng=ag.length,sg=[],lg=0;lg<ng;lg++){var pg=[],dg=[];pg.push((lg+ng-1)%ng,lg,(lg+1)%ng),dg.push(0,1,0);var cg=hm.getKeyframeOrder(pg);pg=hm.sortedArray(pg,1,cg),dg=hm.sortedArray(dg,1,cg),ig||0!==pg[0]||(pg.push(ng),dg.push(dg[0])),sg.push(new vo('.morphTargetInfluences['+ag[lg].name+']',pg,dg).scale(1/og))}return new To(rg,-1,sg)},findByName:function(rg,ag){var og=rg;if(!Array.isArray(rg)){var ig=rg;og=ig.geometry&&ig.geometry.animations||ig.animations}for(var ng=0;ng<og.length;ng++)if(og[ng].name===ag)return og[ng];return null},CreateClipsFromMorphTargetSequences:function(rg,ag,og){for(var ig={},ng=/^([\w-]*?)([\d]+)$/,sg=0,lg=rg.length;sg<lg;sg++){var pg=rg[sg],dg=pg.name.match(ng);if(dg&&1<dg.length){var cg=dg[1],mg=ig[cg];mg||(ig[cg]=mg=[]),mg.push(pg)}}var ug=[];for(var cg in ig)ug.push(To.CreateFromMorphTargetSequence(cg,ig[cg],ag,og));return ug},parseAnimation:function(rg,ag){if(!rg)return console.error('THREE.AnimationClip: No animation in JSONLoader data.'),null;for(var og=function(bg,Sg,Mg,Tg,Eg){if(0!==Mg.length){var wg=[],Lg=[];hm.flattenJSON(Mg,wg,Lg,Tg),0!==wg.length&&Eg.push(new bg(Sg,wg,Lg))}},ig=[],ng=rg.name||'default',sg=rg.length||-1,lg=rg.fps||30,pg=rg.hierarchy||[],dg=0,cg;dg<pg.length;dg++)if(cg=pg[dg].keys,cg&&0!==cg.length)if(cg[0].morphTargets){for(var mg={},ug=0;ug<cg.length;ug++)if(cg[ug].morphTargets)for(var gg=0;gg<cg[ug].morphTargets.length;gg++)mg[cg[ug].morphTargets[gg]]=-1;for(var fg in mg){for(var hg=[],yg=[],gg=0,xg;gg!==cg[ug].morphTargets.length;++gg)xg=cg[ug],hg.push(xg.time),yg.push(xg.morphTarget===fg?1:0);ig.push(new vo('.morphTargetInfluence['+fg+']',hg,yg))}sg=mg.length*(lg||1)}else{var vg='.bones['+ag[dg].name+']';og(Mo,vg+'.position',cg,'pos',ig),og(bo,vg+'.quaternion',cg,'rot',ig),og(Mo,vg+'.scale',cg,'scl',ig)}if(0===ig.length)return null;var _g=new To(ng,sg,ig);return _g}}),Object.assign(To.prototype,{resetDuration:function(){for(var rg=this.tracks,ag=0,og=0,ig=rg.length,ng;og!==ig;++og)ng=this.tracks[og],ag=Math.max(ag,ng.times[ng.times.length-1]);return this.duration=ag,this},trim:function(){for(var rg=0;rg<this.tracks.length;rg++)this.tracks[rg].trim(0,this.duration);return this},validate:function(){for(var rg=!0,ag=0;ag<this.tracks.length;ag++)rg=rg&&this.tracks[ag].validate();return rg},optimize:function(){for(var rg=0;rg<this.tracks.length;rg++)this.tracks[rg].optimize();return this}});var ym={enabled:!1,files:{},add:function(rg,ag){!1===this.enabled||(this.files[rg]=ag)},get:function(rg){return!1===this.enabled?void 0:this.files[rg]},remove:function(rg){delete this.files[rg]},clear:function(){this.files={}}},xm=new Lo,vm={};Object.assign(Po.prototype,{load:function(rg,ag,og,ig){void 0===rg&&(rg=''),void 0!==this.path&&(rg=this.path+rg),rg=this.manager.resolveURL(rg);var ng=this,sg=ym.get(rg);if(void 0!==sg)return ng.manager.itemStart(rg),setTimeout(function(){ag&&ag(sg),ng.manager.itemEnd(rg)},0),sg;if(void 0!==vm[rg])return void vm[rg].push({onLoad:ag,onProgress:og,onError:ig});var lg=/^data:(.*?)(;base64)?,(.*)$/,pg=rg.match(lg);if(pg){var dg=pg[1],cg=!!pg[2],mg=pg[3];mg=decodeURIComponent(mg),cg&&(mg=atob(mg));try{var gg=(this.responseType||'').toLowerCase(),ug;switch(gg){case'arraybuffer':case'blob':for(var fg=new Uint8Array(mg.length),hg=0;hg<mg.length;hg++)fg[hg]=mg.charCodeAt(hg);ug='blob'===gg?new Blob([fg.buffer],{type:dg}):fg.buffer;break;case'document':var yg=new DOMParser;ug=yg.parseFromString(mg,dg);break;case'json':ug=JSON.parse(mg);break;default:ug=mg;}setTimeout(function(){ag&&ag(ug),ng.manager.itemEnd(rg)},0)}catch(_g){setTimeout(function(){ig&&ig(_g),ng.manager.itemError(rg),ng.manager.itemEnd(rg)},0)}}else{vm[rg]=[],vm[rg].push({onLoad:ag,onProgress:og,onError:ig});var xg=new XMLHttpRequest;for(var vg in xg.open('GET',rg,!0),xg.addEventListener('load',function(_g){var bg=this.response;ym.add(rg,bg);var Sg=vm[rg];if(delete vm[rg],200===this.status||0===this.status){0===this.status&&console.warn('THREE.FileLoader: HTTP Status 0 received.');for(var Mg=0,Tg=Sg.length,Eg;Mg<Tg;Mg++)Eg=Sg[Mg],Eg.onLoad&&Eg.onLoad(bg);ng.manager.itemEnd(rg)}else{for(var Mg=0,Tg=Sg.length,Eg;Mg<Tg;Mg++)Eg=Sg[Mg],Eg.onError&&Eg.onError(_g);ng.manager.itemError(rg),ng.manager.itemEnd(rg)}},!1),xg.addEventListener('progress',function(_g){for(var bg=vm[rg],Sg=0,Mg=bg.length,Tg;Sg<Mg;Sg++)Tg=bg[Sg],Tg.onProgress&&Tg.onProgress(_g)},!1),xg.addEventListener('error',function(_g){var bg=vm[rg];delete vm[rg];for(var Sg=0,Mg=bg.length,Tg;Sg<Mg;Sg++)Tg=bg[Sg],Tg.onError&&Tg.onError(_g);ng.manager.itemError(rg),ng.manager.itemEnd(rg)},!1),xg.addEventListener('abort',function(_g){var bg=vm[rg];delete vm[rg];for(var Sg=0,Mg=bg.length,Tg;Sg<Mg;Sg++)Tg=bg[Sg],Tg.onError&&Tg.onError(_g);ng.manager.itemError(rg),ng.manager.itemEnd(rg)},!1),void 0!==this.responseType&&(xg.responseType=this.responseType),void 0!==this.withCredentials&&(xg.withCredentials=this.withCredentials),xg.overrideMimeType&&xg.overrideMimeType(void 0===this.mimeType?'text/plain':this.mimeType),this.requestHeader)xg.setRequestHeader(vg,this.requestHeader[vg]);xg.send(null)}return ng.manager.itemStart(rg),xg},setPath:function(rg){return this.path=rg,this},setResponseType:function(rg){return this.responseType=rg,this},setWithCredentials:function(rg){return this.withCredentials=rg,this},setMimeType:function(rg){return this.mimeType=rg,this},setRequestHeader:function(rg){return this.requestHeader=rg,this}}),Object.assign(function(rg){this.manager=void 0===rg?xm:rg}.prototype,{load:function(rg,ag,og,ig){var ng=this,sg=new Po(ng.manager);sg.setPath(ng.path),sg.load(rg,function(lg){ag(ng.parse(JSON.parse(lg)))},og,ig)},parse:function(rg,ag){for(var og=[],ig=0,ng;ig<rg.length;ig++)ng=To.parse(rg[ig]),og.push(ng);ag(og)},setPath:function(rg){return this.path=rg,this}}),Object.assign(function(rg){this.manager=void 0===rg?xm:rg,this._parser=null}.prototype,{load:function(rg,ag,og,ig){function ng(gg){dg.load(rg[gg],function(fg){var hg=sg._parser(fg,!0);lg[gg]={width:hg.width,height:hg.height,format:hg.format,mipmaps:hg.mipmaps},cg+=1,6===cg&&(1===hg.mipmapCount&&(pg.minFilter=qs),pg.format=hg.format,pg.needsUpdate=!0,ag&&ag(pg))},og,ig)}var sg=this,lg=[],pg=new Ir;pg.image=lg;var dg=new Po(this.manager);if(dg.setPath(this.path),dg.setResponseType('arraybuffer'),Array.isArray(rg))for(var cg=0,mg=0,ug=rg.length;mg<ug;++mg)ng(mg);else dg.load(rg,function(gg){var fg=sg._parser(gg,!0);if(fg.isCubemap)for(var hg=fg.mipmaps.length/fg.mipmapCount,yg=0;yg<hg;yg++){lg[yg]={mipmaps:[]};for(var xg=0;xg<fg.mipmapCount;xg++)lg[yg].mipmaps.push(fg.mipmaps[yg*fg.mipmapCount+xg]),lg[yg].format=fg.format,lg[yg].width=fg.width,lg[yg].height=fg.height}else pg.image.width=fg.width,pg.image.height=fg.height,pg.mipmaps=fg.mipmaps;1===fg.mipmapCount&&(pg.minFilter=qs),pg.format=fg.format,pg.needsUpdate=!0,ag&&ag(pg)},og,ig);return pg},setPath:function(rg){return this.path=rg,this}}),Object.assign(function(rg){this.manager=void 0===rg?xm:rg,this._parser=null}.prototype,{load:function(rg,ag,og,ig){var ng=this,sg=new O,lg=new Po(this.manager);return lg.setResponseType('arraybuffer'),lg.setPath(this.path),lg.load(rg,function(pg){var dg=ng._parser(pg);dg&&(void 0===dg.image?void 0!==dg.data&&(sg.image.width=dg.width,sg.image.height=dg.height,sg.image.data=dg.data):sg.image=dg.image,sg.wrapS=void 0===dg.wrapS?Hs:dg.wrapS,sg.wrapT=void 0===dg.wrapT?Hs:dg.wrapT,sg.magFilter=void 0===dg.magFilter?qs:dg.magFilter,sg.minFilter=void 0===dg.minFilter?Xs:dg.minFilter,sg.anisotropy=void 0===dg.anisotropy?1:dg.anisotropy,void 0!==dg.format&&(sg.format=dg.format),void 0!==dg.type&&(sg.type=dg.type),void 0!==dg.mipmaps&&(sg.mipmaps=dg.mipmaps),1===dg.mipmapCount&&(sg.minFilter=qs),sg.needsUpdate=!0,ag&&ag(sg,dg))},og,ig),sg},setPath:function(rg){return this.path=rg,this}}),Object.assign(Io.prototype,{crossOrigin:'anonymous',load:function(rg,ag,og,ig){function ng(){dg.removeEventListener('load',ng,!1),dg.removeEventListener('error',sg,!1),ym.add(rg,this),ag&&ag(this),lg.manager.itemEnd(rg)}function sg(cg){dg.removeEventListener('load',ng,!1),dg.removeEventListener('error',sg,!1),ig&&ig(cg),lg.manager.itemError(rg),lg.manager.itemEnd(rg)}void 0===rg&&(rg=''),void 0!==this.path&&(rg=this.path+rg),rg=this.manager.resolveURL(rg);var lg=this,pg=ym.get(rg);if(void 0!==pg)return lg.manager.itemStart(rg),setTimeout(function(){ag&&ag(pg),lg.manager.itemEnd(rg)},0),pg;var dg=document.createElementNS('http://www.w3.org/1999/xhtml','img');return dg.addEventListener('load',ng,!1),dg.addEventListener('error',sg,!1),'data:'!==rg.substr(0,5)&&void 0!==this.crossOrigin&&(dg.crossOrigin=this.crossOrigin),lg.manager.itemStart(rg),dg.src=rg,dg},setCrossOrigin:function(rg){return this.crossOrigin=rg,this},setPath:function(rg){return this.path=rg,this}}),Object.assign(zo.prototype,{crossOrigin:'anonymous',load:function(rg,ag,og,ig){function ng(cg){lg.load(rg[cg],function(mg){sg.images[cg]=mg,pg++,6===pg&&(sg.needsUpdate=!0,ag&&ag(sg))},void 0,ig)}var sg=new Ve,lg=new Io(this.manager);lg.setCrossOrigin(this.crossOrigin),lg.setPath(this.path);for(var pg=0,dg=0;dg<rg.length;++dg)ng(dg);return sg},setCrossOrigin:function(rg){return this.crossOrigin=rg,this},setPath:function(rg){return this.path=rg,this}}),Object.assign(Do.prototype,{crossOrigin:'anonymous',load:function(rg,ag,og,ig){var ng=new I,sg=new Io(this.manager);return sg.setCrossOrigin(this.crossOrigin),sg.setPath(this.path),sg.load(rg,function(lg){ng.image=lg;var pg=0<rg.search(/\.jpe?g$/i)||0===rg.search(/^data\:image\/jpeg/);ng.format=pg?yl:xl,ng.needsUpdate=!0,void 0!==ag&&ag(ng)},og,ig),ng},setCrossOrigin:function(rg){return this.crossOrigin=rg,this},setPath:function(rg){return this.path=rg,this}}),Object.assign(Bo.prototype,{getPoint:function(){return console.warn('THREE.Curve: .getPoint() not implemented.'),null},getPointAt:function(rg,ag){var og=this.getUtoTmapping(rg);return this.getPoint(og,ag)},getPoints:function(rg){void 0===rg&&(rg=5);for(var ag=[],og=0;og<=rg;og++)ag.push(this.getPoint(og/rg));return ag},getSpacedPoints:function(rg){void 0===rg&&(rg=5);for(var ag=[],og=0;og<=rg;og++)ag.push(this.getPointAt(og/rg));return ag},getLength:function(){var rg=this.getLengths();return rg[rg.length-1]},getLengths:function(rg){if(void 0===rg&&(rg=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===rg+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var ag=[],ig=this.getPoint(0),sg=0,og,ng;for(ag.push(0),ng=1;ng<=rg;ng++)og=this.getPoint(ng/rg),sg+=og.distanceTo(ig),ag.push(sg),ig=og;return this.cacheArcLengths=ag,ag},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(rg,ag){var og=this.getLengths(),ig=0,ng=og.length,sg;sg=ag?ag:rg*og[ng-1];for(var lg=0,pg=ng-1,dg;lg<=pg;)if(ig=Math.floor(lg+(pg-lg)/2),dg=og[ig]-sg,0>dg)lg=ig+1;else if(0<dg)pg=ig-1;else{pg=ig;break}if(ig=pg,og[ig]===sg)return ig/(ng-1);var cg=og[ig],mg=og[ig+1],gg=(sg-cg)/(mg-cg),fg=(ig+gg)/(ng-1);return fg},getTangent:function(rg){var ag=1e-4,og=rg-ag,ig=rg+ag;0>og&&(og=0),1<ig&&(ig=1);var ng=this.getPoint(og),sg=this.getPoint(ig),lg=sg.clone().sub(ng);return lg.normalize()},getTangentAt:function(rg){var ag=this.getUtoTmapping(rg);return this.getTangent(ag)},computeFrenetFrames:function(rg,ag){var og=new C,ig=[],ng=[],sg=[],lg=new C,pg=new L,dg,cg,mg;for(dg=0;dg<=rg;dg++)cg=dg/rg,ig[dg]=this.getTangentAt(cg),ig[dg].normalize();ng[0]=new C,sg[0]=new C;var ug=Number.MAX_VALUE,gg=Math.abs(ig[0].x),fg=Math.abs(ig[0].y),hg=Math.abs(ig[0].z);for(gg<=ug&&(ug=gg,og.set(1,0,0)),fg<=ug&&(ug=fg,og.set(0,1,0)),hg<=ug&&og.set(0,0,1),lg.crossVectors(ig[0],og).normalize(),ng[0].crossVectors(ig[0],lg),sg[0].crossVectors(ig[0],ng[0]),dg=1;dg<=rg;dg++)ng[dg]=ng[dg-1].clone(),sg[dg]=sg[dg-1].clone(),lg.crossVectors(ig[dg-1],ig[dg]),lg.length()>Number.EPSILON&&(lg.normalize(),mg=Math.acos(Sp.clamp(ig[dg-1].dot(ig[dg]),-1,1)),ng[dg].applyMatrix4(pg.makeRotationAxis(lg,mg))),sg[dg].crossVectors(ig[dg],ng[dg]);if(!0===ag)for(mg=Math.acos(Sp.clamp(ng[0].dot(ng[rg]),-1,1)),mg/=rg,0<ig[0].dot(lg.crossVectors(ng[0],ng[rg]))&&(mg=-mg),dg=1;dg<=rg;dg++)ng[dg].applyMatrix4(pg.makeRotationAxis(ig[dg],mg*dg)),sg[dg].crossVectors(ig[dg],ng[dg]);return{tangents:ig,normals:ng,binormals:sg}},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.arcLengthDivisions=rg.arcLengthDivisions,this},toJSON:function(){var rg={metadata:{version:4.5,type:'Curve',generator:'Curve.toJSON'},arcLengthDivisions:this.arcLengthDivisions,type:this.type};return rg},fromJSON:function(rg){return this.arcLengthDivisions=rg.arcLengthDivisions,this}}),No.prototype=Object.create(Bo.prototype),No.prototype.constructor=No,No.prototype.isEllipseCurve=!0,No.prototype.getPoint=function(rg,ag){for(var og=ag||new E,ig=2*Math.PI,ng=this.aEndAngle-this.aStartAngle,sg=Math.abs(ng)<Number.EPSILON;0>ng;)ng+=ig;for(;ng>ig;)ng-=ig;ng<Number.EPSILON&&(sg?ng=0:ng=ig),!0!==this.aClockwise||sg||(ng==ig?ng=-ig:ng-=ig);var lg=this.aStartAngle+rg*ng,pg=this.aX+this.xRadius*Math.cos(lg),dg=this.aY+this.yRadius*Math.sin(lg);if(0!==this.aRotation){var cg=Math.cos(this.aRotation),mg=Math.sin(this.aRotation),ug=pg-this.aX,gg=dg-this.aY;pg=ug*cg-gg*mg+this.aX,dg=ug*mg+gg*cg+this.aY}return og.set(pg,dg)},No.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.aX=rg.aX,this.aY=rg.aY,this.xRadius=rg.xRadius,this.yRadius=rg.yRadius,this.aStartAngle=rg.aStartAngle,this.aEndAngle=rg.aEndAngle,this.aClockwise=rg.aClockwise,this.aRotation=rg.aRotation,this},No.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.aX=this.aX,rg.aY=this.aY,rg.xRadius=this.xRadius,rg.yRadius=this.yRadius,rg.aStartAngle=this.aStartAngle,rg.aEndAngle=this.aEndAngle,rg.aClockwise=this.aClockwise,rg.aRotation=this.aRotation,rg},No.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.aX=rg.aX,this.aY=rg.aY,this.xRadius=rg.xRadius,this.yRadius=rg.yRadius,this.aStartAngle=rg.aStartAngle,this.aEndAngle=rg.aEndAngle,this.aClockwise=rg.aClockwise,this.aRotation=rg.aRotation,this},Uo.prototype=Object.create(No.prototype),Uo.prototype.constructor=Uo,Uo.prototype.isArcCurve=!0;var _m=new C,bm=new Go,Sm=new Go,Mm=new Go;Oo.prototype=Object.create(Bo.prototype),Oo.prototype.constructor=Oo,Oo.prototype.isCatmullRomCurve3=!0,Oo.prototype.getPoint=function(rg,ag){var og=ag||new C,ig=this.points,ng=ig.length,sg=(ng-(this.closed?0:1))*rg,lg=Math.floor(sg),pg=sg-lg;this.closed?lg+=0<lg?0:(Math.floor(Math.abs(lg)/ng)+1)*ng:0==pg&&lg===ng-1&&(lg=ng-2,pg=1);var dg,cg,mg,ug;if(this.closed||0<lg?dg=ig[(lg-1)%ng]:(_m.subVectors(ig[0],ig[1]).add(ig[0]),dg=_m),cg=ig[lg%ng],mg=ig[(lg+1)%ng],this.closed||lg+2<ng?ug=ig[(lg+2)%ng]:(_m.subVectors(ig[ng-1],ig[ng-2]).add(ig[ng-1]),ug=_m),'centripetal'===this.curveType||'chordal'===this.curveType){var gg='chordal'===this.curveType?0.5:0.25,fg=Math.pow(dg.distanceToSquared(cg),gg),hg=Math.pow(cg.distanceToSquared(mg),gg),yg=Math.pow(mg.distanceToSquared(ug),gg);1e-4>hg&&(hg=1),1e-4>fg&&(fg=hg),1e-4>yg&&(yg=hg),bm.initNonuniformCatmullRom(dg.x,cg.x,mg.x,ug.x,fg,hg,yg),Sm.initNonuniformCatmullRom(dg.y,cg.y,mg.y,ug.y,fg,hg,yg),Mm.initNonuniformCatmullRom(dg.z,cg.z,mg.z,ug.z,fg,hg,yg)}else'catmullrom'===this.curveType&&(bm.initCatmullRom(dg.x,cg.x,mg.x,ug.x,this.tension),Sm.initCatmullRom(dg.y,cg.y,mg.y,ug.y,this.tension),Mm.initCatmullRom(dg.z,cg.z,mg.z,ug.z,this.tension));return og.set(bm.calc(pg),Sm.calc(pg),Mm.calc(pg)),og},Oo.prototype.copy=function(rg){Bo.prototype.copy.call(this,rg),this.points=[];for(var ag=0,og=rg.points.length,ig;ag<og;ag++)ig=rg.points[ag],this.points.push(ig.clone());return this.closed=rg.closed,this.curveType=rg.curveType,this.tension=rg.tension,this},Oo.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);rg.points=[];for(var ag=0,og=this.points.length,ig;ag<og;ag++)ig=this.points[ag],rg.points.push(ig.toArray());return rg.closed=this.closed,rg.curveType=this.curveType,rg.tension=this.tension,rg},Oo.prototype.fromJSON=function(rg){Bo.prototype.fromJSON.call(this,rg),this.points=[];for(var ag=0,og=rg.points.length,ig;ag<og;ag++)ig=rg.points[ag],this.points.push(new C().fromArray(ig));return this.closed=rg.closed,this.curveType=rg.curveType,this.tension=rg.tension,this},Jo.prototype=Object.create(Bo.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isCubicBezierCurve=!0,Jo.prototype.getPoint=function(rg,ag){var og=ag||new E,ig=this.v0,ng=this.v1,sg=this.v2,lg=this.v3;return og.set(Zo(rg,ig.x,ng.x,sg.x,lg.x),Zo(rg,ig.y,ng.y,sg.y,lg.y)),og},Jo.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.v0.copy(rg.v0),this.v1.copy(rg.v1),this.v2.copy(rg.v2),this.v3.copy(rg.v3),this},Jo.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.v0=this.v0.toArray(),rg.v1=this.v1.toArray(),rg.v2=this.v2.toArray(),rg.v3=this.v3.toArray(),rg},Jo.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.v0.fromArray(rg.v0),this.v1.fromArray(rg.v1),this.v2.fromArray(rg.v2),this.v3.fromArray(rg.v3),this},Qo.prototype=Object.create(Bo.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isCubicBezierCurve3=!0,Qo.prototype.getPoint=function(rg,ag){var og=ag||new C,ig=this.v0,ng=this.v1,sg=this.v2,lg=this.v3;return og.set(Zo(rg,ig.x,ng.x,sg.x,lg.x),Zo(rg,ig.y,ng.y,sg.y,lg.y),Zo(rg,ig.z,ng.z,sg.z,lg.z)),og},Qo.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.v0.copy(rg.v0),this.v1.copy(rg.v1),this.v2.copy(rg.v2),this.v3.copy(rg.v3),this},Qo.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.v0=this.v0.toArray(),rg.v1=this.v1.toArray(),rg.v2=this.v2.toArray(),rg.v3=this.v3.toArray(),rg},Qo.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.v0.fromArray(rg.v0),this.v1.fromArray(rg.v1),this.v2.fromArray(rg.v2),this.v3.fromArray(rg.v3),this},Ko.prototype=Object.create(Bo.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isLineCurve=!0,Ko.prototype.getPoint=function(rg,ag){var og=ag||new E;return 1===rg?og.copy(this.v2):(og.copy(this.v2).sub(this.v1),og.multiplyScalar(rg).add(this.v1)),og},Ko.prototype.getPointAt=function(rg,ag){return this.getPoint(rg,ag)},Ko.prototype.getTangent=function(){var rg=this.v2.clone().sub(this.v1);return rg.normalize()},Ko.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.v1.copy(rg.v1),this.v2.copy(rg.v2),this},Ko.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.v1=this.v1.toArray(),rg.v2=this.v2.toArray(),rg},Ko.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.v1.fromArray(rg.v1),this.v2.fromArray(rg.v2),this},$o.prototype=Object.create(Bo.prototype),$o.prototype.constructor=$o,$o.prototype.isLineCurve3=!0,$o.prototype.getPoint=function(rg,ag){var og=ag||new C;return 1===rg?og.copy(this.v2):(og.copy(this.v2).sub(this.v1),og.multiplyScalar(rg).add(this.v1)),og},$o.prototype.getPointAt=function(rg,ag){return this.getPoint(rg,ag)},$o.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.v1.copy(rg.v1),this.v2.copy(rg.v2),this},$o.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.v1=this.v1.toArray(),rg.v2=this.v2.toArray(),rg},$o.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.v1.fromArray(rg.v1),this.v2.fromArray(rg.v2),this},ei.prototype=Object.create(Bo.prototype),ei.prototype.constructor=ei,ei.prototype.isQuadraticBezierCurve=!0,ei.prototype.getPoint=function(rg,ag){var og=ag||new E,ig=this.v0,ng=this.v1,sg=this.v2;return og.set(Wo(rg,ig.x,ng.x,sg.x),Wo(rg,ig.y,ng.y,sg.y)),og},ei.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.v0.copy(rg.v0),this.v1.copy(rg.v1),this.v2.copy(rg.v2),this},ei.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.v0=this.v0.toArray(),rg.v1=this.v1.toArray(),rg.v2=this.v2.toArray(),rg},ei.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.v0.fromArray(rg.v0),this.v1.fromArray(rg.v1),this.v2.fromArray(rg.v2),this},ti.prototype=Object.create(Bo.prototype),ti.prototype.constructor=ti,ti.prototype.isQuadraticBezierCurve3=!0,ti.prototype.getPoint=function(rg,ag){var og=ag||new C,ig=this.v0,ng=this.v1,sg=this.v2;return og.set(Wo(rg,ig.x,ng.x,sg.x),Wo(rg,ig.y,ng.y,sg.y),Wo(rg,ig.z,ng.z,sg.z)),og},ti.prototype.copy=function(rg){return Bo.prototype.copy.call(this,rg),this.v0.copy(rg.v0),this.v1.copy(rg.v1),this.v2.copy(rg.v2),this},ti.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);return rg.v0=this.v0.toArray(),rg.v1=this.v1.toArray(),rg.v2=this.v2.toArray(),rg},ti.prototype.fromJSON=function(rg){return Bo.prototype.fromJSON.call(this,rg),this.v0.fromArray(rg.v0),this.v1.fromArray(rg.v1),this.v2.fromArray(rg.v2),this},ri.prototype=Object.create(Bo.prototype),ri.prototype.constructor=ri,ri.prototype.isSplineCurve=!0,ri.prototype.getPoint=function(rg,ag){var og=ag||new E,ig=this.points,ng=(ig.length-1)*rg,sg=Math.floor(ng),lg=ng-sg,pg=ig[0===sg?sg:sg-1],dg=ig[sg],cg=ig[sg>ig.length-2?ig.length-1:sg+1],mg=ig[sg>ig.length-3?ig.length-1:sg+2];return og.set(Fo(lg,pg.x,dg.x,cg.x,mg.x),Fo(lg,pg.y,dg.y,cg.y,mg.y)),og},ri.prototype.copy=function(rg){Bo.prototype.copy.call(this,rg),this.points=[];for(var ag=0,og=rg.points.length,ig;ag<og;ag++)ig=rg.points[ag],this.points.push(ig.clone());return this},ri.prototype.toJSON=function(){var rg=Bo.prototype.toJSON.call(this);rg.points=[];for(var ag=0,og=this.points.length,ig;ag<og;ag++)ig=this.points[ag],rg.points.push(ig.toArray());return rg},ri.prototype.fromJSON=function(rg){Bo.prototype.fromJSON.call(this,rg),this.points=[];for(var ag=0,og=rg.points.length,ig;ag<og;ag++)ig=rg.points[ag],this.points.push(new E().fromArray(ig));return this};var Tm=Object.freeze({ArcCurve:Uo,CatmullRomCurve3:Oo,CubicBezierCurve:Jo,CubicBezierCurve3:Qo,EllipseCurve:No,LineCurve:Ko,LineCurve3:$o,QuadraticBezierCurve:ei,QuadraticBezierCurve3:ti,SplineCurve:ri});ai.prototype=Object.assign(Object.create(Bo.prototype),{constructor:ai,add:function(rg){this.curves.push(rg)},closePath:function(){var rg=this.curves[0].getPoint(0),ag=this.curves[this.curves.length-1].getPoint(1);rg.equals(ag)||this.curves.push(new Ko(ag,rg))},getPoint:function(rg){for(var ag=rg*this.getLength(),og=this.getCurveLengths(),ig=0;ig<og.length;){if(og[ig]>=ag){var ng=og[ig]-ag,sg=this.curves[ig],lg=sg.getLength(),pg=0===lg?0:1-ng/lg;return sg.getPointAt(pg)}ig++}return null},getLength:function(){var rg=this.getCurveLengths();return rg[rg.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var rg=[],ag=0,og=0,ig=this.curves.length;og<ig;og++)ag+=this.curves[og].getLength(),rg.push(ag);return this.cacheLengths=rg,rg},getSpacedPoints:function(rg){void 0===rg&&(rg=40);for(var ag=[],og=0;og<=rg;og++)ag.push(this.getPoint(og/rg));return this.autoClose&&ag.push(ag[0]),ag},getPoints:function(rg){rg=rg||12;for(var ag=[],ig=0,ng=this.curves,og;ig<ng.length;ig++)for(var sg=ng[ig],lg=sg&&sg.isEllipseCurve?2*rg:sg&&(sg.isLineCurve||sg.isLineCurve3)?1:sg&&sg.isSplineCurve?rg*sg.points.length:rg,pg=sg.getPoints(lg),dg=0,cg;dg<pg.length;dg++)cg=pg[dg],og&&og.equals(cg)||(ag.push(cg),og=cg);return this.autoClose&&1<ag.length&&!ag[ag.length-1].equals(ag[0])&&ag.push(ag[0]),ag},copy:function(rg){Bo.prototype.copy.call(this,rg),this.curves=[];for(var ag=0,og=rg.curves.length,ig;ag<og;ag++)ig=rg.curves[ag],this.curves.push(ig.clone());return this.autoClose=rg.autoClose,this},toJSON:function(){var rg=Bo.prototype.toJSON.call(this);rg.autoClose=this.autoClose,rg.curves=[];for(var ag=0,og=this.curves.length,ig;ag<og;ag++)ig=this.curves[ag],rg.curves.push(ig.toJSON());return rg},fromJSON:function(rg){Bo.prototype.fromJSON.call(this,rg),this.autoClose=rg.autoClose,this.curves=[];for(var ag=0,og=rg.curves.length,ig;ag<og;ag++)ig=rg.curves[ag],this.curves.push(new Tm[ig.type]().fromJSON(ig));return this}}),oi.prototype=Object.assign(Object.create(ai.prototype),{constructor:oi,setFromPoints:function(rg){this.moveTo(rg[0].x,rg[0].y);for(var ag=1,og=rg.length;ag<og;ag++)this.lineTo(rg[ag].x,rg[ag].y)},moveTo:function(rg,ag){this.currentPoint.set(rg,ag)},lineTo:function(rg,ag){var og=new Ko(this.currentPoint.clone(),new E(rg,ag));this.curves.push(og),this.currentPoint.set(rg,ag)},quadraticCurveTo:function(rg,ag,og,ig){var ng=new ei(this.currentPoint.clone(),new E(rg,ag),new E(og,ig));this.curves.push(ng),this.currentPoint.set(og,ig)},bezierCurveTo:function(rg,ag,og,ig,ng,sg){var lg=new Jo(this.currentPoint.clone(),new E(rg,ag),new E(og,ig),new E(ng,sg));this.curves.push(lg),this.currentPoint.set(ng,sg)},splineThru:function(rg){var ag=[this.currentPoint.clone()].concat(rg),og=new ri(ag);this.curves.push(og),this.currentPoint.copy(rg[rg.length-1])},arc:function(rg,ag,og,ig,ng,sg){var lg=this.currentPoint.x,pg=this.currentPoint.y;this.absarc(rg+lg,ag+pg,og,ig,ng,sg)},absarc:function(rg,ag,og,ig,ng,sg){this.absellipse(rg,ag,og,og,ig,ng,sg)},ellipse:function(rg,ag,og,ig,ng,sg,lg,pg){var dg=this.currentPoint.x,cg=this.currentPoint.y;this.absellipse(rg+dg,ag+cg,og,ig,ng,sg,lg,pg)},absellipse:function(rg,ag,og,ig,ng,sg,lg,pg){var dg=new No(rg,ag,og,ig,ng,sg,lg,pg);if(0<this.curves.length){var cg=dg.getPoint(0);cg.equals(this.currentPoint)||this.lineTo(cg.x,cg.y)}this.curves.push(dg);var mg=dg.getPoint(1);this.currentPoint.copy(mg)},copy:function(rg){return ai.prototype.copy.call(this,rg),this.currentPoint.copy(rg.currentPoint),this},toJSON:function(){var rg=ai.prototype.toJSON.call(this);return rg.currentPoint=this.currentPoint.toArray(),rg},fromJSON:function(rg){return ai.prototype.fromJSON.call(this,rg),this.currentPoint.fromArray(rg.currentPoint),this}}),ii.prototype=Object.assign(Object.create(oi.prototype),{constructor:ii,getPointsHoles:function(rg){for(var ag=[],og=0,ig=this.holes.length;og<ig;og++)ag[og]=this.holes[og].getPoints(rg);return ag},extractPoints:function(rg){return{shape:this.getPoints(rg),holes:this.getPointsHoles(rg)}},copy:function(rg){oi.prototype.copy.call(this,rg),this.holes=[];for(var ag=0,og=rg.holes.length,ig;ag<og;ag++)ig=rg.holes[ag],this.holes.push(ig.clone());return this},toJSON:function(){var rg=oi.prototype.toJSON.call(this);rg.uuid=this.uuid,rg.holes=[];for(var ag=0,og=this.holes.length,ig;ag<og;ag++)ig=this.holes[ag],rg.holes.push(ig.toJSON());return rg},fromJSON:function(rg){oi.prototype.fromJSON.call(this,rg),this.uuid=rg.uuid,this.holes=[];for(var ag=0,og=rg.holes.length,ig;ag<og;ag++)ig=rg.holes[ag],this.holes.push(new oi().fromJSON(ig));return this}}),ni.prototype=Object.assign(Object.create(ee.prototype),{constructor:ni,isLight:!0,copy:function(rg){return ee.prototype.copy.call(this,rg),this.color.copy(rg.color),this.intensity=rg.intensity,this},toJSON:function(rg){var ag=ee.prototype.toJSON.call(this,rg);return ag.object.color=this.color.getHex(),ag.object.intensity=this.intensity,void 0!==this.groundColor&&(ag.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(ag.object.distance=this.distance),void 0!==this.angle&&(ag.object.angle=this.angle),void 0!==this.decay&&(ag.object.decay=this.decay),void 0!==this.penumbra&&(ag.object.penumbra=this.penumbra),void 0!==this.shadow&&(ag.object.shadow=this.shadow.toJSON()),ag}}),si.prototype=Object.assign(Object.create(ni.prototype),{constructor:si,isHemisphereLight:!0,copy:function(rg){return ni.prototype.copy.call(this,rg),this.groundColor.copy(rg.groundColor),this}}),Object.assign(li.prototype,{copy:function(rg){return this.camera=rg.camera.clone(),this.bias=rg.bias,this.radius=rg.radius,this.mapSize.copy(rg.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var rg={};return 0!==this.bias&&(rg.bias=this.bias),1!==this.radius&&(rg.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(rg.mapSize=this.mapSize.toArray()),rg.camera=this.camera.toJSON(!1).object,delete rg.camera.matrix,rg}}),pi.prototype=Object.assign(Object.create(li.prototype),{constructor:pi,isSpotLightShadow:!0,update:function(rg){var ag=this.camera,og=2*Sp.RAD2DEG*rg.angle,ig=this.mapSize.width/this.mapSize.height,ng=rg.distance||ag.far;(og!==ag.fov||ig!==ag.aspect||ng!==ag.far)&&(ag.fov=og,ag.aspect=ig,ag.far=ng,ag.updateProjectionMatrix())}}),di.prototype=Object.assign(Object.create(ni.prototype),{constructor:di,isSpotLight:!0,copy:function(rg){return ni.prototype.copy.call(this,rg),this.distance=rg.distance,this.angle=rg.angle,this.penumbra=rg.penumbra,this.decay=rg.decay,this.target=rg.target.clone(),this.shadow=rg.shadow.clone(),this}}),ci.prototype=Object.assign(Object.create(ni.prototype),{constructor:ci,isPointLight:!0,copy:function(rg){return ni.prototype.copy.call(this,rg),this.distance=rg.distance,this.decay=rg.decay,this.shadow=rg.shadow.clone(),this}}),mi.prototype=Object.assign(Object.create(nr.prototype),{constructor:mi,isOrthographicCamera:!0,copy:function(rg,ag){return nr.prototype.copy.call(this,rg,ag),this.left=rg.left,this.right=rg.right,this.top=rg.top,this.bottom=rg.bottom,this.near=rg.near,this.far=rg.far,this.zoom=rg.zoom,this.view=null===rg.view?null:Object.assign({},rg.view),this},setViewOffset:function(rg,ag,og,ig,ng,sg){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=rg,this.view.fullHeight=ag,this.view.offsetX=og,this.view.offsetY=ig,this.view.width=ng,this.view.height=sg,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var rg=(this.right-this.left)/(2*this.zoom),ag=(this.top-this.bottom)/(2*this.zoom),og=(this.right+this.left)/2,ig=(this.top+this.bottom)/2,ng=og-rg,sg=og+rg,lg=ig+ag,pg=ig-ag;if(null!==this.view&&this.view.enabled){var dg=this.zoom/(this.view.width/this.view.fullWidth),cg=this.zoom/(this.view.height/this.view.fullHeight),mg=(this.right-this.left)/this.view.width,ug=(this.top-this.bottom)/this.view.height;ng+=mg*(this.view.offsetX/dg),sg=ng+mg*(this.view.width/dg),lg-=ug*(this.view.offsetY/cg),pg=lg-ug*(this.view.height/cg)}this.projectionMatrix.makeOrthographic(ng,sg,lg,pg,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(rg){var ag=ee.prototype.toJSON.call(this,rg);return ag.object.zoom=this.zoom,ag.object.left=this.left,ag.object.right=this.right,ag.object.top=this.top,ag.object.bottom=this.bottom,ag.object.near=this.near,ag.object.far=this.far,null!==this.view&&(ag.object.view=Object.assign({},this.view)),ag}}),ui.prototype=Object.assign(Object.create(li.prototype),{constructor:ui}),gi.prototype=Object.assign(Object.create(ni.prototype),{constructor:gi,isDirectionalLight:!0,copy:function(rg){return ni.prototype.copy.call(this,rg),this.target=rg.target.clone(),this.shadow=rg.shadow.clone(),this}}),hi.prototype=Object.assign(Object.create(ni.prototype),{constructor:hi,isAmbientLight:!0}),yi.prototype=Object.assign(Object.create(ni.prototype),{constructor:yi,isRectAreaLight:!0,copy:function(rg){return ni.prototype.copy.call(this,rg),this.width=rg.width,this.height=rg.height,this},toJSON:function(rg){var ag=ni.prototype.toJSON.call(this,rg);return ag.object.width=this.width,ag.object.height=this.height,ag}}),Object.assign(xi.prototype,{load:function(rg,ag,og,ig){var ng=this,sg=new Po(ng.manager);sg.setPath(ng.path),sg.load(rg,function(lg){ag(ng.parse(JSON.parse(lg)))},og,ig)},parse:function(rg){function ag(pg){return void 0===og[pg]&&console.warn('THREE.MaterialLoader: Undefined texture',pg),og[pg]}var og=this.textures,ig=new fm[rg.type];if(void 0!==rg.uuid&&(ig.uuid=rg.uuid),void 0!==rg.name&&(ig.name=rg.name),void 0!==rg.color&&ig.color.setHex(rg.color),void 0!==rg.roughness&&(ig.roughness=rg.roughness),void 0!==rg.metalness&&(ig.metalness=rg.metalness),void 0!==rg.emissive&&ig.emissive.setHex(rg.emissive),void 0!==rg.specular&&ig.specular.setHex(rg.specular),void 0!==rg.shininess&&(ig.shininess=rg.shininess),void 0!==rg.clearCoat&&(ig.clearCoat=rg.clearCoat),void 0!==rg.clearCoatRoughness&&(ig.clearCoatRoughness=rg.clearCoatRoughness),void 0!==rg.vertexColors&&(ig.vertexColors=rg.vertexColors),void 0!==rg.fog&&(ig.fog=rg.fog),void 0!==rg.flatShading&&(ig.flatShading=rg.flatShading),void 0!==rg.blending&&(ig.blending=rg.blending),void 0!==rg.combine&&(ig.combine=rg.combine),void 0!==rg.side&&(ig.side=rg.side),void 0!==rg.opacity&&(ig.opacity=rg.opacity),void 0!==rg.transparent&&(ig.transparent=rg.transparent),void 0!==rg.alphaTest&&(ig.alphaTest=rg.alphaTest),void 0!==rg.depthTest&&(ig.depthTest=rg.depthTest),void 0!==rg.depthWrite&&(ig.depthWrite=rg.depthWrite),void 0!==rg.colorWrite&&(ig.colorWrite=rg.colorWrite),void 0!==rg.wireframe&&(ig.wireframe=rg.wireframe),void 0!==rg.wireframeLinewidth&&(ig.wireframeLinewidth=rg.wireframeLinewidth),void 0!==rg.wireframeLinecap&&(ig.wireframeLinecap=rg.wireframeLinecap),void 0!==rg.wireframeLinejoin&&(ig.wireframeLinejoin=rg.wireframeLinejoin),void 0!==rg.rotation&&(ig.rotation=rg.rotation),1!==rg.linewidth&&(ig.linewidth=rg.linewidth),void 0!==rg.dashSize&&(ig.dashSize=rg.dashSize),void 0!==rg.gapSize&&(ig.gapSize=rg.gapSize),void 0!==rg.scale&&(ig.scale=rg.scale),void 0!==rg.polygonOffset&&(ig.polygonOffset=rg.polygonOffset),void 0!==rg.polygonOffsetFactor&&(ig.polygonOffsetFactor=rg.polygonOffsetFactor),void 0!==rg.polygonOffsetUnits&&(ig.polygonOffsetUnits=rg.polygonOffsetUnits),void 0!==rg.skinning&&(ig.skinning=rg.skinning),void 0!==rg.morphTargets&&(ig.morphTargets=rg.morphTargets),void 0!==rg.dithering&&(ig.dithering=rg.dithering),void 0!==rg.visible&&(ig.visible=rg.visible),void 0!==rg.userData&&(ig.userData=rg.userData),void 0!==rg.uniforms)for(var ng in rg.uniforms){var sg=rg.uniforms[ng];switch(ig.uniforms[ng]={},sg.type){case't':ig.uniforms[ng].value=ag(sg.value);break;case'c':ig.uniforms[ng].value=new Y().setHex(sg.value);break;case'v2':ig.uniforms[ng].value=new E().fromArray(sg.value);break;case'v3':ig.uniforms[ng].value=new C().fromArray(sg.value);break;case'v4':ig.uniforms[ng].value=new D().fromArray(sg.value);break;case'm4':ig.uniforms[ng].value=new L().fromArray(sg.value);break;default:ig.uniforms[ng].value=sg.value;}}if(void 0!==rg.defines&&(ig.defines=rg.defines),void 0!==rg.vertexShader&&(ig.vertexShader=rg.vertexShader),void 0!==rg.fragmentShader&&(ig.fragmentShader=rg.fragmentShader),void 0!==rg.shading&&(ig.flatShading=1===rg.shading),void 0!==rg.size&&(ig.size=rg.size),void 0!==rg.sizeAttenuation&&(ig.sizeAttenuation=rg.sizeAttenuation),void 0!==rg.map&&(ig.map=ag(rg.map)),void 0!==rg.alphaMap&&(ig.alphaMap=ag(rg.alphaMap),ig.transparent=!0),void 0!==rg.bumpMap&&(ig.bumpMap=ag(rg.bumpMap)),void 0!==rg.bumpScale&&(ig.bumpScale=rg.bumpScale),void 0!==rg.normalMap&&(ig.normalMap=ag(rg.normalMap)),void 0!==rg.normalMapType&&(ig.normalMapType=rg.normalMapType),void 0!==rg.normalScale){var lg=rg.normalScale;!1===Array.isArray(lg)&&(lg=[lg,lg]),ig.normalScale=new E().fromArray(lg)}return void 0!==rg.displacementMap&&(ig.displacementMap=ag(rg.displacementMap)),void 0!==rg.displacementScale&&(ig.displacementScale=rg.displacementScale),void 0!==rg.displacementBias&&(ig.displacementBias=rg.displacementBias),void 0!==rg.roughnessMap&&(ig.roughnessMap=ag(rg.roughnessMap)),void 0!==rg.metalnessMap&&(ig.metalnessMap=ag(rg.metalnessMap)),void 0!==rg.emissiveMap&&(ig.emissiveMap=ag(rg.emissiveMap)),void 0!==rg.emissiveIntensity&&(ig.emissiveIntensity=rg.emissiveIntensity),void 0!==rg.specularMap&&(ig.specularMap=ag(rg.specularMap)),void 0!==rg.envMap&&(ig.envMap=ag(rg.envMap)),void 0!==rg.envMapIntensity&&(ig.envMapIntensity=rg.envMapIntensity),void 0!==rg.reflectivity&&(ig.reflectivity=rg.reflectivity),void 0!==rg.lightMap&&(ig.lightMap=ag(rg.lightMap)),void 0!==rg.lightMapIntensity&&(ig.lightMapIntensity=rg.lightMapIntensity),void 0!==rg.aoMap&&(ig.aoMap=ag(rg.aoMap)),void 0!==rg.aoMapIntensity&&(ig.aoMapIntensity=rg.aoMapIntensity),void 0!==rg.gradientMap&&(ig.gradientMap=ag(rg.gradientMap)),ig},setPath:function(rg){return this.path=rg,this},setTextures:function(rg){return this.textures=rg,this}});var Em={decodeText:function(rg){if('undefined'!=typeof TextDecoder)return new TextDecoder().decode(rg);for(var ag='',og=0,ig=rg.length;og<ig;og++)ag+=String.fromCharCode(rg[og]);return decodeURIComponent(escape(ag))},extractUrlBase:function(rg){var ag=rg.lastIndexOf('/');return-1===ag?'./':rg.substr(0,ag+1)}};Object.assign(vi.prototype,{load:function(rg,ag,og,ig){var ng=this,sg=new Po(ng.manager);sg.setPath(ng.path),sg.load(rg,function(lg){ag(ng.parse(JSON.parse(lg)))},og,ig)},parse:function(rg){var ag=new ve,og=rg.data.index;if(void 0!==og){var ig=new wm[og.type](og.array);ag.setIndex(new oe(ig,1))}var ng=rg.data.attributes;for(var sg in ng){var lg=ng[sg],ig=new wm[lg.type](lg.array);ag.addAttribute(sg,new oe(ig,lg.itemSize,lg.normalized))}var pg=rg.data.groups||rg.data.drawcalls||rg.data.offsets;if(void 0!==pg)for(var dg=0,cg=pg.length,mg;dg!==cg;++dg)mg=pg[dg],ag.addGroup(mg.start,mg.count,mg.materialIndex);var ug=rg.data.boundingSphere;if(void 0!==ug){var gg=new C;void 0!==ug.center&&gg.fromArray(ug.center),ag.boundingSphere=new H(gg,ug.radius)}return ag},setPath:function(rg){return this.path=rg,this}});var wm={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:'undefined'==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};_i.Handlers={handlers:[],add:function(rg,ag){this.handlers.push(rg,ag)},get:function(rg){for(var ag=this.handlers,og=0,ig=ag.length;og<ig;og+=2){var ng=ag[og],sg=ag[og+1];if(ng.test(rg))return sg}return null}},Object.assign(_i.prototype,{crossOrigin:'anonymous',onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(rg,ag,og){for(var ig=[],ng=0;ng<rg.length;++ng)ig[ng]=this.createMaterial(rg[ng],ag,og);return ig},createMaterial:function(){var rg={NoBlending:qn,NormalBlending:Yn,AdditiveBlending:Xn,SubtractiveBlending:Zn,MultiplyBlending:Jn,CustomBlending:Qn},ag=new Y,og=new Do,ig=new xi;return function(sg,lg,pg){function dg(fg,hg,yg,xg,vg){var _g=lg+fg,bg=_i.Handlers.get(_g),Sg;null===bg?(og.setCrossOrigin(pg),Sg=og.load(_g)):Sg=bg.load(_g),void 0!==hg&&(Sg.repeat.fromArray(hg),1!==hg[0]&&(Sg.wrapS=Fs),1!==hg[1]&&(Sg.wrapT=Fs)),void 0!==yg&&Sg.offset.fromArray(yg),void 0!==xg&&('repeat'===xg[0]&&(Sg.wrapS=Fs),'mirror'===xg[0]&&(Sg.wrapS=Vs),'repeat'===xg[1]&&(Sg.wrapT=Fs),'mirror'===xg[1]&&(Sg.wrapT=Vs)),void 0!==vg&&(Sg.anisotropy=vg);var Mg=Sp.generateUUID();return cg[Mg]=Sg,Mg}var cg={},mg={uuid:Sp.generateUUID(),type:'MeshLambertMaterial'};for(var ug in sg){var gg=sg[ug];switch(ug){case'DbgColor':case'DbgIndex':case'opticalDensity':case'illumination':break;case'DbgName':mg.name=gg;break;case'blending':mg.blending=rg[gg];break;case'colorAmbient':case'mapAmbient':console.warn('THREE.Loader.createMaterial:',ug,'is no longer supported.');break;case'colorDiffuse':mg.color=ag.fromArray(gg).getHex();break;case'colorSpecular':mg.specular=ag.fromArray(gg).getHex();break;case'colorEmissive':mg.emissive=ag.fromArray(gg).getHex();break;case'specularCoef':mg.shininess=gg;break;case'shading':'basic'===gg.toLowerCase()&&(mg.type='MeshBasicMaterial'),'phong'===gg.toLowerCase()&&(mg.type='MeshPhongMaterial'),'standard'===gg.toLowerCase()&&(mg.type='MeshStandardMaterial');break;case'mapDiffuse':mg.map=dg(gg,sg.mapDiffuseRepeat,sg.mapDiffuseOffset,sg.mapDiffuseWrap,sg.mapDiffuseAnisotropy);break;case'mapDiffuseRepeat':case'mapDiffuseOffset':case'mapDiffuseWrap':case'mapDiffuseAnisotropy':break;case'mapEmissive':mg.emissiveMap=dg(gg,sg.mapEmissiveRepeat,sg.mapEmissiveOffset,sg.mapEmissiveWrap,sg.mapEmissiveAnisotropy);break;case'mapEmissiveRepeat':case'mapEmissiveOffset':case'mapEmissiveWrap':case'mapEmissiveAnisotropy':break;case'mapLight':mg.lightMap=dg(gg,sg.mapLightRepeat,sg.mapLightOffset,sg.mapLightWrap,sg.mapLightAnisotropy);break;case'mapLightRepeat':case'mapLightOffset':case'mapLightWrap':case'mapLightAnisotropy':break;case'mapAO':mg.aoMap=dg(gg,sg.mapAORepeat,sg.mapAOOffset,sg.mapAOWrap,sg.mapAOAnisotropy);break;case'mapAORepeat':case'mapAOOffset':case'mapAOWrap':case'mapAOAnisotropy':break;case'mapBump':mg.bumpMap=dg(gg,sg.mapBumpRepeat,sg.mapBumpOffset,sg.mapBumpWrap,sg.mapBumpAnisotropy);break;case'mapBumpScale':mg.bumpScale=gg;break;case'mapBumpRepeat':case'mapBumpOffset':case'mapBumpWrap':case'mapBumpAnisotropy':break;case'mapNormal':mg.normalMap=dg(gg,sg.mapNormalRepeat,sg.mapNormalOffset,sg.mapNormalWrap,sg.mapNormalAnisotropy);break;case'mapNormalFactor':mg.normalScale=gg;break;case'mapNormalRepeat':case'mapNormalOffset':case'mapNormalWrap':case'mapNormalAnisotropy':break;case'mapSpecular':mg.specularMap=dg(gg,sg.mapSpecularRepeat,sg.mapSpecularOffset,sg.mapSpecularWrap,sg.mapSpecularAnisotropy);break;case'mapSpecularRepeat':case'mapSpecularOffset':case'mapSpecularWrap':case'mapSpecularAnisotropy':break;case'mapMetalness':mg.metalnessMap=dg(gg,sg.mapMetalnessRepeat,sg.mapMetalnessOffset,sg.mapMetalnessWrap,sg.mapMetalnessAnisotropy);break;case'mapMetalnessRepeat':case'mapMetalnessOffset':case'mapMetalnessWrap':case'mapMetalnessAnisotropy':break;case'mapRoughness':mg.roughnessMap=dg(gg,sg.mapRoughnessRepeat,sg.mapRoughnessOffset,sg.mapRoughnessWrap,sg.mapRoughnessAnisotropy);break;case'mapRoughnessRepeat':case'mapRoughnessOffset':case'mapRoughnessWrap':case'mapRoughnessAnisotropy':break;case'mapAlpha':mg.alphaMap=dg(gg,sg.mapAlphaRepeat,sg.mapAlphaOffset,sg.mapAlphaWrap,sg.mapAlphaAnisotropy);break;case'mapAlphaRepeat':case'mapAlphaOffset':case'mapAlphaWrap':case'mapAlphaAnisotropy':break;case'flipSided':mg.side=Fn;break;case'doubleSided':mg.side=Hn;break;case'transparency':console.warn('THREE.Loader.createMaterial: transparency has been renamed to opacity'),mg.opacity=gg;break;case'depthTest':case'depthWrite':case'colorWrite':case'opacity':case'reflectivity':case'transparent':case'visible':case'wireframe':mg[ug]=gg;break;case'vertexColors':!0===gg&&(mg.vertexColors=jn),'face'===gg&&(mg.vertexColors=Wn);break;default:console.error('THREE.Loader.createMaterial: Unsupported',ug,gg);}}return'MeshBasicMaterial'===mg.type&&delete mg.emissive,'MeshPhongMaterial'!==mg.type&&delete mg.specular,1>mg.opacity&&(mg.transparent=!0),ig.setTextures(cg),ig.parse(mg)}}()}),Object.assign(bi.prototype,{crossOrigin:'anonymous',load:function(rg,ag,og,ig){var ng=this,sg=void 0===this.path?Em.extractUrlBase(rg):this.path,lg=new Po(this.manager);lg.setPath(this.path),lg.setWithCredentials(this.withCredentials),lg.load(rg,function(pg){var dg=JSON.parse(pg),cg=dg.metadata;if(void 0!==cg){var mg=cg.type;if(void 0!==mg&&'object'===mg.toLowerCase())return void console.error('THREE.JSONLoader: '+rg+' should be loaded with THREE.ObjectLoader instead.')}var ug=ng.parse(dg,sg);ag(ug.geometry,ug.materials)},og,ig)},setPath:function(rg){return this.path=rg,this},setResourcePath:function(rg){return this.resourcePath=rg,this},setCrossOrigin:function(rg){return this.crossOrigin=rg,this},parse:function(){function rg(ng,sg){function lg(Vg,kg){return Vg&1<<kg}var Ng=ng.faces,Ug=ng.vertices,Gg=ng.normals,Og=ng.colors,Fg=ng.scale,Hg=0,pg,dg,cg,mg,ug,gg,fg,hg,yg,xg,vg,_g,bg,Sg,Mg,Tg,Eg,wg,Lg,Pg,Ag,Cg,Rg,Ig,zg,Dg,Bg;if(void 0!==ng.uvs){for(pg=0;pg<ng.uvs.length;pg++)ng.uvs[pg].length&&Hg++;for(pg=0;pg<Hg;pg++)sg.faceVertexUvs[pg]=[]}for(mg=0,ug=Ug.length;mg<ug;)wg=new C,wg.x=Ug[mg++]*Fg,wg.y=Ug[mg++]*Fg,wg.z=Ug[mg++]*Fg,sg.vertices.push(wg);for(mg=0,ug=Ng.length;mg<ug;)if(xg=Ng[mg++],vg=lg(xg,0),_g=lg(xg,1),bg=lg(xg,3),Sg=lg(xg,4),Mg=lg(xg,5),Tg=lg(xg,6),Eg=lg(xg,7),vg){if(Pg=new J,Pg.a=Ng[mg],Pg.b=Ng[mg+1],Pg.c=Ng[mg+3],Ag=new J,Ag.a=Ng[mg+1],Ag.b=Ng[mg+2],Ag.c=Ng[mg+3],mg+=4,_g&&(yg=Ng[mg++],Pg.materialIndex=yg,Ag.materialIndex=yg),cg=sg.faces.length,bg)for(pg=0;pg<Hg;pg++)for(Ig=ng.uvs[pg],sg.faceVertexUvs[pg][cg]=[],sg.faceVertexUvs[pg][cg+1]=[],dg=0;4>dg;dg++)hg=Ng[mg++],Dg=Ig[2*hg],Bg=Ig[2*hg+1],zg=new E(Dg,Bg),2!==dg&&sg.faceVertexUvs[pg][cg].push(zg),0!==dg&&sg.faceVertexUvs[pg][cg+1].push(zg);if(Sg&&(fg=3*Ng[mg++],Pg.normal.set(Gg[fg++],Gg[fg++],Gg[fg]),Ag.normal.copy(Pg.normal)),Mg)for(pg=0;4>pg;pg++)fg=3*Ng[mg++],Rg=new C(Gg[fg++],Gg[fg++],Gg[fg]),2!==pg&&Pg.vertexNormals.push(Rg),0!==pg&&Ag.vertexNormals.push(Rg);if(Tg&&(gg=Ng[mg++],Cg=Og[gg],Pg.color.setHex(Cg),Ag.color.setHex(Cg)),Eg)for(pg=0;4>pg;pg++)gg=Ng[mg++],Cg=Og[gg],2!==pg&&Pg.vertexColors.push(new Y(Cg)),0!==pg&&Ag.vertexColors.push(new Y(Cg));sg.faces.push(Pg),sg.faces.push(Ag)}else{if(Lg=new J,Lg.a=Ng[mg++],Lg.b=Ng[mg++],Lg.c=Ng[mg++],_g&&(yg=Ng[mg++],Lg.materialIndex=yg),cg=sg.faces.length,bg)for(pg=0;pg<Hg;pg++)for(Ig=ng.uvs[pg],sg.faceVertexUvs[pg][cg]=[],dg=0;3>dg;dg++)hg=Ng[mg++],Dg=Ig[2*hg],Bg=Ig[2*hg+1],zg=new E(Dg,Bg),sg.faceVertexUvs[pg][cg].push(zg);if(Sg&&(fg=3*Ng[mg++],Lg.normal.set(Gg[fg++],Gg[fg++],Gg[fg])),Mg)for(pg=0;3>pg;pg++)fg=3*Ng[mg++],Rg=new C(Gg[fg++],Gg[fg++],Gg[fg]),Lg.vertexNormals.push(Rg);if(Tg&&(gg=Ng[mg++],Lg.color.setHex(Og[gg])),Eg)for(pg=0;3>pg;pg++)gg=Ng[mg++],Lg.vertexColors.push(new Y(Og[gg]));sg.faces.push(Lg)}}function ag(ng,sg){var lg=void 0===ng.influencesPerVertex?2:ng.influencesPerVertex;if(ng.skinWeights)for(var pg=0,dg=ng.skinWeights.length;pg<dg;pg+=lg){var cg=ng.skinWeights[pg],mg=1<lg?ng.skinWeights[pg+1]:0,ug=2<lg?ng.skinWeights[pg+2]:0,gg=3<lg?ng.skinWeights[pg+3]:0;sg.skinWeights.push(new D(cg,mg,ug,gg))}if(ng.skinIndices)for(var pg=0,dg=ng.skinIndices.length;pg<dg;pg+=lg){var fg=ng.skinIndices[pg],hg=1<lg?ng.skinIndices[pg+1]:0,yg=2<lg?ng.skinIndices[pg+2]:0,xg=3<lg?ng.skinIndices[pg+3]:0;sg.skinIndices.push(new D(fg,hg,yg,xg))}sg.bones=ng.bones,sg.bones&&0<sg.bones.length&&(sg.skinWeights.length!==sg.skinIndices.length||sg.skinIndices.length!==sg.vertices.length)&&console.warn('When skinning, number of vertices ('+sg.vertices.length+'), skinIndices ('+sg.skinIndices.length+'), and skinWeights ('+sg.skinWeights.length+') should match.')}function og(ng,sg){var lg=ng.scale;if(void 0!==ng.morphTargets)for(var pg=0,dg=ng.morphTargets.length;pg<dg;pg++){sg.morphTargets[pg]={},sg.morphTargets[pg].name=ng.morphTargets[pg].name,sg.morphTargets[pg].vertices=[];for(var cg=sg.morphTargets[pg].vertices,mg=ng.morphTargets[pg].vertices,ug=0,gg=mg.length,fg;ug<gg;ug+=3)fg=new C,fg.x=mg[ug]*lg,fg.y=mg[ug+1]*lg,fg.z=mg[ug+2]*lg,cg.push(fg)}if(void 0!==ng.morphColors&&0<ng.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var hg=sg.faces,yg=ng.morphColors[0].colors,pg=0,dg=hg.length;pg<dg;pg++)hg[pg].color.fromArray(yg,3*pg)}}function ig(ng,sg){var lg=[],pg=[];void 0!==ng.animation&&pg.push(ng.animation),void 0!==ng.animations&&(ng.animations.length?pg=pg.concat(ng.animations):pg.push(ng.animations));for(var dg=0,cg;dg<pg.length;dg++)cg=To.parseAnimation(pg[dg],sg.bones),cg&&lg.push(cg);if(sg.morphTargets){var mg=To.CreateClipsFromMorphTargetSequences(sg.morphTargets,10);lg=lg.concat(mg)}0<lg.length&&(sg.animations=lg)}return function(sg,lg){void 0!==sg.data&&(sg=sg.data),sg.scale=void 0===sg.scale?1:1/sg.scale;var pg=new re;if(rg(sg,pg),ag(sg,pg),og(sg,pg),ig(sg,pg),pg.computeFaceNormals(),pg.computeBoundingSphere(),void 0===sg.materials||0===sg.materials.length)return{geometry:pg};var dg=_i.prototype.initMaterials(sg.materials,this.resourcePath||lg,this.crossOrigin);return{geometry:pg,materials:dg}}}()}),Object.assign(Si.prototype,{crossOrigin:'anonymous',load:function(rg,ag,og,ig){var ng=this,sg=void 0===this.path?Em.extractUrlBase(rg):this.path;this.resourcePath=this.resourcePath||sg;var lg=new Po(ng.manager);lg.setPath(this.path),lg.load(rg,function(pg){var dg=null;try{dg=JSON.parse(pg)}catch(mg){return void 0!==ig&&ig(mg),void console.error('THREE:ObjectLoader: Can\'t parse '+rg+'.',mg.message)}var cg=dg.metadata;return void 0===cg||void 0===cg.type||'geometry'===cg.type.toLowerCase()?void console.error('THREE.ObjectLoader: Can\'t load '+rg+'. Use THREE.JSONLoader instead.'):void ng.parse(dg,ag)},og,ig)},setPath:function(rg){return this.path=rg,this},setResourcePath:function(rg){return this.resourcePath=rg,this},setCrossOrigin:function(rg){return this.crossOrigin=rg,this},parse:function(rg,ag){var og=this.parseShape(rg.shapes),ig=this.parseGeometries(rg.geometries,og),ng=this.parseImages(rg.images,function(){void 0!==ag&&ag(pg)}),sg=this.parseTextures(rg.textures,ng),lg=this.parseMaterials(rg.materials,sg),pg=this.parseObject(rg.object,ig,lg);return rg.animations&&(pg.animations=this.parseAnimations(rg.animations)),(void 0===rg.images||0===rg.images.length)&&void 0!==ag&&ag(pg),pg},parseShape:function(rg){var ag={};if(void 0!==rg)for(var og=0,ig=rg.length,ng;og<ig;og++)ng=new ii().fromJSON(rg[og]),ag[ng.uuid]=ng;return ag},parseGeometries:function(rg,ag){var og={};if(void 0!==rg)for(var ig=new bi,ng=new vi,sg=0,lg=rg.length;sg<lg;sg++){var dg=rg[sg],pg;switch(dg.type){case'PlaneGeometry':case'PlaneBufferGeometry':pg=new gm[dg.type](dg.width,dg.height,dg.widthSegments,dg.heightSegments);break;case'BoxGeometry':case'BoxBufferGeometry':case'CubeGeometry':pg=new gm[dg.type](dg.width,dg.height,dg.depth,dg.widthSegments,dg.heightSegments,dg.depthSegments);break;case'CircleGeometry':case'CircleBufferGeometry':pg=new gm[dg.type](dg.radius,dg.segments,dg.thetaStart,dg.thetaLength);break;case'CylinderGeometry':case'CylinderBufferGeometry':pg=new gm[dg.type](dg.radiusTop,dg.radiusBottom,dg.height,dg.radialSegments,dg.heightSegments,dg.openEnded,dg.thetaStart,dg.thetaLength);break;case'ConeGeometry':case'ConeBufferGeometry':pg=new gm[dg.type](dg.radius,dg.height,dg.radialSegments,dg.heightSegments,dg.openEnded,dg.thetaStart,dg.thetaLength);break;case'SphereGeometry':case'SphereBufferGeometry':pg=new gm[dg.type](dg.radius,dg.widthSegments,dg.heightSegments,dg.phiStart,dg.phiLength,dg.thetaStart,dg.thetaLength);break;case'DodecahedronGeometry':case'DodecahedronBufferGeometry':case'IcosahedronGeometry':case'IcosahedronBufferGeometry':case'OctahedronGeometry':case'OctahedronBufferGeometry':case'TetrahedronGeometry':case'TetrahedronBufferGeometry':pg=new gm[dg.type](dg.radius,dg.detail);break;case'RingGeometry':case'RingBufferGeometry':pg=new gm[dg.type](dg.innerRadius,dg.outerRadius,dg.thetaSegments,dg.phiSegments,dg.thetaStart,dg.thetaLength);break;case'TorusGeometry':case'TorusBufferGeometry':pg=new gm[dg.type](dg.radius,dg.tube,dg.radialSegments,dg.tubularSegments,dg.arc);break;case'TorusKnotGeometry':case'TorusKnotBufferGeometry':pg=new gm[dg.type](dg.radius,dg.tube,dg.tubularSegments,dg.radialSegments,dg.p,dg.q);break;case'LatheGeometry':case'LatheBufferGeometry':pg=new gm[dg.type](dg.points,dg.segments,dg.phiStart,dg.phiLength);break;case'PolyhedronGeometry':case'PolyhedronBufferGeometry':pg=new gm[dg.type](dg.vertices,dg.indices,dg.radius,dg.details);break;case'ShapeGeometry':case'ShapeBufferGeometry':for(var cg=[],mg=0,ug=dg.shapes.length,gg;mg<ug;mg++)gg=ag[dg.shapes[mg]],cg.push(gg);pg=new gm[dg.type](cg,dg.curveSegments);break;case'ExtrudeGeometry':case'ExtrudeBufferGeometry':for(var cg=[],mg=0,ug=dg.shapes.length,gg;mg<ug;mg++)gg=ag[dg.shapes[mg]],cg.push(gg);var fg=dg.options.extrudePath;void 0!==fg&&(dg.options.extrudePath=new Tm[fg.type]().fromJSON(fg)),pg=new gm[dg.type](cg,dg.options);break;case'BufferGeometry':pg=ng.parse(dg);break;case'Geometry':pg=ig.parse(dg,this.resourcePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+dg.type+'"');continue;}pg.uuid=dg.uuid,void 0!==dg.name&&(pg.name=dg.name),!0===pg.isBufferGeometry&&void 0!==dg.userData&&(pg.userData=dg.userData),og[dg.uuid]=pg}return og},parseMaterials:function(rg,ag){var og={},ig={};if(void 0!==rg){var ng=new xi;ng.setTextures(ag);for(var sg=0,lg=rg.length,pg;sg<lg;sg++)if(pg=rg[sg],'MultiMaterial'===pg.type){for(var dg=[],cg=0,mg;cg<pg.materials.length;cg++)mg=pg.materials[cg],void 0===og[mg.uuid]&&(og[mg.uuid]=ng.parse(mg)),dg.push(og[mg.uuid]);ig[pg.uuid]=dg}else ig[pg.uuid]=ng.parse(pg),og[pg.uuid]=ig[pg.uuid]}return ig},parseAnimations:function(rg){for(var ag=[],og=0;og<rg.length;og++){var ig=rg[og],ng=To.parse(ig);void 0!==ig.uuid&&(ng.uuid=ig.uuid),ag.push(ng)}return ag},parseImages:function(rg,ag){function og(yg){return ig.manager.itemStart(yg),lg.load(yg,function(){ig.manager.itemEnd(yg)},void 0,function(){ig.manager.itemError(yg),ig.manager.itemEnd(yg)})}var ig=this,ng={};if(void 0!==rg&&0<rg.length){var sg=new Lo(ag),lg=new Io(sg);lg.setCrossOrigin(this.crossOrigin);for(var pg=0,dg=rg.length;pg<dg;pg++){var cg=rg[pg],mg=cg.url;if(Array.isArray(mg)){ng[cg.uuid]=[];for(var ug=0,gg=mg.length;ug<gg;ug++){var fg=mg[ug],hg=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(fg)?fg:ig.resourcePath+fg;ng[cg.uuid].push(og(hg))}}else{var hg=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(cg.url)?cg.url:ig.resourcePath+cg.url;ng[cg.uuid]=og(hg)}}}return ng},parseTextures:function(rg,ag){function og(dg,cg){return'number'==typeof dg?dg:(console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.',dg),cg[dg])}var ig={};if(void 0!==rg)for(var ng=0,sg=rg.length,lg;ng<sg;ng++){lg=rg[ng],void 0===lg.image&&console.warn('THREE.ObjectLoader: No "image" specified for',lg.uuid),void 0===ag[lg.image]&&console.warn('THREE.ObjectLoader: Undefined image',lg.image);var pg;pg=Array.isArray(ag[lg.image])?new Ve(ag[lg.image]):new I(ag[lg.image]),pg.needsUpdate=!0,pg.uuid=lg.uuid,void 0!==lg.name&&(pg.name=lg.name),void 0!==lg.mapping&&(pg.mapping=og(lg.mapping,Lm)),void 0!==lg.offset&&pg.offset.fromArray(lg.offset),void 0!==lg.repeat&&pg.repeat.fromArray(lg.repeat),void 0!==lg.center&&pg.center.fromArray(lg.center),void 0!==lg.rotation&&(pg.rotation=lg.rotation),void 0!==lg.wrap&&(pg.wrapS=og(lg.wrap[0],Pm),pg.wrapT=og(lg.wrap[1],Pm)),void 0!==lg.format&&(pg.format=lg.format),void 0!==lg.minFilter&&(pg.minFilter=og(lg.minFilter,Am)),void 0!==lg.magFilter&&(pg.magFilter=og(lg.magFilter,Am)),void 0!==lg.anisotropy&&(pg.anisotropy=lg.anisotropy),void 0!==lg.flipY&&(pg.flipY=lg.flipY),ig[lg.uuid]=pg}return ig},parseObject:function(rg,ag,og){function ig(hg){return void 0===ag[hg]&&console.warn('THREE.ObjectLoader: Undefined geometry',hg),ag[hg]}function ng(hg){if(void 0!==hg){if(Array.isArray(hg)){for(var yg=[],xg=0,vg=hg.length,_g;xg<vg;xg++)_g=hg[xg],void 0===og[_g]&&console.warn('THREE.ObjectLoader: Undefined material',_g),yg.push(og[_g]);return yg}return void 0===og[hg]&&console.warn('THREE.ObjectLoader: Undefined material',hg),og[hg]}}var sg;switch(rg.type){case'Scene':sg=new fr,void 0!==rg.background&&Number.isInteger(rg.background)&&(sg.background=new Y(rg.background)),void 0!==rg.fog&&('Fog'===rg.fog.type?sg.fog=new gr(rg.fog.color,rg.fog.near,rg.fog.far):'FogExp2'===rg.fog.type&&(sg.fog=new ur(rg.fog.color,rg.fog.density)));break;case'PerspectiveCamera':sg=new sr(rg.fov,rg.aspect,rg.near,rg.far),void 0!==rg.focus&&(sg.focus=rg.focus),void 0!==rg.zoom&&(sg.zoom=rg.zoom),void 0!==rg.filmGauge&&(sg.filmGauge=rg.filmGauge),void 0!==rg.filmOffset&&(sg.filmOffset=rg.filmOffset),void 0!==rg.view&&(sg.view=Object.assign({},rg.view));break;case'OrthographicCamera':sg=new mi(rg.left,rg.right,rg.top,rg.bottom,rg.near,rg.far),void 0!==rg.zoom&&(sg.zoom=rg.zoom),void 0!==rg.view&&(sg.view=Object.assign({},rg.view));break;case'AmbientLight':sg=new hi(rg.color,rg.intensity);break;case'DirectionalLight':sg=new gi(rg.color,rg.intensity);break;case'PointLight':sg=new ci(rg.color,rg.intensity,rg.distance,rg.decay);break;case'RectAreaLight':sg=new yi(rg.color,rg.intensity,rg.width,rg.height);break;case'SpotLight':sg=new di(rg.color,rg.intensity,rg.distance,rg.angle,rg.penumbra,rg.decay);break;case'HemisphereLight':sg=new si(rg.color,rg.groundColor,rg.intensity);break;case'SkinnedMesh':console.warn('THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.');case'Mesh':var lg=ig(rg.geometry),pg=ng(rg.material);sg=lg.bones&&0<lg.bones.length?new Tr(lg,pg):new Ce(lg,pg);break;case'LOD':sg=new br;break;case'Line':sg=new wr(ig(rg.geometry),ng(rg.material),rg.mode);break;case'LineLoop':sg=new Pr(ig(rg.geometry),ng(rg.material));break;case'LineSegments':sg=new Lr(ig(rg.geometry),ng(rg.material));break;case'PointCloud':case'Points':sg=new Cr(ig(rg.geometry),ng(rg.material));break;case'Sprite':sg=new _r(ng(rg.material));break;case'Group':sg=new ir;break;default:sg=new ee;}if(sg.uuid=rg.uuid,void 0!==rg.name&&(sg.name=rg.name),void 0===rg.matrix?(void 0!==rg.position&&sg.position.fromArray(rg.position),void 0!==rg.rotation&&sg.rotation.fromArray(rg.rotation),void 0!==rg.quaternion&&sg.quaternion.fromArray(rg.quaternion),void 0!==rg.scale&&sg.scale.fromArray(rg.scale)):(sg.matrix.fromArray(rg.matrix),void 0!==rg.matrixAutoUpdate&&(sg.matrixAutoUpdate=rg.matrixAutoUpdate),sg.matrixAutoUpdate&&sg.matrix.decompose(sg.position,sg.quaternion,sg.scale)),void 0!==rg.castShadow&&(sg.castShadow=rg.castShadow),void 0!==rg.receiveShadow&&(sg.receiveShadow=rg.receiveShadow),rg.shadow&&(void 0!==rg.shadow.bias&&(sg.shadow.bias=rg.shadow.bias),void 0!==rg.shadow.radius&&(sg.shadow.radius=rg.shadow.radius),void 0!==rg.shadow.mapSize&&sg.shadow.mapSize.fromArray(rg.shadow.mapSize),void 0!==rg.shadow.camera&&(sg.shadow.camera=this.parseObject(rg.shadow.camera))),void 0!==rg.visible&&(sg.visible=rg.visible),void 0!==rg.frustumCulled&&(sg.frustumCulled=rg.frustumCulled),void 0!==rg.renderOrder&&(sg.renderOrder=rg.renderOrder),void 0!==rg.userData&&(sg.userData=rg.userData),void 0!==rg.layers&&(sg.layers.mask=rg.layers),void 0!==rg.children)for(var dg=rg.children,cg=0;cg<dg.length;cg++)sg.add(this.parseObject(dg[cg],ag,og));if('LOD'===rg.type)for(var mg=rg.levels,ug=0;ug<mg.length;ug++){var gg=mg[ug],fg=sg.getObjectByProperty('uuid',gg.object);void 0!==fg&&sg.addLevel(fg,gg.distance)}return sg}});var Lm={UVMapping:Is,CubeReflectionMapping:zs,CubeRefractionMapping:Ds,EquirectangularReflectionMapping:Bs,EquirectangularRefractionMapping:Ns,SphericalReflectionMapping:Us,CubeUVReflectionMapping:Gs,CubeUVRefractionMapping:Os},Pm={RepeatWrapping:Fs,ClampToEdgeWrapping:Hs,MirroredRepeatWrapping:Vs},Am={NearestFilter:ks,NearestMipMapNearestFilter:Ws,NearestMipMapLinearFilter:js,LinearFilter:qs,LinearMipMapNearestFilter:Ys,LinearMipMapLinearFilter:Xs};Object.assign(Mi.prototype,{moveTo:function(rg,ag){this.currentPath=new oi,this.subPaths.push(this.currentPath),this.currentPath.moveTo(rg,ag)},lineTo:function(rg,ag){this.currentPath.lineTo(rg,ag)},quadraticCurveTo:function(rg,ag,og,ig){this.currentPath.quadraticCurveTo(rg,ag,og,ig)},bezierCurveTo:function(rg,ag,og,ig,ng,sg){this.currentPath.bezierCurveTo(rg,ag,og,ig,ng,sg)},splineThru:function(rg){this.currentPath.splineThru(rg)},toShapes:function(rg,ag){function og(zg){for(var Dg=[],Bg=0,Ng=zg.length;Bg<Ng;Bg++){var Ug=zg[Bg],Gg=new ii;Gg.curves=Ug.curves,Dg.push(Gg)}return Dg}function ig(zg,Dg){for(var Bg=Dg.length,Ng=!1,Ug=Bg-1,Gg=0;Gg<Bg;Ug=Gg++){var Og=Dg[Ug],Fg=Dg[Gg],Hg=Fg.x-Og.x,Vg=Fg.y-Og.y;if(Math.abs(Vg)>Number.EPSILON){if(0>Vg&&(Og=Dg[Gg],Hg=-Hg,Fg=Dg[Ug],Vg=-Vg),zg.y<Og.y||zg.y>Fg.y)continue;if(zg.y!==Og.y){var kg=Vg*(zg.x-Og.x)-Hg*(zg.y-Og.y);if(0==kg)return!0;if(0>kg)continue;Ng=!Ng}else if(zg.x===Og.x)return!0}else{if(zg.y!==Og.y)continue;if(Fg.x<=zg.x&&zg.x<=Og.x||Og.x<=zg.x&&zg.x<=Fg.x)return!0}}return Ng}var ng=mm.isClockWise,sg=this.subPaths;if(0===sg.length)return[];if(!0===ag)return og(sg);var cg=[],lg,pg,dg;if(1===sg.length)return pg=sg[0],dg=new ii,dg.curves=pg.curves,cg.push(dg),cg;var mg=!ng(sg[0].getPoints());mg=rg?!mg:mg;var ug=[],gg=[],fg=[],hg=0,yg;gg[hg]=void 0,fg[hg]=[];for(var xg=0,vg=sg.length;xg<vg;xg++)pg=sg[xg],yg=pg.getPoints(),lg=ng(yg),lg=rg?!lg:lg,lg?(!mg&&gg[hg]&&hg++,gg[hg]={s:new ii,p:yg},gg[hg].s.curves=pg.curves,mg&&hg++,fg[hg]=[]):fg[hg].push({h:pg,p:yg[0]});if(!gg[0])return og(sg);if(1<gg.length){for(var _g=!1,bg=[],Sg=0,Mg=gg.length;Sg<Mg;Sg++)ug[Sg]=[];for(var Sg=0,Mg=gg.length,Tg;Sg<Mg;Sg++){Tg=fg[Sg];for(var Eg=0;Eg<Tg.length;Eg++){for(var wg=Tg[Eg],Lg=!0,Pg=0;Pg<gg.length;Pg++)ig(wg.p,gg[Pg].p)&&(Sg!==Pg&&bg.push({froms:Sg,tos:Pg,hole:Eg}),Lg?(Lg=!1,ug[Pg].push(wg)):_g=!0);Lg&&ug[Sg].push(wg)}}0<bg.length&&!_g&&(fg=ug)}for(var xg=0,Cg=gg.length,Ag;xg<Cg;xg++){dg=gg[xg].s,cg.push(dg),Ag=fg[xg];for(var Rg=0,Ig=Ag.length;Rg<Ig;Rg++)dg.holes.push(Ag[Rg].h)}return cg}}),Object.assign(Ti.prototype,{isFont:!0,generateShapes:function(rg,ag){void 0===ag&&(ag=100);for(var og=[],ig=Ei(rg,ag,this.data),ng=0,sg=ig.length;ng<sg;ng++)Array.prototype.push.apply(og,ig[ng].toShapes());return og}}),Object.assign(function(rg){this.manager=void 0===rg?xm:rg}.prototype,{load:function(rg,ag,og,ig){var ng=this,sg=new Po(this.manager);sg.setPath(this.path),sg.load(rg,function(lg){var pg;try{pg=JSON.parse(lg)}catch(cg){console.warn('THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.'),pg=JSON.parse(lg.substring(65,lg.length-2))}var dg=ng.parse(pg);ag&&ag(dg)},og,ig)},parse:function(rg){return new Ti(rg)},setPath:function(rg){return this.path=rg,this}});var Rm={getContext:function(){return void 0==Cm&&(Cm=new(window.AudioContext||window.webkitAudioContext)),Cm},setContext:function(rg){Cm=rg}},Cm;Object.assign(Pi.prototype,{load:function(rg,ag,og,ig){var ng=new Po(this.manager);ng.setResponseType('arraybuffer'),ng.setPath(this.path),ng.load(rg,function(sg){var lg=sg.slice(0),pg=Rm.getContext();pg.decodeAudioData(lg,function(dg){ag(dg)})},og,ig)},setPath:function(rg){return this.path=rg,this}}),Object.assign(function(){this.type='StereoCamera',this.aspect=1,this.eyeSep=0.064,this.cameraL=new sr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new sr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}.prototype,{update:function(){var dg=new L,cg=new L,rg,ag,og,ig,ng,sg,lg,pg;return function(ug){var gg=rg!==this||ag!==ug.focus||og!==ug.fov||ig!==ug.aspect*this.aspect||ng!==ug.near||sg!==ug.far||lg!==ug.zoom||pg!==this.eyeSep;if(gg){rg=this,ag=ug.focus,og=ug.fov,ig=ug.aspect*this.aspect,ng=ug.near,sg=ug.far,lg=ug.zoom;var fg=ug.projectionMatrix.clone();pg=this.eyeSep/2;var hg=pg*ng/ag,yg=ng*Math.tan(0.5*(Sp.DEG2RAD*og))/lg,xg,vg;cg.elements[12]=-pg,dg.elements[12]=pg,xg=-yg*ig+hg,vg=yg*ig+hg,fg.elements[0]=2*ng/(vg-xg),fg.elements[8]=(vg+xg)/(vg-xg),this.cameraL.projectionMatrix.copy(fg),xg=-yg*ig-hg,vg=yg*ig-hg,fg.elements[0]=2*ng/(vg-xg),fg.elements[8]=(vg+xg)/(vg-xg),this.cameraR.projectionMatrix.copy(fg)}this.cameraL.matrixWorld.copy(ug.matrixWorld).multiply(cg),this.cameraR.matrixWorld.copy(ug.matrixWorld).multiply(dg)}}()}),Ci.prototype=Object.create(ee.prototype),Ci.prototype.constructor=Ci,Object.assign(Ri.prototype,{start:function(){this.startTime=('undefined'==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var rg=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var ag=('undefined'==typeof performance?Date:performance).now();rg=(ag-this.oldTime)/1e3,this.oldTime=ag,this.elapsedTime+=rg}return rg}}),Ii.prototype=Object.assign(Object.create(ee.prototype),{constructor:Ii,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(rg){return null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=rg,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(rg){return this.gain.gain.setTargetAtTime(rg,this.context.currentTime,0.01),this},updateMatrixWorld:function(){var rg=new C,ag=new A,og=new C,ig=new C,ng=new Ri;return function(lg){ee.prototype.updateMatrixWorld.call(this,lg);var pg=this.context.listener,dg=this.up;if(this.timeDelta=ng.getDelta(),this.matrixWorld.decompose(rg,ag,og),ig.set(0,0,-1).applyQuaternion(ag),pg.positionX){var cg=this.context.currentTime+this.timeDelta;pg.positionX.linearRampToValueAtTime(rg.x,cg),pg.positionY.linearRampToValueAtTime(rg.y,cg),pg.positionZ.linearRampToValueAtTime(rg.z,cg),pg.forwardX.linearRampToValueAtTime(ig.x,cg),pg.forwardY.linearRampToValueAtTime(ig.y,cg),pg.forwardZ.linearRampToValueAtTime(ig.z,cg),pg.upX.linearRampToValueAtTime(dg.x,cg),pg.upY.linearRampToValueAtTime(dg.y,cg),pg.upZ.linearRampToValueAtTime(dg.z,cg)}else pg.setPosition(rg.x,rg.y,rg.z),pg.setOrientation(ig.x,ig.y,ig.z,dg.x,dg.y,dg.z)}}()}),zi.prototype=Object.assign(Object.create(ee.prototype),{constructor:zi,getOutput:function(){return this.gain},setNodeSource:function(rg){return this.hasPlaybackControl=!1,this.sourceType='audioNode',this.source=rg,this.connect(),this},setMediaElementSource:function(rg){return this.hasPlaybackControl=!1,this.sourceType='mediaNode',this.source=this.context.createMediaElementSource(rg),this.connect(),this},setBuffer:function(rg){return this.buffer=rg,this.sourceType='buffer',this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var rg=this.context.createBufferSource();return rg.buffer=this.buffer,rg.loop=this.loop,rg.onended=this.onEnded.bind(this),rg.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,rg.start(this.startTime,this.offset),this.isPlaying=!0,this.source=rg,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var rg=1,ag=this.filters.length;rg<ag;rg++)this.filters[rg-1].connect(this.filters[rg]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var rg=1,ag=this.filters.length;rg<ag;rg++)this.filters[rg-1].disconnect(this.filters[rg]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(rg){return rg||(rg=[]),!0===this.isPlaying?(this.disconnect(),this.filters=rg,this.connect()):this.filters=rg,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(rg){return this.setFilters(rg?[rg]:[])},setPlaybackRate:function(rg){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.playbackRate=rg,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn('THREE.Audio: this Audio has no playback control.'),!1):this.loop},setLoop:function(rg){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.loop=rg,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(rg){return this.gain.gain.setTargetAtTime(rg,this.context.currentTime,0.01),this}}),Di.prototype=Object.assign(Object.create(zi.prototype),{constructor:Di,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(rg){return this.panner.refDistance=rg,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(rg){return this.panner.rolloffFactor=rg,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(rg){return this.panner.distanceModel=rg,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(rg){return this.panner.maxDistance=rg,this},setDirectionalCone:function(rg,ag,og){return this.panner.coneInnerAngle=rg,this.panner.coneOuterAngle=ag,this.panner.coneOuterGain=og,this},updateMatrixWorld:function(){var rg=new C,ag=new A,og=new C,ig=new C;return function(sg){ee.prototype.updateMatrixWorld.call(this,sg);var lg=this.panner;if(this.matrixWorld.decompose(rg,ag,og),ig.set(0,0,1).applyQuaternion(ag),lg.positionX){var pg=this.context.currentTime+this.listener.timeDelta;lg.positionX.linearRampToValueAtTime(rg.x,pg),lg.positionY.linearRampToValueAtTime(rg.y,pg),lg.positionZ.linearRampToValueAtTime(rg.z,pg),lg.orientationX.linearRampToValueAtTime(ig.x,pg),lg.orientationY.linearRampToValueAtTime(ig.y,pg),lg.orientationZ.linearRampToValueAtTime(ig.z,pg)}else lg.setPosition(rg.x,rg.y,rg.z),lg.setOrientation(ig.x,ig.y,ig.z)}}()}),Object.assign(Bi.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var rg=0,ag=this.getFrequencyData(),og=0;og<ag.length;og++)rg+=ag[og];return rg/ag.length}}),Object.assign(Ni.prototype,{accumulate:function(rg,ag){var og=this.buffer,ig=this.valueSize,ng=rg*ig+ig,sg=this.cumulativeWeight;if(0===sg){for(var lg=0;lg!==ig;++lg)og[ng+lg]=og[lg];sg=ag}else{sg+=ag;var pg=ag/sg;this._mixBufferRegion(og,ng,0,pg,ig)}this.cumulativeWeight=sg},apply:function(rg){var ag=this.valueSize,og=this.buffer,ig=rg*ag+ag,ng=this.cumulativeWeight,sg=this.binding;if(this.cumulativeWeight=0,1>ng){this._mixBufferRegion(og,ig,3*ag,1-ng,ag)}for(var pg=ag;pg!==ag+ag;++pg)if(og[pg]!==og[pg+ag]){sg.setValue(og,ig);break}},saveOriginalState:function(){var rg=this.binding,ag=this.buffer,og=this.valueSize,ig=3*og;rg.getValue(ag,ig);for(var ng=og;ng!==ig;++ng)ag[ng]=ag[ig+ng%og];this.cumulativeWeight=0},restoreOriginalState:function(){var rg=3*this.valueSize;this.binding.setValue(this.buffer,rg)},_select:function(rg,ag,og,ig,ng){if(0.5<=ig)for(var sg=0;sg!==ng;++sg)rg[ag+sg]=rg[og+sg]},_slerp:function(rg,ag,og,ig){A.slerpFlat(rg,ag,rg,ag,rg,og,ig)},_lerp:function(rg,ag,og,ig,ng){for(var lg=0,pg;lg!==ng;++lg)pg=ag+lg,rg[pg]=rg[pg]*(1-ig)+rg[og+lg]*ig}});var Im='\\[\\]\\.:\\/';Object.assign(Ui.prototype,{getValue:function(rg,ag){this.bind();var og=this._targetGroup.nCachedObjects_,ig=this._bindings[og];void 0!==ig&&ig.getValue(rg,ag)},setValue:function(rg,ag){for(var og=this._bindings,ig=this._targetGroup.nCachedObjects_,ng=og.length;ig!==ng;++ig)og[ig].setValue(rg,ag)},bind:function(){for(var rg=this._bindings,ag=this._targetGroup.nCachedObjects_,og=rg.length;ag!==og;++ag)rg[ag].bind()},unbind:function(){for(var rg=this._bindings,ag=this._targetGroup.nCachedObjects_,og=rg.length;ag!==og;++ag)rg[ag].unbind()}}),Object.assign(Gi,{Composite:Ui,create:function(rg,ag,og){return rg&&rg.isAnimationObjectGroup?new Gi.Composite(rg,ag,og):new Gi(rg,ag,og)},sanitizeNodeName:function(){var rg=/[\[\]\.:\/]/g;return function(og){return og.replace(/\s/g,'_').replace(rg,'')}}(),parseTrackName:function(){var rg='[^'+Im+']',ag='[^'+Im.replace('\\.','')+']',og=/((?:WC+[\/:])*)/.source.replace('WC',rg),ig=/(WCOD+)?/.source.replace('WCOD',ag),ng=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace('WC',rg),sg=/\.(WC+)(?:\[(.+)\])?/.source.replace('WC',rg),lg=new RegExp('^'+og+ig+ng+sg+'$'),pg=['material','materials','bones'];return function(cg){var mg=lg.exec(cg);if(!mg)throw new Error('PropertyBinding: Cannot parse trackName: '+cg);var ug={nodeName:mg[2],objectName:mg[3],objectIndex:mg[4],propertyName:mg[5],propertyIndex:mg[6]},gg=ug.nodeName&&ug.nodeName.lastIndexOf('.');if(void 0!==gg&&-1!==gg){var fg=ug.nodeName.substring(gg+1);-1!==pg.indexOf(fg)&&(ug.nodeName=ug.nodeName.substring(0,gg),ug.objectName=fg)}if(null===ug.propertyName||0===ug.propertyName.length)throw new Error('PropertyBinding: can not parse propertyName from trackName: '+cg);return ug}}(),findNode:function(rg,ag){if(!ag||''===ag||'root'===ag||'.'===ag||-1===ag||ag===rg.name||ag===rg.uuid)return rg;if(rg.skeleton){var og=rg.skeleton.getBoneByName(ag);if(void 0!==og)return og}if(rg.children){var ig=function(sg){for(var lg=0,pg;lg<sg.length;lg++){if(pg=sg[lg],pg.name===ag||pg.uuid===ag)return pg;var dg=ig(pg.children);if(dg)return dg}return null},ng=ig(rg.children);if(ng)return ng}return null}}),Object.assign(Gi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(ag,og){ag[og]=this.node[this.propertyName]},function(ag,og){for(var ig=this.resolvedProperty,ng=0,sg=ig.length;ng!==sg;++ng)ag[og++]=ig[ng]},function(ag,og){ag[og]=this.resolvedProperty[this.propertyIndex]},function(ag,og){this.resolvedProperty.toArray(ag,og)}],SetterByBindingTypeAndVersioning:[[function(ag,og){this.targetObject[this.propertyName]=ag[og]},function(ag,og){this.targetObject[this.propertyName]=ag[og],this.targetObject.needsUpdate=!0},function(ag,og){this.targetObject[this.propertyName]=ag[og],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ag,og){for(var ig=this.resolvedProperty,ng=0,sg=ig.length;ng!==sg;++ng)ig[ng]=ag[og++]},function(ag,og){for(var ig=this.resolvedProperty,ng=0,sg=ig.length;ng!==sg;++ng)ig[ng]=ag[og++];this.targetObject.needsUpdate=!0},function(ag,og){for(var ig=this.resolvedProperty,ng=0,sg=ig.length;ng!==sg;++ng)ig[ng]=ag[og++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ag,og){this.resolvedProperty[this.propertyIndex]=ag[og]},function(ag,og){this.resolvedProperty[this.propertyIndex]=ag[og],this.targetObject.needsUpdate=!0},function(ag,og){this.resolvedProperty[this.propertyIndex]=ag[og],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ag,og){this.resolvedProperty.fromArray(ag,og)},function(ag,og){this.resolvedProperty.fromArray(ag,og),this.targetObject.needsUpdate=!0},function(ag,og){this.resolvedProperty.fromArray(ag,og),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(ag,og){this.bind(),this.getValue(ag,og)},setValue:function(ag,og){this.bind(),this.setValue(ag,og)},bind:function(){var rg=this.node,ag=this.parsedPath,og=ag.objectName,ig=ag.propertyName,ng=ag.propertyIndex;if(rg||(rg=Gi.findNode(this.rootNode,ag.nodeName)||this.rootNode,this.node=rg),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!rg)return void console.error('THREE.PropertyBinding: Trying to update node for track: '+this.path+' but it wasn\'t found.');if(og){var sg=ag.objectIndex;switch(og){case'materials':if(!rg.material)return void console.error('THREE.PropertyBinding: Can not bind to material as node does not have a material.',this);if(!rg.material.materials)return void console.error('THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.',this);rg=rg.material.materials;break;case'bones':if(!rg.skeleton)return void console.error('THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.',this);rg=rg.skeleton.bones;for(var lg=0;lg<rg.length;lg++)if(rg[lg].name===sg){sg=lg;break}break;default:if(void 0===rg[og])return void console.error('THREE.PropertyBinding: Can not bind to objectName of node undefined.',this);rg=rg[og];}if(void 0!==sg){if(void 0===rg[sg])return void console.error('THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.',this,rg);rg=rg[sg]}}var pg=rg[ig];if(void 0===pg){var dg=ag.nodeName;return void console.error('THREE.PropertyBinding: Trying to update property for track: '+dg+'.'+ig+' but it wasn\'t found.',rg)}var cg=this.Versioning.None;this.targetObject=rg,void 0===rg.needsUpdate?void 0!==rg.matrixWorldNeedsUpdate&&(cg=this.Versioning.MatrixWorldNeedsUpdate):cg=this.Versioning.NeedsUpdate;var mg=this.BindingType.Direct;if(void 0!==ng){if('morphTargetInfluences'===ig){if(!rg.geometry)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.',this);if(rg.geometry.isBufferGeometry){if(!rg.geometry.morphAttributes)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.',this);for(var lg=0;lg<this.node.geometry.morphAttributes.position.length;lg++)if(rg.geometry.morphAttributes.position[lg].name===ng){ng=lg;break}}else{if(!rg.geometry.morphTargets)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.',this);for(var lg=0;lg<this.node.geometry.morphTargets.length;lg++)if(rg.geometry.morphTargets[lg].name===ng){ng=lg;break}}}mg=this.BindingType.ArrayElement,this.resolvedProperty=pg,this.propertyIndex=ng}else void 0!==pg.fromArray&&void 0!==pg.toArray?(mg=this.BindingType.HasFromToArray,this.resolvedProperty=pg):Array.isArray(pg)?(mg=this.BindingType.EntireArray,this.resolvedProperty=pg):this.propertyName=ig;this.getValue=this.GetterByBindingType[mg],this.setValue=this.SetterByBindingTypeAndVersioning[mg][cg]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Gi.prototype,{_getValue_unbound:Gi.prototype.getValue,_setValue_unbound:Gi.prototype.setValue}),Object.assign(function(){this.uuid=Sp.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var rg={};this._indicesByUUID=rg;for(var ag=0,og=arguments.length;ag!==og;++ag)rg[arguments[ag].uuid]=ag;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var ig=this;this.stats={objects:{get total(){return ig._objects.length},get inUse(){return this.total-ig.nCachedObjects_}},get bindingsPerObject(){return ig._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var rg=this._objects,ag=rg.length,og=this.nCachedObjects_,ig=this._indicesByUUID,ng=this._paths,sg=this._parsedPaths,lg=this._bindings,pg=lg.length,dg=void 0,cg=0,mg=arguments.length;cg!==mg;++cg){var ug=arguments[cg],gg=ug.uuid,fg=ig[gg];if(void 0===fg){fg=ag++,ig[gg]=fg,rg.push(ug);for(var hg=0,yg=pg;hg!==yg;++hg)lg[hg].push(new Gi(ug,ng[hg],sg[hg]))}else if(fg<og){dg=rg[fg];var xg=--og,vg=rg[xg];ig[vg.uuid]=fg,rg[fg]=vg,ig[gg]=xg,rg[xg]=ug;for(var hg=0,yg=pg;hg!==yg;++hg){var _g=lg[hg],bg=_g[xg],Sg=_g[fg];_g[fg]=bg,void 0===Sg&&(Sg=new Gi(ug,ng[hg],sg[hg])),_g[xg]=Sg}}else rg[fg]!==dg&&console.error('THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.')}this.nCachedObjects_=og},remove:function(){for(var rg=this._objects,ag=this.nCachedObjects_,og=this._indicesByUUID,ig=this._bindings,ng=ig.length,sg=0,lg=arguments.length;sg!==lg;++sg){var pg=arguments[sg],dg=pg.uuid,cg=og[dg];if(void 0!==cg&&cg>=ag){var mg=ag++,ug=rg[mg];og[ug.uuid]=cg,rg[cg]=ug,og[dg]=mg,rg[mg]=pg;for(var gg=0;gg!==ng;++gg){var hg=ig[gg],yg=hg[mg],xg=hg[cg];hg[cg]=yg,hg[mg]=xg}}}this.nCachedObjects_=ag},uncache:function(){for(var rg=this._objects,ag=rg.length,og=this.nCachedObjects_,ig=this._indicesByUUID,ng=this._bindings,sg=ng.length,lg=0,pg=arguments.length;lg!==pg;++lg){var dg=arguments[lg],cg=dg.uuid,mg=ig[cg];if(void 0!==mg)if(delete ig[cg],mg<og){var ug=--og,gg=rg[ug],fg=--ag,hg=rg[fg];ig[gg.uuid]=mg,rg[mg]=gg,ig[hg.uuid]=ug,rg[ug]=hg,rg.pop();for(var yg=0,xg=sg;yg!==xg;++yg){var vg=ng[yg],_g=vg[ug],bg=vg[fg];vg[mg]=_g,vg[ug]=bg,vg.pop()}}else{var fg=--ag,hg=rg[fg];ig[hg.uuid]=mg,rg[mg]=hg,rg.pop();for(var yg=0,xg=sg,vg;yg!==xg;++yg)vg=ng[yg],vg[mg]=vg[fg],vg.pop()}}this.nCachedObjects_=og},subscribe_:function(rg,ag){var og=this._bindingsIndicesByPath,ig=og[rg],ng=this._bindings;if(void 0!==ig)return ng[ig];var sg=this._paths,lg=this._parsedPaths,pg=this._objects,dg=pg.length,cg=this.nCachedObjects_,mg=Array(dg);ig=ng.length,og[rg]=ig,sg.push(rg),lg.push(ag),ng.push(mg);for(var ug=cg,gg=pg.length,fg;ug!==gg;++ug)fg=pg[ug],mg[ug]=new Gi(fg,rg,ag);return mg},unsubscribe_:function(rg){var ag=this._bindingsIndicesByPath,og=ag[rg];if(void 0!==og){var ig=this._paths,ng=this._parsedPaths,sg=this._bindings,lg=sg.length-1,pg=sg[lg],dg=rg[lg];ag[dg]=og,sg[og]=pg,sg.pop(),ng[og]=ng[lg],ng.pop(),ig[og]=ig[lg],ig.pop()}}}),Object.assign(Fi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(rg){return this._startTime=rg,this},setLoop:function(rg,ag){return this.loop=rg,this.repetitions=ag,this},setEffectiveWeight:function(rg){return this.weight=rg,this._effectiveWeight=this.enabled?rg:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(rg){return this._scheduleFading(rg,0,1)},fadeOut:function(rg){return this._scheduleFading(rg,1,0)},crossFadeFrom:function(rg,ag,og){if(rg.fadeOut(ag),this.fadeIn(ag),og){var ig=this._clip.duration,ng=rg._clip.duration;rg.warp(1,ng/ig,ag),this.warp(ig/ng,1,ag)}return this},crossFadeTo:function(rg,ag,og){return rg.crossFadeFrom(this,ag,og)},stopFading:function(){var rg=this._weightInterpolant;return null!==rg&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(rg)),this},setEffectiveTimeScale:function(rg){return this.timeScale=rg,this._effectiveTimeScale=this.paused?0:rg,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(rg){return this.timeScale=this._clip.duration/rg,this.stopWarping()},syncWith:function(rg){return this.time=rg.time,this.timeScale=rg.timeScale,this.stopWarping()},halt:function(rg){return this.warp(this._effectiveTimeScale,0,rg)},warp:function(rg,ag,og){var ig=this._mixer,ng=ig.time,sg=this._timeScaleInterpolant,lg=this.timeScale;null===sg&&(sg=ig._lendControlInterpolant(),this._timeScaleInterpolant=sg);var pg=sg.parameterPositions,dg=sg.sampleValues;return pg[0]=ng,pg[1]=ng+og,dg[0]=rg/lg,dg[1]=ag/lg,this},stopWarping:function(){var rg=this._timeScaleInterpolant;return null!==rg&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(rg)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(rg,ag,og,ig){if(!this.enabled)return void this._updateWeight(rg);var ng=this._startTime;if(null!==ng){var sg=(rg-ng)*og;if(0>sg||0===og)return;this._startTime=null,ag=og*sg}ag*=this._updateTimeScale(rg);var lg=this._updateTime(ag),pg=this._updateWeight(rg);if(0<pg)for(var dg=this._interpolants,cg=this._propertyBindings,mg=0,ug=dg.length;mg!==ug;++mg)dg[mg].evaluate(lg),cg[mg].accumulate(ig,pg)},_updateWeight:function(rg){var ag=0;if(this.enabled){ag=this.weight;var og=this._weightInterpolant;if(null!==og){var ig=og.evaluate(rg)[0];ag*=ig,rg>og.parameterPositions[1]&&(this.stopFading(),0===ig&&(this.enabled=!1))}}return this._effectiveWeight=ag,ag},_updateTimeScale:function(rg){var ag=0;if(!this.paused){ag=this.timeScale;var og=this._timeScaleInterpolant;if(null!==og){var ig=og.evaluate(rg)[0];ag*=ig,rg>og.parameterPositions[1]&&(this.stopWarping(),0==ag?this.paused=!0:this.timeScale=ag)}}return this._effectiveTimeScale=ag,ag},_updateTime:function(rg){var ag=this.time+rg,og=this._clip.duration,ig=this.loop,ng=this._loopCount,sg=ig===2202;if(0===rg)return-1===ng?ag:sg&&1==(1&ng)?og-ag:ag;if(ig===2200){-1===ng&&(this._loopCount=0,this._setEndings(!0,!0,!1));handle_stop:{if(ag>=og)ag=og;else if(0>ag)ag=0;else break handle_stop;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:'finished',action:this,direction:0>rg?-1:1})}}else{if(-1===ng&&(0<=rg?(ng=0,this._setEndings(!0,0===this.repetitions,sg)):this._setEndings(0===this.repetitions,!0,sg)),ag>=og||0>ag){var lg=Math.floor(ag/og);ag-=og*lg,ng+=Math.abs(lg);var pg=this.repetitions-ng;if(0>=pg)this.clampWhenFinished?this.paused=!0:this.enabled=!1,ag=0<rg?og:0,this._mixer.dispatchEvent({type:'finished',action:this,direction:0<rg?1:-1});else{if(1==pg){var dg=0>rg;this._setEndings(dg,!dg,sg)}else this._setEndings(!1,!1,sg);this._loopCount=ng,this._mixer.dispatchEvent({type:'loop',action:this,loopDelta:lg})}}if(sg&&1==(1&ng))return this.time=ag,og-ag}return this.time=ag,ag},_setEndings:function(rg,ag,og){var ig=this._interpolantSettings;og?(ig.endingStart=ap,ig.endingEnd=ap):(ig.endingStart=rg?this.zeroSlopeAtStart?ap:rp:op,ig.endingEnd=ag?this.zeroSlopeAtEnd?ap:rp:op)},_scheduleFading:function(rg,ag,og){var ig=this._mixer,ng=ig.time,sg=this._weightInterpolant;null===sg&&(sg=ig._lendControlInterpolant(),this._weightInterpolant=sg);var lg=sg.parameterPositions,pg=sg.sampleValues;return lg[0]=ng,pg[0]=ag,lg[1]=ng+rg,pg[1]=og,this}}),Hi.prototype=Object.assign(Object.create(M.prototype),{constructor:Hi,_bindAction:function(rg,ag){var og=rg._localRoot||this._root,ig=rg._clip.tracks,ng=ig.length,sg=rg._propertyBindings,lg=rg._interpolants,pg=og.uuid,dg=this._bindingsByRootAndName,cg=dg[pg];void 0===cg&&(cg={},dg[pg]=cg);for(var mg=0;mg!==ng;++mg){var ug=ig[mg],gg=ug.name,fg=cg[gg];if(void 0!==fg)sg[mg]=fg;else{if(fg=sg[mg],void 0!==fg){null===fg._cacheIndex&&(++fg.referenceCount,this._addInactiveBinding(fg,pg,gg));continue}var hg=ag&&ag._propertyBindings[mg].binding.parsedPath;fg=new Ni(Gi.create(og,gg,hg),ug.ValueTypeName,ug.getValueSize()),++fg.referenceCount,this._addInactiveBinding(fg,pg,gg),sg[mg]=fg}lg[mg].resultBuffer=fg.buffer}},_activateAction:function(rg){if(!this._isActiveAction(rg)){if(null===rg._cacheIndex){var ag=(rg._localRoot||this._root).uuid,og=rg._clip.uuid,ig=this._actionsByClip[og];this._bindAction(rg,ig&&ig.knownActions[0]),this._addInactiveAction(rg,og,ag)}for(var ng=rg._propertyBindings,sg=0,lg=ng.length,pg;sg!==lg;++sg)pg=ng[sg],0==pg.useCount++&&(this._lendBinding(pg),pg.saveOriginalState());this._lendAction(rg)}},_deactivateAction:function(rg){if(this._isActiveAction(rg)){for(var ag=rg._propertyBindings,og=0,ig=ag.length,ng;og!==ig;++og)ng=ag[og],0==--ng.useCount&&(ng.restoreOriginalState(),this._takeBackBinding(ng));this._takeBackAction(rg)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var rg=this;this.stats={actions:{get total(){return rg._actions.length},get inUse(){return rg._nActiveActions}},bindings:{get total(){return rg._bindings.length},get inUse(){return rg._nActiveBindings}},controlInterpolants:{get total(){return rg._controlInterpolants.length},get inUse(){return rg._nActiveControlInterpolants}}}},_isActiveAction:function(rg){var ag=rg._cacheIndex;return null!==ag&&ag<this._nActiveActions},_addInactiveAction:function(rg,ag,og){var ig=this._actions,ng=this._actionsByClip,sg=ng[ag];if(void 0===sg)sg={knownActions:[rg],actionByRoot:{}},rg._byClipCacheIndex=0,ng[ag]=sg;else{var lg=sg.knownActions;rg._byClipCacheIndex=lg.length,lg.push(rg)}rg._cacheIndex=ig.length,ig.push(rg),sg.actionByRoot[og]=rg},_removeInactiveAction:function(rg){var ag=this._actions,og=ag[ag.length-1],ig=rg._cacheIndex;og._cacheIndex=ig,ag[ig]=og,ag.pop(),rg._cacheIndex=null;var ng=rg._clip.uuid,sg=this._actionsByClip,lg=sg[ng],pg=lg.knownActions,dg=pg[pg.length-1],cg=rg._byClipCacheIndex;dg._byClipCacheIndex=cg,pg[cg]=dg,pg.pop(),rg._byClipCacheIndex=null;var mg=lg.actionByRoot,ug=(rg._localRoot||this._root).uuid;delete mg[ug],0===pg.length&&delete sg[ng],this._removeInactiveBindingsForAction(rg)},_removeInactiveBindingsForAction:function(rg){for(var ag=rg._propertyBindings,og=0,ig=ag.length,ng;og!==ig;++og)ng=ag[og],0==--ng.referenceCount&&this._removeInactiveBinding(ng)},_lendAction:function(rg){var ag=this._actions,og=rg._cacheIndex,ig=this._nActiveActions++,ng=ag[ig];rg._cacheIndex=ig,ag[ig]=rg,ng._cacheIndex=og,ag[og]=ng},_takeBackAction:function(rg){var ag=this._actions,og=rg._cacheIndex,ig=--this._nActiveActions,ng=ag[ig];rg._cacheIndex=ig,ag[ig]=rg,ng._cacheIndex=og,ag[og]=ng},_addInactiveBinding:function(rg,ag,og){var ig=this._bindingsByRootAndName,ng=ig[ag],sg=this._bindings;void 0===ng&&(ng={},ig[ag]=ng),ng[og]=rg,rg._cacheIndex=sg.length,sg.push(rg)},_removeInactiveBinding:function(rg){var ag=this._bindings,og=rg.binding,ig=og.rootNode.uuid,ng=og.path,sg=this._bindingsByRootAndName,lg=sg[ig],pg=ag[ag.length-1],dg=rg._cacheIndex;pg._cacheIndex=dg,ag[dg]=pg,ag.pop(),delete lg[ng];remove_empty_map:{for(var cg in lg)break remove_empty_map;delete sg[ig]}},_lendBinding:function(rg){var ag=this._bindings,og=rg._cacheIndex,ig=this._nActiveBindings++,ng=ag[ig];rg._cacheIndex=ig,ag[ig]=rg,ng._cacheIndex=og,ag[og]=ng},_takeBackBinding:function(rg){var ag=this._bindings,og=rg._cacheIndex,ig=--this._nActiveBindings,ng=ag[ig];rg._cacheIndex=ig,ag[ig]=rg,ng._cacheIndex=og,ag[og]=ng},_lendControlInterpolant:function(){var rg=this._controlInterpolants,ag=this._nActiveControlInterpolants++,og=rg[ag];return void 0===og&&(og=new uo(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),og.__cacheIndex=ag,rg[ag]=og),og},_takeBackControlInterpolant:function(rg){var ag=this._controlInterpolants,og=rg.__cacheIndex,ig=--this._nActiveControlInterpolants,ng=ag[ig];rg.__cacheIndex=ig,ag[ig]=rg,ng.__cacheIndex=og,ag[og]=ng},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(rg,ag){var og=ag||this._root,ig=og.uuid,ng='string'==typeof rg?To.findByName(og,rg):rg,sg=null===ng?rg:ng.uuid,lg=this._actionsByClip[sg],pg=null;if(void 0!==lg){var dg=lg.actionByRoot[ig];if(void 0!==dg)return dg;pg=lg.knownActions[0],null===ng&&(ng=pg._clip)}if(null===ng)return null;var cg=new Fi(this,ng,ag);return this._bindAction(cg,pg),this._addInactiveAction(cg,sg,ig),cg},existingAction:function(rg,ag){var og=ag||this._root,ig=og.uuid,ng='string'==typeof rg?To.findByName(og,rg):rg,sg=ng?ng.uuid:rg,lg=this._actionsByClip[sg];return void 0===lg?null:lg.actionByRoot[ig]||null},stopAllAction:function(){var rg=this._actions,ag=this._nActiveActions,og=this._bindings,ig=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var ng=0;ng!==ag;++ng)rg[ng].reset();for(var ng=0;ng!==ig;++ng)og[ng].useCount=0;return this},update:function(rg){rg*=this.timeScale;for(var ag=this._actions,og=this._nActiveActions,ig=this.time+=rg,ng=Math.sign(rg),sg=this._accuIndex^=1,lg=0,pg;lg!==og;++lg)pg=ag[lg],pg._update(ig,rg,ng,sg);for(var dg=this._bindings,cg=this._nActiveBindings,lg=0;lg!==cg;++lg)dg[lg].apply(sg);return this},getRoot:function(){return this._root},uncacheClip:function(rg){var ag=this._actions,og=rg.uuid,ig=this._actionsByClip,ng=ig[og];if(void 0!==ng){for(var sg=ng.knownActions,lg=0,pg=sg.length,dg;lg!==pg;++lg){dg=sg[lg],this._deactivateAction(dg);var cg=dg._cacheIndex,mg=ag[ag.length-1];dg._cacheIndex=null,dg._byClipCacheIndex=null,mg._cacheIndex=cg,ag[cg]=mg,ag.pop(),this._removeInactiveBindingsForAction(dg)}delete ig[og]}},uncacheRoot:function(rg){var ag=rg.uuid,og=this._actionsByClip;for(var ig in og){var ng=og[ig].actionByRoot,sg=ng[ag];void 0!==sg&&(this._deactivateAction(sg),this._removeInactiveAction(sg))}var lg=this._bindingsByRootAndName,pg=lg[ag];if(void 0!==pg)for(var dg in pg){var cg=pg[dg];cg.restoreOriginalState(),this._removeInactiveBinding(cg)}},uncacheAction:function(rg,ag){var og=this.existingAction(rg,ag);null!==og&&(this._deactivateAction(og),this._removeInactiveAction(og))}}),Vi.prototype.clone=function(){return new Vi(void 0===this.value.clone?this.value:this.value.clone())},ki.prototype=Object.assign(Object.create(ve.prototype),{constructor:ki,isInstancedBufferGeometry:!0,copy:function(rg){return ve.prototype.copy.call(this,rg),this.maxInstancedCount=rg.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}}),Wi.prototype=Object.assign(Object.create(hr.prototype),{constructor:Wi,isInstancedInterleavedBuffer:!0,copy:function(rg){return hr.prototype.copy.call(this,rg),this.meshPerAttribute=rg.meshPerAttribute,this}}),ji.prototype=Object.assign(Object.create(oe.prototype),{constructor:ji,isInstancedBufferAttribute:!0,copy:function(rg){return oe.prototype.copy.call(this,rg),this.meshPerAttribute=rg.meshPerAttribute,this}}),Object.assign(function(rg,ag,og,ig){this.ray=new Le(rg,ag),this.near=og||0,this.far=ig||Infinity,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn('THREE.Raycaster: params.PointCloud has been renamed to params.Points.'),this.Points}}})}.prototype,{linePrecision:1,set:function(rg,ag){this.ray.set(rg,ag)},setFromCamera:function(rg,ag){ag&&ag.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(ag.matrixWorld),this.ray.direction.set(rg.x,rg.y,0.5).unproject(ag).sub(this.ray.origin).normalize()):ag&&ag.isOrthographicCamera?(this.ray.origin.set(rg.x,rg.y,(ag.near+ag.far)/(ag.near-ag.far)).unproject(ag),this.ray.direction.set(0,0,-1).transformDirection(ag.matrixWorld)):console.error('THREE.Raycaster: Unsupported camera type.')},intersectObject:function(rg,ag,og){var ig=og||[];return Xi(rg,this,ig,ag),ig.sort(Yi),ig},intersectObjects:function(rg,ag,og){var ig=og||[];if(!1===Array.isArray(rg))return console.warn('THREE.Raycaster.intersectObjects: objects is not an Array.'),ig;for(var ng=0,sg=rg.length;ng<sg;ng++)Xi(rg[ng],this,ig,ag);return ig.sort(Yi),ig}}),Object.assign(function(rg,ag,og){return this.radius=void 0===rg?1:rg,this.phi=void 0===ag?0:ag,this.theta=void 0===og?0:og,this}.prototype,{set:function(rg,ag,og){return this.radius=rg,this.phi=ag,this.theta=og,this},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.radius=rg.radius,this.phi=rg.phi,this.theta=rg.theta,this},makeSafe:function(){var rg=1e-6;return this.phi=Math.max(rg,Math.min(Math.PI-rg,this.phi)),this},setFromVector3:function(rg){return this.setFromCartesianCoords(rg.x,rg.y,rg.z)},setFromCartesianCoords:function(rg,ag,og){return this.radius=Math.sqrt(rg*rg+ag*ag+og*og),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(rg,og),this.phi=Math.acos(Sp.clamp(ag/this.radius,-1,1))),this}}),Object.assign(function(rg,ag,og){return this.radius=void 0===rg?1:rg,this.theta=void 0===ag?0:ag,this.y=void 0===og?0:og,this}.prototype,{set:function(rg,ag,og){return this.radius=rg,this.theta=ag,this.y=og,this},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.radius=rg.radius,this.theta=rg.theta,this.y=rg.y,this},setFromVector3:function(rg){return this.setFromCartesianCoords(rg.x,rg.y,rg.z)},setFromCartesianCoords:function(rg,ag,og){return this.radius=Math.sqrt(rg*rg+og*og),this.theta=Math.atan2(rg,og),this.y=ag,this}}),Object.assign(Qi.prototype,{set:function(rg,ag){return this.min.copy(rg),this.max.copy(ag),this},setFromPoints:function(rg){this.makeEmpty();for(var ag=0,og=rg.length;ag<og;ag++)this.expandByPoint(rg[ag]);return this},setFromCenterAndSize:function(){var rg=new E;return function(og,ig){var ng=rg.copy(ig).multiplyScalar(0.5);return this.min.copy(og).sub(ng),this.max.copy(og).add(ng),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.min.copy(rg.min),this.max.copy(rg.max),this},makeEmpty:function(){return this.min.x=this.min.y=+Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(rg){return void 0===rg&&(console.warn('THREE.Box2: .getCenter() target is now required'),rg=new E),this.isEmpty()?rg.set(0,0):rg.addVectors(this.min,this.max).multiplyScalar(0.5)},getSize:function(rg){return void 0===rg&&(console.warn('THREE.Box2: .getSize() target is now required'),rg=new E),this.isEmpty()?rg.set(0,0):rg.subVectors(this.max,this.min)},expandByPoint:function(rg){return this.min.min(rg),this.max.max(rg),this},expandByVector:function(rg){return this.min.sub(rg),this.max.add(rg),this},expandByScalar:function(rg){return this.min.addScalar(-rg),this.max.addScalar(rg),this},containsPoint:function(rg){return rg.x<this.min.x||rg.x>this.max.x||rg.y<this.min.y||rg.y>this.max.y?!1:!0},containsBox:function(rg){return this.min.x<=rg.min.x&&rg.max.x<=this.max.x&&this.min.y<=rg.min.y&&rg.max.y<=this.max.y},getParameter:function(rg,ag){return void 0===ag&&(console.warn('THREE.Box2: .getParameter() target is now required'),ag=new E),ag.set((rg.x-this.min.x)/(this.max.x-this.min.x),(rg.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(rg){return rg.max.x<this.min.x||rg.min.x>this.max.x||rg.max.y<this.min.y||rg.min.y>this.max.y?!1:!0},clampPoint:function(rg,ag){return void 0===ag&&(console.warn('THREE.Box2: .clampPoint() target is now required'),ag=new E),ag.copy(rg).clamp(this.min,this.max)},distanceToPoint:function(){var rg=new E;return function(og){var ig=rg.copy(og).clamp(this.min,this.max);return ig.sub(og).length()}}(),intersect:function(rg){return this.min.max(rg.min),this.max.min(rg.max),this},union:function(rg){return this.min.min(rg.min),this.max.max(rg.max),this},translate:function(rg){return this.min.add(rg),this.max.add(rg),this},equals:function(rg){return rg.min.equals(this.min)&&rg.max.equals(this.max)}}),Object.assign(Ki.prototype,{set:function(rg,ag){return this.start.copy(rg),this.end.copy(ag),this},clone:function(){return new this.constructor().copy(this)},copy:function(rg){return this.start.copy(rg.start),this.end.copy(rg.end),this},getCenter:function(rg){return void 0===rg&&(console.warn('THREE.Line3: .getCenter() target is now required'),rg=new C),rg.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(rg){return void 0===rg&&(console.warn('THREE.Line3: .delta() target is now required'),rg=new C),rg.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(rg,ag){return void 0===ag&&(console.warn('THREE.Line3: .at() target is now required'),ag=new C),this.delta(ag).multiplyScalar(rg).add(this.start)},closestPointToPointParameter:function(){var rg=new C,ag=new C;return function(ig,ng){rg.subVectors(ig,this.start),ag.subVectors(this.end,this.start);var sg=ag.dot(ag),lg=ag.dot(rg),pg=lg/sg;return ng&&(pg=Sp.clamp(pg,0,1)),pg}}(),closestPointToPoint:function(rg,ag,og){var ig=this.closestPointToPointParameter(rg,ag);return void 0===og&&(console.warn('THREE.Line3: .closestPointToPoint() target is now required'),og=new C),this.delta(og).multiplyScalar(ig).add(this.start)},applyMatrix4:function(rg){return this.start.applyMatrix4(rg),this.end.applyMatrix4(rg),this},equals:function(rg){return rg.start.equals(this.start)&&rg.end.equals(this.end)}}),$i.prototype=Object.create(ee.prototype),$i.prototype.constructor=$i,$i.prototype.isImmediateRenderObject=!0,en.prototype=Object.create(Lr.prototype),en.prototype.constructor=en,en.prototype.update=function(){var rg=new C,ag=new C,og=new R;return function(){var ng=['a','b','c'];this.object.updateMatrixWorld(!0),og.getNormalMatrix(this.object.matrixWorld);var sg=this.object.matrixWorld,lg=this.geometry.attributes.position,pg=this.object.geometry;if(pg&&pg.isGeometry)for(var dg=pg.vertices,cg=pg.faces,mg=0,ug=0,gg=cg.length,fg;ug<gg;ug++){fg=cg[ug];for(var hg=0,yg=fg.vertexNormals.length;hg<yg;hg++){var xg=dg[fg[ng[hg]]],vg=fg.vertexNormals[hg];rg.copy(xg).applyMatrix4(sg),ag.copy(vg).applyMatrix3(og).normalize().multiplyScalar(this.size).add(rg),lg.setXYZ(mg,rg.x,rg.y,rg.z),++mg,lg.setXYZ(mg,ag.x,ag.y,ag.z),++mg}}else if(pg&&pg.isBufferGeometry)for(var _g=pg.attributes.position,bg=pg.attributes.normal,mg=0,hg=0,yg=_g.count;hg<yg;hg++)rg.set(_g.getX(hg),_g.getY(hg),_g.getZ(hg)).applyMatrix4(sg),ag.set(bg.getX(hg),bg.getY(hg),bg.getZ(hg)),ag.applyMatrix3(og).normalize().multiplyScalar(this.size).add(rg),lg.setXYZ(mg,rg.x,rg.y,rg.z),++mg,lg.setXYZ(mg,ag.x,ag.y,ag.z),++mg;lg.needsUpdate=!0}}(),tn.prototype=Object.create(ee.prototype),tn.prototype.constructor=tn,tn.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},tn.prototype.update=function(){var rg=new C,ag=new C;return function(){this.light.updateMatrixWorld();var ig=this.light.distance?this.light.distance:1e3,ng=ig*Math.tan(this.light.angle);this.cone.scale.set(ng,ng,ig),rg.setFromMatrixPosition(this.light.matrixWorld),ag.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ag.sub(rg)),void 0===this.color?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),on.prototype=Object.create(Lr.prototype),on.prototype.constructor=on,on.prototype.updateMatrixWorld=function(){var rg=new C,ag=new L,og=new L;return function(ng){var sg=this.bones,lg=this.geometry,pg=lg.getAttribute('position');og.getInverse(this.root.matrixWorld);for(var dg=0,cg=0,mg;dg<sg.length;dg++)mg=sg[dg],mg.parent&&mg.parent.isBone&&(ag.multiplyMatrices(og,mg.matrixWorld),rg.setFromMatrixPosition(ag),pg.setXYZ(cg,rg.x,rg.y,rg.z),ag.multiplyMatrices(og,mg.parent.matrixWorld),rg.setFromMatrixPosition(ag),pg.setXYZ(cg+1,rg.x,rg.y,rg.z),cg+=2);lg.getAttribute('position').needsUpdate=!0,ee.prototype.updateMatrixWorld.call(this,ng)}}(),nn.prototype=Object.create(Ce.prototype),nn.prototype.constructor=nn,nn.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},nn.prototype.update=function(){void 0===this.color?this.material.color.copy(this.light.color):this.material.color.set(this.color)},sn.prototype=Object.create(ee.prototype),sn.prototype.constructor=sn,sn.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},sn.prototype.update=function(){var rg=0.5*this.light.width,ag=0.5*this.light.height,og=this.line.geometry.attributes.position,ig=og.array;ig[0]=rg,ig[1]=-ag,ig[2]=0,ig[3]=rg,ig[4]=ag,ig[5]=0,ig[6]=-rg,ig[7]=ag,ig[8]=0,ig[9]=-rg,ig[10]=-ag,ig[11]=0,ig[12]=rg,ig[13]=-ag,ig[14]=0,og.needsUpdate=!0,void 0===this.color?this.line.material.color.copy(this.light.color):this.line.material.color.set(this.color)},ln.prototype=Object.create(ee.prototype),ln.prototype.constructor=ln,ln.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ln.prototype.update=function(){var rg=new C,ag=new Y,og=new Y;return function(){var ng=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var sg=ng.geometry.getAttribute('color');ag.copy(this.light.color),og.copy(this.light.groundColor);for(var lg=0,pg=sg.count,dg;lg<pg;lg++)dg=lg<pg/2?ag:og,sg.setXYZ(lg,dg.r,dg.g,dg.b);sg.needsUpdate=!0}ng.lookAt(rg.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),pn.prototype=Object.create(Lr.prototype),pn.prototype.constructor=pn,dn.prototype=Object.create(Lr.prototype),dn.prototype.constructor=dn,cn.prototype=Object.create(Lr.prototype),cn.prototype.constructor=cn,cn.prototype.update=function(){var rg=new C,ag=new C,og=new R;return function(){this.object.updateMatrixWorld(!0),og.getNormalMatrix(this.object.matrixWorld);for(var ng=this.object.matrixWorld,sg=this.geometry.attributes.position,lg=this.object.geometry,pg=lg.vertices,dg=lg.faces,cg=0,mg=0,ug=dg.length;mg<ug;mg++){var gg=dg[mg],fg=gg.normal;rg.copy(pg[gg.a]).add(pg[gg.b]).add(pg[gg.c]).divideScalar(3).applyMatrix4(ng),ag.copy(fg).applyMatrix3(og).normalize().multiplyScalar(this.size).add(rg),sg.setXYZ(cg,rg.x,rg.y,rg.z),++cg,sg.setXYZ(cg,ag.x,ag.y,ag.z),++cg}sg.needsUpdate=!0}}(),mn.prototype=Object.create(ee.prototype),mn.prototype.constructor=mn,mn.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},mn.prototype.update=function(){var rg=new C,ag=new C,og=new C;return function(){rg.setFromMatrixPosition(this.light.matrixWorld),ag.setFromMatrixPosition(this.light.target.matrixWorld),og.subVectors(ag,rg),this.lightPlane.lookAt(ag),void 0===this.color?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(ag),this.targetLine.scale.z=og.length()}}(),un.prototype=Object.create(Lr.prototype),un.prototype.constructor=un,un.prototype.update=function(){function rg(sg,lg,pg,dg){ig.set(lg,pg,dg).unproject(ng);var cg=og[sg];if(void 0!==cg)for(var mg=ag.getAttribute('position'),ug=0,gg=cg.length;ug<gg;ug++)mg.setXYZ(cg[ug],ig.x,ig.y,ig.z)}var ig=new C,ng=new nr,ag,og;return function(){ag=this.geometry,og=this.pointMap;var lg=1,pg=1;ng.projectionMatrix.copy(this.camera.projectionMatrix),rg('c',0,0,-1),rg('t',0,0,1),rg('n1',-lg,-pg,-1),rg('n2',lg,-pg,-1),rg('n3',-lg,pg,-1),rg('n4',lg,pg,-1),rg('f1',-lg,-pg,1),rg('f2',lg,-pg,1),rg('f3',-lg,pg,1),rg('f4',lg,pg,1),rg('u1',0.7*lg,1.1*pg,-1),rg('u2',0.7*-lg,1.1*pg,-1),rg('u3',0,2*pg,-1),rg('cf1',-lg,0,1),rg('cf2',lg,0,1),rg('cf3',0,-pg,1),rg('cf4',0,pg,1),rg('cn1',-lg,0,-1),rg('cn2',lg,0,-1),rg('cn3',0,-pg,-1),rg('cn4',0,pg,-1),ag.getAttribute('position').needsUpdate=!0}}(),gn.prototype=Object.create(Lr.prototype),gn.prototype.constructor=gn,gn.prototype.update=function(){var rg=new F;return function(og){if(void 0!==og&&console.warn('THREE.BoxHelper: .update() has no longer arguments.'),void 0!==this.object&&rg.setFromObject(this.object),!rg.isEmpty()){var ig=rg.min,ng=rg.max,sg=this.geometry.attributes.position,lg=sg.array;lg[0]=ng.x,lg[1]=ng.y,lg[2]=ng.z,lg[3]=ig.x,lg[4]=ng.y,lg[5]=ng.z,lg[6]=ig.x,lg[7]=ig.y,lg[8]=ng.z,lg[9]=ng.x,lg[10]=ig.y,lg[11]=ng.z,lg[12]=ng.x,lg[13]=ng.y,lg[14]=ig.z,lg[15]=ig.x,lg[16]=ng.y,lg[17]=ig.z,lg[18]=ig.x,lg[19]=ig.y,lg[20]=ig.z,lg[21]=ng.x,lg[22]=ig.y,lg[23]=ig.z,sg.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),gn.prototype.setFromObject=function(rg){return this.object=rg,this.update(),this},gn.prototype.copy=function(rg){return Lr.prototype.copy.call(this,rg),this.object=rg.object,this},gn.prototype.clone=function(){return new this.constructor().copy(this)},fn.prototype=Object.create(Lr.prototype),fn.prototype.constructor=fn,fn.prototype.updateMatrixWorld=function(rg){var ag=this.box;ag.isEmpty()||(ag.getCenter(this.position),ag.getSize(this.scale),this.scale.multiplyScalar(0.5),ee.prototype.updateMatrixWorld.call(this,rg))},hn.prototype=Object.create(wr.prototype),hn.prototype.constructor=hn,hn.prototype.updateMatrixWorld=function(rg){var ag=-this.plane.constant;1e-8>Math.abs(ag)&&(ag=1e-8),this.scale.set(0.5*this.size,0.5*this.size,ag),this.children[0].material.side=0>ag?Fn:On,this.lookAt(this.plane.normal),ee.prototype.updateMatrixWorld.call(this,rg)};var zm,Dm;yn.prototype=Object.create(ee.prototype),yn.prototype.constructor=yn,yn.prototype.setDirection=function(){var rg=new C,ag;return function(ig){0.99999<ig.y?this.quaternion.set(0,0,0,1):-0.99999>ig.y?this.quaternion.set(1,0,0,0):(rg.set(ig.z,0,-ig.x).normalize(),ag=Math.acos(ig.y),this.quaternion.setFromAxisAngle(rg,ag))}}(),yn.prototype.setLength=function(rg,ag,og){void 0===ag&&(ag=0.2*rg),void 0===og&&(og=0.2*ag),this.line.scale.set(1,Math.max(0,rg-ag),1),this.line.updateMatrix(),this.cone.scale.set(og,ag,og),this.cone.position.y=rg,this.cone.updateMatrix()},yn.prototype.setColor=function(rg){this.line.material.color.copy(rg),this.cone.material.color.copy(rg)},yn.prototype.copy=function(rg){return ee.prototype.copy.call(this,rg,!1),this.line.copy(rg.line),this.cone.copy(rg.cone),this},yn.prototype.clone=function(){return new this.constructor().copy(this)},xn.prototype=Object.create(Lr.prototype),xn.prototype.constructor=xn,Bo.create=function(rg,ag){return console.log('THREE.Curve.create() has been deprecated'),rg.prototype=Object.create(Bo.prototype),rg.prototype.constructor=rg,rg.prototype.getPoint=ag,rg},Object.assign(ai.prototype,{createPointsGeometry:function(rg){console.warn('THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var ag=this.getPoints(rg);return this.createGeometry(ag)},createSpacedPointsGeometry:function(rg){console.warn('THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var ag=this.getSpacedPoints(rg);return this.createGeometry(ag)},createGeometry:function(rg){console.warn('THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');for(var ag=new re,og=0,ig=rg.length,ng;og<ig;og++)ng=rg[og],ag.vertices.push(new C(ng.x,ng.y,ng.z||0));return ag}}),Object.assign(oi.prototype,{fromPoints:function(rg){console.warn('THREE.Path: .fromPoints() has been renamed to .setFromPoints().'),this.setFromPoints(rg)}}),vn.prototype=Object.create(Oo.prototype),Object.assign(vn.prototype,{initFromArray:function(){console.error('THREE.Spline: .initFromArray() has been removed.')},getControlPointsArray:function(){console.error('THREE.Spline: .getControlPointsArray() has been removed.')},reparametrizeByArcLength:function(){console.error('THREE.Spline: .reparametrizeByArcLength() has been removed.')}}),pn.prototype.setColors=function(){console.error('THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.')},on.prototype.update=function(){console.error('THREE.SkeletonHelper: update() no longer needs to be called.')},Object.assign(_i.prototype,{extractUrlBase:function(rg){return console.warn('THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.'),Em.extractUrlBase(rg)}}),Object.assign(bi.prototype,{setTexturePath:function(rg){return console.warn('THREE.JSONLoader: .setTexturePath() has been renamed to .setResourcePath().'),this.setResourcePath(rg)}}),Object.assign(Si.prototype,{setTexturePath:function(rg){return console.warn('THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().'),this.setResourcePath(rg)}}),Object.assign(Qi.prototype,{center:function(rg){return console.warn('THREE.Box2: .center() has been renamed to .getCenter().'),this.getCenter(rg)},empty:function(){return console.warn('THREE.Box2: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(rg){return console.warn('THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(rg)},size:function(rg){return console.warn('THREE.Box2: .size() has been renamed to .getSize().'),this.getSize(rg)}}),Object.assign(F.prototype,{center:function(rg){return console.warn('THREE.Box3: .center() has been renamed to .getCenter().'),this.getCenter(rg)},empty:function(){return console.warn('THREE.Box3: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function(rg){return console.warn('THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(rg)},isIntersectionSphere:function(rg){return console.warn('THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(rg)},size:function(rg){return console.warn('THREE.Box3: .size() has been renamed to .getSize().'),this.getSize(rg)}}),Ki.prototype.center=function(rg){return console.warn('THREE.Line3: .center() has been renamed to .getCenter().'),this.getCenter(rg)},Object.assign(Sp,{random16:function(){return console.warn('THREE.Math: .random16() has been deprecated. Use Math.random() instead.'),Math.random()},nearestPowerOfTwo:function(rg){return console.warn('THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().'),Sp.floorPowerOfTwo(rg)},nextPowerOfTwo:function(rg){return console.warn('THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().'),Sp.ceilPowerOfTwo(rg)}}),Object.assign(R.prototype,{flattenToArrayOffset:function(rg,ag){return console.warn('THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(rg,ag)},multiplyVector3:function(rg){return console.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.'),rg.applyMatrix3(this)},multiplyVector3Array:function(){console.error('THREE.Matrix3: .multiplyVector3Array() has been removed.')},applyToBuffer:function(rg){return console.warn('THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(rg)},applyToVector3Array:function(){console.error('THREE.Matrix3: .applyToVector3Array() has been removed.')}}),Object.assign(L.prototype,{extractPosition:function(rg){return console.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().'),this.copyPosition(rg)},flattenToArrayOffset:function(rg,ag){return console.warn('THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(rg,ag)},getPosition:function(){var rg;return function(){return void 0==rg&&(rg=new C),console.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.'),rg.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(rg){return console.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().'),this.makeRotationFromQuaternion(rg)},multiplyToArray:function(){console.warn('THREE.Matrix4: .multiplyToArray() has been removed.')},multiplyVector3:function(rg){return console.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.'),rg.applyMatrix4(this)},multiplyVector4:function(rg){return console.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.'),rg.applyMatrix4(this)},multiplyVector3Array:function(){console.error('THREE.Matrix4: .multiplyVector3Array() has been removed.')},rotateAxis:function(rg){console.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.'),rg.transformDirection(this)},crossVector:function(rg){return console.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.'),rg.applyMatrix4(this)},translate:function(){console.error('THREE.Matrix4: .translate() has been removed.')},rotateX:function(){console.error('THREE.Matrix4: .rotateX() has been removed.')},rotateY:function(){console.error('THREE.Matrix4: .rotateY() has been removed.')},rotateZ:function(){console.error('THREE.Matrix4: .rotateZ() has been removed.')},rotateByAxis:function(){console.error('THREE.Matrix4: .rotateByAxis() has been removed.')},applyToBuffer:function(rg){return console.warn('THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(rg)},applyToVector3Array:function(){console.error('THREE.Matrix4: .applyToVector3Array() has been removed.')},makeFrustum:function(rg,ag,og,ig,ng,sg){return console.warn('THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.'),this.makePerspective(rg,ag,ig,og,ng,sg)}}),V.prototype.isIntersectionLine=function(rg){return console.warn('THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().'),this.intersectsLine(rg)},A.prototype.multiplyVector3=function(rg){return console.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.'),rg.applyQuaternion(this)},Object.assign(Le.prototype,{isIntersectionBox:function(rg){return console.warn('THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(rg)},isIntersectionPlane:function(rg){return console.warn('THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().'),this.intersectsPlane(rg)},isIntersectionSphere:function(rg){return console.warn('THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(rg)}}),Object.assign(Pe.prototype,{area:function(){return console.warn('THREE.Triangle: .area() has been renamed to .getArea().'),this.getArea()},barycoordFromPoint:function(rg,ag){return console.warn('THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().'),this.getBarycoord(rg,ag)},midpoint:function(rg){return console.warn('THREE.Triangle: .midpoint() has been renamed to .getMidpoint().'),this.getMidpoint(rg)},normal:function(rg){return console.warn('THREE.Triangle: .normal() has been renamed to .getNormal().'),this.getNormal(rg)},plane:function(rg){return console.warn('THREE.Triangle: .plane() has been renamed to .getPlane().'),this.getPlane(rg)}}),Object.assign(Pe,{barycoordFromPoint:function(rg,ag,og,ig,ng){return console.warn('THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().'),Pe.getBarycoord(rg,ag,og,ig,ng)},normal:function(rg,ag,og,ig){return console.warn('THREE.Triangle: .normal() has been renamed to .getNormal().'),Pe.getNormal(rg,ag,og,ig)}}),Object.assign(ii.prototype,{extractAllPoints:function(rg){return console.warn('THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.'),this.extractPoints(rg)},extrude:function(rg){return console.warn('THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.'),new Ra(this,rg)},makeGeometry:function(rg){return console.warn('THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.'),new Va(this,rg)}}),Object.assign(E.prototype,{fromAttribute:function(rg,ag,og){return console.warn('THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(rg,ag,og)},distanceToManhattan:function(rg){return console.warn('THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(rg)},lengthManhattan:function(){return console.warn('THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(C.prototype,{setEulerFromRotationMatrix:function(){console.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.')},setEulerFromQuaternion:function(){console.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.')},getPositionFromMatrix:function(rg){return console.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().'),this.setFromMatrixPosition(rg)},getScaleFromMatrix:function(rg){return console.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().'),this.setFromMatrixScale(rg)},getColumnFromMatrix:function(rg,ag){return console.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().'),this.setFromMatrixColumn(ag,rg)},applyProjection:function(rg){return console.warn('THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.'),this.applyMatrix4(rg)},fromAttribute:function(rg,ag,og){return console.warn('THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(rg,ag,og)},distanceToManhattan:function(rg){return console.warn('THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(rg)},lengthManhattan:function(){return console.warn('THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(D.prototype,{fromAttribute:function(rg,ag,og){return console.warn('THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(rg,ag,og)},lengthManhattan:function(){return console.warn('THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(re.prototype,{computeTangents:function(){console.error('THREE.Geometry: .computeTangents() has been removed.')},computeLineDistances:function(){console.error('THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.')}}),Object.assign(ee.prototype,{getChildByName:function(rg){return console.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().'),this.getObjectByName(rg)},renderDepth:function(){console.warn('THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.')},translate:function(rg,ag){return console.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.'),this.translateOnAxis(ag,rg)},getWorldRotation:function(){console.error('THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.')}}),Object.defineProperties(ee.prototype,{eulerOrder:{get:function(){return console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order},set:function(rg){console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order=rg}},useQuaternion:{get:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')},set:function(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')}}}),Object.defineProperties(br.prototype,{objects:{get:function(){return console.warn('THREE.LOD: .objects has been renamed to .levels.'),this.levels}}}),Object.defineProperty(Sr.prototype,'useVertexTexture',{get:function(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')},set:function(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')}}),Object.defineProperty(Bo.prototype,'__arcLengthDivisions',{get:function(){return console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions},set:function(rg){console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions=rg}}),sr.prototype.setLens=function(rg,ag){console.warn('THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.'),void 0!==ag&&(this.filmGauge=ag),this.setFocalLength(rg)},Object.defineProperties(ni.prototype,{onlyShadow:{set:function(){console.warn('THREE.Light: .onlyShadow has been removed.')}},shadowCameraFov:{set:function(rg){console.warn('THREE.Light: .shadowCameraFov is now .shadow.camera.fov.'),this.shadow.camera.fov=rg}},shadowCameraLeft:{set:function(rg){console.warn('THREE.Light: .shadowCameraLeft is now .shadow.camera.left.'),this.shadow.camera.left=rg}},shadowCameraRight:{set:function(rg){console.warn('THREE.Light: .shadowCameraRight is now .shadow.camera.right.'),this.shadow.camera.right=rg}},shadowCameraTop:{set:function(rg){console.warn('THREE.Light: .shadowCameraTop is now .shadow.camera.top.'),this.shadow.camera.top=rg}},shadowCameraBottom:{set:function(rg){console.warn('THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.'),this.shadow.camera.bottom=rg}},shadowCameraNear:{set:function(rg){console.warn('THREE.Light: .shadowCameraNear is now .shadow.camera.near.'),this.shadow.camera.near=rg}},shadowCameraFar:{set:function(rg){console.warn('THREE.Light: .shadowCameraFar is now .shadow.camera.far.'),this.shadow.camera.far=rg}},shadowCameraVisible:{set:function(){console.warn('THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.')}},shadowBias:{set:function(rg){console.warn('THREE.Light: .shadowBias is now .shadow.bias.'),this.shadow.bias=rg}},shadowDarkness:{set:function(){console.warn('THREE.Light: .shadowDarkness has been removed.')}},shadowMapWidth:{set:function(rg){console.warn('THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.'),this.shadow.mapSize.width=rg}},shadowMapHeight:{set:function(rg){console.warn('THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.'),this.shadow.mapSize.height=rg}}}),Object.defineProperties(oe.prototype,{length:{get:function(){return console.warn('THREE.BufferAttribute: .length has been deprecated. Use .count instead.'),this.array.length}},copyIndicesArray:function(){console.error('THREE.BufferAttribute: .copyIndicesArray() has been removed.')}}),Object.assign(ve.prototype,{addIndex:function(rg){console.warn('THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().'),this.setIndex(rg)},addDrawCall:function(rg,ag,og){void 0!==og&&console.warn('THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.'),console.warn('THREE.BufferGeometry: .addDrawCall() is now .addGroup().'),this.addGroup(rg,ag)},clearDrawCalls:function(){console.warn('THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().'),this.clearGroups()},computeTangents:function(){console.warn('THREE.BufferGeometry: .computeTangents() has been removed.')},computeOffsets:function(){console.warn('THREE.BufferGeometry: .computeOffsets() has been removed.')}}),Object.defineProperties(ve.prototype,{drawcalls:{get:function(){return console.error('THREE.BufferGeometry: .drawcalls has been renamed to .groups.'),this.groups}},offsets:{get:function(){return console.warn('THREE.BufferGeometry: .offsets has been renamed to .groups.'),this.groups}}}),Object.assign(Ia.prototype,{getArrays:function(){console.error('THREE.ExtrudeBufferGeometry: .getArrays() has been removed.')},addShapeList:function(){console.error('THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.')},addShape:function(){console.error('THREE.ExtrudeBufferGeometry: .addShape() has been removed.')}}),Object.defineProperties(Vi.prototype,{dynamic:{set:function(){console.warn('THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.')}},onUpdate:{value:function(){return console.warn('THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.'),this}}}),Object.defineProperties(Ee.prototype,{wrapAround:{get:function(){console.warn('THREE.Material: .wrapAround has been removed.')},set:function(){console.warn('THREE.Material: .wrapAround has been removed.')}},overdraw:{get:function(){console.warn('THREE.Material: .overdraw has been removed.')},set:function(){console.warn('THREE.Material: .overdraw has been removed.')}},wrapRGB:{get:function(){return console.warn('THREE.Material: .wrapRGB has been removed.'),new Y}},shading:{get:function(){console.error('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.')},set:function(rg){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=rg===Vn}}}),Object.defineProperties(oo.prototype,{metal:{get:function(){return console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.'),!1},set:function(){console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead')}}}),Object.defineProperties(we.prototype,{derivatives:{get:function(){return console.warn('THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives},set:function(rg){console.warn('THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives=rg}}}),Object.assign(mr.prototype,{clearTarget:function(rg,ag,og,ig){console.warn('THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.'),this.setRenderTarget(rg),this.clear(ag,og,ig)},animate:function(rg){console.warn('THREE.WebGLRenderer: .animate() is now .setAnimationLoop().'),this.setAnimationLoop(rg)},getCurrentRenderTarget:function(){return console.warn('THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().'),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn('THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().'),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn('THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.'),this.capabilities.precision},resetGLState:function(){return console.warn('THREE.WebGLRenderer: .resetGLState() is now .state.reset().'),this.state.reset()},supportsFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \'OES_texture_float\' ).'),this.extensions.get('OES_texture_float')},supportsHalfFloatTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \'OES_texture_half_float\' ).'),this.extensions.get('OES_texture_half_float')},supportsStandardDerivatives:function(){return console.warn('THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \'OES_standard_derivatives\' ).'),this.extensions.get('OES_standard_derivatives')},supportsCompressedTextureS3TC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \'WEBGL_compressed_texture_s3tc\' ).'),this.extensions.get('WEBGL_compressed_texture_s3tc')},supportsCompressedTexturePVRTC:function(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \'WEBGL_compressed_texture_pvrtc\' ).'),this.extensions.get('WEBGL_compressed_texture_pvrtc')},supportsBlendMinMax:function(){return console.warn('THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \'EXT_blend_minmax\' ).'),this.extensions.get('EXT_blend_minmax')},supportsVertexTextures:function(){return console.warn('THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.'),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn('THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \'ANGLE_instanced_arrays\' ).'),this.extensions.get('ANGLE_instanced_arrays')},enableScissorTest:function(rg){console.warn('THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().'),this.setScissorTest(rg)},initMaterial:function(){console.warn('THREE.WebGLRenderer: .initMaterial() has been removed.')},addPrePlugin:function(){console.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.')},addPostPlugin:function(){console.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.')},updateShadowMap:function(){console.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.')},setFaceCulling:function(){console.warn('THREE.WebGLRenderer: .setFaceCulling() has been removed.')}}),Object.defineProperties(mr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(rg){console.warn('THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.'),this.shadowMap.enabled=rg}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(rg){console.warn('THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.'),this.shadowMap.type=rg}},shadowMapCullFace:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.')}}}),Object.defineProperties(tr.prototype,{cullFace:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.')}},renderReverseSided:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.')}},renderSingleSided:{get:function(){return console.warn('THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.'),void 0},set:function(){console.warn('THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.')}}}),Object.defineProperties(U.prototype,{wrapS:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS},set:function(rg){console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS=rg}},wrapT:{get:function(){return console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT},set:function(rg){console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT=rg}},magFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter},set:function(rg){console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter=rg}},minFilter:{get:function(){return console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter},set:function(rg){console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter=rg}},anisotropy:{get:function(){return console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy},set:function(rg){console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy=rg}},offset:{get:function(){return console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset},set:function(rg){console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset=rg}},repeat:{get:function(){return console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat},set:function(rg){console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat=rg}},format:{get:function(){return console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format},set:function(rg){console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format=rg}},type:{get:function(){return console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type},set:function(rg){console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type=rg}},generateMipmaps:{get:function(){return console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps},set:function(rg){console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps=rg}}}),Object.defineProperties(dr.prototype,{standing:{set:function(){console.warn('THREE.WebVRManager: .standing has been removed.')}},userHeight:{set:function(){console.warn('THREE.WebVRManager: .userHeight has been removed.')}}}),zi.prototype.load=function(rg){console.warn('THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.');var ag=this,og=new Pi;return og.load(rg,function(ig){ag.setBuffer(ig)}),this},Bi.prototype.getData=function(){return console.warn('THREE.AudioAnalyser: .getData() is now .getFrequencyData().'),this.getFrequencyData()},Ci.prototype.updateCubeMap=function(rg,ag){return console.warn('THREE.CubeCamera: .updateCubeMap() is now .update().'),this.update(rg,ag)},Mp.crossOrigin=void 0,Mp.loadTexture=function(rg,ag,og,ig){console.warn('THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.');var ng=new Do;ng.setCrossOrigin(this.crossOrigin);var sg=ng.load(rg,og,void 0,ig);return ag&&(sg.mapping=ag),sg},Mp.loadTextureCube=function(rg,ag,og,ig){console.warn('THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.');var ng=new zo;ng.setCrossOrigin(this.crossOrigin);var sg=ng.load(rg,og,void 0,ig);return ag&&(sg.mapping=ag),sg},Mp.loadCompressedTexture=function(){console.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')},Mp.loadCompressedTextureCube=function(){console.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')};const Bm=Math.PI/6,Nm=1,Um=0,Gm=0.01;class Om{constructor(rg,ag,og,ig){this.camera=new sr(45,rg/ag,0.25,200),this.camera.position.x=og[0],this.camera.position.y=og[1],this.camera.position.z=og[2],this.camera.rotation.x=ig*Math.PI/180,this.isRotating=!1,this.rotationDirection=Nm}getCamera(){return this.camera}rotate(){if(this.isRotating||0!=this.camera.rotation.z){if(!this.isRotating){if(this.rotationDirection==Nm){if(0>this.camera.rotation.z&&(this.camera.rotation.z+=Gm,0<=this.camera.rotation.z))return this.camera.rotation.z=0,void(this.rotationDirection=Um);this.camera.rotation.z+=Gm,this.camera.rotation.z>=Bm&&(this.camera.rotation.z=Bm,this.rotationDirection=Um)}else{if(0<this.camera.rotation.z&&(this.camera.rotation.z-=Gm,0>=this.camera.rotation.z))return this.camera.rotation.z=0,void(this.rotationDirection=Nm);this.camera.rotation.z-=Gm,this.camera.rotation.z<=-Bm&&(this.camera.rotation.z=-Bm,this.rotationDirection=Nm)}return}this.rotationDirection==Nm?(this.camera.rotation.z+=Gm,this.camera.rotation.z>=Bm&&(this.camera.rotation.z=Bm,this.rotationDirection=Um)):(this.camera.rotation.z-=Gm,this.camera.rotation.z<=-Bm&&(this.camera.rotation.z=-Bm,this.rotationDirection=Nm))}}setRotation(){this.isRotating=!0}unsetRotation(){this.isRotating=!1}}const Fm=1.5,Hm=0.14;var Vm,km;const Wm=0.3,jm=62.8;class Xm{constructor(rg,ag){this.edge=rg;var og=new Se(rg,rg,rg),ig=new ro({color:ag});this.player=new Ce(og,ig),'/desktop/game.php'==document.location.pathname&&(this.player.receiveShadow=!0,this.player.castShadow=!0),this.playerBaseY=rg/2,this.player.position.y=this.playerBaseY,this.player.position.z=0,this.player.position.x=0,this.currentPosition=0,this.command=-1,this.next_command=-1,this.time=0,this.second_turn=!1,this.isTranslating=0,this.wantsToTranslate=!1,this.isOnTheSecondLevel=!1,this.going_down=!1,Vm=8*Hm/Math.pow(Fm,2),km=4*Hm/Fm}getPlayer(){return this.player}getPositionX(){return this.player.position.x}getPositionY(){return this.player.position.y}getPositionZ(){return this.player.position.z}getBottomPositionY(){return this.player.position.y-this.edge/2}goDown(){this.going_down&&(this.getBottomPositionY()<this.edge/2?(this.playerBaseY=this.edge/2,this.player.position.y=this.playerBaseY,this.going_down=!1,this.translateCommand()):this.player.position.y-=0.1*Bu)}rotate(){if(0!=this.isTranslating&&this.translateAux(),-1!=this.command){let rg=3/2*(Math.PI/jm/Wm)*Bu;if(0==this.currentPosition&&1==this.command&&this.isOnTheSecondLevel){if(!this.second_turn){this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=this.edge/2,ng=this.edge;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),this.player.rotation.z<-Math.PI&&(this.player.rotation.z=-Math.PI/2,this.player.position.y=this.edge/2,this.player.position.x=this.edge,this.second_turn=!0)}else{this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=3*this.edge/2,ng=0;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),this.player.rotation.z<-Math.PI&&(this.player.rotation.z=-Math.PI,this.player.position.y=this.edge/2,this.player.position.x=2*this.edge,this.second_turn=!1,this.isOnTheSecondLevel=!1,this.currentPosition=1,this.command=this.next_command,this.next_command=-1,this.isOnTheSecondLevel=!1,this.playerBaseY=this.edge/2)}return}if(0==this.currentPosition&&2==this.command&&this.isOnTheSecondLevel){if(!this.second_turn){this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-this.edge/2,ng=this.edge;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),this.player.rotation.z>Math.PI&&(this.player.rotation.z=Math.PI/2,this.player.position.y=this.edge/2,this.player.position.x=-this.edge,this.second_turn=!0)}else{this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-3*this.edge/2,ng=0;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),this.player.rotation.z>Math.PI&&(this.player.rotation.z=Math.PI,this.player.position.y=this.edge/2,this.player.position.x=-2*this.edge,this.second_turn=!1,this.isOnTheSecondLevel=!1,this.currentPosition=-1,this.command=this.next_command,this.next_command=-1,this.isOnTheSecondLevel=!1,this.playerBaseY=this.edge/2)}return}if(-1==this.currentPosition&&0==this.command&&this.isOnTheSecondLevel){if(!this.second_turn){this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-3*this.edge/2,ng=this.edge;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),0>this.player.rotation.z&&(this.player.rotation.z=Math.PI/2,this.player.position.y=this.edge/2,this.player.position.x=-this.edge,this.second_turn=!0)}else{this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-this.edge/2,ng=0;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),0>this.player.rotation.z&&(this.player.rotation.z=0,this.player.position.y=this.edge/2,this.player.position.x=0,this.second_turn=!1,this.isOnTheSecondLevel=!1,this.currentPosition=0,this.command=this.next_command,this.next_command=-1,this.isOnTheSecondLevel=!1,this.playerBaseY=this.edge/2)}return}if(1==this.currentPosition&&3==this.command&&this.isOnTheSecondLevel){if(!this.second_turn){this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=3*this.edge/2,ng=this.edge;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),0<this.player.rotation.z&&(this.player.rotation.z=-Math.PI/2,this.player.position.y=this.edge/2,this.player.position.x=this.edge,this.second_turn=!0)}else{this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=this.edge/2,ng=0;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),0<this.player.rotation.z&&(this.player.rotation.z=0,this.player.position.y=this.edge/2,this.player.position.x=0,this.second_turn=!1,this.isOnTheSecondLevel=!1,this.currentPosition=0,this.command=this.next_command,this.next_command=-1,this.isOnTheSecondLevel=!1,this.playerBaseY=this.edge/2)}return}if(rg=Math.PI/jm/Wm*Bu,0==this.currentPosition&&1==this.command){if(!this.second_turn){this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),this.player.rotation.z<-Math.PI/2&&(this.player.rotation.z=-Math.PI/2,this.player.position.y=this.playerBaseY,this.player.position.x=this.edge,this.second_turn=!0)}else{this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=this.edge+this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),this.player.rotation.z<-Math.PI&&(this.player.rotation.z=-Math.PI,this.player.position.y=this.playerBaseY,this.player.position.x=2*this.edge,this.currentPosition=1,this.command=this.next_command,this.next_command=-1,this.second_turn=!1)}}else if(0==this.currentPosition&&2==this.command){if(!this.second_turn){this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),this.player.rotation.z>Math.PI/2&&(this.player.rotation.z=Math.PI/2,this.player.position.x=-this.edge,this.player.position.y=this.playerBaseY,this.second_turn=!0)}else{this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-this.edge-this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),this.player.rotation.z>Math.PI&&(this.player.rotation.z=Math.PI,this.player.position.x=-2*this.edge,this.player.position.y=this.playerBaseY,this.currentPosition=-1,this.command=this.next_command,this.next_command=-1,this.second_turn=!1)}}else if(-1==this.currentPosition&&0==this.command){if(!this.second_turn){this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-this.edge-this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),this.player.rotation.z<Math.PI/2&&(this.player.rotation.z=Math.PI/2,this.player.position.x=-this.edge,this.player.position.y=this.playerBaseY,this.second_turn=!0)}else{this.player.rotation.z-=rg;let ag=this.player.position.x,og=this.player.position.y,ig=-this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(-rg)-(og-ng)*Math.sin(-rg),this.player.position.y=ng+(ag-ig)*Math.sin(-rg)+(og-ng)*Math.cos(-rg),0>this.player.rotation.z&&(this.player.rotation.z=0,this.player.position.x=0,this.player.position.y=this.playerBaseY,this.currentPosition=0,this.command=this.next_command,this.next_command=-1,this.second_turn=!1)}}else if(1!=this.currentPosition||3!=this.command)4==this.command?this.wantsToTranslate||(this.player.position.y+=(-(1/2)*Vm*Math.pow(this.time+0.05,2)+km*(this.time+0.05)-(-(1/2)*Vm*Math.pow(this.time,2)+km*this.time))/0.05,this.time+=0.05,this.player.rotation.x-=3/2*Math.PI/(Fm/0.05),this.player.position.y<this.playerBaseY&&(this.player.position.y=this.playerBaseY,this.player.rotation.x=0,this.command=this.next_command,this.next_command=-1,this.time=0)):(this.command=this.next_command,this.next_command=-1);else if(!this.second_turn){this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=this.edge+this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),this.player.rotation.z>-Math.PI/2&&(this.player.rotation.z=-Math.PI/2,this.player.position.x=this.edge,this.player.position.y=this.playerBaseY,this.second_turn=!0)}else{this.player.rotation.z+=rg;let ag=this.player.position.x,og=this.player.position.y,ig=this.edge/2,ng=-this.edge/2+this.playerBaseY;this.player.position.x=ig+(ag-ig)*Math.cos(rg)-(og-ng)*Math.sin(rg),this.player.position.y=ng+(ag-ig)*Math.sin(rg)+(og-ng)*Math.cos(rg),0<this.player.rotation.z&&(this.player.rotation.z=0,this.player.position.x=0,this.player.position.y=this.playerBaseY,this.currentPosition=0,this.command=this.next_command,this.next_command=-1,this.second_turn=!1)}}}translateX(rg){0==this.isTranslating&&0==this.jumpingTranslatingIsPossible()?-1==rg&&0==this.currentPosition?(this.isTranslating=-1,this.wantsToTranslate=!0):1==rg&&0==this.currentPosition?(this.isTranslating=1,this.wantsToTranslate=!0):-1==rg&&1==this.currentPosition?(this.isTranslating=2,this.wantsToTranslate=!0):1==rg&&-1==this.currentPosition&&(this.isTranslating=-2,this.wantsToTranslate=!0):-1==rg&&0==this.currentPosition?this.setCommand(2):1==rg&&0==this.currentPosition?this.setCommand(1):-1==rg&&1==this.currentPosition?this.setCommand(3):1==rg&&-1==this.currentPosition&&this.setCommand(0)}translateAux(){let rg=2*(2*this.edge/jm/Wm)*Bu;1==this.isTranslating?(this.player.position.x+=rg,this.player.position.x>2*this.edge&&(this.player.position.x=2*this.edge,this.isTranslating=0,this.player.rotation.z=-Math.PI,this.currentPosition=1,this.wantsToTranslate=!1)):-1==this.isTranslating?(this.player.position.x-=rg,this.player.position.x<-2*this.edge&&(this.player.position.x=-2*this.edge,this.isTranslating=0,this.player.rotation.z=Math.PI,this.currentPosition=-1,this.wantsToTranslate=!1)):2==this.isTranslating?(this.player.position.x-=rg,0>this.player.position.x&&(this.player.position.x=0,this.isTranslating=0,this.player.rotation.z=0,this.currentPosition=0,this.wantsToTranslate=!1)):-2==this.isTranslating&&(this.player.position.x+=rg,0<this.player.position.x&&(this.player.position.x=0,this.isTranslating=0,this.player.rotation.z=0,this.currentPosition=0,this.wantsToTranslate=!1))}jumpingTranslatingIsPossible(){return this.time<=Fm-Fm*0.2?0:1}setCommand(rg){-1==this.command?this.command=rg:-1==this.next_command&&(this.next_command=rg)}setNextCommand(rg){-1==this.next_command&&(this.next_command=rg)}translateCommand(){this.command=this.next_command,this.next_command=-1}}const Zm=30;var Jm;const Qm=200;class Km{constructor(rg,ag,og,ig){Jm=2.5*rg;let ng=new Te(ag,og),sg=new ro({color:ig});this.ground=new Ce(ng,sg),'/desktop/game.php'==document.location.pathname&&(this.ground.receiveShadow=!0);let lg=new Se(Zm,Jm,Qm),pg=new ro({color:5658198});this.rightSide=new Ce(lg,pg),this.leftSide=new Ce(lg,pg),'/desktop/game.php'==document.location.pathname&&(this.rightSide.receiveShadow=!0,this.leftSide.receiveShadow=!0),this.rightSide.position.x=4*rg+Zm/2,this.rightSide.position.y=Jm/2,this.rightSide.position.z=-Qm/2+3,this.leftSide.position.x=-(4*rg+Zm/2),this.leftSide.position.y=Jm/2,this.leftSide.position.z=-Qm/2+3,this.ground.rotation.x=-90*Math.PI/180,this.changeColor(16777215*Math.random())}getGround(){return this.ground}changeColor(rg){this.getGround().material.color.setHex(rg),this.leftSide.material.color.setHex(rg),this.rightSide.material.color.setHex(rg)}}const $m=30,eu=50,tu=150,ru=0,au=1,ou=0,iu=1,nu=-1,lu=4,du=10;class uu{constructor(rg,ag){this.length=Math.random()*$m+du,this.PLAYER_EDGE=ag;var og=new Se(ag,ag,this.length),ig=new ro;this.center_y=ag/2,this.obstacle=new Ce(og,ig),'/desktop/game.php'==document.location.pathname&&(this.obstacle.castShadow=!0,this.obstacle.receiveShadow=!0),this.playing=!1,this.type=ru,this.lane,this.black_and_white=!1,this.interceptions=0,this.setPosition(rg)}setPosition(rg,ag,og){if(this.setObstacleColor(this.black_and_white),this.chose_lane(ag),this.obstacle.position.z=null==rg[this.lane]||rg[this.lane].getTailPositionZ()>-1*(tu+du)?-1*Math.random()*eu-tu-this.length:-1*Math.random()*eu+rg[this.lane].getTailPositionZ()-this.length-2,this.interceptions=0,void 0!=og){for(let ig=0;ig<og.length;ig+=1)this.intercept(og[ig])&&(og[ig].interceptions+=1+this.interceptions,this.interceptions+=og[ig].interceptions);if(2>this.interceptions){let ig=Math.round(Math.random()+1);this.obstacle.scale.y=ig,this.type=ig-1,this.obstacle.position.y=this.PLAYER_EDGE/2*ig}else this.obstacle.scale.y=1,this.type=ru,this.obstacle.position.y=this.PLAYER_EDGE/2}else{let ig=Math.round(Math.random()+1);this.obstacle.scale.y=ig,this.type=ig-1,this.obstacle.position.y=this.PLAYER_EDGE/2*ig}}getObstacle(){return this.obstacle}getPositionZ(){return this.obstacle.position.z}getPositionX(){return this.obstacle.position.x}getPositionY(){return this.obstacle.position.y}getTailPositionZ(){return this.obstacle.position.z-this.length/2}getFrontPositionZ(){return this.obstacle.position.z+this.length/2}getTop(){return 3*this.obstacle.position.y}setObstacleColor(rg){rg?this.obstacle.material.color.setHex(16777215):this.obstacle.material.color.setHex(16777215*Math.random())}setBlackAndWhite(rg){this.black_and_white=rg}getLane(){return this.lane}intercept(rg){return rg.playing&&this.getFrontPositionZ()<rg.getFrontPositionZ()+lu&&this.getFrontPositionZ()>rg.getTailPositionZ()-lu&&rg.type==au||rg.playing&&this.getTailPositionZ()<rg.getFrontPositionZ()+lu&&this.getTailPositionZ()>rg.getTailPositionZ()-lu&&rg.type==au}chose_lane(rg){var ag=Math.random();null==rg?0.33>=ag?(this.lane=0,this.obstacle.position.x=2*nu*this.PLAYER_EDGE):0.33<ag&&0.66>ag?(this.lane=1,this.obstacle.position.x=ou):(this.lane=2,this.obstacle.position.x=2*iu*this.PLAYER_EDGE):0==rg?0.1>=ag?(this.lane=0,this.obstacle.position.x=2*nu*this.PLAYER_EDGE):0.1<ag&&0.55>ag?(this.lane=1,this.obstacle.position.x=ou):(this.lane=2,this.obstacle.position.x=2*iu*this.PLAYER_EDGE):1==rg?0.45>=ag?(this.lane=0,this.obstacle.position.x=2*nu*this.PLAYER_EDGE):0.45<ag&&0.55>ag?(this.lane=1,this.obstacle.position.x=ou):(this.lane=2,this.obstacle.position.x=2*iu*this.PLAYER_EDGE):2==rg&&(0.45>=ag?(this.lane=0,this.obstacle.position.x=2*nu*this.PLAYER_EDGE):0.45<ag&&0.9>ag?(this.lane=1,this.obstacle.position.x=ou):(this.lane=2,this.obstacle.position.x=2*iu*this.PLAYER_EDGE))}}const gu=10,fu=1.5,hu=[0,5,8],xu=hu[2]+$m,vu=0.9;class Eu{constructor(rg,ag){this.scene=new fr,this.camera=new Om(rg,ag,hu,-20),this.player=new Xm(fu,16777215),this.ground=new Km(fu,500,500,0),this.scene.fog=new gr(16777215,50,140),this.obstacles=[],this.living_obstacles=0,this.VELOCITY_STEP=Ru,this.hemisphereLight=new si(16777215,0,vu),this.sun=new gi(16777215,vu),this.time=0,this.isFlashing=!1,this.clock=new Ri,this.last_tail_position_z=[null,null,null],this.last_lane=null,this.generateObstacles(),this.addObjectsToScene()}generateObstacles(){for(let rg=0,ag;rg<gu;rg++)ag=new uu(this.last_tail_position_z,fu),this.obstacles.push(ag),this.scene.add(ag.obstacle)}startObstacle(){let rg=this.obstacles.findIndex(function(ng){return!ng.playing}),ag=this.obstacles[rg];ag.setPosition(this.last_tail_position_z,this.last_lane,this.obstacles);let og=ag.getLane();this.last_lane=ag.getLane(),this.last_tail_position_z[og]=ag,this.obstacles[rg].playing=!0,this.living_obstacles+=1}addObjectsToScene(){this.scene.add(this.player.getPlayer()),this.scene.add(this.ground.ground),this.scene.add(this.ground.rightSide),this.scene.add(this.ground.leftSide),this.addLight()}addLight(){this.sun.position.set(12,6,7),'/desktop/game.php'==document.location.pathname&&(this.sun.castShadow=!0,this.sun.shadow.mapSize.width=256,this.sun.shadow.mapSize.height=256,this.sun.shadow.camera.near=0.5,this.sun.shadow.camera.far=50),this.scene.add(this.sun),this.scene.add(this.hemisphereLight)}getScene(){return this.scene}obstacleMovement(rg){let ag=this.obstacles[rg];return ag.playing?ag.getPositionZ()>xu?(ag.playing=!1,this.living_obstacles-=1,1):(ag.getObstacle().position.z+=this.VELOCITY_STEP,0):0}getObstacleTailPositionZ(rg){return this.obstacles[rg].getTailPositionZ()}getObstacleFrontPositionZ(rg){return this.obstacles[rg].getFrontPositionZ()}getObstaclePositionZ(rg){return this.obstacles[rg].getPositionZ()}getObstaclePositionX(rg){return this.obstacles[rg].getPositionX()}getObstaclePositionY(rg){return this.obstacles[rg].getPositionY()}getObstacleTop(rg){return this.obstacles[rg].getTop()}setObstacleColor(rg){for(let ag=0;ag<gu;ag++)this.obstacles[ag].setObstacleColor(rg),this.obstacles[ag].setBlackAndWhite(rg)}flashLight(){return this.isFlashing||this.sun.intensity!=vu?this.isFlashing?void(this.sun.intensity=vu/2*Math.cos(this.time)+vu/2,this.hemisphereLight.intensity=vu/2*Math.cos(this.time)+vu/2,this.time+=0.05):(this.sun.intensity=vu,this.hemisphereLight.intensity=vu,void(this.time=0)):void 0}enableFlashing(){this.isFlashing=!0}disableFlashing(){this.isFlashing=!1}}const Cu=0.1,Ru=0.5;var Bu=1,Nu=1;class Gu{constructor(){this.loop=this.goGame.bind(this),this.started=!1,this.score=0,this.scoreText,this.clock=new Ri,this.sceneWidth=window.innerWidth,this.sceneHeight=window.innerHeight,this.renderer='/desktop/game.php'==document.location.pathname?new mr({antialias:!0}):new mr,this.myscene=new Eu(this.sceneWidth,this.sceneHeight),this.obstacle_index=0,this.player_on_obstacle_index=-1,this.level=0,this.special_level=-1,this.isLiving=!0,this.finished=!1,window.addEventListener('resize',this.onWindowResize.bind(this),!1),'/desktop/game.php'==document.location.pathname?document.onkeydown=this.handleKeyDown.bind(this):(document.onkeydown=this.handleKeyDown.bind(this),this.enableSwipes()),this.inizializeCanvas()}inizializeCanvas(){this.renderer.setClearColor(16775930,1),this.renderer.setPixelRatio(window.devicePixelRatio),'/desktop/game.php'==document.location.pathname&&(this.renderer.shadowMap.enabled=!0),this.renderer.setSize(this.sceneWidth,this.sceneHeight),document.body.appendChild(this.renderer.domElement),this.scoreText=document.getElementById('scoreText')}renderize(){this.renderer.render(this.myscene.getScene(),this.myscene.camera.getCamera())}goGame(){if(!this.finished)window.requestAnimationFrame(this.loop),this.started&&(this.isLiving?(this.myscene.player.rotate(),this.myscene.player.goDown(),this.obstacleLogic(),this.myscene.camera.rotate(),this.myscene.flashLight()):(this.myscene.sun.intensity=vu,this.myscene.hemisphereLight.intensity=vu,this.die())),this.renderize();else{Tn(Vu);var rg=new XMLHttpRequest;rg.onreadystatechange=function(){4==this.readyState&&200==this.status&&(document.getElementById('new_record').innerHTML='<h1 id = \'game_over_text\'>'+this.responseText+'</h1>')},rg.open('GET','../server_side/setHighscore.php?q='+this.score,!0),rg.send(),document.getElementById('game_over').innerHTML='<h1 id=\'game_over_text\'>Game Over</h1>',document.getElementById('score_on_gameover').innerHTML='<h1 id = \'game_over_text\'>'+this.score+'</h1>'}}die(){this.myscene.player.getPlayer().rotation.y+=5*Math.PI/180,0.05>this.myscene.player.getPlayer().position.x&&-0.05<this.myscene.player.getPlayer().position.x||(-1==this.myscene.player.currentPosition?this.myscene.player.getPlayer().position.x+=0.05:1==this.myscene.player.currentPosition&&(this.myscene.player.getPlayer().position.x-=0.05)),2<this.myscene.player.getPlayer().position.z||(this.myscene.player.getPlayer().position.z+=0.05),3<this.myscene.player.getPlayer().position.y||(this.myscene.player.getPlayer().position.y+=0.05),0<this.myscene.player.getPlayer().scale.x?(this.myscene.player.getPlayer().scale.x-=5e-3,this.myscene.player.getPlayer().scale.z-=5e-3,this.myscene.player.getPlayer().scale.y-=5e-3):this.finished=!0}gameOver(){this.isLiving=!1}collisionLogic(rg){if(!this.myscene.player.isOnTheSecondLevel)this.myscene.player.getPositionZ()-fu/2<=this.myscene.getObstacleFrontPositionZ(rg)&&this.myscene.player.getPositionZ()>=this.myscene.getObstacleTailPositionZ(rg)&&(this.myscene.player.getPositionX()-fu/2==this.myscene.getObstaclePositionX(rg)+fu/2||this.myscene.player.getPositionX()+fu/2==this.myscene.getObstaclePositionX(rg)-fu/2||this.myscene.player.getPositionX()==this.myscene.getObstaclePositionX(rg))&&(this.myscene.player.getPositionY()>this.myscene.getObstacleTop(rg)&&!this.myscene.player.isOnTheSecondLevel?(this.myscene.player.playerBaseY=this.myscene.getObstacleTop(rg),this.myscene.player.isOnTheSecondLevel=!0,this.player_on_obstacle_index=rg):!this.myscene.player.isOnTheSecondLevel&&this.gameOver());else if(this.player_on_obstacle_index==rg)if(this.myscene.player.getPositionZ()+fu/2<this.myscene.getObstacleTailPositionZ(rg))this.myscene.player.going_down=!0,this.myscene.player.isOnTheSecondLevel=!1,this.player_on_obstacle_index=-1;else if(this.myscene.player.getPositionX()!=this.myscene.getObstaclePositionX(rg))if(0==this.myscene.player.command||1==this.myscene.player.command||2==this.myscene.player.command||3==this.myscene.player.command)this.player_on_obstacle_index=-1;else{let ag=!1;for(let og=0;og<gu;og+=1)this.myscene.player.getPositionX()==this.myscene.obstacles[og].getPositionX()&&this.myscene.obstacles[og].getFrontPositionZ()>=this.myscene.player.getPositionZ()+fu&&this.myscene.obstacles[og].getTailPositionZ()<=this.myscene.player.getPositionZ()-fu&&this.myscene.obstacles[og].type==0&&(ag=!0,this.player_on_obstacle_index=og);ag||4==this.myscene.player.command||(this.myscene.player.going_down=!0,this.myscene.player.isOnTheSecondLevel=!1,this.player_on_obstacle_index=-1)}}changeLevel(){this.level<10&&(Nu-=0.1,this.myscene.VELOCITY_STEP+=Cu,Bu+=1*Cu/5/Ru),this.changeLevelAux()}scorelogic(rg){this.score+=rg*100,this.scoreText.innerHTML=this.score.toString(),Math.floor(this.score/1e3)!=this.level&&(this.changeLevel(),this.level+=1)}obstacleLogic(){let rg=this.myscene.living_obstacles;rg<8&&this.clock.getElapsedTime()>Nu&&(this.clock.elapsedTime=0,this.myscene.startObstacle());let ag=0;for(let og=0;og<gu;og+=1)ag+=this.myscene.obstacleMovement(og),this.collisionLogic(og);this.scorelogic(ag)}onWindowResize(){this.sceneHeight=window.innerHeight,this.sceneWidth=window.innerWidth,this.renderer.setSize(this.sceneWidth,this.sceneHeight),this.myscene.camera.getCamera().aspect=this.sceneWidth/this.sceneHeight,this.myscene.camera.getCamera().updateProjectionMatrix()}handleKeyDown(rg){this.started&&(37==rg.keyCode||65==rg.keyCode||'swipeleft'==rg?-1==this.myscene.player.command?0==this.myscene.player.currentPosition?this.myscene.player.command=2:1==this.myscene.player.currentPosition&&(this.myscene.player.command=3):4==this.myscene.player.command?this.myscene.player.translateX(-1):-1==this.myscene.player.next_command&&(0==this.myscene.player.currentPosition&&1==this.myscene.player.command?this.myscene.player.next_command=3:-1==this.myscene.player.currentPosition&&0==this.myscene.player.command?this.myscene.player.next_command=2:1==this.myscene.player.currentPosition&&3==this.myscene.player.command&&(this.myscene.player.next_command=2)):39==rg.keyCode||68==rg.keyCode||'swiperight'==rg?-1==this.myscene.player.command?0==this.myscene.player.currentPosition?this.myscene.player.command=1:-1==this.myscene.player.currentPosition&&(this.myscene.player.command=0):4==this.myscene.player.command?this.myscene.player.translateX(1):-1==this.myscene.player.next_command&&(1==this.myscene.player.currentPosition&&3==this.myscene.player.command?this.myscene.player.next_command=1:-1==this.myscene.player.currentPosition&&0==this.myscene.player.command?this.myscene.player.next_command=1:0==this.myscene.player.currentPosition&&2==this.myscene.player.command&&(this.myscene.player.next_command=0)):38!=rg.keyCode&&87!=rg.keyCode&&32!=rg.keyCode&&'swipeup'!=rg||this.myscene.player.isOnTheSecondLevel||-1!=this.myscene.player.command||!1!=this.myscene.player.going_down?80==rg.keyCode&&In():this.myscene.player.command=4)}enableSwipes(){let rg=new Hammer(document.getElementById('fullspace'));rg.get('swipe').set({direction:Hammer.DIRECTION_ALL}),rg.on('swipeleft swiperight swipeup',ag=>this.handleKeyDown(ag.type))}changeLevelAux(){let rg=Math.random();this.turnOffSpecial(),rg<0.5?this.changeToNormalLevel():this.changeToSpecialLevel()}changeToNormalLevel(){this.myscene.ground.changeColor(16777215*Math.random())}changeToSpecialLevel(){let rg=Math.floor(Math.random()*3);this.special_level=rg,0==rg?this.blackAndWhite():1==rg?this.rotationLevel():2==rg&&this.flashingLights()}turnOffSpecial(){0==this.special_level?this.myscene.setObstacleColor(!1):1==this.special_level?this.myscene.camera.unsetRotation():2==this.special_level&&this.myscene.disableFlashing(),this.special_level=-1}blackAndWhite(){this.myscene.ground.changeColor(0),this.myscene.setObstacleColor(!0)}rotationLevel(){this.changeToNormalLevel(),this.myscene.camera.setRotation()}flashingLights(){this.changeToNormalLevel(),this.myscene.enableFlashing()}}var Ou;const Fu=1,Hu=2,Vu=3;var eg=sessionStorage.getItem('isSoundActive'),ku,Wu,ju,qu,Yu,Xu,Zu,Ju,Qu,Ku,$u;null==eg&&(eg='true',sessionStorage.setItem('isSoundActive','true'));var tg;return $(document).ready(function(){_n(),Rn(),bn(),window.setInterval(bn,5e3),Tn(Fu),Mn(),Ou=new Gu,Ou.goGame(),Ou.started=!0}),S.PLAY=Fu,S.PAUSE=Hu,S.DEAD=Vu,S.setButtonVisibility=Tn,S.goToPause=In,S}({});